(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(Re,E,i){var T=i("JHRd");function m(X){var z=new X.constructor(X.byteLength);return new T(z).set(new T(X)),z}Re.exports=m},"+Qka":function(Re,E,i){var T=i("fmRc"),m=i("t2Dn"),X=i("cq/+"),z=i("T1AV"),o=i("GoyQ"),Z=i("mTTR"),D=i("itsj");function K(re,fe,Y,Fe,We){if(re===fe)return;X(fe,function(ge,we){if(We||(We=new T),o(ge))z(re,fe,we,Y,K,Fe,We);else{var dt=Fe?Fe(D(re,we),ge,we+"",re,fe,We):void 0;dt===void 0&&(dt=ge),m(re,we,dt)}},Z)}Re.exports=K},"+VLl":function(Re,E,i){"use strict";i.d(E,"a",function(){return ge});var T=i("lSNA"),m=i.n(T),X=i("J4zp"),z=i.n(X),o=i("Hel2"),Z=Math.PI/3,D=[0,Z,2*Z,3*Z,4*Z,5*Z];function K(we){return we[0]}function re(we){return we[1]}var fe=function(){var we=0,dt=0,ke=1,Et=1,Ze=K,vt=re,Qe,yt,_t;function De(Ue){var st={},Le=[],ut,Gt=Ue.length;for(ut=0;ut<Gt;++ut){if(isNaN(ar=+Ze.call(null,Kt=Ue[ut],ut,Ue))||isNaN(oe=+vt.call(null,Kt,ut,Ue)))continue;var Kt,ar,oe,Q=Math.round(oe=oe/_t),H=Math.round(ar=ar/yt-(Q&1)/2),Ce=oe-Q;if(Math.abs(Ce)*3>1){var Ee=ar-H,_e=H+(ar<H?-1:1)/2,ve=Q+(oe<Q?-1:1),rt=ar-_e,$t=oe-ve;Ee*Ee+Ce*Ce>rt*rt+$t*$t&&(H=_e+(Q&1?1:-1)/2,Q=ve)}var St=H+"-"+Q,ye=st[St];ye?ye.push(Kt):(Le.push(ye=st[St]=[Kt]),ye.x=(H+(Q&1)/2)*yt,ye.y=Q*_t)}return Le}function Ne(Ue){var st=0,Le=0;return D.map(function(ut){var Gt=Math.sin(ut)*Ue,Kt=-Math.cos(ut)*Ue,ar=Gt-st,oe=Kt-Le;return st=Gt,Le=Kt,[ar,oe]})}return De.hexagon=function(Ue){return"m"+Ne(Ue==null?Qe:+Ue).join("l")+"z"},De.centers=function(){for(var Ue=[],st=Math.round(dt/_t),Le=Math.round(we/yt),ut=st*_t;ut<Et+Qe;ut+=_t,++st)for(var Gt=Le*yt+(st&1)*yt/2;Gt<ke+yt/2;Gt+=yt)Ue.push([Gt,ut]);return Ue},De.mesh=function(){var Ue=Ne(Qe).slice(0,4).join("l");return De.centers().map(function(st){return"M"+st+"m"+Ue}).join("")},De.x=function(Ue){return arguments.length?(Ze=Ue,De):Ze},De.y=function(Ue){return arguments.length?(vt=Ue,De):vt},De.radius=function(Ue){return arguments.length?(Qe=+Ue,yt=Qe*2*Math.sin(Z),_t=Qe*1.5,De):Qe},De.size=function(Ue){return arguments.length?(we=dt=0,ke=+Ue[0],Et=+Ue[1],De):[ke-we,Et-dt]},De.extent=function(Ue){return arguments.length?(we=+Ue[0][0],dt=+Ue[0][1],ke=+Ue[1][0],Et=+Ue[1][1],De):[[we,dt],[ke,Et]]},De.radius(1)};function Y(we,dt){var ke=Object.keys(we);if(Object.getOwnPropertySymbols){var Et=Object.getOwnPropertySymbols(we);dt&&(Et=Et.filter(function(Ze){return Object.getOwnPropertyDescriptor(we,Ze).enumerable})),ke.push.apply(ke,Et)}return ke}function Fe(we){for(var dt=1;dt<arguments.length;dt++){var ke=arguments[dt]!=null?arguments[dt]:{};dt%2?Y(Object(ke),!0).forEach(function(Et){m()(we,Et,ke[Et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(ke)):Y(Object(ke)).forEach(function(Et){Object.defineProperty(we,Et,Object.getOwnPropertyDescriptor(ke,Et))})}return we}var We=6378e3;function ge(we,dt){var ke=we.dataArray,Et=dt.size,Ze=Et===void 0?10:Et,vt=dt.method,Qe=vt===void 0?"sum":vt,yt=Ze/(2*Math.PI*We)*(256<<20)/2,_t=ke.map(function(st){var Le=Object(o.d)(st.coordinates),ut=z()(Le,2),Gt=ut[0],Kt=ut[1];return Fe(Fe({},st),{},{coordinates:[Gt,Kt]})}),De=fe().radius(yt).x(function(st){return st.coordinates[0]}).y(function(st){return st.coordinates[1]}),Ne=De(_t),Ue={dataArray:Ne.map(function(st,Le){var ut;if(dt.field&&Qe){var Gt=o.c.getColumn(st,dt.field);st[Qe]=o.c.statMap[Qe](Gt)}return ut={},m()(ut,dt.method,st[Qe]),m()(ut,"count",st.length),m()(ut,"rawData",st),m()(ut,"coordinates",[st.x,st.y]),m()(ut,"_id",Le),ut}),radius:yt,xOffset:yt,yOffset:yt,type:"hexagon"};return Ue}},"+em5":function(Re,E,i){"use strict";i.d(E,"a",function(){return oe});var T=i("lSNA"),m=i.n(T),X=i("yG8O"),z=i.n(X),o=i("lwsE"),Z=i.n(o),D=i("W8MJ"),K=i.n(D),re=i("U+yc"),fe=i.n(re),Y=i("1ABj"),Fe=i.n(Y),We=i("gQMU"),ge=i.n(We),we=i("J2iB"),dt=i.n(we),ke=i("u6S6"),Et=i.n(ke),Ze=i("4cb6"),vt=i.n(Ze),Qe=i("h1nZ"),yt=i("bB6j"),_t=i("bPkA"),De,Ne,Ue,st,Le,ut;function Gt(Q,H){var Ce=Object.keys(Q);if(Object.getOwnPropertySymbols){var Ee=Object.getOwnPropertySymbols(Q);H&&(Ee=Ee.filter(function(_e){return Object.getOwnPropertyDescriptor(Q,_e).enumerable})),Ce.push.apply(Ce,Ee)}return Ce}function Kt(Q){for(var H=1;H<arguments.length;H++){var Ce=arguments[H]!=null?arguments[H]:{};H%2?Gt(Object(Ce),!0).forEach(function(Ee){m()(Q,Ee,Ce[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(Ce)):Gt(Object(Ce)).forEach(function(Ee){Object.defineProperty(Q,Ee,Object.getOwnPropertyDescriptor(Ce,Ee))})}return Q}var ar=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(De=Object(Ze.injectable)(),Ne=Object(Ze.inject)(yt.a.IShaderModuleService),De(Ue=(st=(ut=function(){function Q(){Z()(this,Q),z()(this,"shaderModuleService",Le,this),this.rendererService=void 0,this.config=void 0,this.quad=ar,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return K()(Q,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Ce){this.name=Ce}},{key:"getType",value:function(){return _t.a.PostProcessing}},{key:"init",value:function(Ce,Ee){this.config=Ee,this.rendererService=Ce.getContainer().get(yt.a.IRendererService);var _e=this.rendererService,ve=_e.createAttribute,rt=_e.createBuffer,$t=_e.createModel,St=this.setupShaders(),ye=St.vs,be=St.fs,Be=St.uniforms;this.model=$t({vs:ye,fs:be,attributes:{a_Position:ve({buffer:rt({data:[-4,-4,4,-4,0,4],type:Qe.gl.FLOAT}),size:2})},uniforms:Kt(Kt({u_Texture:null},Be),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Ce){var Ee=this,_e=Ce.multiPassRenderer.getPostProcessor(),ve=this.rendererService,rt=ve.useFramebuffer,$t=ve.getViewportSize,St=ve.clear,ye=$t(),be=ye.width,Be=ye.height;rt(this.renderToScreen?null:_e.getWriteFBO(),function(){St({framebuffer:_e.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),Ee.model.draw({uniforms:Kt({u_Texture:_e.getReadFBO(),u_ViewportSize:[be,Be]},Ee.convertOptionsToUniforms(Ee.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Ce){this.enabled=Ce}},{key:"setRenderToScreen",value:function(Ce){this.renderToScreen=Ce}},{key:"updateOptions",value:function(Ce){this.optionsToUpdate=Kt(Kt({},this.optionsToUpdate),Ce)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Ce){var Ee={};return Object.keys(Ce).forEach(function(_e){dt()(Ce[_e])||(Ee["u_".concat(ge()(Et()(_e)))]=Ce[_e])}),Ee}}]),Q}(),ut),Le=fe()(st.prototype,"shaderModuleService",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st))||Ue)},"+iFO":function(Re,E,i){var T=i("dTAl"),m=i("LcsW"),X=i("6sVZ");function z(o){return typeof o.constructor=="function"&&!X(o)?T(m(o)):{}}Re.exports=z},"/33/":function(Re,E){},"/Uc5":function(Re,E){},"/ezw":function(Re,E,i){"use strict";var T=i("lSNA"),m=i.n(T),X=i("pVnL"),z=i.n(X),o=i("cDf5"),Z=i.n(o),D=i("q1tI"),K=i("TSYQ"),re=i.n(K),fe=function(Ee){var _e=Ee.prefixCls,ve=Ee.className,rt=Ee.width,$t=Ee.style;return D.createElement("h3",{className:re()(_e,ve),style:z()({width:rt},$t)})},Y=fe,Fe=i("RIqP"),We=i.n(Fe),ge=function(Ee){var _e=function(Be){var lt=Ee.width,Pe=Ee.rows,ht=Pe===void 0?2:Pe;return Array.isArray(lt)?lt[Be]:ht-1===Be?lt:void 0},ve=Ee.prefixCls,rt=Ee.className,$t=Ee.style,St=Ee.rows,ye=We()(Array(St)).map(function(be,Be){return D.createElement("li",{key:Be,style:{width:_e(Be)}})});return D.createElement("ul",{className:re()(ve,rt),style:$t},ye)},we=ge,dt=i("H84U"),ke=function(Ee){var _e,ve,rt=Ee.prefixCls,$t=Ee.className,St=Ee.style,ye=Ee.size,be=Ee.shape,Be=re()((_e={},m()(_e,"".concat(rt,"-lg"),ye==="large"),m()(_e,"".concat(rt,"-sm"),ye==="small"),_e)),lt=re()((ve={},m()(ve,"".concat(rt,"-circle"),be==="circle"),m()(ve,"".concat(rt,"-square"),be==="square"),m()(ve,"".concat(rt,"-round"),be==="round"),ve)),Pe=typeof ye=="number"?{width:ye,height:ye,lineHeight:"".concat(ye,"px")}:{};return D.createElement("span",{className:re()(rt,Be,lt,$t),style:z()(z()({},Pe),St)})},Et=ke,Ze=i("BGR+"),vt=function(Ee){var _e=function(rt){var $t=rt.getPrefixCls,St=Ee.prefixCls,ye=Ee.className,be=Ee.active,Be=$t("skeleton",St),lt=Object(Ze.a)(Ee,["prefixCls"]),Pe=re()(Be,"".concat(Be,"-element"),m()({},"".concat(Be,"-active"),be),ye);return D.createElement("div",{className:Pe},D.createElement(Et,z()({prefixCls:"".concat(Be,"-avatar")},lt)))};return D.createElement(dt.a,null,_e)};vt.defaultProps={size:"default",shape:"circle"};var Qe=vt,yt=function(Ee){var _e=function(rt){var $t=rt.getPrefixCls,St=Ee.prefixCls,ye=Ee.className,be=Ee.active,Be=$t("skeleton",St),lt=Object(Ze.a)(Ee,["prefixCls"]),Pe=re()(Be,"".concat(Be,"-element"),m()({},"".concat(Be,"-active"),be),ye);return D.createElement("div",{className:Pe},D.createElement(Et,z()({prefixCls:"".concat(Be,"-button")},lt)))};return D.createElement(dt.a,null,_e)};yt.defaultProps={size:"default"};var _t=yt,De=function(Ee){var _e=function(rt){var $t=rt.getPrefixCls,St=Ee.prefixCls,ye=Ee.className,be=Ee.active,Be=$t("skeleton",St),lt=Object(Ze.a)(Ee,["prefixCls"]),Pe=re()(Be,"".concat(Be,"-element"),m()({},"".concat(Be,"-active"),be),ye);return D.createElement("div",{className:Pe},D.createElement(Et,z()({prefixCls:"".concat(Be,"-input")},lt)))};return D.createElement(dt.a,null,_e)};De.defaultProps={size:"default"};var Ne=De,Ue="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",st=function(Ee){var _e=function(rt){var $t=rt.getPrefixCls,St=Ee.prefixCls,ye=Ee.className,be=Ee.style,Be=$t("skeleton",St),lt=re()(Be,"".concat(Be,"-element"),ye);return D.createElement("div",{className:lt},D.createElement("div",{className:re()("".concat(Be,"-image"),ye),style:be},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Be,"-image-svg")},D.createElement("path",{d:Ue,className:"".concat(Be,"-image-path")}))))};return D.createElement(dt.a,null,_e)},Le=st;function ut(Ce){return Ce&&Z()(Ce)==="object"?Ce:{}}function Gt(Ce,Ee){return Ce&&!Ee?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Kt(Ce,Ee){return!Ce&&Ee?{width:"38%"}:Ce&&Ee?{width:"50%"}:{}}function ar(Ce,Ee){var _e={};return(!Ce||!Ee)&&(_e.width="61%"),!Ce&&Ee?_e.rows=3:_e.rows=2,_e}var oe=function(Ee){var _e=function(rt){var $t=rt.getPrefixCls,St=rt.direction,ye=Ee.prefixCls,be=Ee.loading,Be=Ee.className,lt=Ee.children,Pe=Ee.avatar,ht=Ee.title,w=Ee.paragraph,I=Ee.active,q=Ee.round,ce=$t("skeleton",ye);if(be||!("loading"in Ee)){var Ve,$e=!!Pe,gt=!!ht,nt=!!w,kt;if($e){var $=z()(z()({prefixCls:"".concat(ce,"-avatar")},Gt(gt,nt)),ut(Pe));kt=D.createElement("div",{className:"".concat(ce,"-header")},D.createElement(Et,$))}var Ke;if(gt||nt){var ae;if(gt){var et=z()(z()({prefixCls:"".concat(ce,"-title")},Kt($e,nt)),ut(ht));ae=D.createElement(Y,et)}var zt;if(nt){var sr=z()(z()({prefixCls:"".concat(ce,"-paragraph")},ar($e,gt)),ut(w));zt=D.createElement(we,sr)}Ke=D.createElement("div",{className:"".concat(ce,"-content")},ae,zt)}var ft=re()(ce,(Ve={},m()(Ve,"".concat(ce,"-with-avatar"),$e),m()(Ve,"".concat(ce,"-active"),I),m()(Ve,"".concat(ce,"-rtl"),St==="rtl"),m()(Ve,"".concat(ce,"-round"),q),Ve),Be);return D.createElement("div",{className:ft},kt,Ke)}return lt};return D.createElement(dt.a,null,_e)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=_t,oe.Avatar=Qe,oe.Input=Ne,oe.Image=Le;var Q=oe,H=E.a=Q},"/rf6":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.earthRadius=63710088e-1,E.factors={centimeters:E.earthRadius*100,centimetres:E.earthRadius*100,degrees:E.earthRadius/111325,feet:E.earthRadius*3.28084,inches:E.earthRadius*39.37,kilometers:E.earthRadius/1e3,kilometres:E.earthRadius/1e3,meters:E.earthRadius,metres:E.earthRadius,miles:E.earthRadius/1609.344,millimeters:E.earthRadius*1e3,millimetres:E.earthRadius*1e3,nauticalmiles:E.earthRadius/1852,radians:1,yards:E.earthRadius/1.0936},E.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/E.earthRadius,yards:1/1.0936},E.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function T(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"Feature"};return(Ce.id===0||Ce.id)&&(Ee.id=Ce.id),Ce.bbox&&(Ee.bbox=Ce.bbox),Ee.properties=H||{},Ee.geometry=Q,Ee}E.feature=T;function m(Q,H,Ce){Ce===void 0&&(Ce={});switch(Q){case"Point":return X(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return o(H).geometry;case"MultiPoint":return Y(H).geometry;case"MultiLineString":return fe(H).geometry;case"MultiPolygon":return Fe(H).geometry;default:throw new Error(Q+" is invalid")}}E.geometry=m;function X(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"Point",coordinates:Q};return T(Ee,H,Ce)}E.point=X;function z(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return X(Ee,H)}),Ce)}E.points=z;function o(Q,H,Ce){Ce===void 0&&(Ce={});for(var Ee=0,_e=Q;Ee<_e.length;Ee++){var ve=_e[Ee];if(ve.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var rt=0;rt<ve[ve.length-1].length;rt++)if(ve[ve.length-1][rt]!==ve[0][rt])throw new Error("First and last Position are not equivalent.")}var $t={type:"Polygon",coordinates:Q};return T($t,H,Ce)}E.polygon=o;function Z(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return o(Ee,H)}),Ce)}E.polygons=Z;function D(Q,H,Ce){if(Ce===void 0&&(Ce={}),Q.length<2)throw new Error("coordinates must be an array of two or more positions");var Ee={type:"LineString",coordinates:Q};return T(Ee,H,Ce)}E.lineString=D;function K(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return D(Ee,H)}),Ce)}E.lineStrings=K;function re(Q,H){H===void 0&&(H={});var Ce={type:"FeatureCollection"};return H.id&&(Ce.id=H.id),H.bbox&&(Ce.bbox=H.bbox),Ce.features=Q,Ce}E.featureCollection=re;function fe(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiLineString",coordinates:Q};return T(Ee,H,Ce)}E.multiLineString=fe;function Y(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiPoint",coordinates:Q};return T(Ee,H,Ce)}E.multiPoint=Y;function Fe(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiPolygon",coordinates:Q};return T(Ee,H,Ce)}E.multiPolygon=Fe;function We(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"GeometryCollection",geometries:Q};return T(Ee,H,Ce)}E.geometryCollection=We;function ge(Q,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Ce=Math.pow(10,H||0);return Math.round(Q*Ce)/Ce}E.round=ge;function we(Q,H){H===void 0&&(H="kilometers");var Ce=E.factors[H];if(!Ce)throw new Error(H+" units is invalid");return Q*Ce}E.radiansToLength=we;function dt(Q,H){H===void 0&&(H="kilometers");var Ce=E.factors[H];if(!Ce)throw new Error(H+" units is invalid");return Q/Ce}E.lengthToRadians=dt;function ke(Q,H){return Ze(dt(Q,H))}E.lengthToDegrees=ke;function Et(Q){var H=Q%360;return H<0&&(H+=360),H}E.bearingToAzimuth=Et;function Ze(Q){var H=Q%(2*Math.PI);return H*180/Math.PI}E.radiansToDegrees=Ze;function vt(Q){var H=Q%360;return H*Math.PI/180}E.degreesToRadians=vt;function Qe(Q,H,Ce){if(H===void 0&&(H="kilometers"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("length must be a positive number");return we(dt(Q,H),Ce)}E.convertLength=Qe;function yt(Q,H,Ce){if(H===void 0&&(H="meters"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("area must be a positive number");var Ee=E.areaFactors[H];if(!Ee)throw new Error("invalid original units");var _e=E.areaFactors[Ce];if(!_e)throw new Error("invalid final units");return Q/Ee*_e}E.convertArea=yt;function _t(Q){return!isNaN(Q)&&Q!==null&&!Array.isArray(Q)&&!/^\s*$/.test(Q)}E.isNumber=_t;function De(Q){return!!Q&&Q.constructor===Object}E.isObject=De;function Ne(Q){if(!Q)throw new Error("bbox is required");if(!Array.isArray(Q))throw new Error("bbox must be an Array");if(Q.length!==4&&Q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Q.forEach(function(H){if(!_t(H))throw new Error("bbox must only contain numbers")})}E.validateBBox=Ne;function Ue(Q){if(!Q)throw new Error("id is required");if(["string","number"].indexOf(typeof Q)===-1)throw new Error("id must be a number or a string")}E.validateId=Ue;function st(){throw new Error("method has been renamed to `radiansToDegrees`")}E.radians2degrees=st;function Le(){throw new Error("method has been renamed to `degreesToRadians`")}E.degrees2radians=Le;function ut(){throw new Error("method has been renamed to `lengthToDegrees`")}E.distanceToDegrees=ut;function Gt(){throw new Error("method has been renamed to `lengthToRadians`")}E.distanceToRadians=Gt;function Kt(){throw new Error("method has been renamed to `radiansToLength`")}E.radiansToDistance=Kt;function ar(){throw new Error("method has been renamed to `bearingToAzimuth`")}E.bearingToAngle=ar;function oe(){throw new Error("method has been renamed to `convertLength`")}E.convertDistance=oe},"0JQy":function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="["+i+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",fe="[^"+i+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",We="\\u200d",ge=re+"?",we="["+o+"]?",dt="(?:"+We+"(?:"+[fe,Y,Fe].join("|")+")"+we+ge+")*",ke=we+ge+dt,Et="(?:"+[fe+D+"?",D,Y,Fe,Z].join("|")+")",Ze=RegExp(K+"(?="+K+")|"+Et+ke,"g");function vt(Qe){return Qe.match(Ze)||[]}Re.exports=vt},"0ZTe":function(Re,E,i){var T=i("wy8a"),m=i("quyA"),X=i("Em2t"),z=i("dt0z");function o(Z){return function(D){D=z(D);var K=m(D)?X(D):void 0,re=K?K[0]:D.charAt(0),fe=K?T(K,1).join(""):D.slice(1);return re[Z]()+fe}}Re.exports=o},"0eqD":function(Re,E){},"0gSV":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("GXnB"),m=i("Ztfv");function X(z,o){return function(Z,D,K){var re=new T.Metadata(z,o);typeof K=="number"?m.tagParameter(Z,D,K,re):m.tagProperty(Z,D,re)}}E.tagged=X},"1+5i":function(Re,E,i){var T=i("w/wX"),m=i("sEf8"),X=i("mdPL"),z=X&&X.isSet,o=z?m(z):T;Re.exports=o},"14J3":function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("1GLa")},"1ABj":function(Re,E){function i(T,m){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Re.exports=i},"1XEM":function(Re,E,i){Re.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(Re,E){Re.exports=function(T){return T&&typeof T=="object"&&typeof T.copy=="function"&&typeof T.fill=="function"&&typeof T.readUInt8=="function"}},"1jvM":function(Re,E){},2:function(Re,E){},"2ajD":function(Re,E){function i(T){return T!==T}Re.exports=i},"3DfO":function(Re,E){function i(T){return T==null}Re.exports=i},"3L66":function(Re,E,i){var T=i("MMmD"),m=i("ExA7");function X(z){return m(z)&&T(z)}Re.exports=X},"3cYt":function(Re,E){function i(T){return function(m){return T==null?void 0:T[m]}}Re.exports=i},"406g":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("z4Hk"),m=function(){function X(z){this._binding=z}return X.prototype.onActivation=function(z){return this._binding.onActivation=z,new T.BindingWhenSyntax(this._binding)},X}();E.BindingOnSyntax=m},"4U9+":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=function(we){return(0,m.default)((0,K.default)(we)&&we.length>=1,"Must merge at least 1 JSON schema."),z.default.apply(void 0,[{}].concat(ge(we),[function(dt,ke,Et){if((0,Z.default)(dt))return;if(Et==="required")return(0,fe.default)(dt.concat(ke));if((0,Fe.default)(dt)){if(!(0,Fe.default)(ke))throw new Error('Failed to merge schemas because "'+Et+'" has different values.');return}m.default.deepEqual(dt,ke,'Failed to merge schemas because "'+Et+'" has different values: '+JSON.stringify(dt)+" and "+JSON.stringify(ke)+".")}]))};var T=i("9lTW"),m=We(T),X=i("qd8s"),z=We(X),o=i("3DfO"),Z=We(o),D=i("WFAs"),K=We(D),re=i("w26f"),fe=We(re),Y=i("zZPE"),Fe=We(Y);function We(we){return we&&we.__esModule?we:{default:we}}function ge(we){if(Array.isArray(we)){for(var dt=0,ke=Array(we.length);dt<we.length;dt++)ke[dt]=we[dt];return ke}else return Array.from(we)}Re.exports=E.default},"4ZJM":function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";var T,m,X;function z(o,Z){if(!T)T=Z;else if(!m)m=Z;else{var D="var sharedChunk = {}; ("+T+")(sharedChunk); ("+m+")(sharedChunk);",K={};T(K),X=Z(K),typeof window!="undefined"&&(X.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(o){"use strict";function Z(e,t){return e(t={exports:{}},t.exports),t.exports}var D=K;function K(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}K.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},K.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},K.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},K.prototype.solveCurveX=function(e,t){var r,u,f,g,A;for(t===void 0&&(t=1e-6),f=e,A=0;A<8;A++){if(g=this.sampleCurveX(f)-e,Math.abs(g)<t)return f;var L=this.sampleCurveDerivativeX(f);if(Math.abs(L)<1e-6)break;f-=g/L}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(g=this.sampleCurveX(f),Math.abs(g-e)<t)return f;e>g?r=f:u=f,f=.5*(u-r)+r}return f},K.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var re=fe;function fe(e,t){this.x=e,this.y=t}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),g=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(e){return e instanceof fe?e:Array.isArray(e)?new fe(e[0],e[1]):e};var Y=typeof self!="undefined"?self:{},Fe=Math.pow(2,53)-1;function We(e,t,r,u){var f=new D(e,t,r,u);return function(g){return f.solve(g)}}var ge=We(.25,.1,.25,1);function we(e,t,r){return Math.min(r,Math.max(t,e))}function dt(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function ke(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var g=f[u];for(var A in g)e[A]=g[A]}return e}var Et=1;function Ze(){return Et++}function vt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Qe(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function yt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function _t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function De(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function Ne(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function Ue(e){return Array.isArray(e)?e.map(Ue):typeof e=="object"&&e?De(e,Ue):e}var st={};function Le(e){st[e]||(typeof console!="undefined"&&console.warn(e),st[e]=!0)}function ut(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Gt(e){for(var t=0,r=0,u=e.length,f=u-1,g=void 0,A=void 0;r<u;f=r++)t+=((A=e[f]).x-(g=e[r]).x)*(g.y+A.y);return t}function Kt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ar(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,g,A){var L=g||A;return t[f]=!L||L.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function Q(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=Y[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Ce,Ee,_e,ve,rt=Y.performance&&Y.performance.now?Y.performance.now.bind(Y.performance):Date.now.bind(Date),$t=Y.requestAnimationFrame||Y.mozRequestAnimationFrame||Y.webkitRequestAnimationFrame||Y.msRequestAnimationFrame,St=Y.cancelAnimationFrame||Y.mozCancelAnimationFrame||Y.webkitCancelAnimationFrame||Y.msCancelAnimationFrame,ye={now:rt,frame:function(t){var r=$t(t);return{cancel:function(){return St(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=Y.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ce||(Ce=Y.document.createElement("a")),Ce.href=t,Ce.href},hardwareConcurrency:Y.navigator&&Y.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(Ee==null&&(Ee=Y.matchMedia("(prefers-reduced-motion: reduce)")),Ee.matches)}},be={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Be={supported:!1,testSupport:function(t){!lt&&ve&&(Pe?ht(t):_e=t)}},lt=!1,Pe=!1;function ht(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ve),e.isContextLost())return;Be.supported=!0}catch(r){}e.deleteTexture(t),lt=!0}Y.document&&((ve=Y.document.createElement("img")).onload=function(){_e&&ht(_e),_e=null,Pe=!0},ve.onerror=function(){lt=!0,_e=null},ve.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var w="01",I=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}I.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",w,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},I.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},I.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},I.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=gt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=gt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=gt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSpriteURL=function(e,t,r,u){var f=gt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,nt(f))},I.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=gt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ye.devicePixelRatio>=2||t===512?"@2x":"")+(Be.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var g=0,A=f;g<A.length;g+=1){var L=A[g].match(/^access_token=(.*)$/);if(L)return L[1]}return null}(r.params)||be.ACCESS_TOKEN;return be.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},I.prototype.canonicalizeTileURL=function(e,t){var r=gt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(g){return!g.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},I.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],f=0,g=e.tiles||[];f<g.length;f+=1){var A=g[f];Ve(A)?u.push(this.canonicalizeTileURL(A,r)):u.push(A)}return u},I.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=gt(be.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!be.REQUIRE_ACCESS_TOKEN)return nt(e);if(!(t=t||be.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(g){return g.indexOf("access_token")===-1}),e.params.push("access_token="+t),nt(e)};var ce=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ve(e){return ce.test(e)}var $e=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gt(e){var t=e.match($e);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function nt(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function kt(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Y.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=kt(be.ACCESS_TOKEN);return t=r&&r.u?Y.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):be.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=Y.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=Y.localStorage.getItem(r);f&&(this.anonId=f)}catch(g){Le("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Le("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,u){var f=this;if(be.EVENTS_URL){var g=gt(be.EVENTS_URL);g.params.push("access_token="+(u||be.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:w,userId:this.anonId},L=t?ke(A,t):A,V={url:nt(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=Gn(V,function(te){f.pendingRequest=null,r(te),f.saveEventData(),f.processRequests(u)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ke,ae,et=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,g){this.skuToken=f,(be.EVENTS_URL&&g||be.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(A){return q(A)||Ve(A)}))&&this.queueRequest({id:u,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),g=f.id,A=f.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),Qe(this.anonId)||(this.anonId=vt()),this.postEvent(A,{skuToken:this.skuToken},function(L){L||g&&(u.success[g]=!0)},r))}},t}($),zt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){be.EVENTS_URL&&be.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||Ve(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=kt(be.ACCESS_TOKEN),g=f?f.u:be.ACCESS_TOKEN,A=g!==this.eventData.tokenU;Qe(this.anonId)||(this.anonId=vt(),A=!0);var L=this.queue.shift();if(this.eventData.lastSuccess){var V=new Date(this.eventData.lastSuccess),te=new Date(L),de=(L-this.eventData.lastSuccess)/864e5;A=A||de>=1||de<-1||V.getDate()!==te.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(L,{"enabled.telemetry":!1},function(Se){Se||(u.eventData.lastSuccess=L,u.eventData.tokenU=g)},r)}},t}($)),sr=zt.postTurnstileEvent.bind(zt),ft=new et,pt=ft.postMapLoadEvent.bind(ft),At=500,mt=50;function Me(){Y.caches&&!Ke&&(Ke=Y.caches.open("mapbox-tiles"))}function ct(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var qe,Vt=1/0;function pr(){return qe==null&&(qe=Y.OffscreenCanvas&&new Y.OffscreenCanvas(1,1).getContext("2d")&&typeof Y.createImageBitmap=="function"),qe}var Gr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Gr);var ur=function(e){function t(r,u,f){u===401&&Ve(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),zn=Kt()?function(){return self.worker&&self.worker.referrer}:function(){return(Y.location.protocol==="blob:"?Y.parent:Y).location.href},xn,na,fa=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(zn())&&!/^\w+:/.test(u))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(f,g){var A,L=new Y.AbortController,V=new Y.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:zn(),signal:L.signal}),te=!1,de=!1,Se=(A=V.url).indexOf("sku=")>0&&Ve(A);f.type==="json"&&V.headers.set("Accept","application/json");var Oe=function(xt,Wt,Ht){if(!de){if(xt&&xt.message!=="SecurityError"&&Le(xt),Wt&&Ht)return it(Wt);var tr=Date.now();Y.fetch(V).then(function(dr){if(dr.ok){var br=Se?dr.clone():null;return it(dr,br,tr)}return g(new ur(dr.statusText,dr.status,f.url))}).catch(function(dr){dr.code!==20&&g(new Error(dr.message))})}},it=function(xt,Wt,Ht){(f.type==="arrayBuffer"?xt.arrayBuffer():f.type==="json"?xt.json():xt.text()).then(function(tr){de||(Wt&&Ht&&function(dr,br,jr){if(Me(),Ke){var Ir={status:br.status,statusText:br.statusText,headers:new Y.Headers};br.headers.forEach(function(cn,Ln){return Ir.headers.set(Ln,cn)});var hn=ar(br.headers.get("Cache-Control")||"");hn["no-store"]||(hn["max-age"]&&Ir.headers.set("Expires",new Date(jr+1e3*hn["max-age"]).toUTCString()),new Date(Ir.headers.get("Expires")).getTime()-jr<42e4||function(cn,Ln){if(ae===void 0)try{new Response(new ReadableStream),ae=!0}catch($n){ae=!1}ae?Ln(cn.body):cn.blob().then(Ln)}(br,function(cn){var Ln=new Y.Response(cn,Ir);Me(),Ke&&Ke.then(function($n){return $n.put(ct(dr.url),Ln)}).catch(function($n){return Le($n.message)})}))}}(V,Wt,Ht),te=!0,g(null,tr,xt.headers.get("Cache-Control"),xt.headers.get("Expires")))}).catch(function(tr){de||g(new Error(tr.message))})};return Se?function(Ct,xt){if(Me(),!Ke)return xt(null);var Wt=ct(Ct.url);Ke.then(function(Ht){Ht.match(Wt).then(function(tr){var dr=function(br){if(!br)return!1;var jr=new Date(br.headers.get("Expires")||0),Ir=ar(br.headers.get("Cache-Control")||"");return jr>Date.now()&&!Ir["no-cache"]}(tr);Ht.delete(Wt),dr&&Ht.put(Wt,tr.clone()),xt(null,tr,dr)}).catch(xt)}).catch(xt)}(V,Oe):Oe(null,null),{cancel:function(){de=!0,te||L.abort()}}}(t,r);if(Kt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,g){var A=new Y.XMLHttpRequest;for(var L in A.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(A.responseType="arraybuffer"),f.headers)A.setRequestHeader(L,f.headers[L]);return f.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=f.credentials==="include",A.onerror=function(){g(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var V=A.response;if(f.type==="json")try{V=JSON.parse(A.response)}catch(te){return g(te)}g(null,V,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else g(new ur(A.statusText,A.status,f.url))},A.send(f.body),{cancel:function(){return A.abort()}}}(t,r)},Hn=function(t,r){return fa(ke(t,{type:"arrayBuffer"}),r)},Gn=function(t,r){return fa(ke(t,{method:"POST"}),r)},F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";xn=[],na=0;var W=function e(t,r){if(Be.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),na>=be.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return xn.push(u),u}na++;var f=!1,g=function(){if(!f)for(f=!0,na--;xn.length&&na<be.MAX_PARALLEL_IMAGE_REQUESTS;){var V=xn.shift();V.cancelled||(V.cancel=e(V.requestParameters,V.callback).cancel)}},A=Hn(t,function(L,V,te,de){g(),L?r(L):V&&(pr()?function(Se,Oe){var it=new Y.Blob([new Uint8Array(Se)],{type:"image/png"});Y.createImageBitmap(it).then(function(Ct){Oe(null,Ct)}).catch(function(Ct){Oe(new Error("Could not load image because of "+Ct.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(V,r):function(Se,Oe,it,Ct){var xt=new Y.Image,Wt=Y.URL;xt.onload=function(){Oe(null,xt),Wt.revokeObjectURL(xt.src),xt.onload=null,xt.src=F},xt.onerror=function(){return Oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ht=new Y.Blob([new Uint8Array(Se)],{type:"image/png"});xt.cacheControl=it,xt.expires=Ct,xt.src=Se.byteLength?Wt.createObjectURL(Ht):F}(V,r,te,de))});return{cancel:function(){A.cancel(),g()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function pe(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var at=function(t,r){r===void 0&&(r={}),ke(this,r),this.type=t},Tt=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",ke({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(at),jt=function(){};jt.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},jt.prototype.off=function(e,t){return pe(e,t,this._listeners),pe(e,t,this._oneTimeListeners),this},jt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},jt.prototype.fire=function(e,t){typeof e=="string"&&(e=new at(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var g=0,A=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<A.length;g+=1){var L=A[g];pe(r,L,this._oneTimeListeners),L.call(this,e)}var V=this._eventedParent;V&&(ke(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(e))}else e instanceof Tt&&console.error(e.error);return this},jt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},jt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ge={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},wt=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function ir(e){var t=e.value;return t?[new wt(e.key,t,"constants have been deprecated as of v8")]:[]}function Ur(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var g=f[u];for(var A in g)e[A]=g[A]}return e}function Vr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function or(e){if(Array.isArray(e))return e.map(or);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=or(e[r]);return t}return Vr(e)}var Fr=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Sn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var g=f[u];this.bindings[g[0]]=g[1]}};Sn.prototype.concat=function(e){return new Sn(this,e)},Sn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Sn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var fn={kind:"null"},Er={kind:"number"},Tn={kind:"string"},dn={kind:"boolean"},vn={kind:"color"},Sr={kind:"object"},Kr={kind:"value"},wn={kind:"collator"},Ka={kind:"formatted"},da={kind:"resolvedImage"};function Oa(e,t){return{kind:"array",itemType:e,N:t}}function Ia(e){if(e.kind==="array"){var t=Ia(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Xi=[fn,Er,Tn,dn,vn,Ka,Sr,Oa(Kr),da];function ha(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ha(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Xi;r<u.length;r+=1)if(!ha(u[r],t))return null}}return"Expected "+Ia(e)+" but found "+Ia(t)+" instead."}function gi(e,t){return t.some(function(r){return r.kind===e.kind})}function Ma(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ya=Z(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(L){return(L=Math.round(L))<0?0:L>255?255:L}function f(L){return u(L[L.length-1]==="%"?parseFloat(L)/100*255:parseInt(L))}function g(L){return(V=L[L.length-1]==="%"?parseFloat(L)/100:parseFloat(L))<0?0:V>1?1:V;var V}function A(L,V,te){return te<0?te+=1:te>1&&(te-=1),6*te<1?L+(V-L)*te*6:2*te<1?V:3*te<2?L+(V-L)*(2/3-te)*6:L}try{t.parseCSSColor=function(L){var V,te=L.replace(/ /g,"").toLowerCase();if(te in r)return r[te].slice();if(te[0]==="#")return te.length===4?(V=parseInt(te.substr(1),16))>=0&&V<=4095?[(3840&V)>>4|(3840&V)>>8,240&V|(240&V)>>4,15&V|(15&V)<<4,1]:null:te.length===7&&(V=parseInt(te.substr(1),16))>=0&&V<=16777215?[(16711680&V)>>16,(65280&V)>>8,255&V,1]:null;var de=te.indexOf("("),Se=te.indexOf(")");if(de!==-1&&Se+1===te.length){var Oe=te.substr(0,de),it=te.substr(de+1,Se-(de+1)).split(","),Ct=1;switch(Oe){case"rgba":if(it.length!==4)return null;Ct=g(it.pop());case"rgb":return it.length!==3?null:[f(it[0]),f(it[1]),f(it[2]),Ct];case"hsla":if(it.length!==4)return null;Ct=g(it.pop());case"hsl":if(it.length!==3)return null;var xt=(parseFloat(it[0])%360+360)%360/360,Wt=g(it[1]),Ht=g(it[2]),tr=Ht<=.5?Ht*(Wt+1):Ht+Wt-Ht*Wt,dr=2*Ht-tr;return[u(255*A(dr,tr,xt+1/3)),u(255*A(dr,tr,xt)),u(255*A(dr,tr,xt-1/3)),Ct];default:return null}}return null}}catch(L){}}).parseCSSColor,la=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};la.parse=function(e){if(e){if(e instanceof la)return e;if(typeof e=="string"){var t=ya(e);if(t)return new la(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},la.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},la.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},la.black=new la(0,0,0,1),la.white=new la(1,1,1,1),la.transparent=new la(0,0,0,0),la.red=new la(1,0,0,1);var Li=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Li.prototype.compare=function(e,t){return this.collator.compare(e,t)},Li.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var po=function(t,r,u,f,g){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=g},Yi=function(t){this.sections=t};Yi.fromString=function(e){return new Yi([new po(e,null,null,null,null)])},Yi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Yi.factory=function(e){return e instanceof Yi?e:Yi.fromString(e)},Yi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Yi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Ko=function(t){this.name=t.name,this.available=t.available};function Gu(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ba(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof la)return!0;if(e instanceof Li)return!0;if(e instanceof Yi)return!0;if(e instanceof Ko)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ba(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!Ba(e[u]))return!1;return!0}return!1}function Ai(e){if(e===null)return fn;if(typeof e=="string")return Tn;if(typeof e=="boolean")return dn;if(typeof e=="number")return Er;if(e instanceof la)return vn;if(e instanceof Li)return wn;if(e instanceof Yi)return Ka;if(e instanceof Ko)return da;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var g=Ai(f[u]);if(t){if(t===g)continue;t=Kr;break}t=g}return Oa(t||Kr,r)}return Sr}function es(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof la||e instanceof Yi||e instanceof Ko?e.toString():JSON.stringify(e)}Ko.prototype.toString=function(){return this.name},Ko.fromString=function(e){return e?new Ko({name:e,available:!1}):null},Ko.prototype.serialize=function(){return["image",this.name]};var ii=function(t,r){this.type=t,this.value=r};ii.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ba(e[1]))return t.error("invalid value");var r=e[1],u=Ai(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new ii(u,r)},ii.prototype.evaluate=function(){return this.value},ii.prototype.eachChild=function(){},ii.prototype.outputDefined=function(){return!0},ii.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof la?["rgba"].concat(this.value.toArray()):this.value instanceof Yi?this.value.serialize():this.value};var Ki=function(t){this.name="ExpressionEvaluationError",this.message=t};Ki.prototype.toJSON=function(){return this.message};var ts={string:Tn,number:Er,boolean:dn,object:Sr},Ja=function(t,r){this.type=t,this.args=r};Ja.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var g,A;if(e.length>2){var L=e[1];if(typeof L!="string"||!(L in ts)||L==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=ts[L],u++}else g=Kr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],u++}r=Oa(g,A)}else r=ts[f];for(var V=[];u<e.length;u++){var te=t.parse(e[u],u,Kr);if(!te)return null;V.push(te)}return new Ja(r,V)},Ja.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!ha(this.type,Ai(r)))return r;if(t===this.args.length-1)throw new Ki("Expected value to be of type "+Ia(this.type)+", but found "+Ia(Ai(r))+" instead.")}return null},Ja.prototype.eachChild=function(e){this.args.forEach(e)},Ja.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ja.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Ka,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,g=1;g<=e.length-1;++g){var A=e[g];if(f&&typeof A=="object"&&!Array.isArray(A)){f=!1;var L=null;if(A["font-scale"]&&!(L=t.parse(A["font-scale"],1,Er)))return null;var V=null;if(A["text-font"]&&!(V=t.parse(A["text-font"],1,Oa(Tn))))return null;var te=null;if(A["text-color"]&&!(te=t.parse(A["text-color"],1,vn)))return null;var de=u[u.length-1];de.scale=L,de.font=V,de.textColor=te}else{var Se=t.parse(e[g],1,Kr);if(!Se)return null;var Oe=Se.type.kind;if(Oe!=="string"&&Oe!=="value"&&Oe!=="null"&&Oe!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:Se,scale:null,font:null,textColor:null})}}return new oo(u)},oo.prototype.evaluate=function(e){return new Yi(this.sections.map(function(t){var r=t.content.evaluate(e);return Ai(r)===da?new po("",r,null,null,null):new po(es(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=da,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Tn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Ko.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var Ys={"to-boolean":dn,"to-color":vn,"to-number":Er,"to-string":Tn},_o=function(t,r){this.type=t,this.args=r};_o.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=Ys[r],f=[],g=1;g<e.length;g++){var A=t.parse(e[g],g,Kr);if(!A)return null;f.push(A)}return new _o(u,f)},_o.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof la)return t;if(typeof t=="string"){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Gu(t[0],t[1],t[2],t[3])))return new la(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ki(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var A=null,L=0,V=this.args;L<V.length;L+=1){if((A=V[L].evaluate(e))===null)return 0;var te=Number(A);if(!isNaN(te))return te}throw new Ki("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?Yi.fromString(es(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ko.fromString(es(this.args[0].evaluate(e))):es(this.args[0].evaluate(e))},_o.prototype.eachChild=function(e){this.args.forEach(e)},_o.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},_o.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Zl=["Unknown","Point","LineString","Polygon"],Ks=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ks.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ks.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Zl[this.feature.type]:this.feature.type:null},Ks.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ks.prototype.canonicalID=function(){return this.canonical},Ks.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ks.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=la.parse(e)),t};var So=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};So.prototype.evaluate=function(e){return this._evaluate(e,this.args)},So.prototype.eachChild=function(e){this.args.forEach(e)},So.prototype.outputDefined=function(){return!1},So.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},So.parse=function(e,t){var r,u=e[0],f=So.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(f)?f[0]:f.type,A=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,L=A.filter(function(Xn){var Dn=Xn[0];return!Array.isArray(Dn)||Dn.length===e.length-1}),V=null,te=0,de=L;te<de.length;te+=1){var Se=de[te],Oe=Se[0],it=Se[1];V=new cu(t.registry,t.path,null,t.scope);for(var Ct=[],xt=!1,Wt=1;Wt<e.length;Wt++){var Ht=e[Wt],tr=Array.isArray(Oe)?Oe[Wt-1]:Oe.type,dr=V.parse(Ht,1+Ct.length,tr);if(!dr){xt=!0;break}Ct.push(dr)}if(!xt)if(Array.isArray(Oe)&&Oe.length!==Ct.length)V.error("Expected "+Oe.length+" arguments, but found "+Ct.length+" instead.");else{for(var br=0;br<Ct.length;br++){var jr=Array.isArray(Oe)?Oe[br]:Oe.type,Ir=Ct[br];V.concat(br+1).checkSubtype(jr,Ir.type)}if(V.errors.length===0)return new So(u,g,it,Ct)}}if(L.length===1)(r=t.errors).push.apply(r,V.errors);else{for(var hn=(L.length?L:A).map(function(Xn){var Dn;return Dn=Xn[0],Array.isArray(Dn)?"("+Dn.map(Ia).join(", ")+")":"("+Ia(Dn.type)+"...)"}).join(" | "),cn=[],Ln=1;Ln<e.length;Ln++){var $n=t.parse(e[Ln],1+cn.length);if(!$n)return null;cn.push(Ia($n.type))}t.error("Expected arguments of type "+hn+", but found ("+cn.join(", ")+") instead.")}return null},So.register=function(e,t){for(var r in So.definitions=t,t)e[r]=So};var Ut=function(t,r,u){this.type=wn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Ie(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Pt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function cr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function tn(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function En(e,t){for(var r,u,f,g,A,L,V,te=!1,de=0,Se=t.length;de<Se;de++)for(var Oe=t[de],it=0,Ct=Oe.length;it<Ct-1;it++){if((g=(r=e)[0]-(u=Oe[it])[0])*(V=r[1]-(f=Oe[it+1])[1])-(L=r[0]-f[0])*(A=r[1]-u[1])==0&&g*L<=0&&A*V<=0)return!1;tn(e,Oe[it],Oe[it+1])&&(te=!te)}return te}function Fn(e,t){for(var r=0;r<t.length;r++)if(En(e,t[r]))return!0;return!1}function Ri(e,t,r,u){var f=u[0]-r[0],g=u[1]-r[1],A=(e[0]-r[0])*g-f*(e[1]-r[1]),L=(t[0]-r[0])*g-f*(t[1]-r[1]);return A>0&&L<0||A<0&&L>0}function to(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var g=f[u],A=0;A<g.length-1;++A)if((Se=[(de=g[A+1])[0]-(te=g[A])[0],de[1]-te[1]])[0]*(Oe=[(V=t)[0]-(L=e)[0],V[1]-L[1]])[1]-Se[1]*Oe[0]!=0&&Ri(L,V,te,de)&&Ri(te,de,L,V))return!0;var L,V,te,de,Se,Oe;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!En(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(to(e[u],e[u+1],t))return!1;return!0}function Do(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function Hu(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var g=[],A=0;A<e[f].length;A++){var L=cr(e[f][A],r);Ie(t,L),g.push(L)}u.push(g)}return u}function Xl(e,t,r){for(var u=[],f=0;f<e.length;f++){var g=Hu(e[f],t,r);u.push(g)}return u}function $s(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,g=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;g===0&&(g=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=g}Ie(t,e)}function Ic(e,t,r,u){for(var f=8192*Math.pow(2,u.z),g=[8192*u.x,8192*u.y],A=[],L=0,V=e;L<V.length;L+=1)for(var te=0,de=V[L];te<de.length;te+=1){var Se=de[te],Oe=[Se.x+g[0],Se.y+g[1]];$s(Oe,t,r,f),A.push(Oe)}return A}function Ll(e,t,r,u){for(var f,g=8192*Math.pow(2,u.z),A=[8192*u.x,8192*u.y],L=[],V=0,te=e;V<te.length;V+=1){for(var de=[],Se=0,Oe=te[V];Se<Oe.length;Se+=1){var it=Oe[Se],Ct=[it.x+A[0],it.y+A[1]];Ie(t,Ct),de.push(Ct)}L.push(de)}if(t[2]-t[0]<=g/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var xt=0,Wt=L;xt<Wt.length;xt+=1)for(var Ht=0,tr=Wt[xt];Ht<tr.length;Ht+=1)$s(tr[Ht],t,r,g)}return L}Ut.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,dn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,dn);if(!f)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,Tn))?null:new Ut(u,f,g)},Ut.prototype.evaluate=function(e){return new Li(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Ut.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Ut.prototype.outputDefined=function(){return!1},Ut.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var fs=function(t,r){this.type=dn,this.geojson=t,this.geometries=r};function ks(e){if(e instanceof So){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof fs)return!1;var t=!0;return e.eachChild(function(r){t&&!ks(r)&&(t=!1)}),t}function uo(e){if(e instanceof So&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!uo(r)&&(t=!1)}),t}function hs(e,t){if(e instanceof So&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!hs(u,t)&&(r=!1)}),r}fs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ba(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new fs(r,r.features[u].geometry)}else if(r.type==="Feature"){var g=r.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new fs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new fs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},fs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=Hu(r.coordinates,f,g),L=Ic(t.geometry(),u,f,g);if(!Pt(u,f))return!1;for(var V=0,te=L;V<te.length;V+=1)if(!En(te[V],A))return!1}if(r.type==="MultiPolygon"){var de=Xl(r.coordinates,f,g),Se=Ic(t.geometry(),u,f,g);if(!Pt(u,f))return!1;for(var Oe=0,it=Se;Oe<it.length;Oe+=1)if(!Fn(it[Oe],de))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=Hu(r.coordinates,f,g),L=Ll(t.geometry(),u,f,g);if(!Pt(u,f))return!1;for(var V=0,te=L;V<te.length;V+=1)if(!mo(te[V],A))return!1}if(r.type==="MultiPolygon"){var de=Xl(r.coordinates,f,g),Se=Ll(t.geometry(),u,f,g);if(!Pt(u,f))return!1;for(var Oe=0,it=Se;Oe<it.length;Oe+=1)if(!Do(it[Oe],de))return!1}return!0}(e,this.geometries)}return!1},fs.prototype.eachChild=function(){},fs.prototype.outputDefined=function(){return!0},fs.prototype.serialize=function(){return["within",this.geojson]};var Js=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Js.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Js(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Js.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Js.prototype.eachChild=function(){},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){return["var",this.name]};var cu=function(t,r,u,f,g){r===void 0&&(r=[]),f===void 0&&(f=new Sn),g===void 0&&(g=[]),this.registry=t,this.path=r,this.key=r.map(function(A){return"["+A+"]"}).join(""),this.scope=f,this.errors=g,this.expectedType=u};function Yl(e,t){for(var r,u=e.length-1,f=0,g=u,A=0;f<=g;)if((r=e[A=Math.floor((f+g)/2)])<=t){if(A===u||t<e[A+1])return A;f=A+1}else{if(!(r>t))throw new Ki("Input is not a number.");g=A-1}return 0}cu.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},cu.prototype._parse=function(e,t){function r(te,de,Se){return Se==="assert"?new Ja(de,[te]):Se==="coerce"?new _o(de,[te]):te}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var g=f.parse(e,this);if(!g)return null;if(this.expectedType){var A=this.expectedType,L=g.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||L.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||L.kind!=="value"&&L.kind!=="string"){if(this.checkSubtype(A,L))return null}else g=r(g,A,t.typeAnnotation||"coerce");else g=r(g,A,t.typeAnnotation||"assert")}if(!(g instanceof ii)&&g.type.kind!=="resolvedImage"&&function te(de){if(de instanceof Js)return te(de.boundExpression);if(de instanceof So&&de.name==="error")return!1;if(de instanceof Ut)return!1;if(de instanceof fs)return!1;var Se=de instanceof _o||de instanceof Ja,Oe=!0;return de.eachChild(function(it){Oe=Se?Oe&&te(it):Oe&&it instanceof ii}),!!Oe&&ks(de)&&hs(de,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var V=new Ks;try{g=new ii(g.type,g.evaluate(V))}catch(te){return this.error(te.message),null}}return g}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},cu.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new cu(this.registry,u,t||null,f,this.errors)},cu.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Fr(u,e))},cu.prototype.checkSubtype=function(e,t){var r=ha(e,t);return r&&this.error(r),r};var yi=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,g=u;f<g.length;f+=1){var A=g[f],L=A[1];this.labels.push(A[0]),this.outputs.push(L)}};function Ni(e,t,r){return e*(1-r)+t*r}yi.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var g=1;g<e.length;g+=2){var A=g===1?-1/0:e[g],L=e[g+1],V=g,te=g+1;if(typeof A!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(u.length&&u[u.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);var de=t.parse(L,te,f);if(!de)return null;f=f||de.type,u.push([A,de])}return new yi(f,r,u)},yi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[Yl(t,u)].evaluate(e)},yi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},yi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},yi.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var vl=Object.freeze({__proto__:null,number:Ni,color:function(t,r,u){return new la(Ni(t.r,r.r,u),Ni(t.g,r.g,u),Ni(t.b,r.b,u),Ni(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,g){return Ni(f,r[g],u)})}}),js=6/29*3*(6/29),ds=Math.PI/180,Ot=180/Math.PI;function er(e){return e>.008856451679035631?Math.pow(e,1/3):e/js+4/29}function Or(e){return e>6/29?e*e*e:js*(e-4/29)}function Bn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Qa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ii(e){var t=Qa(e.r),r=Qa(e.g),u=Qa(e.b),f=er((.4124564*t+.3575761*r+.1804375*u)/.95047),g=er((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-er((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Gi(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Or(t),r=.95047*Or(r),u=1.08883*Or(u),new la(Bn(3.2404542*r-1.5371385*t-.4985314*u),Bn(-.969266*r+1.8760108*t+.041556*u),Bn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function qa(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var bi={forward:Ii,reverse:Gi,interpolate:function(t,r,u){return{l:Ni(t.l,r.l,u),a:Ni(t.a,r.a,u),b:Ni(t.b,r.b,u),alpha:Ni(t.alpha,r.alpha,u)}}},Ao={forward:function(t){var r=Ii(t),u=r.l,f=r.a,g=r.b,A=Math.atan2(g,f)*Ot;return{h:A<0?A+360:A,c:Math.sqrt(f*f+g*g),l:u,alpha:t.a}},reverse:function(t){var r=t.h*ds,u=t.c;return Gi({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:qa(t.h,r.h,u),c:Ni(t.c,r.c,u),l:Ni(t.l,r.l,u),alpha:Ni(t.alpha,r.alpha,u)}}},zs=Object.freeze({__proto__:null,lab:bi,hcl:Ao}),di=function(t,r,u,f,g){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var A=0,L=g;A<L.length;A+=1){var V=L[A],te=V[1];this.labels.push(V[0]),this.outputs.push(te)}};function Kl(e,t,r,u){var f=u-r,g=e-r;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}di.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=Kl(t,e.base,r,u);else if(e.name==="linear")f=Kl(t,1,r,u);else if(e.name==="cubic-bezier"){var g=e.controlPoints;f=new D(g[0],g[1],g[2],g[3]).solve(Kl(t,1,r,u))}return f},di.parse=function(e,t){var r=e[0],u=e[1],f=e[2],g=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var A=u[1];if(typeof A!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:A}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var L=u.slice(1);if(L.length!==4||L.some(function(Wt){return typeof Wt!="number"||Wt<0||Wt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:L}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Er)))return null;var V=[],te=null;r==="interpolate-hcl"||r==="interpolate-lab"?te=vn:t.expectedType&&t.expectedType.kind!=="value"&&(te=t.expectedType);for(var de=0;de<g.length;de+=2){var Se=g[de],Oe=g[de+1],it=de+3,Ct=de+4;if(typeof Se!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(V.length&&V[V.length-1][0]>=Se)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);var xt=t.parse(Oe,Ct,te);if(!xt)return null;te=te||xt.type,V.push([Se,xt])}return te.kind==="number"||te.kind==="color"||te.kind==="array"&&te.itemType.kind==="number"&&typeof te.N=="number"?new di(te,r,u,f,V):t.error("Type "+Ia(te)+" is not interpolatable.")},di.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var g=Yl(t,u),A=di.interpolationFactor(this.interpolation,u,t[g],t[g+1]),L=r[g].evaluate(e),V=r[g+1].evaluate(e);return this.operator==="interpolate"?vl[this.type.kind.toLowerCase()](L,V,A):this.operator==="interpolate-hcl"?Ao.reverse(Ao.interpolate(Ao.forward(L),Ao.forward(V),A)):bi.reverse(bi.interpolate(bi.forward(L),bi.forward(V),A))},di.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},di.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},di.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var fu=function(t,r){this.type=t,this.args=r};fu.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],g=0,A=e.slice(1);g<A.length;g+=1){var L=t.parse(A[g],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!L)return null;r=r||L.type,f.push(L)}var V=u&&f.some(function(te){return ha(u,te.type)});return new fu(V?Kr:r,f)},fu.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,g=this.args;f<g.length&&(u++,(r=g[f].evaluate(e))&&r instanceof Ko&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},fu.prototype.eachChild=function(e){this.args.forEach(e)},fu.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},fu.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Os=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};Os.prototype.evaluate=function(e){return this.result.evaluate(e)},Os.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Os.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var g=t.parse(e[u+1],u+1);if(!g)return null;r.push([f,g])}var A=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return A?new Os(r,A):null},Os.prototype.outputDefined=function(){return this.result.outputDefined()},Os.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var gl=function(t,r,u){this.type=t,this.index=r,this.input=u};gl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Er),u=t.parse(e[2],2,Oa(t.expectedType||Kr));return r&&u?new gl(u.type.itemType,r,u):null},gl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ki("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ki("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ki("Array index must be an integer, but found "+t+" instead.");return r[t]},gl.prototype.eachChild=function(e){e(this.index),e(this.input)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var hu=function(t,r){this.type=dn,this.needle=t,this.haystack=r};hu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Kr),u=t.parse(e[2],2,Kr);return r&&u?gi(r.type,[dn,Tn,Er,fn,Kr])?new hu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead"):null},hu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Ma(t,["boolean","string","number","null"]))throw new Ki("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!Ma(r,["string","array"]))throw new Ki("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");return r.indexOf(t)>=0},hu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},hu.prototype.outputDefined=function(){return!0},hu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Wu=function(t,r,u){this.type=Er,this.needle=t,this.haystack=r,this.fromIndex=u};Wu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Kr),u=t.parse(e[2],2,Kr);if(!r||!u)return null;if(!gi(r.type,[dn,Tn,Er,fn,Kr]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new Wu(r,u,f):null}return new Wu(r,u)},Wu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ma(t,["boolean","string","number","null"]))throw new Ki("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!Ma(r,["string","array"]))throw new Ki("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},Wu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Wu.prototype.outputDefined=function(){return!1},Wu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Qs=function(t,r,u,f,g,A){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=g,this.otherwise=A};Qs.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},g=[],A=2;A<e.length-1;A+=2){var L=e[A],V=e[A+1];Array.isArray(L)||(L=[L]);var te=t.concat(A);if(L.length===0)return te.error("Expected at least one branch label.");for(var de=0,Se=L;de<Se.length;de+=1){var Oe=Se[de];if(typeof Oe!="number"&&typeof Oe!="string")return te.error("Branch labels must be numbers or strings.");if(typeof Oe=="number"&&Math.abs(Oe)>Number.MAX_SAFE_INTEGER)return te.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Oe=="number"&&Math.floor(Oe)!==Oe)return te.error("Numeric branch labels must be integer values.");if(r){if(te.checkSubtype(r,Ai(Oe)))return null}else r=Ai(Oe);if(f[String(Oe)]!==void 0)return te.error("Branch labels must be unique.");f[String(Oe)]=g.length}var it=t.parse(V,A,u);if(!it)return null;u=u||it.type,g.push(it)}var Ct=t.parse(e[1],1,Kr);if(!Ct)return null;var xt=t.parse(e[e.length-1],e.length-1,u);return xt?Ct.type.kind!=="value"&&t.concat(1).checkSubtype(r,Ct.type)?null:new Qs(r,u,Ct,f,g,xt):null},Qs.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Ai(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Qs.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Qs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Qs.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,g=Object.keys(this.cases).sort();f<g.length;f+=1){var A=g[f];(Se=u[this.cases[A]])===void 0?(u[this.cases[A]]=r.length,r.push([this.cases[A],[A]])):r[Se][1].push(A)}for(var L=function(Ct){return e.inputType.kind==="number"?Number(Ct):Ct},V=0,te=r;V<te.length;V+=1){var de=te[V],Se=de[0],Oe=de[1];t.push(Oe.length===1?L(Oe[0]):Oe.map(L)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var nl=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};nl.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var g=t.parse(e[f],f,dn);if(!g)return null;var A=t.parse(e[f+1],f+1,r);if(!A)return null;u.push([g,A]),r=r||A.type}var L=t.parse(e[e.length-1],e.length-1,r);return L?new nl(r,u,L):null},nl.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},nl.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},nl.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},nl.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var du=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function vc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Pf(e,t,r,u){return u.compare(t,r)===0}function pi(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(g,A,L){this.type=dn,this.lhs=g,this.rhs=A,this.collator=L,this.hasUntypedArgument=g.type.kind==="value"||A.type.kind==="value"}return f.parse=function(g,A){if(g.length!==3&&g.length!==4)return A.error("Expected two or three arguments.");var L=g[0],V=A.parse(g[1],1,Kr);if(!V)return null;if(!vc(L,V.type))return A.concat(1).error('"'+L+`" comparisons are not supported for type '`+Ia(V.type)+"'.");var te=A.parse(g[2],2,Kr);if(!te)return null;if(!vc(L,te.type))return A.concat(2).error('"'+L+`" comparisons are not supported for type '`+Ia(te.type)+"'.");if(V.type.kind!==te.type.kind&&V.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot compare types '"+Ia(V.type)+"' and '"+Ia(te.type)+"'.");u&&(V.type.kind==="value"&&te.type.kind!=="value"?V=new Ja(te.type,[V]):V.type.kind!=="value"&&te.type.kind==="value"&&(te=new Ja(V.type,[te])));var de=null;if(g.length===4){if(V.type.kind!=="string"&&te.type.kind!=="string"&&V.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(de=A.parse(g[3],3,wn)))return null}return new f(V,te,de)},f.prototype.evaluate=function(g){var A=this.lhs.evaluate(g),L=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){var V=Ai(A),te=Ai(L);if(V.kind!==te.kind||V.kind!=="string"&&V.kind!=="number")throw new Ki('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+V.kind+", "+te.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var de=Ai(A),Se=Ai(L);if(de.kind!=="string"||Se.kind!=="string")return t(g,A,L)}return this.collator?r(g,A,L,this.collator.evaluate(g)):t(g,A,L)},f.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var g=[e];return this.eachChild(function(A){g.push(A.serialize())}),g},f}()}du.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Kr),u=t.parse(e[2],2,Er);if(!r||!u)return null;if(!gi(r.type,[Oa(Kr),Tn,Kr]))return t.error("Expected first argument to be of type array or string, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new du(r.type,r,u,f):null}return new du(r.type,r,u)},du.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Ma(t,["string","array"]))throw new Ki("Expected first argument to be of type array or string, but found "+Ia(Ai(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},du.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},du.prototype.outputDefined=function(){return!1},du.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Dc=pi("==",function(e,t,r){return t===r},Pf),gc=pi("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!Pf(0,t,r,u)}),rf=pi("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),nf=pi(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),af=pi("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),$i=pi(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Cu=function(t,r,u,f,g){this.type=Tn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=g};Cu.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,Tn)))return null;var g=null;if(u.currency&&!(g=t.parse(u.currency,1,Tn)))return null;var A=null;if(u["min-fraction-digits"]&&!(A=t.parse(u["min-fraction-digits"],1,Er)))return null;var L=null;return u["max-fraction-digits"]&&!(L=t.parse(u["max-fraction-digits"],1,Er))?null:new Cu(r,f,g,A,L)},Cu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Cu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Cu.prototype.outputDefined=function(){return!1},Cu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var qs=function(t){this.type=Er,this.input=t};qs.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ia(r.type)+" instead."):new qs(r):null},qs.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Ki("Expected value to be of type string or array, but found "+Ia(Ai(t))+" instead.")},qs.prototype.eachChild=function(e){e(this.input)},qs.prototype.outputDefined=function(){return!1},qs.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ps={"==":Dc,"!=":gc,">":nf,"<":rf,">=":$i,"<=":af,array:Ja,at:gl,boolean:Ja,case:nl,coalesce:fu,collator:Ut,format:oo,image:so,in:hu,"index-of":Wu,interpolate:di,"interpolate-hcl":di,"interpolate-lab":di,length:qs,let:Os,literal:ii,match:Qs,number:Ja,"number-format":Cu,object:Ja,slice:du,step:yi,string:Ja,"to-boolean":_o,"to-color":_o,"to-number":_o,"to-string":_o,var:Js,within:fs};function Nc(e,t){var r=t[0],u=t[1],f=t[2],g=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var A=g?g.evaluate(e):1,L=Gu(r,u,f,A);if(L)throw new Ki(L);return new la(r/255*A,u/255*A,f/255*A,A)}function yc(e,t){return e in t}function yl(e,t){var r=t[e];return r===void 0?null:r}function al(e){return{type:e}}function bc(e){return{result:"success",value:e}}function eu(e){return{result:"error",value:e}}function Zu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function kc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function $l(e){return!!e.expression&&e.expression.interpolated}function Ci(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function jc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Lf(e){return e}function xc(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function zc(e,t,r,u,f){return xc(typeof r===f?u[r]:void 0,e.default,t.default)}function Jl(e,t,r){if(Ci(r)!=="number")return xc(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=Yl(e.stops.map(function(g){return g[0]}),r);return e.stops[f][1]}function Xu(e,t,r){var u=e.base!==void 0?e.base:1;if(Ci(r)!=="number")return xc(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var g=Yl(e.stops.map(function(Se){return Se[0]}),r),A=function(Se,Oe,it,Ct){var xt=Ct-it,Wt=Se-it;return xt===0?0:Oe===1?Wt/xt:(Math.pow(Oe,Wt)-1)/(Math.pow(Oe,xt)-1)}(r,u,e.stops[g][0],e.stops[g+1][0]),L=e.stops[g][1],V=e.stops[g+1][1],te=vl[t.type]||Lf;if(e.colorSpace&&e.colorSpace!=="rgb"){var de=zs[e.colorSpace];te=function(Oe,it){return de.reverse(de.interpolate(de.forward(Oe),de.forward(it),A))}}return typeof L.evaluate=="function"?{evaluate:function(){for(var Oe=[],it=arguments.length;it--;)Oe[it]=arguments[it];var Ct=L.evaluate.apply(void 0,Oe),xt=V.evaluate.apply(void 0,Oe);if(Ct!==void 0&&xt!==void 0)return te(Ct,xt,A)}}:te(L,V,A)}function wu(e,t,r){return t.type==="color"?r=la.parse(r):t.type==="formatted"?r=Yi.fromString(r.toString()):t.type==="resolvedImage"?r=Ko.fromString(r.toString()):Ci(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),xc(r,e.default,t.default)}So.register(ps,{error:[{kind:"error"},[Tn],function(e,t){throw new Ki(t[0].evaluate(e))}],typeof:[Tn,[Kr],function(e,t){return Ia(Ai(t[0].evaluate(e)))}],"to-rgba":[Oa(Er,4),[vn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[vn,[Er,Er,Er],Nc],rgba:[vn,[Er,Er,Er,Er],Nc],has:{type:dn,overloads:[[[Tn],function(e,t){return yc(t[0].evaluate(e),e.properties())}],[[Tn,Sr],function(e,t){var r=t[1];return yc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Kr,overloads:[[[Tn],function(e,t){return yl(t[0].evaluate(e),e.properties())}],[[Tn,Sr],function(e,t){var r=t[1];return yl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Kr,[Tn],function(e,t){return yl(t[0].evaluate(e),e.featureState||{})}],properties:[Sr,[],function(e){return e.properties()}],"geometry-type":[Tn,[],function(e){return e.geometryType()}],id:[Kr,[],function(e){return e.id()}],zoom:[Er,[],function(e){return e.globals.zoom}],"heatmap-density":[Er,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Er,[],function(e){return e.globals.lineProgress||0}],accumulated:[Kr,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Er,al(Er),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[Er,al(Er),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:Er,overloads:[[[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Er],function(e,t){return-t[0].evaluate(e)}]]},"/":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Er,[],function(){return Math.LN2}],pi:[Er,[],function(){return Math.PI}],e:[Er,[],function(){return Math.E}],"^":[Er,[Er,Er],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Er,[Er],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Er,[Er],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Er,[Er],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Er,[Er],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Er,[Er],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Er,[Er],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Er,[Er],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Er,al(Er),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Er,al(Er),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Er,[Er],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Er,[Er],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Er,[Er],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Er,[Er],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[dn,[Tn,Kr],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[dn,[Kr],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[dn,[Tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[dn,[Tn,Kr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[dn,[Kr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[dn,[Tn,Kr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[dn,[Kr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[dn,[Tn,Kr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[dn,[Kr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[dn,[Tn,Kr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[dn,[Kr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[dn,[Kr],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[dn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[dn,[Oa(Tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[dn,[Oa(Kr)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[dn,[Tn,Oa(Kr)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[dn,[Tn,Oa(Kr)],function(e,t){var r=t[0],u=t[1];return function(f,g,A,L){for(;A<=L;){var V=A+L>>1;if(g[V]===f)return!0;g[V]>f?L=V-1:A=V+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[al(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[al(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[dn,[dn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[dn,[Tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Tn,al(Kr),function(e,t){return t.map(function(r){return es(r.evaluate(e))}).join("")}],"resolved-locale":[Tn,[wn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Rl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Ks,this._defaultValue=r?function(u){return u.type==="color"&&jc(u.default)?new la(0,0,0,0):u.type==="color"?la.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function No(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in ps}function Ql(e,t){var r=new cu(ps,[],t?function(f){var g={color:vn,string:Tn,number:Er,enum:Tn,boolean:dn,formatted:Ka,resolvedImage:da};return f.type==="array"?Oa(g[f.value]||Kr,f.length):g[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?bc(new Rl(u,t)):eu(r.errors)}Rl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},Rl.prototype.evaluate=function(e,t,r,u,f,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Ki("Expected value to be one of "+Object.keys(this._enumValues).map(function(L){return JSON.stringify(L)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console!="undefined"&&console.warn(L.message)),this._defaultValue}};var Il=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!uo(r.expression)};Il.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,g)},Il.prototype.evaluate=function(e,t,r,u,f,g){return this._styleExpression.evaluate(e,t,r,u,f,g)};var bl=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!uo(r.expression),this.interpolationType=f};function Fc(e,t){if((e=Ql(e,t)).result==="error")return e;var r=e.value.expression,u=ks(r);if(!u&&!Zu(t))return eu([new Fr("","data expressions not supported")]);var f=hs(r,["zoom"]);if(!f&&!kc(t))return eu([new Fr("","zoom expressions not supported")]);var g=function A(L){var V=null;if(L instanceof Os)V=A(L.result);else if(L instanceof fu)for(var te=0,de=L.args;te<de.length&&!(V=A(de[te]));te+=1);else(L instanceof yi||L instanceof di)&&L.input instanceof So&&L.input.name==="zoom"&&(V=L);return V instanceof Fr||L.eachChild(function(Se){var Oe=A(Se);Oe instanceof Fr?V=Oe:!V&&Oe?V=new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&Oe&&V!==Oe&&(V=new Fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(r);return g||f?g instanceof Fr?eu([g]):g instanceof di&&!$l(t)?eu([new Fr("",'"interpolate" expressions cannot be used with this property')]):bc(g?new bl(u?"camera":"composite",e.value,g.labels,g instanceof di?g.interpolation:void 0):new Il(u?"constant":"source",e.value)):eu([new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}bl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,g)},bl.prototype.evaluate=function(e,t,r,u,f,g){return this._styleExpression.evaluate(e,t,r,u,f,g)},bl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?di.interpolationFactor(this.interpolationType,e,t,r):0};var Dl=function(t,r){this._parameters=t,this._specification=r,Ur(this,function u(f,g){var A,L,V,te=g.type==="color",de=f.stops&&typeof f.stops[0][0]=="object",Se=de||!(de||f.property!==void 0),Oe=f.type||($l(g)?"exponential":"interval");if(te&&((f=Ur({},f)).stops&&(f.stops=f.stops.map(function(Xn){return[Xn[0],la.parse(Xn[1])]})),f.default=la.parse(f.default?f.default:g.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!zs[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Oe==="exponential")A=Xu;else if(Oe==="interval")A=Jl;else if(Oe==="categorical"){A=zc,L=Object.create(null);for(var it=0,Ct=f.stops;it<Ct.length;it+=1){var xt=Ct[it];L[xt[0]]=xt[1]}V=typeof f.stops[0][0]}else{if(Oe!=="identity")throw new Error('Unknown function type "'+Oe+'"');A=wu}if(de){for(var Wt={},Ht=[],tr=0;tr<f.stops.length;tr++){var dr=f.stops[tr],br=dr[0].zoom;Wt[br]===void 0&&(Wt[br]={zoom:br,type:f.type,property:f.property,default:f.default,stops:[]},Ht.push(br)),Wt[br].stops.push([dr[0].value,dr[1]])}for(var jr=[],Ir=0,hn=Ht;Ir<hn.length;Ir+=1){var cn=hn[Ir];jr.push([Wt[cn].zoom,u(Wt[cn],g)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:di.interpolationFactor.bind(void 0,Ln),zoomStops:jr.map(function(Xn){return Xn[0]}),evaluate:function(Dn,Ta){var sa=Dn.zoom;return Xu({stops:jr,base:f.base},g,sa).evaluate(sa,Ta)}}}if(Se){var $n=Oe==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:$n,interpolationFactor:di.interpolationFactor.bind(void 0,$n),zoomStops:f.stops.map(function(Xn){return Xn[0]}),evaluate:function(Dn){return A(f,g,Dn.zoom,L,V)}}}return{kind:"source",evaluate:function(Dn,Ta){var sa=Ta&&Ta.properties?Ta.properties[f.property]:void 0;return sa===void 0?xc(f.default,g.default):A(f,g,sa,L,V)}}}(this._parameters,this._specification))};function tu(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},g=e.style,A=e.styleSpec,L=[],V=Ci(r);if(V!=="object")return[new wt(t,r,"object expected, "+V+" found")];for(var te in r){var de=te.split(".")[0],Se=u[de]||u["*"],Oe=void 0;if(f[de])Oe=f[de];else if(u[de])Oe=Da;else if(f["*"])Oe=f["*"];else{if(!u["*"]){L.push(new wt(t,r[te],'unknown property "'+te+'"'));continue}Oe=Da}L=L.concat(Oe({key:(t&&t+".")+te,value:r[te],valueSpec:Se,style:g,styleSpec:A,object:r,objectKey:te},r))}for(var it in u)f[it]||u[it].required&&u[it].default===void 0&&r[it]===void 0&&L.push(new wt(t,r,'missing required property "'+it+'"'));return L}function yf(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,g=e.key,A=e.arrayElementValidator||Da;if(Ci(t)!=="array")return[new wt(g,t,"array expected, "+Ci(t)+" found")];if(r.length&&t.length!==r.length)return[new wt(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new wt(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var L={type:r.value,values:r.values};f.$version<7&&(L.function=r.function),Ci(r.value)==="object"&&(L=r.value);for(var V=[],te=0;te<t.length;te++)V=V.concat(A({array:t,arrayIndex:te,value:t[te],valueSpec:L,style:u,styleSpec:f,key:g+"["+te+"]"}));return V}function bf(e){var t=e.key,r=e.value,u=e.valueSpec,f=Ci(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new wt(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new wt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new wt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function of(e){var t,r,u,f=e.valueSpec,g=Vr(e.value.type),A={},L=g!=="categorical"&&e.value.property===void 0,V=!L,te=Ci(e.value.stops)==="array"&&Ci(e.value.stops[0])==="array"&&Ci(e.value.stops[0][0])==="object",de=tu({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Ct){if(g==="identity")return[new wt(Ct.key,Ct.value,'identity function may not have a "stops" property')];var xt=[],Wt=Ct.value;return xt=xt.concat(yf({key:Ct.key,value:Wt,valueSpec:Ct.valueSpec,style:Ct.style,styleSpec:Ct.styleSpec,arrayElementValidator:Se})),Ci(Wt)==="array"&&Wt.length===0&&xt.push(new wt(Ct.key,Wt,"array must have at least one stop")),xt},default:function(Ct){return Da({key:Ct.key,value:Ct.value,valueSpec:f,style:Ct.style,styleSpec:Ct.styleSpec})}}});return g==="identity"&&L&&de.push(new wt(e.key,e.value,'missing required property "property"')),g==="identity"||e.value.stops||de.push(new wt(e.key,e.value,'missing required property "stops"')),g==="exponential"&&e.valueSpec.expression&&!$l(e.valueSpec)&&de.push(new wt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(V&&!Zu(e.valueSpec)?de.push(new wt(e.key,e.value,"property functions not supported")):L&&!kc(e.valueSpec)&&de.push(new wt(e.key,e.value,"zoom functions not supported"))),g!=="categorical"&&!te||e.value.property!==void 0||de.push(new wt(e.key,e.value,'"property" property is required')),de;function Se(it){var Ct=[],xt=it.value,Wt=it.key;if(Ci(xt)!=="array")return[new wt(Wt,xt,"array expected, "+Ci(xt)+" found")];if(xt.length!==2)return[new wt(Wt,xt,"array length 2 expected, length "+xt.length+" found")];if(te){if(Ci(xt[0])!=="object")return[new wt(Wt,xt,"object expected, "+Ci(xt[0])+" found")];if(xt[0].zoom===void 0)return[new wt(Wt,xt,"object stop key must have zoom")];if(xt[0].value===void 0)return[new wt(Wt,xt,"object stop key must have value")];if(u&&u>Vr(xt[0].zoom))return[new wt(Wt,xt[0].zoom,"stop zoom values must appear in ascending order")];Vr(xt[0].zoom)!==u&&(u=Vr(xt[0].zoom),r=void 0,A={}),Ct=Ct.concat(tu({key:Wt+"[0]",value:xt[0],valueSpec:{zoom:{}},style:it.style,styleSpec:it.styleSpec,objectElementValidators:{zoom:bf,value:Oe}}))}else Ct=Ct.concat(Oe({key:Wt+"[0]",value:xt[0],valueSpec:{},style:it.style,styleSpec:it.styleSpec},xt));return No(or(xt[1]))?Ct.concat([new wt(Wt+"[1]",xt[1],"expressions are not allowed in function stops.")]):Ct.concat(Da({key:Wt+"[1]",value:xt[1],valueSpec:f,style:it.style,styleSpec:it.styleSpec}))}function Oe(it,Ct){var xt=Ci(it.value),Wt=Vr(it.value),Ht=it.value!==null?it.value:Ct;if(t){if(xt!==t)return[new wt(it.key,Ht,xt+" stop domain type must match previous stop domain type "+t)]}else t=xt;if(xt!=="number"&&xt!=="string"&&xt!=="boolean")return[new wt(it.key,Ht,"stop domain value must be a number, string, or boolean")];if(xt!=="number"&&g!=="categorical"){var tr="number expected, "+xt+" found";return Zu(f)&&g===void 0&&(tr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(it.key,Ht,tr)]}return g!=="categorical"||xt!=="number"||isFinite(Wt)&&Math.floor(Wt)===Wt?g!=="categorical"&&xt==="number"&&r!==void 0&&Wt<r?[new wt(it.key,Ht,"stop domain values must appear in ascending order")]:(r=Wt,g==="categorical"&&Wt in A?[new wt(it.key,Ht,"stop domain values must be unique")]:(A[Wt]=!0,[])):[new wt(it.key,Ht,"integer expected, found "+Wt)]}}function xl(e){var t=(e.expressionContext==="property"?Fc:Ql)(or(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new wt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new wt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!uo(r))return[new wt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!uo(r))return[new wt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!hs(r,["zoom","feature-state"]))return[new wt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ks(r))return[new wt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ki(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Vr(r))===-1&&f.push(new wt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Vr(r))===-1&&f.push(new wt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function il(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!il(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}Dl.deserialize=function(e){return new Dl(e._parameters,e._specification)},Dl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Nl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ec(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};il(e)||(e=kl(e));var t=Ql(e,Nl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,g){return t.value.evaluate(u,f,{},g)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function Uc(e,t){return e<t?-1:e>t?1:0}function kl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?Rf(e[1],e[2],"=="):r==="!="?El(Rf(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Rf(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(kl))):r==="all"?["all"].concat(e.slice(1).map(kl)):r==="none"?["all"].concat(e.slice(1).map(kl).map(El)):r==="in"?If(e[1],e.slice(2)):r==="!in"?El(If(e[1],e.slice(2))):r==="has"?sf(e[1]):r==="!has"?El(sf(e[1])):r!=="within"||e}function Rf(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function If(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Uc)]]:["filter-in-small",e,["literal",t]]}}function sf(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function El(e){return["!",e]}function ql(e){return il(or(e.value))?xl(Ur({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(Ci(u)!=="array")return[new wt(f,u,"array expected, "+Ci(u)+" found")];var g,A=r.styleSpec,L=[];if(u.length<1)return[new wt(f,u,"filter array must have at least 1 element")];switch(L=L.concat(ki({key:f+"[0]",value:u[0],valueSpec:A.filter_operator,style:r.style,styleSpec:r.styleSpec})),Vr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Vr(u[1])==="$type"&&L.push(new wt(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&L.push(new wt(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(g=Ci(u[1]))!=="string"&&L.push(new wt(f+"[1]",u[1],"string expected, "+g+" found"));for(var V=2;V<u.length;V++)g=Ci(u[V]),Vr(u[1])==="$type"?L=L.concat(ki({key:f+"["+V+"]",value:u[V],valueSpec:A.geometry_type,style:r.style,styleSpec:r.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&L.push(new wt(f+"["+V+"]",u[V],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var te=1;te<u.length;te++)L=L.concat(t({key:f+"["+te+"]",value:u[te],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=Ci(u[1]),u.length!==2?L.push(new wt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="string"&&L.push(new wt(f+"[1]",u[1],"string expected, "+g+" found"));break;case"within":g=Ci(u[1]),u.length!==2?L.push(new wt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="object"&&L.push(new wt(f+"[1]",u[1],"object expected, "+g+" found"))}return L}(e)}function Ou(e,t){var r=e.key,u=e.style,f=e.styleSpec,g=e.value,A=e.objectKey,L=f[t+"_"+e.layerType];if(!L)return[];var V=A.match(/^(.*)-transition$/);if(t==="paint"&&V&&L[V[1]]&&L[V[1]].transition)return Da({key:r,value:g,valueSpec:f.transition,style:u,styleSpec:f});var te,de=e.valueSpec||L[A];if(!de)return[new wt(r,g,'unknown property "'+A+'"')];if(Ci(g)==="string"&&Zu(de)&&!de.tokens&&(te=/^{([^}]+)}$/.exec(g)))return[new wt(r,g,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(te[1])+" }`.")];var Se=[];return e.layerType==="symbol"&&(A==="text-field"&&u&&!u.glyphs&&Se.push(new wt(r,g,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&jc(or(g))&&Vr(g.type)==="identity"&&Se.push(new wt(r,g,'"text-font" does not support identity functions'))),Se.concat(Da({key:e.key,value:g,valueSpec:de,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:A}))}function Fs(e){return Ou(e,"paint")}function ol(e){return Ou(e,"layout")}function Bc(e){var t=[],r=e.value,u=e.key,f=e.style,g=e.styleSpec;r.type||r.ref||t.push(new wt(u,r,'either "type" or "ref" is required'));var A,L=Vr(r.type),V=Vr(r.ref);if(r.id)for(var te=Vr(r.id),de=0;de<e.arrayIndex;de++){var Se=f.layers[de];Vr(Se.id)===te&&t.push(new wt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Se.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Ct){Ct in r&&t.push(new wt(u,r[Ct],'"'+Ct+'" is prohibited for ref layers'))}),f.layers.forEach(function(Ct){Vr(Ct.id)===V&&(A=Ct)}),A?A.ref?t.push(new wt(u,r.ref,"ref cannot reference another ref layer")):L=Vr(A.type):t.push(new wt(u,r.ref,'ref layer "'+V+'" not found'));else if(L!=="background")if(r.source){var Oe=f.sources&&f.sources[r.source],it=Oe&&Vr(Oe.type);Oe?it==="vector"&&L==="raster"?t.push(new wt(u,r.source,'layer "'+r.id+'" requires a raster source')):it==="raster"&&L!=="raster"?t.push(new wt(u,r.source,'layer "'+r.id+'" requires a vector source')):it!=="vector"||r["source-layer"]?it==="raster-dem"&&L!=="hillshade"?t.push(new wt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):L!=="line"||!r.paint||!r.paint["line-gradient"]||it==="geojson"&&Oe.lineMetrics||t.push(new wt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new wt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new wt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new wt(u,r,'missing required property "source"'));return t=t.concat(tu({key:u,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Da({key:u+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:ql,layout:function(xt){return tu({layer:r,key:xt.key,value:xt.value,style:xt.style,styleSpec:xt.styleSpec,objectElementValidators:{"*":function(Ht){return ol(Ur({layerType:L},Ht))}}})},paint:function(xt){return tu({layer:r,key:xt.key,value:xt.value,style:xt.style,styleSpec:xt.styleSpec,objectElementValidators:{"*":function(Ht){return Fs(Ur({layerType:L},Ht))}}})}}}))}function Yu(e){var t=e.value,r=e.key,u=Ci(t);return u!=="string"?[new wt(r,t,"string expected, "+u+" found")]:[]}var ji={promoteId:function(t){var r=t.key,u=t.value;if(Ci(u)==="string")return Yu({key:r,value:u});var f=[];for(var g in u)f.push.apply(f,Yu({key:r+"."+g,value:u[g]}));return f}};function pu(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new wt(r,t,'"type" is required')];var g,A=Vr(t.type);switch(A){case"vector":case"raster":case"raster-dem":return tu({key:r,value:t,valueSpec:u["source_"+A.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:ji});case"geojson":if(g=tu({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:ji}),t.cluster)for(var L in t.clusterProperties){var V=t.clusterProperties[L],te=V[0],de=typeof te=="string"?[te,["accumulated"],["get",L]]:te;g.push.apply(g,xl({key:r+"."+L+".map",value:V[1],expressionContext:"cluster-map"})),g.push.apply(g,xl({key:r+"."+L+".reduce",value:de,expressionContext:"cluster-reduce"}))}return g;case"video":return tu({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return tu({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new wt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ki({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function sl(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,g=[],A=Ci(t);if(t===void 0)return g;if(A!=="object")return g.concat([new wt("light",t,"object expected, "+A+" found")]);for(var L in t){var V=L.match(/^(.*)-transition$/);g=g.concat(V&&u[V[1]]&&u[V[1]].transition?Da({key:L,value:t[L],valueSpec:r.transition,style:f,styleSpec:r}):u[L]?Da({key:L,value:t[L],valueSpec:u[L],style:f,styleSpec:r}):[new wt(L,t[L],'unknown property "'+L+'"')])}return g}var ul={"*":function(){return[]},array:yf,boolean:function(t){var r=t.value,u=t.key,f=Ci(r);return f!=="boolean"?[new wt(u,r,"boolean expected, "+f+" found")]:[]},number:bf,color:function(t){var r=t.key,u=t.value,f=Ci(u);return f!=="string"?[new wt(r,u,"color expected, "+f+" found")]:ya(u)===null?[new wt(r,u,'color expected, "'+u+'" found')]:[]},constants:ir,enum:ki,filter:ql,function:of,layer:Bc,object:tu,source:pu,light:sl,string:Yu,formatted:function(t){return Yu(t).length===0?[]:xl(t)},resolvedImage:function(t){return Yu(t).length===0?[]:xl(t)}};function Da(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&jc(Vr(t))?of(e):r.expression&&No(or(t))?xl(e):r.type&&ul[r.type]?ul[r.type](e):tu(Ur({},e,{valueSpec:r.type?u[r.type]:r}))}function mi(e){var t=e.value,r=e.key,u=Yu(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new wt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new wt(r,t,'"glyphs" url must include a "{range}" token'))),u}function Ms(e,t){t===void 0&&(t=Ge);var r=[];return r=r.concat(Da({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:mi,"*":function(){return[]}}})),e.constants&&(r=r.concat(ir({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ti(r)}function Ti(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Wa(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ti(e.apply(this,t))}}Ms.source=Wa(pu),Ms.light=Wa(sl),Ms.layer=Wa(Bc),Ms.filter=Wa(ql),Ms.paintProperty=Wa(Fs),Ms.layoutProperty=Wa(ol);var ec=Ms,xf=ec.light,rs=ec.paintProperty,ll=ec.layoutProperty;function mu(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new Tt(new Error(f[u].message))),r=!0;return r}var Ku=ro;function ro(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var g=0;g<this.d*this.d;g++){var A=f[3+g],L=f[3+g+1];u.push(A===L?null:f.subarray(A,L))}var V=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],V),this.bboxes=f.subarray(V),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var te=0;te<this.d*this.d;te++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var de=r/t*e;this.min=-de,this.max=e+de}ro.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},ro.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ro.prototype._insertCell=function(e,t,r,u,f,g){this.cells[f].push(g)},ro.prototype.query=function(e,t,r,u,f){var g=this.min,A=this.max;if(e<=g&&t<=g&&A<=r&&A<=u&&!f)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(e,t,r,u,this._queryCell,L,{},f),L},ro.prototype._queryCell=function(e,t,r,u,f,g,A,L){var V=this.cells[f];if(V!==null)for(var te=this.keys,de=this.bboxes,Se=0;Se<V.length;Se++){var Oe=V[Se];if(A[Oe]===void 0){var it=4*Oe;(L?L(de[it+0],de[it+1],de[it+2],de[it+3]):e<=de[it+2]&&t<=de[it+3]&&r>=de[it+0]&&u>=de[it+1])?(A[Oe]=!0,g.push(te[Oe])):A[Oe]=!1}}},ro.prototype._forEachCell=function(e,t,r,u,f,g,A,L){for(var V=this._convertToCellCoord(e),te=this._convertToCellCoord(t),de=this._convertToCellCoord(r),Se=this._convertToCellCoord(u),Oe=V;Oe<=de;Oe++)for(var it=te;it<=Se;it++){var Ct=this.d*it+Oe;if((!L||L(this._convertFromCellCoord(Oe),this._convertFromCellCoord(it),this._convertFromCellCoord(Oe+1),this._convertFromCellCoord(it+1)))&&f.call(this,e,t,r,u,Ct,g,A,L))return}},ro.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},ro.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},ro.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=t,A=0;A<e.length;A++){var L=e[A];f[3+A]=g,f.set(L,g),g+=L.length}return f[3+e.length]=g,f.set(this.keys,g),f[3+e.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var ns=Y.ImageData,jl=Y.ImageBitmap,lo={};function Mn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),lo[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Us in Mn("Object",Object),Ku.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Ku.deserialize=function(e){return new Ku(e.buffer)},Mn("Grid",Ku),Mn("Color",la),Mn("Error",Error),Mn("ResolvedImage",Ko),Mn("StylePropertyFunction",Dl),Mn("StyleExpression",Rl,{omit:["_evaluator"]}),Mn("ZoomDependentExpression",bl),Mn("ZoomConstantExpression",Il),Mn("CompoundExpression",So,{omit:["_evaluate"]}),ps)ps[Us]._classRegistryKey||Mn("Expression_"+Us,ps[Us]);function Tc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Tl(e){return jl&&e instanceof jl}function Mu(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Tc(e)||Tl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof ns)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,g=e;f<g.length;f+=1)u.push(Mu(g[f],t));return u}if(typeof e=="object"){var A=e.constructor,L=A._classRegistryKey;if(!L)throw new Error("can't serialize object of unregistered class");var V=A.serialize?A.serialize(e,t):{};if(!A.serialize){for(var te in e)if(e.hasOwnProperty(te)&&!(lo[L].omit.indexOf(te)>=0)){var de=e[te];V[te]=lo[L].shallow.indexOf(te)>=0?de:Mu(de,t)}e instanceof Error&&(V.message=e.message)}if(V.$name)throw new Error("$name property is reserved for worker serialization logic.");return L!=="Object"&&(V.$name=L),V}throw new Error("can't serialize object of type "+typeof e)}function Bs(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Tc(e)||Tl(e)||ArrayBuffer.isView(e)||e instanceof ns)return e;if(Array.isArray(e))return e.map(Bs);if(typeof e=="object"){var t=e.$name||"Object",r=lo[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,g=Object.keys(e);f<g.length;f+=1){var A=g[f];if(A!=="$name"){var L=e[A];u[A]=lo[t].shallow.indexOf(A)>=0?L:Bs(L)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var ei=function(){this.first=!0};ei.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Vc(e){for(var t=0,r=e;t<r.length;t+=1)if(_c(r[t].charCodeAt(0)))return!0;return!1}function _c(e){return!(e!==746&&e!==747&&(e<4352||!(qr["Bopomofo Extended"](e)||qr.Bopomofo(e)||qr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qr["CJK Compatibility Ideographs"](e)||qr["CJK Compatibility"](e)||qr["CJK Radicals Supplement"](e)||qr["CJK Strokes"](e)||!(!qr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qr["CJK Unified Ideographs Extension A"](e)||qr["CJK Unified Ideographs"](e)||qr["Enclosed CJK Letters and Months"](e)||qr["Hangul Compatibility Jamo"](e)||qr["Hangul Jamo Extended-A"](e)||qr["Hangul Jamo Extended-B"](e)||qr["Hangul Jamo"](e)||qr["Hangul Syllables"](e)||qr.Hiragana(e)||qr["Ideographic Description Characters"](e)||qr.Kanbun(e)||qr["Kangxi Radicals"](e)||qr["Katakana Phonetic Extensions"](e)||qr.Katakana(e)&&e!==12540||!(!qr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qr["Unified Canadian Aboriginal Syllabics"](e)||qr["Unified Canadian Aboriginal Syllabics Extended"](e)||qr["Vertical Forms"](e)||qr["Yijing Hexagram Symbols"](e)||qr["Yi Syllables"](e)||qr["Yi Radicals"](e))))}function cl(e){return!(_c(e)||function(t){return!!(qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||qr["Letterlike Symbols"](t)||qr["Number Forms"](t)||qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||qr["Control Pictures"](t)&&t!==9251||qr["Optical Character Recognition"](t)||qr["Enclosed Alphanumerics"](t)||qr["Geometric Shapes"](t)||qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qr["CJK Symbols and Punctuation"](t)||qr.Katakana(t)||qr["Private Use Area"](t)||qr["CJK Compatibility Forms"](t)||qr["Small Form Variants"](t)||qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function vu(e){return e>=1424&&e<=2303||qr["Arabic Presentation Forms-A"](e)||qr["Arabic Presentation Forms-B"](e)}function Ps(e,t){return!(!t&&vu(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qr.Khmer(e))}function Ls(e){for(var t=0,r=e;t<r.length;t+=1)if(vu(r[t].charCodeAt(0)))return!0;return!1}var $o=null,ko="unavailable",fl=null,_l=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(ko="error"),$o&&$o(t)};function zl(){uf.fire(new at("pluginStateChange",{pluginStatus:ko,pluginURL:fl}))}var uf=new jt,Fl=function(){return ko},Rs=function(){if(ko!=="deferred"||!fl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ko="loading",zl(),fl&&Hn({url:fl},function(t){t?_l(t):(ko="loaded",zl())})},as={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ko==="loaded"||as.applyArabicShaping!=null},isLoading:function(){return ko==="loading"},setState:function(t){ko=t.pluginStatus,fl=t.pluginURL},isParsed:function(){return as.applyArabicShaping!=null&&as.processBidirectionalText!=null&&as.processStyledBidirectionalText!=null},getPluginURL:function(){return fl}},Pa=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ei,this.transition={})};Pa.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Ps(f[u].charCodeAt(0),r))return!1;return!0}(e,as.isLoaded())},Pa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Pa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var $u=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(jc(u))return new Dl(u,f);if(No(u)){var g=Fc(u,f);if(g.result==="error")throw new Error(g.value.map(function(L){return L.key+": "+L.message}).join(", "));return g.value}var A=u;return typeof u=="string"&&f.type==="color"&&(A=la.parse(u)),{kind:"constant",evaluate:function(){return A}}}(r===void 0?t.specification.default:r,t.specification)};$u.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},$u.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var zi=function(t){this.property=t,this.value=new $u(t,void 0)};zi.prototype.transitioned=function(e,t){return new Sl(this.property,this.value,t,ke({},e.transition,this.transition),e.now)},zi.prototype.untransitioned=function(){return new Sl(this.property,this.value,null,{},0)};var Co=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Co.prototype.getValue=function(e){return Ue(this._values[e].value.value)},Co.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zi(this._values[e].property)),this._values[e].value=new $u(this._values[e].property,t===null?void 0:Ue(t))},Co.prototype.getTransition=function(e){return Ue(this._values[e].transition)},Co.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new zi(this._values[e].property)),this._values[e].transition=Ue(t)||void 0},Co.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var g=this.getTransition(u);g!==void 0&&(e[u+"-transition"]=g)}return e},Co.prototype.transitioned=function(e,t){for(var r=new gu(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var g=f[u];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},Co.prototype.untransitioned=function(){for(var e=new gu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Sl=function(t,r,u,f,g){this.property=t,this.value=r,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};Sl.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return g.possiblyEvaluate(e,t,r);var A=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),f,function(L){if(L<=0)return 0;if(L>=1)return 1;var V=L*L,te=V*L;return 4*(L<.5?te:3*(L-V)+te-.75)}(A))}return f};var gu=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};gu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Sc(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var A=g[f];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u},gu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var yu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};yu.prototype.getValue=function(e){return Ue(this._values[e].value)},yu.prototype.setValue=function(e,t){this._values[e]=new $u(this._values[e].property,t===null?void 0:Ue(t))},yu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},yu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Sc(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var A=g[f];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u};var Ss=function(t,r,u){this.property=t,this.value=r,this.parameters=u};Ss.prototype.isConstant=function(){return this.value.kind==="constant"},Ss.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Ss.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var Sc=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Sc.prototype.get=function(e){return this._values[e]};var Yn=function(t){this.specification=t};Yn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Yn.prototype.interpolate=function(e,t,r){var u=vl[this.specification.type];return u?u(e,t,r):e};var Nn=function(t,r){this.specification=t,this.overrides=r};Nn.prototype.possiblyEvaluate=function(e,t,r,u){return new Ss(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},Nn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Ss(this,{kind:"constant",value:void 0},e.parameters);var u=vl[this.specification.type];return u?new Ss(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},Nn.prototype.evaluate=function(e,t,r,u,f,g){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,g)};var Ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,g){if(r.value===void 0)return new Ss(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var A=r.expression.evaluate(u,null,{},f,g),L=r.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,V=this._calculate(L,L,L,u);return new Ss(this,{kind:"constant",value:V},u)}if(r.expression.kind==="camera"){var te=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Ss(this,{kind:"constant",value:te},u)}return new Ss(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,g,A,L){if(r.kind==="source"){var V=r.evaluate(u,f,g,A,L);return this._calculate(V,V,V,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,g),r.evaluate({zoom:Math.floor(u.zoom)},f,g),r.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):r.value},t.prototype._calculate=function(r,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(Nn),ms=function(t){this.specification=t};ms.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Pa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom+1),t)),t)}},ms.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},ms.prototype.interpolate=function(e){return e};var jo=function(t){this.specification=t};jo.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},jo.prototype.interpolate=function(){return!1};var wo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new $u(u,void 0),g=this.defaultTransitionablePropertyValues[r]=new zi(u);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};Mn("DataDrivenProperty",Nn),Mn("DataConstantProperty",Yn),Mn("CrossFadedDataDrivenProperty",Ac),Mn("CrossFadedProperty",ms),Mn("ColorRampProperty",jo);var ru=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new yu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new Co(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Sc(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(ll,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return _t(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(rs,"layers."+this.id+".paint."+r,r,u,f))return!1;if(_t(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var g=this._transitionablePaint._values[r],A=g.property.specification["property-type"]==="cross-faded-data-driven",L=g.value.isDataDriven(),V=g.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var te=this._transitionablePaint._values[r].value;return te.isDataDriven()||L||A||this._handleOverridablePaintPropertyUpdate(r,V,te)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ne(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,g,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&mu(this,r.call(ec,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Ge,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof Ss&&Zu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(jt),Pu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tc=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Za=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Hi(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var g=Pu[f.type].BYTES_PER_ELEMENT,A=r=hl(r,Math.max(t,g)),L=f.components||1;return u=Math.max(u,g),r+=g*L,{name:f.name,type:f.type,components:L,offset:A}}),size:hl(r,Math.max(u,t)),alignment:t}}function hl(e,t){return Math.ceil(e/t)*t}Za.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Za.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Za.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Za.prototype.clear=function(){this.length=0},Za.prototype.resize=function(e){this.reserve(e),this.length=e},Za.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Za.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var dl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.int16[g+0]=u,this.int16[g+1]=f,r},t}(Za);dl.prototype.bytesPerElement=4,Mn("StructArrayLayout2i4",dl);var rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var L=4*r;return this.int16[L+0]=u,this.int16[L+1]=f,this.int16[L+2]=g,this.int16[L+3]=A,r},t}(Za);rc.prototype.bytesPerElement=8,Mn("StructArrayLayout4i8",rc);var Lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,g,A,L)},t.prototype.emplace=function(r,u,f,g,A,L,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=g,this.int16[te+3]=A,this.int16[te+4]=L,this.int16[te+5]=V,r},t}(Za);Lu.prototype.bytesPerElement=12,Mn("StructArrayLayout2i4i12",Lu);var Is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,g,A,L)},t.prototype.emplace=function(r,u,f,g,A,L,V){var te=4*r,de=8*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.uint8[de+4]=g,this.uint8[de+5]=A,this.uint8[de+6]=L,this.uint8[de+7]=V,r},t}(Za);Is.prototype.bytesPerElement=8,Mn("StructArrayLayout2i4ub8",Is);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.float32[g+0]=u,this.float32[g+1]=f,r},t}(Za);Ul.prototype.bytesPerElement=8,Mn("StructArrayLayout2f8",Ul);var vs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L,V,te,de,Se){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,r,u,f,g,A,L,V,te,de,Se)},t.prototype.emplace=function(r,u,f,g,A,L,V,te,de,Se,Oe){var it=10*r;return this.uint16[it+0]=u,this.uint16[it+1]=f,this.uint16[it+2]=g,this.uint16[it+3]=A,this.uint16[it+4]=L,this.uint16[it+5]=V,this.uint16[it+6]=te,this.uint16[it+7]=de,this.uint16[it+8]=Se,this.uint16[it+9]=Oe,r},t}(Za);vs.prototype.bytesPerElement=20,Mn("StructArrayLayout10ui20",vs);var Ef=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L,V,te,de,Se,Oe,it){var Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,r,u,f,g,A,L,V,te,de,Se,Oe,it)},t.prototype.emplace=function(r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct){var xt=12*r;return this.int16[xt+0]=u,this.int16[xt+1]=f,this.int16[xt+2]=g,this.int16[xt+3]=A,this.uint16[xt+4]=L,this.uint16[xt+5]=V,this.uint16[xt+6]=te,this.uint16[xt+7]=de,this.int16[xt+8]=Se,this.int16[xt+9]=Oe,this.int16[xt+10]=it,this.int16[xt+11]=Ct,r},t}(Za);Ef.prototype.bytesPerElement=24,Mn("StructArrayLayout4i4ui4i24",Ef);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.float32[A+0]=u,this.float32[A+1]=f,this.float32[A+2]=g,r},t}(Za);Bl.prototype.bytesPerElement=12,Mn("StructArrayLayout3f12",Bl);var Gc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(Za);Gc.prototype.bytesPerElement=4,Mn("StructArrayLayout1ul4",Gc);var Tf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L,V,te,de){var Se=this.length;return this.resize(Se+1),this.emplace(Se,r,u,f,g,A,L,V,te,de)},t.prototype.emplace=function(r,u,f,g,A,L,V,te,de,Se){var Oe=10*r,it=5*r;return this.int16[Oe+0]=u,this.int16[Oe+1]=f,this.int16[Oe+2]=g,this.int16[Oe+3]=A,this.int16[Oe+4]=L,this.int16[Oe+5]=V,this.uint32[it+3]=te,this.uint16[Oe+8]=de,this.uint16[Oe+9]=Se,r},t}(Za);Tf.prototype.bytesPerElement=20,Mn("StructArrayLayout6i1ul2ui20",Tf);var Vs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,g,A,L)},t.prototype.emplace=function(r,u,f,g,A,L,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=g,this.int16[te+3]=A,this.int16[te+4]=L,this.int16[te+5]=V,r},t}(Za);Vs.prototype.bytesPerElement=12,Mn("StructArrayLayout2i2i2i12",Vs);var Al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A){var L=this.length;return this.resize(L+1),this.emplace(L,r,u,f,g,A)},t.prototype.emplace=function(r,u,f,g,A,L){var V=4*r,te=8*r;return this.float32[V+0]=u,this.float32[V+1]=f,this.float32[V+2]=g,this.int16[te+6]=A,this.int16[te+7]=L,r},t}(Za);Al.prototype.bytesPerElement=16,Mn("StructArrayLayout2f1f2i16",Al);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var L=12*r,V=3*r;return this.uint8[L+0]=u,this.uint8[L+1]=f,this.float32[V+1]=g,this.float32[V+2]=A,r},t}(Za);Vl.prototype.bytesPerElement=12,Mn("StructArrayLayout2ub2f12",Vl);var Ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.uint16[A+0]=u,this.uint16[A+1]=f,this.uint16[A+2]=g,r},t}(Za);Ru.prototype.bytesPerElement=6,Mn("StructArrayLayout3ui6",Ru);var Iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr){var dr=this.length;return this.resize(dr+1),this.emplace(dr,r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr)},t.prototype.emplace=function(r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr,dr){var br=24*r,jr=12*r,Ir=48*r;return this.int16[br+0]=u,this.int16[br+1]=f,this.uint16[br+2]=g,this.uint16[br+3]=A,this.uint32[jr+2]=L,this.uint32[jr+3]=V,this.uint32[jr+4]=te,this.uint16[br+10]=de,this.uint16[br+11]=Se,this.uint16[br+12]=Oe,this.float32[jr+7]=it,this.float32[jr+8]=Ct,this.uint8[Ir+36]=xt,this.uint8[Ir+37]=Wt,this.uint8[Ir+38]=Ht,this.uint32[jr+10]=tr,this.int16[br+22]=dr,r},t}(Za);Iu.prototype.bytesPerElement=48,Mn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Iu);var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr,dr,br,jr,Ir,hn,cn,Ln,$n,Xn,Dn,Ta){var sa=this.length;return this.resize(sa+1),this.emplace(sa,r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr,dr,br,jr,Ir,hn,cn,Ln,$n,Xn,Dn,Ta)},t.prototype.emplace=function(r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt,Wt,Ht,tr,dr,br,jr,Ir,hn,cn,Ln,$n,Xn,Dn,Ta,sa){var qn=34*r,$a=17*r;return this.int16[qn+0]=u,this.int16[qn+1]=f,this.int16[qn+2]=g,this.int16[qn+3]=A,this.int16[qn+4]=L,this.int16[qn+5]=V,this.int16[qn+6]=te,this.int16[qn+7]=de,this.uint16[qn+8]=Se,this.uint16[qn+9]=Oe,this.uint16[qn+10]=it,this.uint16[qn+11]=Ct,this.uint16[qn+12]=xt,this.uint16[qn+13]=Wt,this.uint16[qn+14]=Ht,this.uint16[qn+15]=tr,this.uint16[qn+16]=dr,this.uint16[qn+17]=br,this.uint16[qn+18]=jr,this.uint16[qn+19]=Ir,this.uint16[qn+20]=hn,this.uint16[qn+21]=cn,this.uint16[qn+22]=Ln,this.uint32[$a+12]=$n,this.float32[$a+13]=Xn,this.float32[$a+14]=Dn,this.float32[$a+15]=Ta,this.float32[$a+16]=sa,r},t}(Za);Cl.prototype.bytesPerElement=68,Mn("StructArrayLayout8i15ui1ul4f68",Cl);var Ju=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(Za);Ju.prototype.bytesPerElement=4,Mn("StructArrayLayout1f4",Ju);var Ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,r},t}(Za);Ds.prototype.bytesPerElement=6,Mn("StructArrayLayout3i6",Ds);var Cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=4*r;return this.uint32[2*r+0]=u,this.uint16[A+2]=f,this.uint16[A+3]=g,r},t}(Za);Cc.prototype.bytesPerElement=8,Mn("StructArrayLayout1ul2ui8",Cc);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.uint16[g+0]=u,this.uint16[g+1]=f,r},t}(Za);nc.prototype.bytesPerElement=4,Mn("StructArrayLayout2ui4",nc);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(Za);ac.prototype.bytesPerElement=2,Mn("StructArrayLayout1ui2",ac);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var L=4*r;return this.float32[L+0]=u,this.float32[L+1]=f,this.float32[L+2]=g,this.float32[L+3]=A,r},t}(Za);ic.prototype.bytesPerElement=16,Mn("StructArrayLayout4f16",ic);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new re(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(tc);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Tf);Mn("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(tc);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Iu);Mn("PlacedSymbolArray",l);var b=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(tc);b.prototype.size=68;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new b(this,r)},t}(Cl);Mn("SymbolInstanceArray",O);var R=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Ju);Mn("GlyphOffsetArray",R);var j=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ds);Mn("SymbolLineVertexArray",j);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(tc);ue.prototype.size=8;var Te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(Cc);Mn("FeatureIndexArray",Te);var Xe=Hi([{name:"a_pos",components:2,type:"Int16"}],4).members,Je=function(t){t===void 0&&(t=[]),this.segments=t};function tt(e,t){return 256*(e=we(Math.floor(e),0,255))+we(Math.floor(t),0,255)}Je.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>Je.MAX_VERTEX_ARRAY_LENGTH&&Le("Max vertices per segment is "+Je.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>Je.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},Je.prototype.get=function(){return this.segments},Je.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},Je.simpleSegment=function(e,t,r,u){return new Je([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},Je.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mn("SegmentVector",Je);var Dt=Hi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Lt=Z(function(e){e.exports=function(t,r){var u,f,g,A,L,V,te,de;for(f=t.length-(u=3&t.length),g=r,L=3432918353,V=461845907,de=0;de<f;)te=255&t.charCodeAt(de)|(255&t.charCodeAt(++de))<<8|(255&t.charCodeAt(++de))<<16|(255&t.charCodeAt(++de))<<24,++de,g=27492+(65535&(A=5*(65535&(g=(g^=te=(65535&(te=(te=(65535&te)*L+(((te>>>16)*L&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(te=0,u){case 3:te^=(255&t.charCodeAt(de+2))<<16;case 2:te^=(255&t.charCodeAt(de+1))<<8;case 1:g^=te=(65535&(te=(te=(65535&(te^=255&t.charCodeAt(de)))*L+(((te>>>16)*L&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Zt=Z(function(e){e.exports=function(t,r){for(var u,f=t.length,g=r^f,A=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++A;switch(f){case 3:g^=(255&t.charCodeAt(A+2))<<16;case 2:g^=(255&t.charCodeAt(A+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(A)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),Rt=Lt,Bt=Zt;Rt.murmur3=Lt,Rt.murmur2=Bt;var qt=function(){this.ids=[],this.positions=[],this.indexed=!1};qt.prototype.add=function(e,t,r,u){this.ids.push(Pr(e)),this.positions.push(t,r,u)},qt.prototype.getPositions=function(e){for(var t=Pr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},qt.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(g,A,L,V){for(;L<V;){for(var te=g[L+V>>1],de=L-1,Se=V+1;;){do de++;while(g[de]<te);do Se--;while(g[Se]>te);if(de>=Se)break;fr(g,de,Se),fr(A,3*de,3*Se),fr(A,3*de+1,3*Se+1),fr(A,3*de+2,3*Se+2)}Se-L<V-Se?(f(g,A,L,Se),L=Se+1):(f(g,A,Se+1,V),V=Se)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},qt.deserialize=function(e){var t=new qt;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Qt=Math.pow(2,53)-1;function Pr(e){var t=+e;return!isNaN(t)&&t<=Qt?t:Rt(String(e))}function fr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}Mn("FeaturePositionMap",qt);var Tr=function(t,r){this.gl=t.gl,this.location=r},Ar=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Tr),nn=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Tr),Xr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Tr),gn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Tr),Pn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Tr),Jn=function(e){function t(r,u){e.call(this,r,u),this.current=la.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Tr),aa=new Float32Array(16),ba=function(e){function t(r,u){e.call(this,r,u),this.current=aa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Tr);function Xa(e){return[tt(255*e.r,255*e.g),tt(255*e.b,255*e.a)]}var _n=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};_n.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},_n.prototype.getBinding=function(e,t,r){return this.type==="color"?new Jn(e,t):new nn(e,t)};var ia=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ia.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ia.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ia.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Pn(e,t):new nn(e,t)};var xa=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(g){return{name:"a_"+g,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};xa.prototype.populatePaintArray=function(e,t,r,u,f){var g=this.paintVertexArray.length,A=this.expression.evaluate(new Pa(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(g,e,A)},xa.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},xa.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Xa(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},xa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Wn=function(t,r,u,f,g,A){this.expression=t,this.uniformNames=r.map(function(L){return"u_"+L+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(function(L){return{name:"a_"+L,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new A};Wn.prototype.populatePaintArray=function(e,t,r,u,f){var g=this.expression.evaluate(new Pa(this.zoom),t,{},u,[],f),A=this.expression.evaluate(new Pa(this.zoom+1),t,{},u,[],f),L=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(L,e,g,A)},Wn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),g=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,g)},Wn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Xa(r),g=Xa(u),A=e;A<t;A++)this.paintVertexArray.emplace(A,f[0],f[1],g[0],g[1]);else{for(var L=e;L<t;L++)this.paintVertexArray.emplace(L,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Wn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Wn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=we(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Wn.prototype.getBinding=function(e,t,r){return new nn(e,t)};var Aa=function(t,r,u,f,g,A){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=A,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};Aa.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Aa.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Aa.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],g=u[r.mid],A=u[r.max];if(f&&g&&A)for(var L=e;L<t;L++)this.zoomInPaintVertexArray.emplace(L,g.tl[0],g.tl[1],g.br[0],g.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],g.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,g.tl[0],g.tl[1],g.br[0],g.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],g.pixelRatio,A.pixelRatio)}},Aa.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Dt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Dt.members,this.expression.isStateDependent))},Aa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ta=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var g in t.paint._values)if(u(g)){var A=t.paint.get(g);if(A instanceof Ss&&Zu(A.property.specification)){var L=ja(g,t.type),V=A.value,te=A.property.specification.type,de=A.property.useIntegerZoom,Se=A.property.specification["property-type"],Oe=Se==="cross-faded"||Se==="cross-faded-data-driven";if(V.kind==="constant")this.binders[g]=Oe?new ia(V.value,L):new _n(V.value,L,te),f.push("/u_"+g);else if(V.kind==="source"||Oe){var it=Ji(g,te,"source");this.binders[g]=Oe?new Aa(V,te,de,r,it,t.id):new xa(V,L,te,it),f.push("/a_"+g)}else{var Ct=Ji(g,te,"composite");this.binders[g]=new Wn(V,L,te,de,r,Ct),f.push("/z_"+g)}}}this.cacheKey=f.sort().join("")};ta.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof xa||t instanceof Wn?t.maxValue:0},ta.prototype.populatePaintArrays=function(e,t,r,u,f){for(var g in this.binders){var A=this.binders[g];(A instanceof xa||A instanceof Wn||A instanceof Aa)&&A.populatePaintArray(e,t,r,u,f)}},ta.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ia&&u.setConstantPatternPositions(e,t)}},ta.prototype.updatePaintArrays=function(e,t,r,u,f){var g=!1;for(var A in e)for(var L=0,V=t.getPositions(A);L<V.length;L+=1){var te=V[L],de=r.feature(te.index);for(var Se in this.binders){var Oe=this.binders[Se];if((Oe instanceof xa||Oe instanceof Wn||Oe instanceof Aa)&&Oe.expression.isStateDependent===!0){var it=u.paint.get(Se);Oe.expression=it.value,Oe.updatePaintArray(te.start,te.end,de,e[A],f),g=!0}}}return g},ta.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof _n||r instanceof ia)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},ta.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof xa||r instanceof Wn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Aa)for(var f=0;f<Dt.members.length;f++)e.push(Dt.members[f].name)}return e},ta.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof _n||r instanceof ia||r instanceof Wn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},ta.prototype.getPaintVertexBuffers=function(){return this._buffers},ta.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof _n||f instanceof ia||f instanceof Wn)for(var g=0,A=f.uniformNames;g<A.length;g+=1){var L=A[g];if(t[L]){var V=f.getBinding(e,t[L],L);r.push({name:L,property:u,binding:V})}}}return r},ta.prototype.setUniforms=function(e,t,r,u){for(var f=0,g=t;f<g.length;f+=1){var A=g[f],L=A.name,V=A.property;this.binders[V].setUniform(A.binding,u,r.get(V),L)}},ta.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Aa){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof xa||r instanceof Wn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ta.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof xa||r instanceof Wn||r instanceof Aa)&&r.upload(e)}this.updatePaintBuffers()},ta.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof xa||t instanceof Wn||t instanceof Aa)&&t.destroy()}};var La=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,g=t;f<g.length;f+=1){var A=g[f];this.programConfigurations[A.id]=new ta(A,r,u)}this.needsUpload=!1,this._featureMap=new qt,this._bufferOffset=0};function ja(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Ji(e,t,r){var u={color:{source:Ul,composite:ic},number:{source:Ju,composite:Ul}},f=function(g){return{"line-pattern":{source:vs,composite:vs},"fill-pattern":{source:vs,composite:vs},"fill-extrusion-pattern":{source:vs,composite:vs}}[g]}(e);return f&&f[r]||u[t][r]}La.prototype.populatePaintArrays=function(e,t,r,u,f,g){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(e,t,u,f,g);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},La.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,g=r;f<g.length;f+=1){var A=g[f];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(e,this._featureMap,t,A,u)||this.needsUpload}},La.prototype.get=function(e){return this.programConfigurations[e]},La.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},La.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Mn("ConstantBinder",_n),Mn("CrossFadedConstantBinder",ia),Mn("SourceExpressionBinder",xa),Mn("CrossFadedCompositeBinder",Aa),Mn("CompositeExpressionBinder",Wn),Mn("ProgramConfiguration",ta,{omit:["_buffers"]}),Mn("ProgramConfigurationSet",La);var wi=Math.pow(2,14)-1,vo=-wi-1;function _i(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],g=0;g<f.length;g++){var A=f[g],L=Math.round(A.x*t),V=Math.round(A.y*t);A.x=we(L,vo,wi),A.y=we(V,vo,wi),(L<A.x||L>A.x+1||V<A.y||V>A.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Wi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?_i(e):[]}}function Ns(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var go=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new dl,this.indexArray=new Ru,this.segments=new Je,this.programConfigurations=new La(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function bu(e,t){for(var r=0;r<e.length;r++)if(Nu(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(Nu(e,t[u]))return!0;return!!Du(e,t)}function xu(e,t,r){return!!Nu(e,t)||!!Qu(t,e,r)}function zo(e,t){if(e.length===1)return uc(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(Nu(e,u[f]))return!0;for(var g=0;g<e.length;g++)if(uc(t,e[g]))return!0;for(var A=0;A<t.length;A++)if(Du(e,t[A]))return!0;return!1}function As(e,t,r){if(e.length>1){if(Du(e,t))return!0;for(var u=0;u<t.length;u++)if(Qu(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(Qu(e[f],t,r))return!0;return!1}function Du(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],g=0;g<t.length-1;g++)if(oc(u,f,t[g],t[g+1]))return!0;return!1}function oc(e,t,r,u){return ut(e,r,u)!==ut(t,r,u)&&ut(e,t,r)!==ut(e,t,u)}function Qu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(sc(e,t[f-1],t[f])<u)return!0;return!1}function sc(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function uc(e,t){for(var r,u,f,g=!1,A=0;A<e.length;A++)for(var L=0,V=(r=e[A]).length-1;L<r.length;V=L++)(u=r[L]).y>t.y!=(f=r[V]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(g=!g);return g}function Nu(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var g=e[u],A=e[f];g.y>t.y!=A.y>t.y&&t.x<(A.x-g.x)*(t.y-g.y)/(A.y-g.y)+g.x&&(r=!r)}return r}function pl(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var g=ut(e,t,r[0]);return g!==ut(e,t,r[1])||g!==ut(e,t,r[2])||g!==ut(e,t,r[3])}function Cs(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function co(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ku(e,t,r,u,f){if(!t[0]&&!t[1])return e;var g=re.convert(t)._mult(f);r==="viewport"&&g._rotate(-u);for(var A=[],L=0;L<e.length;L++)A.push(e[L].sub(g));return A}go.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],g=null;u.type==="circle"&&(g=u.layout.get("circle-sort-key"));for(var A=0,L=e;A<L.length;A+=1){var V=L[A],te=V.feature,de=V.id,Se=V.index,Oe=V.sourceLayerIndex,it=this.layers[0]._featureFilter.needGeometry,Ct=Wi(te,it);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Ct,r)){var xt=g?g.evaluate(Ct,{},r):void 0,Wt={id:de,properties:te.properties,type:te.type,sourceLayerIndex:Oe,index:Se,geometry:it?Ct.geometry:_i(te),patterns:{},sortKey:xt};f.push(Wt)}}g&&f.sort(function(cn,Ln){return cn.sortKey-Ln.sortKey});for(var Ht=0,tr=f;Ht<tr.length;Ht+=1){var dr=tr[Ht],br=dr.geometry,jr=dr.index,Ir=dr.sourceLayerIndex,hn=e[jr].feature;this.addFeature(dr,br,jr,r),t.featureIndex.insert(hn,br,jr,Ir,this.index)}},go.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},go.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},go.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},go.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},go.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},go.prototype.addFeature=function(e,t,r,u){for(var f=0,g=t;f<g.length;f+=1)for(var A=0,L=g[f];A<L.length;A+=1){var V=L[A],te=V.x,de=V.y;if(!(te<0||te>=8192||de<0||de>=8192)){var Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Oe=Se.vertexLength;Ns(this.layoutVertexArray,te,de,-1,-1),Ns(this.layoutVertexArray,te,de,1,-1),Ns(this.layoutVertexArray,te,de,1,1),Ns(this.layoutVertexArray,te,de,-1,1),this.indexArray.emplaceBack(Oe,Oe+1,Oe+2),this.indexArray.emplaceBack(Oe,Oe+3,Oe+2),Se.vertexLength+=4,Se.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},Mn("CircleBucket",go,{omit:["layers"]});var Eu=new wo({"circle-sort-key":new Nn(Ge.layout_circle["circle-sort-key"])}),Oo={paint:new wo({"circle-radius":new Nn(Ge.paint_circle["circle-radius"]),"circle-color":new Nn(Ge.paint_circle["circle-color"]),"circle-blur":new Nn(Ge.paint_circle["circle-blur"]),"circle-opacity":new Nn(Ge.paint_circle["circle-opacity"]),"circle-translate":new Yn(Ge.paint_circle["circle-translate"]),"circle-translate-anchor":new Yn(Ge.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yn(Ge.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yn(Ge.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nn(Ge.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nn(Ge.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nn(Ge.paint_circle["circle-stroke-opacity"])}),layout:Eu},Mo=typeof Float32Array!="undefined"?Float32Array:Array;function Po(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jo(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3],L=t[4],V=t[5],te=t[6],de=t[7],Se=t[8],Oe=t[9],it=t[10],Ct=t[11],xt=t[12],Wt=t[13],Ht=t[14],tr=t[15],dr=r[0],br=r[1],jr=r[2],Ir=r[3];return e[0]=dr*u+br*L+jr*Se+Ir*xt,e[1]=dr*f+br*V+jr*Oe+Ir*Wt,e[2]=dr*g+br*te+jr*it+Ir*Ht,e[3]=dr*A+br*de+jr*Ct+Ir*tr,e[4]=(dr=r[4])*u+(br=r[5])*L+(jr=r[6])*Se+(Ir=r[7])*xt,e[5]=dr*f+br*V+jr*Oe+Ir*Wt,e[6]=dr*g+br*te+jr*it+Ir*Ht,e[7]=dr*A+br*de+jr*Ct+Ir*tr,e[8]=(dr=r[8])*u+(br=r[9])*L+(jr=r[10])*Se+(Ir=r[11])*xt,e[9]=dr*f+br*V+jr*Oe+Ir*Wt,e[10]=dr*g+br*te+jr*it+Ir*Ht,e[11]=dr*A+br*de+jr*Ct+Ir*tr,e[12]=(dr=r[12])*u+(br=r[13])*L+(jr=r[14])*Se+(Ir=r[15])*xt,e[13]=dr*f+br*V+jr*Oe+Ir*Wt,e[14]=dr*g+br*te+jr*it+Ir*Ht,e[15]=dr*A+br*de+jr*Ct+Ir*tr,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var yo,Fo=Jo;function Gs(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*g+r[12]*A,e[1]=r[1]*u+r[5]*f+r[9]*g+r[13]*A,e[2]=r[2]*u+r[6]*f+r[10]*g+r[14]*A,e[3]=r[3]*u+r[7]*f+r[11]*g+r[15]*A,e}yo=new Mo(3),Mo!=Float32Array&&(yo[0]=0,yo[1]=0,yo[2]=0),function(){var e=new Mo(4);Mo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var wl=(function(){var e=new Mo(2);Mo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Oo)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new go(r)},t.prototype.queryRadius=function(r){var u=r;return Cs("circle-radius",this,u)+Cs("circle-stroke-width",this,u)+co(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,L,V,te){for(var de=ku(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),L.angle,V),Se=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),Oe=this.paint.get("circle-pitch-alignment")==="map",it=Oe?de:function(hn,cn){return hn.map(function(Ln){return Hc(Ln,cn)})}(de,te),Ct=Oe?Se*V:Se,xt=0,Wt=g;xt<Wt.length;xt+=1)for(var Ht=0,tr=Wt[xt];Ht<tr.length;Ht+=1){var dr=tr[Ht],br=Oe?dr:Hc(dr,te),jr=Ct,Ir=Gs([],[dr.x,dr.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?jr*=Ir[3]/L.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(jr*=L.cameraToCenterDistance/Ir[3]),xu(it,br,jr))return!0}return!1},t}(ru));function Hc(e,t){var r=Gs([],[e.x,e.y,0,1],t);return new re(r[0]/r[3],r[1]/r[3])}var Gl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(go);function qu(e,t,r,u){var f=t.width,g=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*g*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*g*r);return e.width=f,e.height=g,e.data=u,e}function ju(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var g=qu({},{width:u,height:f},r);zu(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=g.data}}function zu(e,t,r,u,f,g){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=e.data,L=t.data,V=0;V<f.height;V++)for(var te=((r.y+V)*e.width+r.x)*g,de=((u.y+V)*t.width+u.x)*g,Se=0;Se<f.width*g;Se++)L[de+Se]=A[te+Se];return t}Mn("HeatmapBucket",Gl,{omit:["layers"]});var Hs=function(t,r){qu(this,t,1,r)};Hs.prototype.resize=function(e){ju(this,e,1)},Hs.prototype.clone=function(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))},Hs.copy=function(e,t,r,u,f){zu(e,t,r,u,f,1)};var Lo=function(t,r){qu(this,t,4,r)};Lo.prototype.resize=function(e){ju(this,e,4)},Lo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Lo.prototype.clone=function(){return new Lo({width:this.width,height:this.height},new Uint8Array(this.data))},Lo.copy=function(e,t,r,u,f){zu(e,t,r,u,f,4)},Mn("AlphaImage",Hs),Mn("RGBAImage",Lo);var Wc={paint:new wo({"heatmap-radius":new Nn(Ge.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nn(Ge.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yn(Ge.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jo(Ge.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yn(Ge.paint_heatmap["heatmap-opacity"])})};function gs(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new Lo({width:r,height:u}),g=function(xt,Wt,Ht){t[e.evaluationKey]=Ht;var tr=e.expression.evaluate(t);f.data[xt+Wt+0]=Math.floor(255*tr.r/tr.a),f.data[xt+Wt+1]=Math.floor(255*tr.g/tr.a),f.data[xt+Wt+2]=Math.floor(255*tr.b/tr.a),f.data[xt+Wt+3]=Math.floor(255*tr.a)};if(e.clips)for(var A=0,L=0;A<u;++A,L+=4*r)for(var V=0,te=0;V<r;V++,te+=4){var de=V/(r-1),Se=e.clips[A];g(L,te,Se.start*(1-de)+Se.end*de)}else for(var Oe=0,it=0;Oe<r;Oe++,it+=4)g(0,it,Oe/(r-1));return f}var lf=function(e){function t(r){e.call(this,r,Wc),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Gl(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=gs({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(ru),Df={paint:new wo({"hillshade-illumination-direction":new Yn(Ge.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yn(Ge.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yn(Ge.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yn(Ge.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yn(Ge.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yn(Ge.paint_hillshade["hillshade-accent-color"])})},Nf=function(e){function t(r){e.call(this,r,Df)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(ru),Bf=Hi([{name:"a_pos",components:2,type:"Int16"}],4).members,el=cf,_f=cf;function cf(e,t,r){r=r||2;var u,f,g,A,L,V,te,de=t&&t.length,Se=de?t[0]*r:e.length,Oe=lc(e,0,Se,r,!0),it=[];if(!Oe||Oe.next===Oe.prev)return it;if(de&&(Oe=function(xt,Wt,Ht,tr){var dr,br,jr,Ir=[];for(dr=0,br=Wt.length;dr<br;dr++)(jr=lc(xt,Wt[dr]*tr,dr<br-1?Wt[dr+1]*tr:xt.length,tr,!1))===jr.next&&(jr.steiner=!0),Ir.push(fh(jr));for(Ir.sort(Hf),dr=0;dr<Ir.length;dr++)ih(Ir[dr],Ht),Ht=Fu(Ht,Ht.next);return Ht}(e,t,Oe,r)),e.length>80*r){u=g=e[0],f=A=e[1];for(var Ct=r;Ct<Se;Ct+=r)(L=e[Ct])<u&&(u=L),(V=e[Ct+1])<f&&(f=V),L>g&&(g=L),V>A&&(A=V);te=(te=Math.max(g-u,A-f))!==0?1/te:0}return cc(Oe,it,r,u,f,te),it}function lc(e,t,r,u,f){var g,A;if(f===Yc(e,t,r,u)>0)for(g=t;g<r;g+=u)A=Af(g,e[g],e[g+1],A);else for(g=r-u;g>=t;g-=u)A=Af(g,e[g],e[g+1],A);return A&&Hl(A,A.next)&&(Xc(A),A=A.next),A}function Fu(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!Hl(u,u.next)&&no(u.prev,u,u.next)!==0)u=u.next;else{if(Xc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function cc(e,t,r,u,f,g,A){if(e){!A&&g&&function(de,Se,Oe,it){var Ct=de;do Ct.z===null&&(Ct.z=kf(Ct.x,Ct.y,Se,Oe,it)),Ct.prevZ=Ct.prev,Ct.nextZ=Ct.next,Ct=Ct.next;while(Ct!==de);Ct.prevZ.nextZ=null,Ct.prevZ=null,function(xt){var Wt,Ht,tr,dr,br,jr,Ir,hn,cn=1;do{for(Ht=xt,xt=null,br=null,jr=0;Ht;){for(jr++,tr=Ht,Ir=0,Wt=0;Wt<cn&&(Ir++,tr=tr.nextZ);Wt++);for(hn=cn;Ir>0||hn>0&&tr;)Ir!==0&&(hn===0||!tr||Ht.z<=tr.z)?(dr=Ht,Ht=Ht.nextZ,Ir--):(dr=tr,tr=tr.nextZ,hn--),br?br.nextZ=dr:xt=dr,dr.prevZ=br,br=dr;Ht=tr}br.nextZ=null,cn*=2}while(jr>1)}(Ct)}(e,u,f,g);for(var L,V,te=e;e.prev!==e.next;)if(L=e.prev,V=e.next,g?wc(e,u,f,g):Vf(e))t.push(L.i/r),t.push(e.i/r),t.push(V.i/r),Xc(e),e=V.next,te=V.next;else if((e=V)===te){A?A===1?cc(e=Oc(Fu(e),t,r),t,r,u,f,g,2):A===2&&Gf(e,t,r,u,f,g):cc(Fu(e),t,r,u,f,g,1);break}}}function Vf(e){var t=e.prev,r=e,u=e.next;if(no(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(fc(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&no(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function wc(e,t,r,u){var f=e.prev,g=e,A=e.next;if(no(f,g,A)>=0)return!1;for(var L=f.x>g.x?f.x>A.x?f.x:A.x:g.x>A.x?g.x:A.x,V=f.y>g.y?f.y>A.y?f.y:A.y:g.y>A.y?g.y:A.y,te=kf(f.x<g.x?f.x<A.x?f.x:A.x:g.x<A.x?g.x:A.x,f.y<g.y?f.y<A.y?f.y:A.y:g.y<A.y?g.y:A.y,t,r,u),de=kf(L,V,t,r,u),Se=e.prevZ,Oe=e.nextZ;Se&&Se.z>=te&&Oe&&Oe.z<=de;){if(Se!==e.prev&&Se!==e.next&&fc(f.x,f.y,g.x,g.y,A.x,A.y,Se.x,Se.y)&&no(Se.prev,Se,Se.next)>=0)return!1;if(Se=Se.prevZ,Oe!==e.prev&&Oe!==e.next&&fc(f.x,f.y,g.x,g.y,A.x,A.y,Oe.x,Oe.y)&&no(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}for(;Se&&Se.z>=te;){if(Se!==e.prev&&Se!==e.next&&fc(f.x,f.y,g.x,g.y,A.x,A.y,Se.x,Se.y)&&no(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;Oe&&Oe.z<=de;){if(Oe!==e.prev&&Oe!==e.next&&fc(f.x,f.y,g.x,g.y,A.x,A.y,Oe.x,Oe.y)&&no(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function Oc(e,t,r){var u=e;do{var f=u.prev,g=u.next.next;!Hl(f,g)&&hf(f,u,u.next,g)&&Ol(f,g)&&Ol(g,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(g.i/r),Xc(u),Xc(u.next),u=e=g),u=u.next}while(u!==e);return Fu(u)}function Gf(e,t,r,u,f,g){var A=e;do{for(var L=A.next.next;L!==A.prev;){if(A.i!==L.i&&ff(A,L)){var V=Sf(A,L);return A=Fu(A,A.next),V=Fu(V,V.next),cc(A,t,r,u,f,g),void cc(V,t,r,u,f,g)}L=L.next}A=A.next}while(A!==e)}function Hf(e,t){return e.x-t.x}function ih(e,t){if(t=function(u,f){var g,A=f,L=u.x,V=u.y,te=-1/0;do{if(V<=A.y&&V>=A.next.y&&A.next.y!==A.y){var de=A.x+(V-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(de<=L&&de>te){if(te=de,de===L){if(V===A.y)return A;if(V===A.next.y)return A.next}g=A.x<A.next.x?A:A.next}}A=A.next}while(A!==f);if(!g)return null;if(L===te)return g;var Se,Oe=g,it=g.x,Ct=g.y,xt=1/0;A=g;do L>=A.x&&A.x>=it&&L!==A.x&&fc(V<Ct?L:te,V,it,Ct,V<Ct?te:L,V,A.x,A.y)&&(Se=Math.abs(V-A.y)/(L-A.x),Ol(A,u)&&(Se<xt||Se===xt&&(A.x>g.x||A.x===g.x&&Wf(g,A)))&&(g=A,xt=Se)),A=A.next;while(A!==Oe);return g}(e,t)){var r=Sf(t,e);Fu(t,t.next),Fu(r,r.next)}}function Wf(e,t){return no(e.prev,e,t.prev)<0&&no(t.next,e,e.next)<0}function kf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function fh(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function fc(e,t,r,u,f,g,A,L){return(f-A)*(t-L)-(e-A)*(g-L)>=0&&(e-A)*(u-L)-(r-A)*(t-L)>=0&&(r-A)*(g-L)-(f-A)*(u-L)>=0}function ff(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&hf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Ol(e,t)&&Ol(t,e)&&function(r,u){var f=r,g=!1,A=(r.x+u.x)/2,L=(r.y+u.y)/2;do f.y>L!=f.next.y>L&&f.next.y!==f.y&&A<(f.next.x-f.x)*(L-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==r);return g}(e,t)&&(no(e.prev,e,t.prev)||no(e,t.prev,t))||Hl(e,t)&&no(e.prev,e,e.next)>0&&no(t.prev,t,t.next)>0)}function no(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Hl(e,t){return e.x===t.x&&e.y===t.y}function hf(e,t,r,u){var f=nu(no(e,t,r)),g=nu(no(e,t,u)),A=nu(no(r,u,e)),L=nu(no(r,u,t));return f!==g&&A!==L||!(f!==0||!Zc(e,r,t))||!(g!==0||!Zc(e,u,t))||!(A!==0||!Zc(r,e,u))||!(L!==0||!Zc(r,t,u))}function Zc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function nu(e){return e>0?1:e<0?-1:0}function Ol(e,t){return no(e.prev,e,e.next)<0?no(e,t,e.next)>=0&&no(e,e.prev,t)>=0:no(e,t,e.prev)<0||no(e,e.next,t)<0}function Sf(e,t){var r=new df(e.i,e.x,e.y),u=new df(t.i,t.x,t.y),f=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,g.next=u,u.prev=g,u}function Af(e,t,r,u){var f=new df(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Xc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function df(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yc(e,t,r,u){for(var f=0,g=t,A=r-u;g<r;g+=u)f+=(e[A]-e[g])*(e[g+1]+e[A+1]),A=g;return f}function Wl(e,t,r,u,f){!function g(A,L,V,te,de){for(;te>V;){if(te-V>600){var Se=te-V+1,Oe=L-V+1,it=Math.log(Se),Ct=.5*Math.exp(2*it/3),xt=.5*Math.sqrt(it*Ct*(Se-Ct)/Se)*(Oe-Se/2<0?-1:1);g(A,L,Math.max(V,Math.floor(L-Oe*Ct/Se+xt)),Math.min(te,Math.floor(L+(Se-Oe)*Ct/Se+xt)),de)}var Wt=A[L],Ht=V,tr=te;for(ne(A,V,L),de(A[te],Wt)>0&&ne(A,V,te);Ht<tr;){for(ne(A,Ht,tr),Ht++,tr--;de(A[Ht],Wt)<0;)Ht++;for(;de(A[tr],Wt)>0;)tr--}de(A[V],Wt)===0?ne(A,V,tr):ne(A,++tr,te),tr<=L&&(V=tr+1),L<=tr&&(te=tr-1)}}(e,t,r||0,u||e.length-1,f||se)}function ne(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function se(e,t){return e<t?-1:e>t?1:0}function k(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,g=[],A=0;A<r;A++){var L=Gt(e[A]);L!==0&&(e[A].area=Math.abs(L),f===void 0&&(f=L<0),f===L<0?(u&&g.push(u),u=[e[A]]):u.push(e[A]))}if(u&&g.push(u),t>1)for(var V=0;V<g.length;V++)g[V].length<=t||(Wl(g[V],t,1,g[V].length-1,G),g[V]=g[V].slice(0,t));return g}function G(e,t){return t.area-e.area}function Ae(e,t,r){for(var u=r.patternDependencies,f=!1,g=0,A=t;g<A.length;g+=1){var L=A[g].paint.get(e+"-pattern");L.isConstant()||(f=!0);var V=L.constantOr(null);V&&(f=!0,u[V.to]=!0,u[V.from]=!0)}return f}function ot(e,t,r,u,f){for(var g=f.patternDependencies,A=0,L=t;A<L.length;A+=1){var V=L[A],te=V.paint.get(e+"-pattern").value;if(te.kind!=="constant"){var de=te.evaluate({zoom:u-1},r,{},f.availableImages),Se=te.evaluate({zoom:u},r,{},f.availableImages),Oe=te.evaluate({zoom:u+1},r,{},f.availableImages);Se=Se&&Se.name?Se.name:Se,Oe=Oe&&Oe.name?Oe.name:Oe,g[de=de&&de.name?de.name:de]=!0,g[Se]=!0,g[Oe]=!0,r.patterns[V.id]={min:de,mid:Se,max:Oe}}}return r}cf.deviation=function(e,t,r,u){var f=t&&t.length,g=Math.abs(Yc(e,0,f?t[0]*r:e.length,r));if(f)for(var A=0,L=t.length;A<L;A++)g-=Math.abs(Yc(e,t[A]*r,A<L-1?t[A+1]*r:e.length,r));var V=0;for(A=0;A<u.length;A+=3){var te=u[A]*r,de=u[A+1]*r,Se=u[A+2]*r;V+=Math.abs((e[te]-e[Se])*(e[de+1]-e[te+1])-(e[te]-e[de])*(e[Se+1]-e[te+1]))}return g===0&&V===0?0:Math.abs((V-g)/g)},cf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var g=0;g<e[f].length;g++)for(var A=0;A<t;A++)r.vertices.push(e[f][g][A]);f>0&&r.holes.push(u+=e[f-1].length)}return r},el.default=_f;var Xt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new dl,this.indexArray=new Ru,this.indexArray2=new nc,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new Je,this.segments2=new Je,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Xt.prototype.populate=function(e,t,r){this.hasPattern=Ae("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],g=0,A=e;g<A.length;g+=1){var L=A[g],V=L.feature,te=L.id,de=L.index,Se=L.sourceLayerIndex,Oe=this.layers[0]._featureFilter.needGeometry,it=Wi(V,Oe);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),it,r)){var Ct=u?u.evaluate(it,{},r,t.availableImages):void 0,xt={id:te,properties:V.properties,type:V.type,sourceLayerIndex:Se,index:de,geometry:Oe?it.geometry:_i(V),patterns:{},sortKey:Ct};f.push(xt)}}u&&f.sort(function(hn,cn){return hn.sortKey-cn.sortKey});for(var Wt=0,Ht=f;Wt<Ht.length;Wt+=1){var tr=Ht[Wt],dr=tr.geometry,br=tr.index,jr=tr.sourceLayerIndex;if(this.hasPattern){var Ir=ot("fill",this.layers,tr,this.zoom,t);this.patternFeatures.push(Ir)}else this.addFeature(tr,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,jr,this.index)}},Xt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Xt.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},Xt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Xt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Xt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Xt.prototype.addFeature=function(e,t,r,u,f){for(var g=0,A=k(t,500);g<A.length;g+=1){for(var L=A[g],V=0,te=0,de=L;te<de.length;te+=1)V+=de[te].length;for(var Se=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),Oe=Se.vertexLength,it=[],Ct=[],xt=0,Wt=L;xt<Wt.length;xt+=1){var Ht=Wt[xt];if(Ht.length!==0){Ht!==L[0]&&Ct.push(it.length/2);var tr=this.segments2.prepareSegment(Ht.length,this.layoutVertexArray,this.indexArray2),dr=tr.vertexLength;this.layoutVertexArray.emplaceBack(Ht[0].x,Ht[0].y),this.indexArray2.emplaceBack(dr+Ht.length-1,dr),it.push(Ht[0].x),it.push(Ht[0].y);for(var br=1;br<Ht.length;br++)this.layoutVertexArray.emplaceBack(Ht[br].x,Ht[br].y),this.indexArray2.emplaceBack(dr+br-1,dr+br),it.push(Ht[br].x),it.push(Ht[br].y);tr.vertexLength+=Ht.length,tr.primitiveLength+=Ht.length}}for(var jr=el(it,Ct),Ir=0;Ir<jr.length;Ir+=3)this.indexArray.emplaceBack(Oe+jr[Ir],Oe+jr[Ir+1],Oe+jr[Ir+2]);Se.vertexLength+=V,Se.primitiveLength+=jr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Mn("FillBucket",Xt,{omit:["layers","patternFeatures"]});var nr=new wo({"fill-sort-key":new Nn(Ge.layout_fill["fill-sort-key"])}),rr={paint:new wo({"fill-antialias":new Yn(Ge.paint_fill["fill-antialias"]),"fill-opacity":new Nn(Ge.paint_fill["fill-opacity"]),"fill-color":new Nn(Ge.paint_fill["fill-color"]),"fill-outline-color":new Nn(Ge.paint_fill["fill-outline-color"]),"fill-translate":new Yn(Ge.paint_fill["fill-translate"]),"fill-translate-anchor":new Yn(Ge.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ac(Ge.paint_fill["fill-pattern"])}),layout:nr},Rr=function(e){function t(r){e.call(this,r,rr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Xt(r)},t.prototype.queryRadius=function(){return co(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,L,V){return zo(ku(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),L.angle,V),g)},t.prototype.isTileClipped=function(){return!0},t}(ru),on=Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Un=Kn;function Kn(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(oa,this,t)}function oa(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var g=u.readVarint()+u.pos;u.pos<g;){var A=f._keys[u.readVarint()],L=f._values[u.readVarint()];f.properties[A]=L}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function ti(e){for(var t,r,u=0,f=0,g=e.length,A=g-1;f<g;A=f++)u+=((r=e[A]).x-(t=e[f]).x)*(t.y+r.y);return u}Kn.types=["Unknown","Point","LineString","Polygon"],Kn.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,g=0,A=0,L=[];e.pos<r;){if(f<=0){var V=e.readVarint();u=7&V,f=V>>3}if(f--,u===1||u===2)g+=e.readSVarint(),A+=e.readSVarint(),u===1&&(t&&L.push(t),t=[]),t.push(new re(g,A));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&L.push(t),L},Kn.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,g=0,A=1/0,L=-1/0,V=1/0,te=-1/0;e.pos<t;){if(u<=0){var de=e.readVarint();r=7&de,u=de>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<A&&(A=f),f>L&&(L=f),(g+=e.readSVarint())<V&&(V=g),g>te&&(te=g);else if(r!==7)throw new Error("unknown command "+r)}return[A,V,L,te]},Kn.prototype.toGeoJSON=function(e,t,r){var u,f,g=this.extent*Math.pow(2,r),A=this.extent*e,L=this.extent*t,V=this.loadGeometry(),te=Kn.types[this.type];function de(it){for(var Ct=0;Ct<it.length;Ct++){var xt=it[Ct];it[Ct]=[360*(xt.x+A)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(xt.y+L)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var Se=[];for(u=0;u<V.length;u++)Se[u]=V[u][0];de(V=Se);break;case 2:for(u=0;u<V.length;u++)de(V[u]);break;case 3:for(V=function(it){var Ct=it.length;if(Ct<=1)return[it];for(var xt,Wt,Ht=[],tr=0;tr<Ct;tr++){var dr=ti(it[tr]);dr!==0&&(Wt===void 0&&(Wt=dr<0),Wt===dr<0?(xt&&Ht.push(xt),xt=[it[tr]]):xt.push(it[tr]))}return xt&&Ht.push(xt),Ht}(V),u=0;u<V.length;u++)for(f=0;f<V[u].length;f++)de(V[u][f])}V.length===1?V=V[0]:te="Multi"+te;var Oe={type:"Feature",geometry:{type:te,coordinates:V},properties:this.properties};return"id"in this&&(Oe.id=this.id),Oe};var za=Oi;function Oi(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ni,this,t),this.length=this._features.length}function ni(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,g=u.readVarint()+u.pos;u.pos<g;){var A=u.readVarint()>>3;f=A===1?u.readString():A===2?u.readFloat():A===3?u.readDouble():A===4?u.readVarint64():A===5?u.readVarint():A===6?u.readSVarint():A===7?u.readBoolean():null}return f}(r))}function Fi(e,t,r){if(e===3){var u=new za(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}Oi.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Un(this._pbf,t,this.extent,this._keys,this._values)};var Ro={VectorTile:function(t,r){this.layers=t.readFields(Fi,{},r)},VectorTileFeature:Un,VectorTileLayer:za},bo=Ro.VectorTileFeature.types,Zi=Math.pow(2,13);function Uo(e,t,r,u,f,g,A,L){e.emplaceBack(t,r,2*Math.floor(u*Zi)+A,f*Zi*2,g*Zi*2,Math.round(L))}var ri=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Lu,this.indexArray=new Ru,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new Je,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function fo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}ri.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ae("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var g=f[u],A=g.feature,L=g.id,V=g.index,te=g.sourceLayerIndex,de=this.layers[0]._featureFilter.needGeometry,Se=Wi(A,de);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Se,r)){var Oe={id:L,sourceLayerIndex:te,index:V,geometry:de?Se.geometry:_i(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(ot("fill-extrusion",this.layers,Oe,this.zoom,t)):this.addFeature(Oe,Oe.geometry,V,r,{}),t.featureIndex.insert(A,Oe.geometry,V,te,this.index,!0)}}},ri.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},ri.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ri.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ri.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ri.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,on),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ri.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ri.prototype.addFeature=function(e,t,r,u,f){for(var g=0,A=k(t,500);g<A.length;g+=1){for(var L=A[g],V=0,te=0,de=L;te<de.length;te+=1)V+=de[te].length;for(var Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Oe=0,it=L;Oe<it.length;Oe+=1){var Ct=it[Oe];if(Ct.length!==0&&!(($a=Ct).every(function(Ra){return Ra.x<0})||$a.every(function(Ra){return Ra.x>8192})||$a.every(function(Ra){return Ra.y<0})||$a.every(function(Ra){return Ra.y>8192})))for(var xt=0,Wt=0;Wt<Ct.length;Wt++){var Ht=Ct[Wt];if(Wt>=1){var tr=Ct[Wt-1];if(!fo(Ht,tr)){Se.vertexLength+4>Je.MAX_VERTEX_ARRAY_LENGTH&&(Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var dr=Ht.sub(tr)._perp()._unit(),br=tr.dist(Ht);xt+br>32768&&(xt=0),Uo(this.layoutVertexArray,Ht.x,Ht.y,dr.x,dr.y,0,0,xt),Uo(this.layoutVertexArray,Ht.x,Ht.y,dr.x,dr.y,0,1,xt),Uo(this.layoutVertexArray,tr.x,tr.y,dr.x,dr.y,0,0,xt+=br),Uo(this.layoutVertexArray,tr.x,tr.y,dr.x,dr.y,0,1,xt);var jr=Se.vertexLength;this.indexArray.emplaceBack(jr,jr+2,jr+1),this.indexArray.emplaceBack(jr+1,jr+2,jr+3),Se.vertexLength+=4,Se.primitiveLength+=2}}}}if(Se.vertexLength+V>Je.MAX_VERTEX_ARRAY_LENGTH&&(Se=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),bo[e.type]==="Polygon"){for(var Ir=[],hn=[],cn=Se.vertexLength,Ln=0,$n=L;Ln<$n.length;Ln+=1){var Xn=$n[Ln];if(Xn.length!==0){Xn!==L[0]&&hn.push(Ir.length/2);for(var Dn=0;Dn<Xn.length;Dn++){var Ta=Xn[Dn];Uo(this.layoutVertexArray,Ta.x,Ta.y,0,0,1,1,0),Ir.push(Ta.x),Ir.push(Ta.y)}}}for(var sa=el(Ir,hn),qn=0;qn<sa.length;qn+=3)this.indexArray.emplaceBack(cn+sa[qn],cn+sa[qn+2],cn+sa[qn+1]);Se.primitiveLength+=sa.length/3,Se.vertexLength+=V}}var $a;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Mn("FillExtrusionBucket",ri,{omit:["layers","features"]});var au={paint:new wo({"fill-extrusion-opacity":new Yn(Ge["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nn(Ge["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yn(Ge["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yn(Ge["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ac(Ge["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nn(Ge["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nn(Ge["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Yn(Ge["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Si=function(e){function t(r){e.call(this,r,au)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ri(r)},t.prototype.queryRadius=function(){return co(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,L,V,te){var de=ku(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),L.angle,V),Se=this.paint.get("fill-extrusion-height").evaluate(u,f),Oe=this.paint.get("fill-extrusion-base").evaluate(u,f),it=function(xt,Wt,Ht,tr){for(var dr=[],br=0,jr=xt;br<jr.length;br+=1){var Ir=jr[br],hn=[Ir.x,Ir.y,0,1];Gs(hn,hn,Wt),dr.push(new re(hn[0]/hn[3],hn[1]/hn[3]))}return dr}(de,te),Ct=function(xt,Wt,Ht,tr){for(var dr=[],br=[],jr=tr[8]*Wt,Ir=tr[9]*Wt,hn=tr[10]*Wt,cn=tr[11]*Wt,Ln=tr[8]*Ht,$n=tr[9]*Ht,Xn=tr[10]*Ht,Dn=tr[11]*Ht,Ta=0,sa=xt;Ta<sa.length;Ta+=1){for(var qn=[],$a=[],Ra=0,Bi=sa[Ta];Ra<Bi.length;Ra+=1){var va=Bi[Ra],oi=va.x,Wo=va.y,Ei=tr[0]*oi+tr[4]*Wo+tr[12],Zo=tr[1]*oi+tr[5]*Wo+tr[13],Xo=tr[2]*oi+tr[6]*Wo+tr[14],ls=tr[3]*oi+tr[7]*Wo+tr[15],Su=Xo+hn,cs=ls+cn,tl=Ei+Ln,su=Zo+$n,rl=Xo+Xn,uu=ls+Dn,Zs=new re((Ei+jr)/cs,(Zo+Ir)/cs);Zs.z=Su/cs,qn.push(Zs);var lu=new re(tl/uu,su/uu);lu.z=rl/uu,$a.push(lu)}dr.push(qn),br.push($a)}return[dr,br]}(g,Oe,Se,te);return function(xt,Wt,Ht){var tr=1/0;zo(Ht,Wt)&&(tr=Ea(Ht,Wt[0]));for(var dr=0;dr<Wt.length;dr++)for(var br=Wt[dr],jr=xt[dr],Ir=0;Ir<br.length-1;Ir++){var hn=br[Ir],cn=[hn,br[Ir+1],jr[Ir+1],jr[Ir],hn];bu(Ht,cn)&&(tr=Math.min(tr,Ea(Ht,cn)))}return tr!==1/0&&tr}(Ct[0],Ct[1],it)},t}(ru);function Ui(e,t){return e.x*t.x+e.y*t.y}function Ea(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var g=t[u],A=e[0],L=r.sub(f),V=g.sub(f),te=A.sub(f),de=Ui(L,L),Se=Ui(L,V),Oe=Ui(V,V),it=Ui(te,L),Ct=Ui(te,V),xt=de*Oe-Se*Se,Wt=(Oe*it-Se*Ct)/xt,Ht=(de*Ct-Se*it)/xt,tr=f.z*(1-Wt-Ht)+r.z*Wt+g.z*Ht;if(isFinite(tr))return tr}return 1/0}for(var dr=1/0,br=0,jr=t;br<jr.length;br+=1)dr=Math.min(dr,jr[br].z);return dr}var Io=Hi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hc=Hi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Zf=Ro.VectorTileFeature.types,hh=Math.cos(Math.PI/180*37.5),Xf=Math.pow(2,14)/.5,Uu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Is,this.layoutVertexArray2=new Ul,this.indexArray=new Ru,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new Je,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Uu.prototype.populate=function(e,t,r){this.hasPattern=Ae("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],g=0,A=e;g<A.length;g+=1){var L=A[g],V=L.feature,te=L.id,de=L.index,Se=L.sourceLayerIndex,Oe=this.layers[0]._featureFilter.needGeometry,it=Wi(V,Oe);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),it,r)){var Ct=u?u.evaluate(it,{},r):void 0,xt={id:te,properties:V.properties,type:V.type,sourceLayerIndex:Se,index:de,geometry:Oe?it.geometry:_i(V),patterns:{},sortKey:Ct};f.push(xt)}}u&&f.sort(function(hn,cn){return hn.sortKey-cn.sortKey});for(var Wt=0,Ht=f;Wt<Ht.length;Wt+=1){var tr=Ht[Wt],dr=tr.geometry,br=tr.index,jr=tr.sourceLayerIndex;if(this.hasPattern){var Ir=ot("line",this.layers,tr,this.zoom,t);this.patternFeatures.push(Ir)}else this.addFeature(tr,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,jr,this.index)}},Uu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Uu.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},Uu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Uu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Uu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,hc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Io),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Uu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Uu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Uu.prototype.addFeature=function(e,t,r,u,f){var g=this.layers[0].layout,A=g.get("line-join").evaluate(e,{}),L=g.get("line-cap"),V=g.get("line-miter-limit"),te=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var de=0,Se=t;de<Se.length;de+=1)this.addLine(Se[de],e,A,L,V,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Uu.prototype.addLine=function(e,t,r,u,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var L=Zf[t.type]==="Polygon",V=e.length;V>=2&&e[V-1].equals(e[V-2]);)V--;for(var te=0;te<V-1&&e[te].equals(e[te+1]);)te++;if(!(V<(L?3:2))){r==="bevel"&&(f=1.05);var de,Se=this.overscaling<=16?122880/(512*this.overscaling):0,Oe=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray),it=void 0,Ct=void 0,xt=void 0,Wt=void 0;this.e1=this.e2=-1,L&&(Wt=e[te].sub(de=e[V-2])._unit()._perp());for(var Ht=te;Ht<V;Ht++)if(!(Ct=Ht===V-1?L?e[te+1]:void 0:e[Ht+1])||!e[Ht].equals(Ct)){Wt&&(xt=Wt),de&&(it=de),de=e[Ht],Wt=Ct?Ct.sub(de)._unit()._perp():xt;var tr=(xt=xt||Wt).add(Wt);tr.x===0&&tr.y===0||tr._unit();var dr=xt.x*Wt.x+xt.y*Wt.y,br=tr.x*Wt.x+tr.y*Wt.y,jr=br!==0?1/br:1/0,Ir=2*Math.sqrt(2-2*br),hn=br<hh&&it&&Ct,cn=xt.x*Wt.y-xt.y*Wt.x>0;if(hn&&Ht>te){var Ln=de.dist(it);if(Ln>2*Se){var $n=de.sub(de.sub(it)._mult(Se/Ln)._round());this.updateDistance(it,$n),this.addCurrentVertex($n,xt,0,0,Oe),it=$n}}var Xn=it&&Ct,Dn=Xn?r:L?"butt":u;if(Xn&&Dn==="round"&&(jr<g?Dn="miter":jr<=2&&(Dn="fakeround")),Dn==="miter"&&jr>f&&(Dn="bevel"),Dn==="bevel"&&(jr>2&&(Dn="flipbevel"),jr<f&&(Dn="miter")),it&&this.updateDistance(it,de),Dn==="miter")tr._mult(jr),this.addCurrentVertex(de,tr,0,0,Oe);else if(Dn==="flipbevel"){if(jr>100)tr=Wt.mult(-1);else{var Ta=jr*xt.add(Wt).mag()/xt.sub(Wt).mag();tr._perp()._mult(Ta*(cn?-1:1))}this.addCurrentVertex(de,tr,0,0,Oe),this.addCurrentVertex(de,tr.mult(-1),0,0,Oe)}else if(Dn==="bevel"||Dn==="fakeround"){var sa=-Math.sqrt(jr*jr-1),qn=cn?sa:0,$a=cn?0:sa;if(it&&this.addCurrentVertex(de,xt,qn,$a,Oe),Dn==="fakeround")for(var Ra=Math.round(180*Ir/Math.PI/20),Bi=1;Bi<Ra;Bi++){var va=Bi/Ra;if(va!==.5){var oi=va-.5;va+=va*oi*(va-1)*((1.0904+dr*(dr*(3.55645-1.43519*dr)-3.2452))*oi*oi+(.848013+dr*(.215638*dr-1.06021)))}var Wo=Wt.sub(xt)._mult(va)._add(xt)._unit()._mult(cn?-1:1);this.addHalfVertex(de,Wo.x,Wo.y,!1,cn,0,Oe)}Ct&&this.addCurrentVertex(de,Wt,-qn,-$a,Oe)}else if(Dn==="butt")this.addCurrentVertex(de,tr,0,0,Oe);else if(Dn==="square"){var Ei=it?1:-1;this.addCurrentVertex(de,tr,Ei,Ei,Oe)}else Dn==="round"&&(it&&(this.addCurrentVertex(de,xt,0,0,Oe),this.addCurrentVertex(de,xt,1,1,Oe,!0)),Ct&&(this.addCurrentVertex(de,Wt,-1,-1,Oe,!0),this.addCurrentVertex(de,Wt,0,0,Oe)));if(hn&&Ht<V-1){var Zo=de.dist(Ct);if(Zo>2*Se){var Xo=de.add(Ct.sub(de)._mult(Se/Zo)._round());this.updateDistance(de,Xo),this.addCurrentVertex(Xo,Wt,0,0,Oe),de=Xo}}}}},Uu.prototype.addCurrentVertex=function(e,t,r,u,f,g){g===void 0&&(g=!1);var A=t.y*u-t.x,L=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,f),this.addHalfVertex(e,A,L,g,!0,-u,f),this.distance>Xf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,g))},Uu.prototype.addHalfVertex=function(e,t,r,u,f,g,A){var L=.5*(this.lineClips?this.scaledDistance*(Xf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(g===0?0:g<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var V=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),A.primitiveLength++),f?this.e2=V:this.e1=V},Uu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Uu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Mn("LineBucket",Uu,{omit:["layers","patternFeatures"]});var Yf=new wo({"line-cap":new Yn(Ge.layout_line["line-cap"]),"line-join":new Nn(Ge.layout_line["line-join"]),"line-miter-limit":new Yn(Ge.layout_line["line-miter-limit"]),"line-round-limit":new Yn(Ge.layout_line["line-round-limit"]),"line-sort-key":new Nn(Ge.layout_line["line-sort-key"])}),pf={paint:new wo({"line-opacity":new Nn(Ge.paint_line["line-opacity"]),"line-color":new Nn(Ge.paint_line["line-color"]),"line-translate":new Yn(Ge.paint_line["line-translate"]),"line-translate-anchor":new Yn(Ge.paint_line["line-translate-anchor"]),"line-width":new Nn(Ge.paint_line["line-width"]),"line-gap-width":new Nn(Ge.paint_line["line-gap-width"]),"line-offset":new Nn(Ge.paint_line["line-offset"]),"line-blur":new Nn(Ge.paint_line["line-blur"]),"line-dasharray":new ms(Ge.paint_line["line-dasharray"]),"line-pattern":new Ac(Ge.paint_line["line-pattern"]),"line-gradient":new jo(Ge.paint_line["line-gradient"])}),layout:Yf},Kf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Pa(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,g){return u=ke({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,g)},t}(Nn))(pf.paint.properties["line-width"].specification);Kf.useIntegerZoom=!0;var Sh=function(e){function t(r){e.call(this,r,pf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof yi,this.gradientVersion=(this.gradientVersion+1)%Fe)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=Kf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Uu(r)},t.prototype.queryRadius=function(r){var u=r,f=dh(Cs("line-width",this,u),Cs("line-gap-width",this,u)),g=Cs("line-offset",this,u);return f/2+Math.abs(g)+co(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,L,V){var te=ku(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),L.angle,V),de=V/2*dh(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),Se=this.paint.get("line-offset").evaluate(u,f);return Se&&(g=function(Oe,it){for(var Ct=[],xt=new re(0,0),Wt=0;Wt<Oe.length;Wt++){for(var Ht=Oe[Wt],tr=[],dr=0;dr<Ht.length;dr++){var br=Ht[dr],jr=Ht[dr+1],Ir=dr===0?xt:br.sub(Ht[dr-1])._unit()._perp(),hn=dr===Ht.length-1?xt:jr.sub(br)._unit()._perp(),cn=Ir._add(hn)._unit();cn._mult(1/(cn.x*hn.x+cn.y*hn.y)),tr.push(cn._mult(it)._add(br))}Ct.push(tr)}return Ct}(g,Se*V)),function(Oe,it,Ct){for(var xt=0;xt<it.length;xt++){var Wt=it[xt];if(Oe.length>=3){for(var Ht=0;Ht<Wt.length;Ht++)if(Nu(Oe,Wt[Ht]))return!0}if(As(Oe,Wt,Ct))return!0}return!1}(te,g,de)},t.prototype.isTileClipped=function(){return!0},t}(ru);function dh(e,t){return t>0?t+2*e:e}var Cf=Hi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),oh=Hi([{name:"a_projected_pos",components:3,type:"Float32"}],4),$f=(Hi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Hi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ph=(Hi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),jh=Hi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function wf(e,t,r){return e.sections.forEach(function(u){u.text=function(f,g,A){var L=g.layout.get("text-transform").evaluate(A,{});return L==="uppercase"?f=f.toLocaleUpperCase():L==="lowercase"&&(f=f.toLocaleLowerCase()),as.applyArabicShaping&&(f=as.applyArabicShaping(f)),f}(u.text,t,r)}),e}Hi([{name:"triangle",components:3,type:"Uint16"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Hi([{type:"Float32",name:"offsetX"}]),Hi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var jf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ah=function(t,r,u,f,g){var A,L,V=8*g-f-1,te=(1<<V)-1,de=te>>1,Se=-7,Oe=u?g-1:0,it=u?-1:1,Ct=t[r+Oe];for(Oe+=it,A=Ct&(1<<-Se)-1,Ct>>=-Se,Se+=V;Se>0;A=256*A+t[r+Oe],Oe+=it,Se-=8);for(L=A&(1<<-Se)-1,A>>=-Se,Se+=f;Se>0;L=256*L+t[r+Oe],Oe+=it,Se-=8);if(A===0)A=1-de;else{if(A===te)return L?NaN:1/0*(Ct?-1:1);L+=Math.pow(2,f),A-=de}return(Ct?-1:1)*L*Math.pow(2,A-f)},xe=function(t,r,u,f,g,A){var L,V,te,de=8*A-g-1,Se=(1<<de)-1,Oe=Se>>1,it=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ct=f?0:A-1,xt=f?1:-1,Wt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(V=isNaN(r)?1:0,L=Se):(L=Math.floor(Math.log(r)/Math.LN2),r*(te=Math.pow(2,-L))<1&&(L--,te*=2),(r+=L+Oe>=1?it/te:it*Math.pow(2,1-Oe))*te>=2&&(L++,te/=2),L+Oe>=Se?(V=0,L=Se):L+Oe>=1?(V=(r*te-1)*Math.pow(2,g),L+=Oe):(V=r*Math.pow(2,Oe-1)*Math.pow(2,g),L=0));g>=8;t[u+Ct]=255&V,Ct+=xt,V/=256,g-=8);for(L=L<<g|V,de+=g;de>0;t[u+Ct]=255&L,Ct+=xt,L/=256,de-=8);t[u+Ct-xt]|=128*Wt},je=bt;function bt(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}bt.Varint=0,bt.Fixed64=1,bt.Bytes=2,bt.Fixed32=5;var vr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Mr(e){return e.type===bt.Bytes?e.readVarint()+e.pos:e.pos+1}function Cr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function gr(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function sn(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function en(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function $r(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function ln(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function An(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function pn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Jr(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function yr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function hr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Zr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function On(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Lr(e,t,r){e===1&&r.readMessage(Qn,t)}function Qn(e,t,r){if(e===3){var u=r.readMessage(Qr,{}),f=u.width,g=u.height,A=u.left,L=u.top,V=u.advance;t.push({id:u.id,bitmap:new Hs({width:f+6,height:g+6},u.bitmap),metrics:{width:f,height:g,left:A,top:L,advance:V}})}}function Qr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function zr(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var g=f[u];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(xt,Wt){return Wt.h-xt.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],L=0,V=0,te=0,de=e;te<de.length;te+=1)for(var Se=de[te],Oe=A.length-1;Oe>=0;Oe--){var it=A[Oe];if(!(Se.w>it.w||Se.h>it.h)){if(Se.x=it.x,Se.y=it.y,V=Math.max(V,Se.y+Se.h),L=Math.max(L,Se.x+Se.w),Se.w===it.w&&Se.h===it.h){var Ct=A.pop();Oe<A.length&&(A[Oe]=Ct)}else Se.h===it.h?(it.x+=Se.w,it.w-=Se.w):Se.w===it.w?(it.y+=Se.h,it.h-=Se.h):(A.push({x:it.x+Se.w,y:it.y,w:it.w-Se.w,h:Se.h}),it.y+=Se.h,it.h-=Se.h);break}}return{w:L,h:V,fill:t/(L*V)||0}}bt.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,A=this.pos;this.type=7&f,t(g,r,this),this.pos===A&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=hr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=On(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=hr(this.buf,this.pos)+4294967296*hr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=hr(this.buf,this.pos)+4294967296*On(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ah(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ah(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(g,A,L){var V,te,de=L.buf;if(V=(112&(te=de[L.pos++]))>>4,te<128)return Cr(g,V,A);if(V|=(127&(te=de[L.pos++]))<<3,te<128)return Cr(g,V,A);if(V|=(127&(te=de[L.pos++]))<<10,te<128)return Cr(g,V,A);if(V|=(127&(te=de[L.pos++]))<<17,te<128)return Cr(g,V,A);if(V|=(127&(te=de[L.pos++]))<<24,te<128)return Cr(g,V,A);if(V|=(1&(te=de[L.pos++]))<<31,te<128)return Cr(g,V,A);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&vr?function(u,f,g){return vr.decode(u.subarray(f,g))}(this.buf,r,t):function(u,f,g){for(var A="",L=f;L<g;){var V,te,de,Se=u[L],Oe=null,it=Se>239?4:Se>223?3:Se>191?2:1;if(L+it>g)break;it===1?Se<128&&(Oe=Se):it===2?(192&(V=u[L+1]))==128&&(Oe=(31&Se)<<6|63&V)<=127&&(Oe=null):it===3?(te=u[L+2],(192&(V=u[L+1]))==128&&(192&te)==128&&((Oe=(15&Se)<<12|(63&V)<<6|63&te)<=2047||Oe>=55296&&Oe<=57343)&&(Oe=null)):it===4&&(te=u[L+2],de=u[L+3],(192&(V=u[L+1]))==128&&(192&te)==128&&(192&de)==128&&((Oe=(15&Se)<<18|(63&V)<<12|(63&te)<<6|63&de)<=65535||Oe>=1114112)&&(Oe=null)),Oe===null?(Oe=65533,it=1):Oe>65535&&(Oe-=65536,A+=String.fromCharCode(Oe>>>10&1023|55296),Oe=56320|1023&Oe),A+=String.fromCharCode(Oe),L+=it}return A}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==bt.Bytes)return t.push(this.readVarint(r));var u=Mr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==bt.Bytes)return t.push(this.readSVarint());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==bt.Bytes)return t.push(this.readBoolean());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==bt.Bytes)return t.push(this.readFloat());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==bt.Bytes)return t.push(this.readDouble());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==bt.Bytes)return t.push(this.readFixed32());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==bt.Bytes)return t.push(this.readSFixed32());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==bt.Bytes)return t.push(this.readFixed64());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==bt.Bytes)return t.push(this.readSFixed64());var r=Mr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===bt.Varint)for(;this.buf[this.pos++]>127;);else if(r===bt.Bytes)this.pos=this.readVarint()+this.pos;else if(r===bt.Fixed32)this.pos+=4;else{if(r!==bt.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Zr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Zr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Zr(this.buf,-1&t,this.pos),Zr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Zr(this.buf,-1&t,this.pos),Zr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,g;if(r>=0?(f=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(A,L,V){V.buf[V.pos++]=127&A|128,A>>>=7,V.buf[V.pos++]=127&A|128,A>>>=7,V.buf[V.pos++]=127&A|128,A>>>=7,V.buf[V.pos++]=127&A|128,V.buf[V.pos]=127&(A>>>=7)}(f,0,u),function(A,L){var V=(7&A)<<4;L.buf[L.pos++]|=V|((A>>>=3)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A)))))}(g,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,g,A){for(var L,V,te=0;te<g.length;te++){if((L=g.charCodeAt(te))>55295&&L<57344){if(!V){L>56319||te+1===g.length?(f[A++]=239,f[A++]=191,f[A++]=189):V=L;continue}if(L<56320){f[A++]=239,f[A++]=191,f[A++]=189,V=L;continue}L=V-55296<<10|L-56320|65536,V=null}else V&&(f[A++]=239,f[A++]=191,f[A++]=189,V=null);L<128?f[A++]=L:(L<2048?f[A++]=L>>6|192:(L<65536?f[A++]=L>>12|224:(f[A++]=L>>18|240,f[A++]=L>>12&63|128),f[A++]=L>>6&63|128),f[A++]=63&L|128)}return A}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&gr(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),xe(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xe(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&gr(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,bt.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,sn,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,ln,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,en,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,$r,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,An,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,pn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,Jr,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,yr,r)},writeBytesField:function(t,r){this.writeTag(t,bt.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,bt.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,bt.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,bt.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,bt.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,bt.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,bt.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,bt.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,bt.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,bt.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Br=function(t,r){var u=r.pixelRatio,f=r.version,g=r.stretchX,A=r.stretchY,L=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=g,this.stretchY=A,this.content=L,this.version=f},Yr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Yr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Yr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Yr.tlbr.get=function(){return this.tl.concat(this.br)},Yr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Br.prototype,Yr);var Zn=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var g=[];this.addImages(t,u,g),this.addImages(r,f,g);var A=zr(g),L=new Lo({width:A.w||1,height:A.h||1});for(var V in t){var te=t[V],de=u[V].paddedRect;Lo.copy(te.data,L,{x:0,y:0},{x:de.x+1,y:de.y+1},te.data)}for(var Se in r){var Oe=r[Se],it=f[Se].paddedRect,Ct=it.x+1,xt=it.y+1,Wt=Oe.data.width,Ht=Oe.data.height;Lo.copy(Oe.data,L,{x:0,y:0},{x:Ct,y:xt},Oe.data),Lo.copy(Oe.data,L,{x:0,y:Ht-1},{x:Ct,y:xt-1},{width:Wt,height:1}),Lo.copy(Oe.data,L,{x:0,y:0},{x:Ct,y:xt+Ht},{width:Wt,height:1}),Lo.copy(Oe.data,L,{x:Wt-1,y:0},{x:Ct-1,y:xt},{width:1,height:Ht}),Lo.copy(Oe.data,L,{x:0,y:0},{x:Ct+Wt,y:xt},{width:1,height:Ht})}this.image=L,this.iconPositions=u,this.patternPositions=f};Zn.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],g={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(g),t[u]=new Br(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Zn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Zn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},Mn("ImagePosition",Br),Mn("ImageAtlas",Zn);var ra={horizontal:1,vertical:2,horizontalOnly:3},an=function(){this.scale=1,this.fontStack="",this.imageName=null};an.forText=function(e,t){var r=new an;return r.scale=e||1,r.fontStack=t,r},an.forImage=function(e){var t=new an;return t.imageName=e,t};var Hr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function kr(e,t,r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt){var Wt,Ht=Hr.fromFeature(e,f);Se===ra.vertical&&Ht.verticalizePunctuation();var tr=as.processBidirectionalText,dr=as.processStyledBidirectionalText;if(tr&&Ht.sections.length===1){Wt=[];for(var br=0,jr=tr(Ht.toString(),fi(Ht,te,g,t,u,it,Ct));br<jr.length;br+=1){var Ir=jr[br],hn=new Hr;hn.text=Ir,hn.sections=Ht.sections;for(var cn=0;cn<Ir.length;cn++)hn.sectionIndex.push(0);Wt.push(hn)}}else if(dr){Wt=[];for(var Ln=0,$n=dr(Ht.text,Ht.sectionIndex,fi(Ht,te,g,t,u,it,Ct));Ln<$n.length;Ln+=1){var Xn=$n[Ln],Dn=new Hr;Dn.text=Xn[0],Dn.sectionIndex=Xn[1],Dn.sections=Ht.sections,Wt.push(Dn)}}else Wt=function(qn,$a){for(var Ra=[],Bi=qn.text,va=0,oi=0,Wo=$a;oi<Wo.length;oi+=1){var Ei=Wo[oi];Ra.push(qn.substring(va,Ei)),va=Ei}return va<Bi.length&&Ra.push(qn.substring(va,Bi.length)),Ra}(Ht,fi(Ht,te,g,t,u,it,Ct));var Ta=[],sa={positionedLines:Ta,text:Ht.toString(),top:de[1],bottom:de[1],left:de[0],right:de[0],writingMode:Se,iconsInText:!1,verticalizable:!1};return function(qn,$a,Ra,Bi,va,oi,Wo,Ei,Zo,Xo,ls,Su){for(var cs=0,tl=-17,su=0,rl=0,uu=Ei==="right"?1:Ei==="left"?0:.5,Zs=0,lu=0,vi=va;lu<vi.length;lu+=1){var si=vi[lu];si.trim();var Qi=si.getMaxScale(),ho=24*(Qi-1),Au={positionedGlyphs:[],lineOffset:0};qn.positionedLines[Zs]=Au;var Eo=Au.positionedGlyphs,Yo=0;if(si.length()){for(var Bu=0;Bu<si.length();Bu++){var hi=si.getSection(Bu),eh=si.getSectionIndex(Bu),Jc=si.getCharCode(Bu),vf=0,mc=null,Vu=null,zf=null,Ff=24,th=!(Zo===ra.horizontal||!ls&&!_c(Jc)||ls&&(pa[Jc]||(vh=Jc,qr.Arabic(vh)||qr["Arabic Supplement"](vh)||qr["Arabic Extended-A"](vh)||qr["Arabic Presentation Forms-A"](vh)||qr["Arabic Presentation Forms-B"](vh))));if(hi.imageName){var wh=Bi[hi.imageName];if(!wh)continue;zf=hi.imageName,qn.iconsInText=qn.iconsInText||!0,Vu=wh.paddedRect;var Mf=wh.displaySize;hi.scale=24*hi.scale/Su,vf=ho+(24-Mf[1]*hi.scale),Ff=(mc={width:Mf[0],height:Mf[1],left:1,top:-3,advance:th?Mf[1]:Mf[0]}).advance;var Oh=th?Mf[0]*hi.scale-24*Qi:Mf[1]*hi.scale-24*Qi;Oh>0&&Oh>Yo&&(Yo=Oh)}else{var rh=Ra[hi.fontStack],mh=rh&&rh[Jc];if(mh&&mh.rect)Vu=mh.rect,mc=mh.metrics;else{var Zh=$a[hi.fontStack],Fh=Zh&&Zh[Jc];if(!Fh)continue;mc=Fh.metrics}vf=24*(Qi-hi.scale)}th?(qn.verticalizable=!0,Eo.push({glyph:Jc,imageName:zf,x:cs,y:tl+vf,vertical:th,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:eh,metrics:mc,rect:Vu}),cs+=Ff*hi.scale+Xo):(Eo.push({glyph:Jc,imageName:zf,x:cs,y:tl+vf,vertical:th,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:eh,metrics:mc,rect:Vu}),cs+=mc.advance*hi.scale+Xo)}Eo.length!==0&&(su=Math.max(cs-Xo,su),ys(Eo,0,Eo.length-1,uu,Yo)),cs=0;var Xh=oi*Qi+Yo;Au.lineOffset=Math.max(Yo,ho),tl+=Xh,rl=Math.max(Xh,rl),++Zs}else tl+=oi,++Zs}var vh,Mh=tl- -17,Yh=Bo(Wo),gh=Yh.horizontalAlign,nh=Yh.verticalAlign;(function(uh,Kh,Uh,yh,Bh,Ph,bh,Vh,Gh){var Lh,Rh=(Kh-Uh)*Bh;Lh=Ph!==bh?-Vh*yh- -17:(-yh*Gh+.5)*bh;for(var xh=0,Ih=uh;xh<Ih.length;xh+=1)for(var Eh=0,Uf=Ih[xh].positionedGlyphs;Eh<Uf.length;Eh+=1){var Dh=Uf[Eh];Dh.x+=Rh,Dh.y+=Lh}})(qn.positionedLines,uu,gh,nh,su,rl,oi,Mh,va.length),qn.top+=-nh*Mh,qn.bottom=qn.top+Mh,qn.left+=-gh*su,qn.right=qn.left+su}(sa,t,r,u,Wt,A,L,V,Se,te,Oe,xt),!function(qn){for(var $a=0,Ra=qn;$a<Ra.length;$a+=1)if(Ra[$a].positionedGlyphs.length!==0)return!1;return!0}(Ta)&&sa}Hr.fromFeature=function(e,t){for(var r=new Hr,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Hr.prototype.length=function(){return this.text.length},Hr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Hr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Hr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Hr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&cl(u)&&!jf[e[r+1]]||f&&cl(f)&&!jf[e[r-1]]||!jf[e[r]]?e[r]:jf[e[r]]}return t}(this.text)},Hr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&pa[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&pa[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Hr.prototype.substring=function(e,t){var r=new Hr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Hr.prototype.toString=function(){return this.text},Hr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Hr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(an.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Hr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(an.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}else Le("Can't add FormattedSection with an empty image.")},Hr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var pa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ca={};function jn(e,t,r,u,f,g){if(t.imageName){var A=u[t.imageName];return A?A.displaySize[0]*t.scale*24/g+f:0}var L=r[t.fontStack],V=L&&L[e];return V?V.metrics.advance*t.scale+f:0}function Fa(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function Sa(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Ua(e,t,r,u,f,g){for(var A=null,L=Fa(t,r,f,g),V=0,te=u;V<te.length;V+=1){var de=te[V],Se=Fa(t-de.x,r,f,g)+de.badness;Se<=L&&(A=de,L=Se)}return{index:e,x:t,priorBreak:A,badness:L}}function fi(e,t,r,u,f,g,A){if(g!=="point")return[];if(!e)return[];for(var L,V=[],te=function(Wt,Ht,tr,dr,br,jr){for(var Ir=0,hn=0;hn<Wt.length();hn++){var cn=Wt.getSection(hn);Ir+=jn(Wt.getCharCode(hn),cn,dr,br,Ht,jr)}return Ir/Math.max(1,Math.ceil(Ir/tr))}(e,t,r,u,f,A),de=e.text.indexOf("\u200B")>=0,Se=0,Oe=0;Oe<e.length();Oe++){var it=e.getSection(Oe),Ct=e.getCharCode(Oe);if(pa[Ct]||(Se+=jn(Ct,it,u,f,t,A)),Oe<e.length()-1){var xt=!((L=Ct)<11904||!(qr["Bopomofo Extended"](L)||qr.Bopomofo(L)||qr["CJK Compatibility Forms"](L)||qr["CJK Compatibility Ideographs"](L)||qr["CJK Compatibility"](L)||qr["CJK Radicals Supplement"](L)||qr["CJK Strokes"](L)||qr["CJK Symbols and Punctuation"](L)||qr["CJK Unified Ideographs Extension A"](L)||qr["CJK Unified Ideographs"](L)||qr["Enclosed CJK Letters and Months"](L)||qr["Halfwidth and Fullwidth Forms"](L)||qr.Hiragana(L)||qr["Ideographic Description Characters"](L)||qr["Kangxi Radicals"](L)||qr["Katakana Phonetic Extensions"](L)||qr.Katakana(L)||qr["Vertical Forms"](L)||qr["Yi Radicals"](L)||qr["Yi Syllables"](L)));(ca[Ct]||xt||it.imageName)&&V.push(Ua(Oe+1,Se,te,V,Sa(Ct,e.getCharCode(Oe+1),xt&&de),!1))}}return function Wt(Ht){return Ht?Wt(Ht.priorBreak).concat(Ht.index):[]}(Ua(e.length(),Se,te,V,0,!0))}function Bo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ys(e,t,r,u,f){if(u||f)for(var g=e[r],A=(e[r].x+g.metrics.advance*g.scale)*u,L=t;L<=r;L++)e[L].x-=A,e[L].y+=f}function Va(e,t,r,u,f,g){var A,L=e.image;if(L.content){var V=L.content,te=L.pixelRatio||1;A=[V[0]/te,V[1]/te,L.displaySize[0]-V[2]/te,L.displaySize[1]-V[3]/te]}var de,Se,Oe,it,Ct=t.left*g,xt=t.right*g;r==="width"||r==="both"?(it=f[0]+Ct-u[3],Se=f[0]+xt+u[1]):Se=(it=f[0]+(Ct+xt-L.displaySize[0])/2)+L.displaySize[0];var Wt=t.top*g,Ht=t.bottom*g;return r==="height"||r==="both"?(de=f[1]+Wt-u[0],Oe=f[1]+Ht+u[2]):Oe=(de=f[1]+(Wt+Ht-L.displaySize[1])/2)+L.displaySize[1],{image:L,top:de,right:Se,bottom:Oe,left:it,collisionPadding:A}}ca[10]=!0,ca[32]=!0,ca[38]=!0,ca[40]=!0,ca[41]=!0,ca[43]=!0,ca[45]=!0,ca[47]=!0,ca[173]=!0,ca[183]=!0,ca[8203]=!0,ca[8208]=!0,ca[8211]=!0,ca[8231]=!0;var xo=function(e){function t(r,u,f,g){e.call(this,r,u),this.angle=f,g!==void 0&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(re);function Mi(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pa(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,g=0;g<u.length&&u[g]<=e;)g++;for(var A=g=Math.max(0,g-1);A<u.length&&u[A]<e+1;)A++;A=Math.min(u.length-1,A);var L=u[g],V=u[A];return r.kind==="composite"?{kind:"composite",minZoom:L,maxZoom:V,interpolationType:f}:{kind:"camera",minZoom:L,maxZoom:V,minSize:r.evaluate(new Pa(L)),maxSize:r.evaluate(new Pa(V)),interpolationType:f}}function bs(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Ni(f/128,r.upperSize/128,t.uSizeT):u}function is(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,g=f?we(di.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Ni(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:u}}Mn("Anchor",xo);var os=Object.freeze({__proto__:null,getSizeData:Mi,evaluateSizeForFeature:bs,evaluateSizeForZoom:is,SIZE_PACK_FACTOR:128});function ss(e,t,r,u,f){if(t.segment===void 0)return!0;for(var g=t,A=t.segment+1,L=0;L>-r/2;){if(--A<0)return!1;L-=e[A].dist(g),g=e[A]}L+=e[A].dist(e[A+1]),A++;for(var V=[],te=0;L<r/2;){var de=e[A],Se=e[A+1];if(!Se)return!1;var Oe=e[A-1].angleTo(de)-de.angleTo(Se);for(Oe=Math.abs((Oe+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:L,angleDelta:Oe}),te+=Oe;L-V[0].distance>u;)te-=V.shift().angleDelta;if(te>f)return!1;A++,L+=de.dist(Se)}return!0}function Ws(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Vo(e,t,r){return e?.6*t*r:0}function ea(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Tu(e,t,r,u,f,g){for(var A=Vo(r,f,g),L=ea(r,u)*g,V=0,te=Ws(e)/2,de=0;de<e.length-1;de++){var Se=e[de],Oe=e[de+1],it=Se.dist(Oe);if(V+it>te){var Ct=(te-V)/it,xt=Ni(Se.x,Oe.x,Ct),Wt=Ni(Se.y,Oe.y,Ct),Ht=new xo(xt,Wt,Oe.angleTo(Se),de);return Ht._round(),!A||ss(e,Ht,L,A,t)?Ht:void 0}V+=it}}function xi(e,t,r,u,f,g,A,L,V){var te=Vo(u,g,A),de=ea(u,f),Se=de*A,Oe=e[0].x===0||e[0].x===V||e[0].y===0||e[0].y===V;return t-Se<t/4&&(t=Se+t/4),function it(Ct,xt,Wt,Ht,tr,dr,br,jr,Ir){for(var hn=dr/2,cn=Ws(Ct),Ln=0,$n=xt-Wt,Xn=[],Dn=0;Dn<Ct.length-1;Dn++){for(var Ta=Ct[Dn],sa=Ct[Dn+1],qn=Ta.dist(sa),$a=sa.angleTo(Ta);$n+Wt<Ln+qn;){var Ra=(($n+=Wt)-Ln)/qn,Bi=Ni(Ta.x,sa.x,Ra),va=Ni(Ta.y,sa.y,Ra);if(Bi>=0&&Bi<Ir&&va>=0&&va<Ir&&$n-hn>=0&&$n+hn<=cn){var oi=new xo(Bi,va,$a,Dn);oi._round(),Ht&&!ss(Ct,oi,dr,Ht,tr)||Xn.push(oi)}}Ln+=qn}return jr||Xn.length||br||(Xn=it(Ct,Ln/2,Wt,Ht,tr,dr,br,!0,Ir)),Xn}(e,Oe?t/2*L%t:(de/2+2*g)*A*L%t,t,te,r,Se,Oe,!1,V)}function Cn(e,t,r,u,f){for(var g=[],A=0;A<e.length;A++)for(var L=e[A],V=void 0,te=0;te<L.length-1;te++){var de=L[te],Se=L[te+1];de.x<t&&Se.x<t||(de.x<t?de=new re(t,de.y+(t-de.x)/(Se.x-de.x)*(Se.y-de.y))._round():Se.x<t&&(Se=new re(t,de.y+(t-de.x)/(Se.x-de.x)*(Se.y-de.y))._round()),de.y<r&&Se.y<r||(de.y<r?de=new re(de.x+(r-de.y)/(Se.y-de.y)*(Se.x-de.x),r)._round():Se.y<r&&(Se=new re(de.x+(r-de.y)/(Se.y-de.y)*(Se.x-de.x),r)._round()),de.x>=u&&Se.x>=u||(de.x>=u?de=new re(u,de.y+(u-de.x)/(Se.x-de.x)*(Se.y-de.y))._round():Se.x>=u&&(Se=new re(u,de.y+(u-de.x)/(Se.x-de.x)*(Se.y-de.y))._round()),de.y>=f&&Se.y>=f||(de.y>=f?de=new re(de.x+(f-de.y)/(Se.y-de.y)*(Se.x-de.x),f)._round():Se.y>=f&&(Se=new re(de.x+(f-de.y)/(Se.y-de.y)*(Se.x-de.x),f)._round()),V&&de.equals(V[V.length-1])||g.push(V=[de]),V.push(Se)))))}return g}function ga(e,t,r,u){var f=[],g=e.image,A=g.pixelRatio,L=g.paddedRect.w-2,V=g.paddedRect.h-2,te=e.right-e.left,de=e.bottom-e.top,Se=g.stretchX||[[0,L]],Oe=g.stretchY||[[0,V]],it=function(va,oi){return va+oi[1]-oi[0]},Ct=Se.reduce(it,0),xt=Oe.reduce(it,0),Wt=L-Ct,Ht=V-xt,tr=0,dr=Ct,br=0,jr=xt,Ir=0,hn=Wt,cn=0,Ln=Ht;if(g.content&&u){var $n=g.content;tr=Ga(Se,0,$n[0]),br=Ga(Oe,0,$n[1]),dr=Ga(Se,$n[0],$n[2]),jr=Ga(Oe,$n[1],$n[3]),Ir=$n[0]-tr,cn=$n[1]-br,hn=$n[2]-$n[0]-dr,Ln=$n[3]-$n[1]-jr}var Xn=function(va,oi,Wo,Ei){var Zo=iu(va.stretch-tr,dr,te,e.left),Xo=Mc(va.fixed-Ir,hn,va.stretch,Ct),ls=iu(oi.stretch-br,jr,de,e.top),Su=Mc(oi.fixed-cn,Ln,oi.stretch,xt),cs=iu(Wo.stretch-tr,dr,te,e.left),tl=Mc(Wo.fixed-Ir,hn,Wo.stretch,Ct),su=iu(Ei.stretch-br,jr,de,e.top),rl=Mc(Ei.fixed-cn,Ln,Ei.stretch,xt),uu=new re(Zo,ls),Zs=new re(cs,ls),lu=new re(cs,su),vi=new re(Zo,su),si=new re(Xo/A,Su/A),Qi=new re(tl/A,rl/A),ho=t*Math.PI/180;if(ho){var Au=Math.sin(ho),Eo=Math.cos(ho),Yo=[Eo,-Au,Au,Eo];uu._matMult(Yo),Zs._matMult(Yo),vi._matMult(Yo),lu._matMult(Yo)}var Bu=va.stretch+va.fixed,hi=oi.stretch+oi.fixed;return{tl:uu,tr:Zs,bl:vi,br:lu,tex:{x:g.paddedRect.x+1+Bu,y:g.paddedRect.y+1+hi,w:Wo.stretch+Wo.fixed-Bu,h:Ei.stretch+Ei.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:si,pixelOffsetBR:Qi,minFontScaleX:hn/A/te,minFontScaleY:Ln/A/de,isSDF:r}};if(u&&(g.stretchX||g.stretchY))for(var Dn=Go(Se,Wt,Ct),Ta=Go(Oe,Ht,xt),sa=0;sa<Dn.length-1;sa++)for(var qn=Dn[sa],$a=Dn[sa+1],Ra=0;Ra<Ta.length-1;Ra++)f.push(Xn(qn,Ta[Ra],$a,Ta[Ra+1]));else f.push(Xn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:L+1},{fixed:0,stretch:V+1}));return f}function Ga(e,t,r){for(var u=0,f=0,g=e;f<g.length;f+=1){var A=g[f];u+=Math.max(t,Math.min(r,A[1]))-Math.max(t,Math.min(r,A[0]))}return u}function Go(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,g=e;f<g.length;f+=1){var A=g[f],L=A[0],V=A[1],te=u[u.length-1];u.push({fixed:L-te.stretch,stretch:te.stretch}),u.push({fixed:L-te.stretch,stretch:te.stretch+(V-L)})}return u.push({fixed:t+1,stretch:r}),u}function iu(e,t,r,u){return e/t*r+u}function Mc(e,t,r,u){return e-t*r/u}var Mt=function(t,r,u,f,g,A,L,V,te,de){if(this.boxStartIndex=t.length,te){var Se=A.top,Oe=A.bottom,it=A.collisionPadding;it&&(Se-=it[1],Oe+=it[3]);var Ct=Oe-Se;Ct>0&&(Ct=Math.max(10,Ct),this.circleDiameter=Ct)}else{var xt=A.top*L-V,Wt=A.bottom*L+V,Ht=A.left*L-V,tr=A.right*L+V,dr=A.collisionPadding;if(dr&&(Ht-=dr[0]*L,xt-=dr[1]*L,tr+=dr[2]*L,Wt+=dr[3]*L),de){var br=new re(Ht,xt),jr=new re(tr,xt),Ir=new re(Ht,Wt),hn=new re(tr,Wt),cn=de*Math.PI/180;br._rotate(cn),jr._rotate(cn),Ir._rotate(cn),hn._rotate(cn),Ht=Math.min(br.x,jr.x,Ir.x,hn.x),tr=Math.max(br.x,jr.x,Ir.x,hn.x),xt=Math.min(br.y,jr.y,Ir.y,hn.y),Wt=Math.max(br.y,jr.y,Ir.y,hn.y)}t.emplaceBack(r.x,r.y,Ht,xt,tr,Wt,u,f,g)}this.boxEndIndex=t.length},xr=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=mr),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function mr(e,t){return e<t?-1:e>t?1:0}function Rn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,g=-1/0,A=-1/0,L=e[0],V=0;V<L.length;V++){var te=L[V];(!V||te.x<u)&&(u=te.x),(!V||te.y<f)&&(f=te.y),(!V||te.x>g)&&(g=te.x),(!V||te.y>A)&&(A=te.y)}var de=Math.min(g-u,A-f),Se=de/2,Oe=new xr([],Na);if(de===0)return new re(u,f);for(var it=u;it<g;it+=de)for(var Ct=f;Ct<A;Ct+=de)Oe.push(new v(it+Se,Ct+Se,Se,e));for(var xt=function(tr){for(var dr=0,br=0,jr=0,Ir=tr[0],hn=0,cn=Ir.length,Ln=cn-1;hn<cn;Ln=hn++){var $n=Ir[hn],Xn=Ir[Ln],Dn=$n.x*Xn.y-Xn.x*$n.y;br+=($n.x+Xn.x)*Dn,jr+=($n.y+Xn.y)*Dn,dr+=3*Dn}return new v(br/dr,jr/dr,0,tr)}(e),Wt=Oe.length;Oe.length;){var Ht=Oe.pop();(Ht.d>xt.d||!xt.d)&&(xt=Ht,r&&console.log("found best %d after %d probes",Math.round(1e4*Ht.d)/1e4,Wt)),Ht.max-xt.d<=t||(Oe.push(new v(Ht.p.x-(Se=Ht.h/2),Ht.p.y-Se,Se,e)),Oe.push(new v(Ht.p.x+Se,Ht.p.y-Se,Se,e)),Oe.push(new v(Ht.p.x-Se,Ht.p.y+Se,Se,e)),Oe.push(new v(Ht.p.x+Se,Ht.p.y+Se,Se,e)),Wt+=4)}return r&&(console.log("num probes: "+Wt),console.log("best distance: "+xt.d)),xt.p}function Na(e,t){return t.max-e.max}function v(e,t,r,u){this.p=new re(e,t),this.h=r,this.d=function(f,g){for(var A=!1,L=1/0,V=0;V<g.length;V++)for(var te=g[V],de=0,Se=te.length,Oe=Se-1;de<Se;Oe=de++){var it=te[de],Ct=te[Oe];it.y>f.y!=Ct.y>f.y&&f.x<(Ct.x-it.x)*(f.y-it.y)/(Ct.y-it.y)+it.x&&(A=!A),L=Math.min(L,sc(f,it,Ct))}return(A?1:-1)*Math.sqrt(L)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}xr.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},xr.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},xr.prototype.peek=function(){return this.data[0]},xr.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,g=t[f];if(r(u,g)>=0)break;t[e]=g,e=f}t[e]=u},xr.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var g=1+(e<<1),A=t[g],L=g+1;if(L<this.length&&r(t[L],A)<0&&(g=L,A=t[L]),r(A,f)>=0)break;t[e]=A,e=g}t[e]=f};var h=Number.POSITIVE_INFINITY;function c(e,t){return t[1]!==h?function(r,u,f){var g=0,A=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":A=f-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-f}switch(r){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,A]}(e,t[0],t[1]):function(r,u){var f=0,g=0;u<0&&(u=0);var A=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=A-7;break;case"bottom-right":case"bottom-left":g=7-A;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(r){case"top-right":case"bottom-right":f=-A;break;case"top-left":case"bottom-left":f=A;break;case"left":f=u;break;case"right":f=-u}return[f,g]}(e,t[0])}function p(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function y(e,t,r,u,f,g,A,L,V,te,de,Se,Oe,it,Ct){var xt=function(br,jr,Ir,hn,cn,Ln,$n,Xn){for(var Dn=hn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,Ta=[],sa=0,qn=jr.positionedLines;sa<qn.length;sa+=1)for(var $a=qn[sa],Ra=0,Bi=$a.positionedGlyphs;Ra<Bi.length;Ra+=1){var va=Bi[Ra];if(va.rect){var oi=va.rect||{},Wo=4,Ei=!0,Zo=1,Xo=0,ls=(cn||Xn)&&va.vertical,Su=va.metrics.advance*va.scale/2;if(Xn&&jr.verticalizable&&(Xo=$a.lineOffset/2-(va.imageName?-(24-va.metrics.width*va.scale)/2:24*(va.scale-1))),va.imageName){var cs=$n[va.imageName];Ei=cs.sdf,Wo=1/(Zo=cs.pixelRatio)}var tl=cn?[va.x+Su,va.y]:[0,0],su=cn?[0,0]:[va.x+Su+Ir[0],va.y+Ir[1]-Xo],rl=[0,0];ls&&(rl=su,su=[0,0]);var uu=(va.metrics.left-Wo)*va.scale-Su+su[0],Zs=(-va.metrics.top-Wo)*va.scale+su[1],lu=uu+oi.w*va.scale/Zo,vi=Zs+oi.h*va.scale/Zo,si=new re(uu,Zs),Qi=new re(lu,Zs),ho=new re(uu,vi),Au=new re(lu,vi);if(ls){var Eo=new re(-Su,Su- -17),Yo=-Math.PI/2,Bu=12-Su,hi=new re(22-Bu,-(va.imageName?Bu:0)),eh=new(Function.prototype.bind.apply(re,[null].concat(rl)));si._rotateAround(Yo,Eo)._add(hi)._add(eh),Qi._rotateAround(Yo,Eo)._add(hi)._add(eh),ho._rotateAround(Yo,Eo)._add(hi)._add(eh),Au._rotateAround(Yo,Eo)._add(hi)._add(eh)}if(Dn){var Jc=Math.sin(Dn),vf=Math.cos(Dn),mc=[vf,-Jc,Jc,vf];si._matMult(mc),Qi._matMult(mc),ho._matMult(mc),Au._matMult(mc)}var Vu=new re(0,0),zf=new re(0,0);Ta.push({tl:si,tr:Qi,bl:ho,br:Au,tex:oi,writingMode:jr.writingMode,glyphOffset:tl,sectionIndex:va.sectionIndex,isSDF:Ei,pixelOffsetTL:Vu,pixelOffsetBR:zf,minFontScaleX:0,minFontScaleY:0})}}return Ta}(0,r,L,f,g,A,u,e.allowVerticalPlacement),Wt=e.textSizeData,Ht=null;Wt.kind==="source"?(Ht=[128*f.layout.get("text-size").evaluate(A,{})])[0]>32640&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Wt.kind==="composite"&&((Ht=[128*it.compositeTextSizes[0].evaluate(A,{},Ct),128*it.compositeTextSizes[1].evaluate(A,{},Ct)])[0]>32640||Ht[1]>32640)&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,xt,Ht,L,g,A,te,t,V.lineStartIndex,V.lineLength,Oe,Ct);for(var tr=0,dr=de;tr<dr.length;tr+=1)Se[dr[tr]]=e.text.placedSymbolArray.length-1;return 4*xt.length}function P(e){for(var t in e)return e[t];return null}function N(e,t,r,u){var f=e.compareText;if(t in f){for(var g=f[t],A=g.length-1;A>=0;A--)if(u.dist(g[A])<r)return!0}else f[t]=[];return f[t].push(u),!1}var ee=Ro.VectorTileFeature.types,B=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function J(e,t,r,u,f,g,A,L,V,te,de,Se,Oe){var it=L?Math.min(32640,Math.round(L[0])):0,Ct=L?Math.min(32640,Math.round(L[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),g,A,(it<<1)+(V?1:0),Ct,16*te,16*de,256*Se,256*Oe)}function he(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Ye(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Ls(r[t].text))return!0;return!1}var He=function(t){this.layoutVertexArray=new Ef,this.indexArray=new Ru,this.programConfigurations=t,this.segments=new Je,this.dynamicLayoutVertexArray=new Bl,this.opacityVertexArray=new Gc,this.placedSymbolArray=new l};He.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},He.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,oh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,B,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},He.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Mn("SymbolBuffers",He);var It=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new Je,this.collisionVertexArray=new Vl};It.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,$f.members,!0)},It.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Mn("CollisionBuffers",It);var Ft=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Po([]),this.placementViewportMatrix=Po([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mi(this.zoom,r["text-size"]),this.iconSizeData=Mi(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(A){return ra[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=t.sourceID};Ft.prototype.createArrays=function(){this.text=new He(new La(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new He(new La(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new R,this.lineVertexArray=new j,this.symbolInstances=new O},Ft.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||u)&&f){var A=jf[e.charAt(g)];A&&(t[A.charCodeAt(0)]=!0)}},Ft.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,g=f.get("text-font"),A=f.get("text-field"),L=f.get("icon-image"),V=(A.value.kind!=="constant"||A.value.value instanceof Yi&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),te=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,de=f.get("symbol-sort-key");if(this.features=[],V||te){for(var Se=t.iconDependencies,Oe=t.glyphDependencies,it=t.availableImages,Ct=new Pa(this.zoom),xt=0,Wt=e;xt<Wt.length;xt+=1){var Ht=Wt[xt],tr=Ht.feature,dr=Ht.id,br=Ht.index,jr=Ht.sourceLayerIndex,Ir=u._featureFilter.needGeometry,hn=Wi(tr,Ir);if(u._featureFilter.filter(Ct,hn,r)){Ir||(hn.geometry=_i(tr));var cn=void 0;if(V){var Ln=u.getValueAndResolveTokens("text-field",hn,r,it),$n=Yi.factory(Ln);Ye($n)&&(this.hasRTLText=!0),(!this.hasRTLText||Fl()==="unavailable"||this.hasRTLText&&as.isParsed())&&(cn=wf($n,u,hn))}var Xn=void 0;if(te){var Dn=u.getValueAndResolveTokens("icon-image",hn,r,it);Xn=Dn instanceof Ko?Dn:Ko.fromString(Dn)}if(cn||Xn){var Ta=this.sortFeaturesByKey?de.evaluate(hn,{},r):void 0;if(this.features.push({id:dr,text:cn,icon:Xn,index:br,sourceLayerIndex:jr,geometry:hn.geometry,properties:tr.properties,type:ee[tr.type],sortKey:Ta}),Xn&&(Se[Xn.name]=!0),cn){var sa=g.evaluate(hn,{},r).join(","),qn=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ra.vertical)>=0;for(var $a=0,Ra=cn.sections;$a<Ra.length;$a+=1){var Bi=Ra[$a];if(Bi.image)Se[Bi.image.name]=!0;else{var va=Vc(cn.toString()),oi=Bi.fontStack||sa,Wo=Oe[oi]=Oe[oi]||{};this.calculateGlyphDependencies(Bi.text,Wo,qn,this.allowVerticalPlacement,va)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(Ei){var Zo={},Xo={},ls=[],Su=0;function cs(Eo){ls.push(Ei[Eo]),Su++}function tl(Eo,Yo,Bu){var hi=Xo[Eo];return delete Xo[Eo],Xo[Yo]=hi,ls[hi].geometry[0].pop(),ls[hi].geometry[0]=ls[hi].geometry[0].concat(Bu[0]),hi}function su(Eo,Yo,Bu){var hi=Zo[Yo];return delete Zo[Yo],Zo[Eo]=hi,ls[hi].geometry[0].shift(),ls[hi].geometry[0]=Bu[0].concat(ls[hi].geometry[0]),hi}function rl(Eo,Yo,Bu){var hi=Bu?Yo[0][Yo[0].length-1]:Yo[0][0];return Eo+":"+hi.x+":"+hi.y}for(var uu=0;uu<Ei.length;uu++){var Zs=Ei[uu],lu=Zs.geometry,vi=Zs.text?Zs.text.toString():null;if(vi){var si=rl(vi,lu),Qi=rl(vi,lu,!0);if(si in Xo&&Qi in Zo&&Xo[si]!==Zo[Qi]){var ho=su(si,Qi,lu),Au=tl(si,Qi,ls[ho].geometry);delete Zo[si],delete Xo[Qi],Xo[rl(vi,ls[Au].geometry,!0)]=Au,ls[ho].geometry=null}else si in Xo?tl(si,Qi,lu):Qi in Zo?su(si,Qi,lu):(cs(uu),Zo[si]=Su-1,Xo[Qi]=Su-1)}else cs(uu)}return ls.filter(function(Eo){return Eo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ei,Zo){return Ei.sortKey-Zo.sortKey})}},Ft.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Ft.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Ft.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ft.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ft.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Ft.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Ft.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),g={},A=e.segment+1;A<t.length;A++)g[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:u},A<t.length-1&&(u+=t[A+1].dist(t[A]));for(var L=e.segment||0;L>=0;L--)g[L]={x:t[L].x,y:t[L].y,tileUnitDistanceFromAnchor:f},L>0&&(f+=t[L-1].dist(t[L]));for(var V=0;V<t.length;V++){var te=g[V];this.lineVertexArray.emplaceBack(te.x,te.y,te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Ft.prototype.addSymbols=function(e,t,r,u,f,g,A,L,V,te,de,Se){for(var Oe=e.indexArray,it=e.layoutVertexArray,Ct=e.segments.prepareSegment(4*t.length,it,Oe,this.canOverlap?g.sortKey:void 0),xt=this.glyphOffsetArray.length,Wt=Ct.vertexLength,Ht=this.allowVerticalPlacement&&A===ra.vertical?Math.PI/2:0,tr=g.text&&g.text.sections,dr=0;dr<t.length;dr++){var br=t[dr],jr=br.tl,Ir=br.tr,hn=br.bl,cn=br.br,Ln=br.tex,$n=br.pixelOffsetTL,Xn=br.pixelOffsetBR,Dn=br.minFontScaleX,Ta=br.minFontScaleY,sa=br.glyphOffset,qn=br.isSDF,$a=br.sectionIndex,Ra=Ct.vertexLength,Bi=sa[1];J(it,L.x,L.y,jr.x,Bi+jr.y,Ln.x,Ln.y,r,qn,$n.x,$n.y,Dn,Ta),J(it,L.x,L.y,Ir.x,Bi+Ir.y,Ln.x+Ln.w,Ln.y,r,qn,Xn.x,$n.y,Dn,Ta),J(it,L.x,L.y,hn.x,Bi+hn.y,Ln.x,Ln.y+Ln.h,r,qn,$n.x,Xn.y,Dn,Ta),J(it,L.x,L.y,cn.x,Bi+cn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,qn,Xn.x,Xn.y,Dn,Ta),he(e.dynamicLayoutVertexArray,L,Ht),Oe.emplaceBack(Ra,Ra+1,Ra+2),Oe.emplaceBack(Ra+1,Ra+2,Ra+3),Ct.vertexLength+=4,Ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(sa[0]),dr!==t.length-1&&$a===t[dr+1].sectionIndex||e.programConfigurations.populatePaintArrays(it.length,g,g.index,{},Se,tr&&tr[$a])}e.placedSymbolArray.emplaceBack(L.x,L.y,xt,this.glyphOffsetArray.length-xt,Wt,V,te,L.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],A,0,!1,0,de)},Ft.prototype._addCollisionDebugVertex=function(e,t,r,u,f,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(g.x),Math.round(g.y))},Ft.prototype.addCollisionDebugVertices=function(e,t,r,u,f,g,A){var L=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),V=L.vertexLength,te=f.layoutVertexArray,de=f.collisionVertexArray,Se=A.anchorX,Oe=A.anchorY;this._addCollisionDebugVertex(te,de,g,Se,Oe,new re(e,t)),this._addCollisionDebugVertex(te,de,g,Se,Oe,new re(r,t)),this._addCollisionDebugVertex(te,de,g,Se,Oe,new re(r,u)),this._addCollisionDebugVertex(te,de,g,Se,Oe,new re(e,u)),L.vertexLength+=4;var it=f.indexArray;it.emplaceBack(V,V+1),it.emplaceBack(V+1,V+2),it.emplaceBack(V+2,V+3),it.emplaceBack(V+3,V),L.primitiveLength+=4},Ft.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var g=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,u?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},Ft.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new It(Vs,ph.members,nc),this.iconCollisionBox=new It(Vs,ph.members,nc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Ft.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,g,A,L,V){for(var te={},de=t;de<r;de++){var Se=e.get(de);te.textBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},te.textFeatureIndex=Se.featureIndex;break}for(var Oe=u;Oe<f;Oe++){var it=e.get(Oe);te.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},te.verticalTextFeatureIndex=it.featureIndex;break}for(var Ct=g;Ct<A;Ct++){var xt=e.get(Ct);te.iconBox={x1:xt.x1,y1:xt.y1,x2:xt.x2,y2:xt.y2,anchorPointX:xt.anchorPointX,anchorPointY:xt.anchorPointY},te.iconFeatureIndex=xt.featureIndex;break}for(var Wt=L;Wt<V;Wt++){var Ht=e.get(Wt);te.verticalIconBox={x1:Ht.x1,y1:Ht.y1,x2:Ht.x2,y2:Ht.y2,anchorPointX:Ht.anchorPointX,anchorPointY:Ht.anchorPointY},te.verticalIconFeatureIndex=Ht.featureIndex;break}return te},Ft.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Ft.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ft.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ft.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Ft.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Ft.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Ft.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Ft.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],g=[],A=0;A<this.symbolInstances.length;++A){g.push(A);var L=this.symbolInstances.get(A);u.push(0|Math.round(t*L.anchorX+r*L.anchorY)),f.push(L.featureIndex)}return g.sort(function(V,te){return u[V]-u[te]||f[te]-f[V]}),g},Ft.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Ft.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(g,A,L){g>=0&&L.indexOf(g)===A&&t.addIndicesForPlacedSymbol(t.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Mn("SymbolBucket",Ft,{omit:["layers","collisionBoxArray","features","compareText"]}),Ft.MAX_GLYPHS=65535,Ft.addDynamicAttributes=he;var Yt=new wo({"symbol-placement":new Yn(Ge.layout_symbol["symbol-placement"]),"symbol-spacing":new Yn(Ge.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yn(Ge.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nn(Ge.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yn(Ge.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Yn(Ge.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Yn(Ge.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yn(Ge.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yn(Ge.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nn(Ge.layout_symbol["icon-size"]),"icon-text-fit":new Yn(Ge.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Yn(Ge.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nn(Ge.layout_symbol["icon-image"]),"icon-rotate":new Nn(Ge.layout_symbol["icon-rotate"]),"icon-padding":new Yn(Ge.layout_symbol["icon-padding"]),"icon-keep-upright":new Yn(Ge.layout_symbol["icon-keep-upright"]),"icon-offset":new Nn(Ge.layout_symbol["icon-offset"]),"icon-anchor":new Nn(Ge.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yn(Ge.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yn(Ge.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yn(Ge.layout_symbol["text-rotation-alignment"]),"text-field":new Nn(Ge.layout_symbol["text-field"]),"text-font":new Nn(Ge.layout_symbol["text-font"]),"text-size":new Nn(Ge.layout_symbol["text-size"]),"text-max-width":new Nn(Ge.layout_symbol["text-max-width"]),"text-line-height":new Yn(Ge.layout_symbol["text-line-height"]),"text-letter-spacing":new Nn(Ge.layout_symbol["text-letter-spacing"]),"text-justify":new Nn(Ge.layout_symbol["text-justify"]),"text-radial-offset":new Nn(Ge.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yn(Ge.layout_symbol["text-variable-anchor"]),"text-anchor":new Nn(Ge.layout_symbol["text-anchor"]),"text-max-angle":new Yn(Ge.layout_symbol["text-max-angle"]),"text-writing-mode":new Yn(Ge.layout_symbol["text-writing-mode"]),"text-rotate":new Nn(Ge.layout_symbol["text-rotate"]),"text-padding":new Yn(Ge.layout_symbol["text-padding"]),"text-keep-upright":new Yn(Ge.layout_symbol["text-keep-upright"]),"text-transform":new Nn(Ge.layout_symbol["text-transform"]),"text-offset":new Nn(Ge.layout_symbol["text-offset"]),"text-allow-overlap":new Yn(Ge.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Yn(Ge.layout_symbol["text-ignore-placement"]),"text-optional":new Yn(Ge.layout_symbol["text-optional"])}),lr={paint:new wo({"icon-opacity":new Nn(Ge.paint_symbol["icon-opacity"]),"icon-color":new Nn(Ge.paint_symbol["icon-color"]),"icon-halo-color":new Nn(Ge.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nn(Ge.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nn(Ge.paint_symbol["icon-halo-blur"]),"icon-translate":new Yn(Ge.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yn(Ge.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nn(Ge.paint_symbol["text-opacity"]),"text-color":new Nn(Ge.paint_symbol["text-color"],{runtimeType:vn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Nn(Ge.paint_symbol["text-halo-color"]),"text-halo-width":new Nn(Ge.paint_symbol["text-halo-width"]),"text-halo-blur":new Nn(Ge.paint_symbol["text-halo-blur"]),"text-translate":new Yn(Ge.paint_symbol["text-translate"]),"text-translate-anchor":new Yn(Ge.paint_symbol["text-translate-anchor"])}),layout:Yt},_r=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:fn,this.defaultValue=t};_r.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},_r.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},_r.prototype.outputDefined=function(){return!1},_r.prototype.serialize=function(){return null},Mn("FormatSectionOverride",_r,{omit:["defaultValue"]});var un=function(e){function t(r){e.call(this,r,lr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var g=[],A=0,L=f;A<L.length;A+=1){var V=L[A];g.indexOf(V)<0&&g.push(V)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,g){var A=this.layout.get(r).evaluate(u,{},f,g),L=this._unevaluatedLayout._values[r];return L.isDataDriven()||No(L.value)||!A?A:function(V,te){return te.replace(/{([^{}]+)}/g,function(de,Se){return Se in V?String(V[Se]):""})}(u.properties,A)},t.prototype.createBucket=function(r){return new Ft(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=lr.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var g,A=this.paint.get(f),L=new _r(A),V=new Rl(L,A.property.specification);g=A.value.kind==="constant"||A.value.kind==="source"?new Il("source",V):new bl("composite",V,A.value.zoomStops,A.value._interpolationType),this.paint._values[f]=new Ss(A.property,g,A.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),g=lr.paint.properties[u],A=!1,L=function(Se){for(var Oe=0,it=Se;Oe<it.length;Oe+=1)if(g.overrides&&g.overrides.hasOverride(it[Oe]))return void(A=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Yi)L(f.value.value.sections);else if(f.value.kind==="source"){var V=function de(Se){A||(Se instanceof ii&&Ai(Se.value)===Ka?L(Se.value.sections):Se instanceof oo?L(Se.sections):Se.eachChild(de))},te=f.value;te._styleExpression&&V(te._styleExpression.expression)}return A},t}(ru),Nr={paint:new wo({"background-color":new Yn(Ge.paint_background["background-color"]),"background-pattern":new ms(Ge.paint_background["background-pattern"]),"background-opacity":new Yn(Ge.paint_background["background-opacity"])})},rn=function(e){function t(r){e.call(this,r,Nr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ru),yn={paint:new wo({"raster-opacity":new Yn(Ge.paint_raster["raster-opacity"]),"raster-hue-rotate":new Yn(Ge.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yn(Ge.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yn(Ge.paint_raster["raster-brightness-max"]),"raster-saturation":new Yn(Ge.paint_raster["raster-saturation"]),"raster-contrast":new Yn(Ge.paint_raster["raster-contrast"]),"raster-resampling":new Yn(Ge.paint_raster["raster-resampling"]),"raster-fade-duration":new Yn(Ge.paint_raster["raster-fade-duration"])})},Vn=function(e){function t(r){e.call(this,r,yn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ru),ua=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(ru),ma={circle:wl,heatmap:lf,hillshade:Nf,fill:Rr,"fill-extrusion":Si,line:Sh,symbol:un,background:rn,raster:Vn},Pi=Y.HTMLImageElement,Ha=Y.HTMLCanvasElement,Ho=Y.HTMLVideoElement,Qo=Y.ImageData,_u=Y.ImageBitmap,us=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};us.prototype.update=function(e,t,r){var u=e.width,f=e.height,g=!(this.size&&this.size[0]===u&&this.size[1]===f||r),A=this.context,L=A.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!t||t.premultiply!==!1)),g)this.size=[u,f],e instanceof Pi||e instanceof Ha||e instanceof Ho||e instanceof Qo||_u&&e instanceof _u?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,e):L.texImage2D(L.TEXTURE_2D,0,this.format,u,f,0,this.format,L.UNSIGNED_BYTE,e.data);else{var V=r||{x:0,y:0},te=V.x,de=V.y;e instanceof Pi||e instanceof Ha||e instanceof Ho||e instanceof Qo||_u&&e instanceof _u?L.texSubImage2D(L.TEXTURE_2D,0,te,de,L.RGBA,L.UNSIGNED_BYTE,e):L.texSubImage2D(L.TEXTURE_2D,0,te,de,u,f,L.RGBA,L.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)},us.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},us.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},us.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ml=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};Ml.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Ml.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Kc=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},yt(["receive","process"],this),this.invoker=new Ml(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Kt()?t:Y};function Pc(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}Kc.prototype.send=function(e,t,r,u,f){var g=this;f===void 0&&(f=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);var L=Q(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:Mu(t,L)},L),{cancel:function(){r&&delete g.callbacks[A],g.target.postMessage({id:A,type:"<cancel>",targetMapId:u,sourceMapId:g.mapId})}}},Kc.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Kt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Kc.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Kc.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Bs(t.error)):u(null,Bs(t.data)))}else{var f=!1,g=Q(this.globalScope)?void 0:[],A=t.hasCallback?function(de,Se){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:de?Mu(de):null,data:Mu(Se,g)},g)}:function(de){f=!0},L=null,V=Bs(t.data);if(this.parent[t.type])L=this.parent[t.type](t.sourceMapId,V,A);else if(this.parent.getWorkerSource){var te=t.type.split(".");L=this.parent.getWorkerSource(t.sourceMapId,te[0],V.source)[te[1]](V,A)}else A(new Error("Could not find function "+t.type));!f&&L&&L.cancel&&(this.cancelCallbacks[e]=L.cancel)}},Kc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ao=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};ao.prototype.setNorthEast=function(e){return this._ne=e instanceof ai?new ai(e.lng,e.lat):ai.convert(e),this},ao.prototype.setSouthWest=function(e){return this._sw=e instanceof ai?new ai(e.lng,e.lat):ai.convert(e),this},ao.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof ai)t=e,r=e;else{if(!(e instanceof ao))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ao.convert(e)):this.extend(ai.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new ai(t.lng,t.lat),this._ne=new ai(r.lng,r.lat)),this},ao.prototype.getCenter=function(){return new ai((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ao.prototype.getSouthWest=function(){return this._sw},ao.prototype.getNorthEast=function(){return this._ne},ao.prototype.getNorthWest=function(){return new ai(this.getWest(),this.getNorth())},ao.prototype.getSouthEast=function(){return new ai(this.getEast(),this.getSouth())},ao.prototype.getWest=function(){return this._sw.lng},ao.prototype.getSouth=function(){return this._sw.lat},ao.prototype.getEast=function(){return this._ne.lng},ao.prototype.getNorth=function(){return this._ne.lat},ao.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ao.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ao.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ao.prototype.contains=function(e){var t=ai.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},ao.convert=function(e){return!e||e instanceof ao?e:new ao(e)};var ai=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ai.prototype.wrap=function(){return new ai(dt(this.lng,-180,180),this.lat)},ai.prototype.toArray=function(){return[this.lng,this.lat]},ai.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ai.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},ai.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new ao(new ai(this.lng-r,this.lat-t),new ai(this.lng+r,this.lat+t))},ai.convert=function(e){if(e instanceof ai)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ai(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ai(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function dc(e){return Of*Math.cos(e*Math.PI/180)}function Pl(e){return(180+e)/360}function $c(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Jf(e,t){return e/dc(t)}function io(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ou=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};ou.fromLngLat=function(e,t){t===void 0&&(t=0);var r=ai.convert(e);return new ou(Pl(r.lng),$c(r.lat),Jf(t,r.lat))},ou.prototype.toLngLat=function(){return new ai(360*this.x-180,io(this.y))},ou.prototype.toAltitude=function(){return this.z*dc(io(this.y))},ou.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=io(this.y),1/Math.cos(e*Math.PI/180));var e};var mf=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=ml(0,t,t,r,u)};mf.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},mf.prototype.url=function(e,t){var r,u,f,g,A,L=(u=this.y,f=this.z,g=Pc(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),A=Pc(256*(r+1),256*(u+1),f),g[0]+","+g[1]+","+A[0]+","+A[1]),V=function(te,de,Se){for(var Oe,it="",Ct=te;Ct>0;Ct--)it+=(de&(Oe=1<<Ct-1)?1:0)+(Se&Oe?2:0);return it}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",L)},mf.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new re(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},mf.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var sh=function(t,r){this.wrap=t,this.canonical=r,this.key=ml(t,r.z,r.z,r.x,r.y)},xs=function(t,r,u,f,g){this.overscaledZ=t,this.wrap=r,this.canonical=new mf(u,+f,+g),this.key=ml(r,t,u,f,g)};function ml(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*f+u).toString(36)+r.toString(36)+t.toString(36)}xs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},xs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new xs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new xs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},xs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?ml(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):ml(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},xs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},xs.prototype.children=function(e){if(this.overscaledZ>=e)return[new xs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new xs(t,this.wrap,t,r,u),new xs(t,this.wrap,t,r+1,u),new xs(t,this.wrap,t,r,u+1),new xs(t,this.wrap,t,r+1,u+1)]},xs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},xs.prototype.wrapped=function(){return new xs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},xs.prototype.unwrapTo=function(e){return new xs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},xs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},xs.prototype.toUnwrapped=function(){return new sh(this.wrap,this.canonical)},xs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},xs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ou(e.x-this.wrap,e.y))},Mn("CanonicalTileID",mf),Mn("OverscaledTileID",xs,{omit:["posMatrix"]});var pc=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Le('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var g=0;g<f;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(f,g)]=this.data[this._idx(f-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,f)]=this.data[this._idx(g,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};pc.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},pc.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},pc.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},pc.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},pc.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},pc.prototype.getPixels=function(){return new Lo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},pc.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,g=r*this.dim,A=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:g=A-1;break;case 1:A=g+1}for(var L=-t*this.dim,V=-r*this.dim,te=g;te<A;te++)for(var de=u;de<f;de++)this.data[this._idx(de,te)]=e.data[this._idx(de+L,te+V)]},Mn("DEMData",pc);var zh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};zh.prototype.encode=function(e){return this._stringToNumber[e]},zh.prototype.decode=function(e){return this._numberToString[e]};var Wh=function(t,r,u,f,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=g},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Wh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Wh.prototype,ed);var Ch=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ch.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ke(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var g in this.deletedStates[e][u]={},this.state[e][u])r[g]||(this.deletedStates[e][u][g]=null);else for(var A in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][A]===null&&delete this.deletedStates[e][u][A]},Ch.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},Ch.prototype.getState=function(e,t){var r=String(t),u=ke({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var g in f)delete u[g]}return u},Ch.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Ch.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),ke(this.state[u][g],this.stateChanges[u][g]),f[g]=this.state[u][g];r[u]=f}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var L={};if(this.deletedStates[A]===null)for(var V in this.state[A])L[V]={},this.state[A][V]={};else for(var te in this.deletedStates[A]){if(this.deletedStates[A][te]===null)this.state[A][te]={};else for(var de=0,Se=Object.keys(this.deletedStates[A][te]);de<Se.length;de+=1)delete this.state[A][te][Se[de]];L[te]=this.state[A][te]}r[A]=r[A]||{},ke(r[A],L)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Oe in e)e[Oe].setFeatureState(r,t)};var Qf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ku(8192,16,0),this.grid3D=new Ku(8192,16,0),this.featureIndexArray=new Te,this.promoteId=r};function td(e,t,r,u,f){return De(e,function(g,A){var L=t instanceof Sc?t.get(A):null;return L&&L.evaluate?L.evaluate(r,u,f):L})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,g=0,A=e;g<A.length;g+=1){var L=A[g];t=Math.min(t,L.x),r=Math.min(r,L.y),u=Math.max(u,L.x),f=Math.max(f,L.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ld(e,t){return t-e}Qf.prototype.insert=function(e,t,r,u,f,g){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var L=g?this.grid3D:this.grid,V=0;V<t.length;V++){for(var te=t[V],de=[1/0,1/0,-1/0,-1/0],Se=0;Se<te.length;Se++){var Oe=te[Se];de[0]=Math.min(de[0],Oe.x),de[1]=Math.min(de[1],Oe.y),de[2]=Math.max(de[2],Oe.x),de[3]=Math.max(de[3],Oe.y)}de[0]<8192&&de[1]<8192&&de[2]>=0&&de[3]>=0&&L.insert(A,de[0],de[1],de[2],de[3])}},Qf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ro.VectorTile(new je(this.rawTileData)).layers,this.sourceLayerCoder=new zh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Qf.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var g=e.params||{},A=8192/e.tileSize/e.scale,L=Ec(g.filter),V=e.queryGeometry,te=e.queryPadding*A,de=rd(V),Se=this.grid.query(de.minX-te,de.minY-te,de.maxX+te,de.maxY+te),Oe=rd(e.cameraQueryGeometry),it=this.grid3D.query(Oe.minX-te,Oe.minY-te,Oe.maxX+te,Oe.maxY+te,function(br,jr,Ir,hn){return function(cn,Ln,$n,Xn,Dn){for(var Ta=0,sa=cn;Ta<sa.length;Ta+=1){var qn=sa[Ta];if(Ln<=qn.x&&$n<=qn.y&&Xn>=qn.x&&Dn>=qn.y)return!0}var $a=[new re(Ln,$n),new re(Ln,Dn),new re(Xn,Dn),new re(Xn,$n)];if(cn.length>2){for(var Ra=0,Bi=$a;Ra<Bi.length;Ra+=1)if(Nu(cn,Bi[Ra]))return!0}for(var va=0;va<cn.length-1;va++)if(pl(cn[va],cn[va+1],$a))return!0;return!1}(e.cameraQueryGeometry,br-te,jr-te,Ir+te,hn+te)}),Ct=0,xt=it;Ct<xt.length;Ct+=1)Se.push(xt[Ct]);Se.sort(ld);for(var Wt,Ht={},tr=function(jr){var Ir=Se[jr];if(Ir!==Wt){Wt=Ir;var hn=f.featureIndexArray.get(Ir),cn=null;f.loadMatchingFeature(Ht,hn.bucketIndex,hn.sourceLayerIndex,hn.featureIndex,L,g.layers,g.availableImages,t,r,u,function(Ln,$n,Xn){return cn||(cn=_i(Ln)),$n.queryIntersectsFeature(V,Ln,Xn,cn,f.z,e.transform,A,e.pixelPosMatrix)})}},dr=0;dr<Se.length;dr++)tr(dr);return Ht},Qf.prototype.loadMatchingFeature=function(e,t,r,u,f,g,A,L,V,te,de){var Se=this.bucketLayerIDs[t];if(!g||function(cn,Ln){for(var $n=0;$n<cn.length;$n++)if(Ln.indexOf(cn[$n])>=0)return!0;return!1}(g,Se)){var Oe=this.sourceLayerCoder.decode(r),it=this.vtLayers[Oe].feature(u);if(f.needGeometry){var Ct=Wi(it,!0);if(!f.filter(new Pa(this.tileID.overscaledZ),Ct,this.tileID.canonical))return}else if(!f.filter(new Pa(this.tileID.overscaledZ),it))return;for(var xt=this.getId(it,Oe),Wt=0;Wt<Se.length;Wt++){var Ht=Se[Wt];if(!(g&&g.indexOf(Ht)<0)){var tr=L[Ht];if(tr){var dr={};xt!==void 0&&te&&(dr=te.getState(tr.sourceLayer||"_geojsonTileLayer",xt));var br=ke({},V[Ht]);br.paint=td(br.paint,tr.paint,it,dr,A),br.layout=td(br.layout,tr.layout,it,dr,A);var jr=!de||de(it,tr,dr);if(jr){var Ir=new Wh(it,this.z,this.x,this.y,xt);Ir.layer=br;var hn=e[Ht];hn===void 0&&(hn=e[Ht]=[]),hn.push({featureIndex:u,feature:Ir,intersectionZ:jr})}}}}}},Qf.prototype.lookupSymbolFeatures=function(e,t,r,u,f,g,A,L){var V={};this.loadVTLayers();for(var te=Ec(f),de=0,Se=e;de<Se.length;de+=1)this.loadMatchingFeature(V,r,u,Se[de],te,g,A,L,t);return V},Qf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Qf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},Mn("FeatureIndex",Qf,{omit:["rawTileData","sourceLayerCoder"]});var Es=function(t,r){this.tileID=t,this.uid=Ze(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Es.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ye.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Es.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Es.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(te,de){var Se={};if(!de)return Se;for(var Oe=function(){var Wt=Ct[it],Ht=Wt.layerIds.map(function(br){return de.getLayer(br)}).filter(Boolean);if(Ht.length!==0){Wt.layers=Ht,Wt.stateDependentLayerIds&&(Wt.stateDependentLayers=Wt.stateDependentLayerIds.map(function(br){return Ht.filter(function(jr){return jr.id===br})[0]}));for(var tr=0,dr=Ht;tr<dr.length;tr+=1)Se[dr[tr].id]=Wt}},it=0,Ct=te;it<Ct.length;it+=1)Oe();return Se}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof Ft){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var A=this.buckets[g];if(A instanceof Ft&&A.hasRTLText){this.hasRTLText=!0,as.isLoading()||as.isLoaded()||Fl()!=="deferred"||Rs();break}}for(var L in this.queryPadding=0,this.buckets){var V=this.buckets[L];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(L).queryRadius(V))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},Es.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Es.prototype.getBucket=function(e){return this.buckets[e.id]},Es.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new us(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new us(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},Es.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Es.prototype.queryRenderedFeatures=function(e,t,r,u,f,g,A,L,V,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:g,tileSize:this.tileSize,pixelPosMatrix:te,transform:L,params:A,queryPadding:this.queryPadding*V},e,t,r):{}},Es.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",g=u._geojsonTileLayer||u[f];if(g)for(var A=Ec(t&&t.filter),L=this.tileID.canonical,V=L.z,te=L.x,de=L.y,Se={z:V,x:te,y:de},Oe=0;Oe<g.length;Oe++){var it=g.feature(Oe);if(A.needGeometry){var Ct=Wi(it,!0);if(!A.filter(new Pa(this.tileID.overscaledZ),Ct,this.tileID.canonical))continue}else if(!A.filter(new Pa(this.tileID.overscaledZ),it))continue;var xt=r.getId(it,f),Wt=new Wh(it,V,te,de,xt);Wt.tile=Se,e.push(Wt)}}},Es.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Es.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Es.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ar(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var g=this.expirationTime-t;g?this.expirationTime=u+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Es.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Es.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],g=f.layers[0].sourceLayer||"_geojsonTileLayer",A=r[g],L=e[g];if(A&&L&&Object.keys(L).length!==0){f.update(L,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var V=t&&t.style&&t.style.getLayer(u);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(f)))}}}},Es.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Es.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ye.now()},Es.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Es.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ye.now()+e},Es.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},Es.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var g=0,A=t;g<A.length;g+=1)if(f[A[g]])return!0}}return!1};var qf=Y.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},qf.mark(this._marks.start)};cd.prototype.finish=function(){qf.mark(this._marks.end);var e=qf.getEntriesByName(this._marks.measure);return e.length===0&&(qf.measure(this._marks.measure,this._marks.start,this._marks.end),e=qf.getEntriesByName(this._marks.measure),qf.clearMarks(this._marks.start),qf.clearMarks(this._marks.end),qf.clearMeasures(this._marks.measure)),e},o.Actor=Kc,o.AlphaImage=Hs,o.CanonicalTileID=mf,o.CollisionBoxArray=a,o.Color=la,o.DEMData=pc,o.DataConstantProperty=Yn,o.DictionaryCoder=zh,o.EXTENT=8192,o.ErrorEvent=Tt,o.EvaluationParameters=Pa,o.Event=at,o.Evented=jt,o.FeatureIndex=Qf,o.FillBucket=Xt,o.FillExtrusionBucket=ri,o.ImageAtlas=Zn,o.ImagePosition=Br,o.LineBucket=Uu,o.LngLat=ai,o.LngLatBounds=ao,o.MercatorCoordinate=ou,o.ONE_EM=24,o.OverscaledTileID=xs,o.Point=re,o.Point$1=re,o.Properties=wo,o.Protobuf=je,o.RGBAImage=Lo,o.RequestManager=I,o.RequestPerformance=cd,o.ResourceType=Gr,o.SegmentVector=Je,o.SourceFeatureState=Ch,o.StructArrayLayout1ui2=ac,o.StructArrayLayout2f1f2i16=Al,o.StructArrayLayout2i4=dl,o.StructArrayLayout3ui6=Ru,o.StructArrayLayout4i8=rc,o.SymbolBucket=Ft,o.Texture=us,o.Tile=Es,o.Transitionable=Co,o.Uniform1f=nn,o.Uniform1i=Ar,o.Uniform2f=Xr,o.Uniform3f=gn,o.Uniform4f=Pn,o.UniformColor=Jn,o.UniformMatrix4f=ba,o.UnwrappedTileID=sh,o.ValidationError=wt,o.WritingMode=ra,o.ZoomHistory=ei,o.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},o.addDynamicAttributes=he,o.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),g=null;e.forEach(function(A,L){t(A,function(V,te){V&&(g=V),f[L]=te,--u==0&&r(g,f)})})},o.bezier=We,o.bindAll=yt,o.browser=ye,o.cacheEntryPossiblyAdded=function(e){++Vt>mt&&(e.getActor().send("enforceCacheSizeLimit",At),Vt=0)},o.clamp=we,o.clearTileCache=function(e){var t=Y.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},o.clipLine=Cn,o.clone=function(e){var t=new Mo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.clone$1=Ue,o.clone$2=function(e){var t=new Mo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.collisionCircleLayout=jh,o.config=be,o.create=function(){var e=new Mo(16);return Mo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new Mo(9);return Mo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new Mo(4);return Mo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=Z,o.createExpression=Ql,o.createLayout=Hi,o.createStyleLayer=function(e){return e.type==="custom"?new ua(e):new ma[e.type](e)},o.cross=function(e,t,r){var u=t[0],f=t[1],g=t[2],A=r[0],L=r[1],V=r[2];return e[0]=f*V-g*L,e[1]=g*A-u*V,e[2]=u*L-f*A,e},o.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.ease=ge,o.emitValidationErrors=mu,o.endsWith=_t,o.enforceCacheSizeLimit=function(e){Me(),Ke&&Ke.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},o.evaluateSizeForFeature=bs,o.evaluateSizeForZoom=is,o.evaluateVariableOffset=c,o.evented=uf,o.extend=ke,o.featureFilter=Ec,o.filterObject=Ne,o.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=Bo,o.getAnchorJustification=p,o.getArrayBuffer=Hn,o.getImage=W,o.getJSON=function(e,t){return fa(ke(e,{type:"json"}),t)},o.getRTLTextPluginStatus=Fl,o.getReferrer=zn,o.getVideo=function(e,t){var r,u,f=Y.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var g=0;g<e.length;g++){var A=Y.document.createElement("source");r=e[g],u=void 0,(u=Y.document.createElement("a")).href=r,(u.protocol!==Y.document.location.protocol||u.host!==Y.document.location.host)&&(f.crossOrigin="Anonymous"),A.src=e[g],f.appendChild(A)}return{cancel:function(){}}},o.identity=Po,o.invert=function(e,t){var r=t[0],u=t[1],f=t[2],g=t[3],A=t[4],L=t[5],V=t[6],te=t[7],de=t[8],Se=t[9],Oe=t[10],it=t[11],Ct=t[12],xt=t[13],Wt=t[14],Ht=t[15],tr=r*L-u*A,dr=r*V-f*A,br=r*te-g*A,jr=u*V-f*L,Ir=u*te-g*L,hn=f*te-g*V,cn=de*xt-Se*Ct,Ln=de*Wt-Oe*Ct,$n=de*Ht-it*Ct,Xn=Se*Wt-Oe*xt,Dn=Se*Ht-it*xt,Ta=Oe*Ht-it*Wt,sa=tr*Ta-dr*Dn+br*Xn+jr*$n-Ir*Ln+hn*cn;return sa?(e[0]=(L*Ta-V*Dn+te*Xn)*(sa=1/sa),e[1]=(f*Dn-u*Ta-g*Xn)*sa,e[2]=(xt*hn-Wt*Ir+Ht*jr)*sa,e[3]=(Oe*Ir-Se*hn-it*jr)*sa,e[4]=(V*$n-A*Ta-te*Ln)*sa,e[5]=(r*Ta-f*$n+g*Ln)*sa,e[6]=(Wt*br-Ct*hn-Ht*dr)*sa,e[7]=(de*hn-Oe*br+it*dr)*sa,e[8]=(A*Dn-L*$n+te*cn)*sa,e[9]=(u*$n-r*Dn-g*cn)*sa,e[10]=(Ct*Ir-xt*br+Ht*tr)*sa,e[11]=(Se*br-de*Ir-it*tr)*sa,e[12]=(L*Ln-A*Xn-V*cn)*sa,e[13]=(r*Xn-u*Ln+f*cn)*sa,e[14]=(xt*dr-Ct*jr-Wt*tr)*sa,e[15]=(de*jr-Se*dr+Oe*tr)*sa,e):null},o.isChar=qr,o.isMapboxURL=q,o.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},o.makeRequest=fa,o.mapObject=De,o.mercatorXfromLng=Pl,o.mercatorYfromLat=$c,o.mercatorZfromAltitude=Jf,o.mul=Fo,o.multiply=Jo,o.mvt=Ro,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],g=r*r+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},o.number=Ni,o.offscreenCanvasSupported=pr,o.ortho=function(e,t,r,u,f,g,A){var L=1/(t-r),V=1/(u-f),te=1/(g-A);return e[0]=-2*L,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*V,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*te,e[11]=0,e[12]=(t+r)*L,e[13]=(f+u)*V,e[14]=(A+g)*te,e[15]=1,e},o.parseGlyphPBF=function(e){return new je(e).readFields(Lr,[])},o.pbf=je,o.performSymbolLayout=function(e,t,r,u,f,g,A){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var L=e.layers[0].layout,V=e.layers[0]._unevaluatedLayout._values,te={};if(e.textSizeData.kind==="composite"){var de=e.textSizeData,Se=de.maxZoom;te.compositeTextSizes=[V["text-size"].possiblyEvaluate(new Pa(de.minZoom),A),V["text-size"].possiblyEvaluate(new Pa(Se),A)]}if(e.iconSizeData.kind==="composite"){var Oe=e.iconSizeData,it=Oe.maxZoom;te.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new Pa(Oe.minZoom),A),V["icon-size"].possiblyEvaluate(new Pa(it),A)]}te.layoutTextSize=V["text-size"].possiblyEvaluate(new Pa(e.zoom+1),A),te.layoutIconSize=V["icon-size"].possiblyEvaluate(new Pa(e.zoom+1),A),te.textMaxSize=V["text-size"].possiblyEvaluate(new Pa(18));for(var Ct=24*L.get("text-line-height"),xt=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Wt=L.get("text-keep-upright"),Ht=L.get("text-size"),tr=function(){var Ir=br[dr],hn=L.get("text-font").evaluate(Ir,{},A).join(","),cn=Ht.evaluate(Ir,{},A),Ln=te.layoutTextSize.evaluate(Ir,{},A),$n=te.layoutIconSize.evaluate(Ir,{},A),Xn={horizontal:{},vertical:void 0},Dn=Ir.text,Ta=[0,0];if(Dn){var sa=Dn.toString(),qn=24*L.get("text-letter-spacing").evaluate(Ir,{},A),$a=function(vi){for(var si=0,Qi=vi;si<Qi.length;si+=1)if(ho=Qi[si].charCodeAt(0),qr.Arabic(ho)||qr["Arabic Supplement"](ho)||qr["Arabic Extended-A"](ho)||qr["Arabic Presentation Forms-A"](ho)||qr["Arabic Presentation Forms-B"](ho))return!1;var ho;return!0}(sa)?qn:0,Ra=L.get("text-anchor").evaluate(Ir,{},A),Bi=L.get("text-variable-anchor");if(!Bi){var va=L.get("text-radial-offset").evaluate(Ir,{},A);Ta=va?c(Ra,[24*va,h]):L.get("text-offset").evaluate(Ir,{},A).map(function(vi){return 24*vi})}var oi=xt?"center":L.get("text-justify").evaluate(Ir,{},A),Wo=L.get("symbol-placement"),Ei=Wo==="point"?24*L.get("text-max-width").evaluate(Ir,{},A):0,Zo=function(){e.allowVerticalPlacement&&Vc(sa)&&(Xn.vertical=kr(Dn,t,r,f,hn,Ei,Ct,Ra,"left",$a,Ta,ra.vertical,!0,Wo,Ln,cn))};if(!xt&&Bi){for(var Xo=oi==="auto"?Bi.map(function(vi){return p(vi)}):[oi],ls=!1,Su=0;Su<Xo.length;Su++){var cs=Xo[Su];if(!Xn.horizontal[cs])if(ls)Xn.horizontal[cs]=Xn.horizontal[0];else{var tl=kr(Dn,t,r,f,hn,Ei,Ct,"center",cs,$a,Ta,ra.horizontal,!1,Wo,Ln,cn);tl&&(Xn.horizontal[cs]=tl,ls=tl.positionedLines.length===1)}}Zo()}else{oi==="auto"&&(oi=p(Ra));var su=kr(Dn,t,r,f,hn,Ei,Ct,Ra,oi,$a,Ta,ra.horizontal,!1,Wo,Ln,cn);su&&(Xn.horizontal[oi]=su),Zo(),Vc(sa)&&xt&&Wt&&(Xn.vertical=kr(Dn,t,r,f,hn,Ei,Ct,Ra,oi,$a,Ta,ra.vertical,!1,Wo,Ln,cn))}}var rl=void 0,uu=!1;if(Ir.icon&&Ir.icon.name){var Zs=u[Ir.icon.name];Zs&&(rl=function(vi,si,Qi){var ho=Bo(Qi),Au=si[0]-vi.displaySize[0]*ho.horizontalAlign,Eo=si[1]-vi.displaySize[1]*ho.verticalAlign;return{image:vi,top:Eo,bottom:Eo+vi.displaySize[1],left:Au,right:Au+vi.displaySize[0]}}(f[Ir.icon.name],L.get("icon-offset").evaluate(Ir,{},A),L.get("icon-anchor").evaluate(Ir,{},A)),uu=Zs.sdf,e.sdfIcons===void 0?e.sdfIcons=Zs.sdf:e.sdfIcons!==Zs.sdf&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zs.pixelRatio!==e.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var lu=P(Xn.horizontal)||Xn.vertical;e.iconsInText=!!lu&&lu.iconsInText,(lu||rl)&&function(vi,si,Qi,ho,Au,Eo,Yo,Bu,hi,eh,Jc){var vf=Eo.textMaxSize.evaluate(si,{});vf===void 0&&(vf=Yo);var mc,Vu=vi.layers[0].layout,zf=Vu.get("icon-offset").evaluate(si,{},Jc),Ff=P(Qi.horizontal),th=Yo/24,wh=vi.tilePixelRatio*th,Mf=vi.tilePixelRatio*vf/24,Oh=vi.tilePixelRatio*Bu,rh=vi.tilePixelRatio*Vu.get("symbol-spacing"),mh=Vu.get("text-padding")*vi.tilePixelRatio,Zh=Vu.get("icon-padding")*vi.tilePixelRatio,Fh=Vu.get("text-max-angle")/180*Math.PI,Xh=Vu.get("text-rotation-alignment")==="map"&&Vu.get("symbol-placement")!=="point",vh=Vu.get("icon-rotation-alignment")==="map"&&Vu.get("symbol-placement")!=="point",Mh=Vu.get("symbol-placement"),Yh=rh/2,gh=Vu.get("icon-text-fit");ho&&gh!=="none"&&(vi.allowVerticalPlacement&&Qi.vertical&&(mc=Va(ho,Qi.vertical,gh,Vu.get("icon-text-fit-padding"),zf,th)),Ff&&(ho=Va(ho,Ff,gh,Vu.get("icon-text-fit-padding"),zf,th)));var nh=function(fd,Nh){Nh.x<0||Nh.x>=8192||Nh.y<0||Nh.y>=8192||function(Ts,Qc,hd,ah,od,d,S,_,x,C,M,U,ie,me,ze,Nt,Jt,wr,Dr,bn,mn,kn,_a,Ca,Di){var ui,li,qi,wa,eo,To=Ts.addToLineVertexArray(Qc,hd),Xs=0,Ya=0,ws=0,qo=0,gf=-1,kh=-1,Lc={},Th=Rt(""),lh=0,qc=0;if(_._unevaluatedLayout.getValue("text-radial-offset")===void 0?(lh=(ui=_.layout.get("text-offset").evaluate(mn,{},Ca).map(function(_d){return 24*_d}))[0],qc=ui[1]):(lh=24*_.layout.get("text-radial-offset").evaluate(mn,{},Ca),qc=h),Ts.allowVerticalPlacement&&ah.vertical){var dd=_.layout.get("text-rotate").evaluate(mn,{},Ca)+90;wa=new Mt(x,Qc,C,M,U,ah.vertical,ie,me,ze,dd),S&&(eo=new Mt(x,Qc,C,M,U,S,Jt,wr,ze,dd))}if(od){var sd=_.layout.get("icon-rotate").evaluate(mn,{}),pd=_.layout.get("icon-text-fit")!=="none",md=ga(od,sd,_a,pd),ud=S?ga(S,sd,_a,pd):void 0;qi=new Mt(x,Qc,C,M,U,od,Jt,wr,!1,sd),Xs=4*md.length;var vd=Ts.iconSizeData,Hh=null;vd.kind==="source"?(Hh=[128*_.layout.get("icon-size").evaluate(mn,{})])[0]>32640&&Le(Ts.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):vd.kind==="composite"&&((Hh=[128*kn.compositeIconSizes[0].evaluate(mn,{},Ca),128*kn.compositeIconSizes[1].evaluate(mn,{},Ca)])[0]>32640||Hh[1]>32640)&&Le(Ts.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ts.addSymbols(Ts.icon,md,Hh,bn,Dr,mn,!1,Qc,To.lineStartIndex,To.lineLength,-1,Ca),gf=Ts.icon.placedSymbolArray.length-1,ud&&(Ya=4*ud.length,Ts.addSymbols(Ts.icon,ud,Hh,bn,Dr,mn,ra.vertical,Qc,To.lineStartIndex,To.lineLength,-1,Ca),kh=Ts.icon.placedSymbolArray.length-1)}for(var gd in ah.horizontal){var qh=ah.horizontal[gd];if(!li){Th=Rt(qh.text);var ka=_.layout.get("text-rotate").evaluate(mn,{},Ca);li=new Mt(x,Qc,C,M,U,qh,ie,me,ze,ka)}var Vi=qh.positionedLines.length===1;if(ws+=y(Ts,Qc,qh,d,_,ze,mn,Nt,To,ah.vertical?ra.horizontal:ra.horizontalOnly,Vi?Object.keys(ah.horizontal):[gd],Lc,gf,kn,Ca),Vi)break}ah.vertical&&(qo+=y(Ts,Qc,ah.vertical,d,_,ze,mn,Nt,To,ra.vertical,["vertical"],Lc,kh,kn,Ca));var ci=li?li.boxStartIndex:Ts.collisionBoxArray.length,In=li?li.boxEndIndex:Ts.collisionBoxArray.length,Rc=wa?wa.boxStartIndex:Ts.collisionBoxArray.length,_s=wa?wa.boxEndIndex:Ts.collisionBoxArray.length,ef=qi?qi.boxStartIndex:Ts.collisionBoxArray.length,tf=qi?qi.boxEndIndex:Ts.collisionBoxArray.length,_h=eo?eo.boxStartIndex:Ts.collisionBoxArray.length,yd=eo?eo.boxEndIndex:Ts.collisionBoxArray.length,ch=-1,bd=function(xd,Sd){return xd&&xd.circleDiameter?Math.max(xd.circleDiameter,Sd):Sd};ch=bd(li,ch),ch=bd(wa,ch),ch=bd(qi,ch);var Td=(ch=bd(eo,ch))>-1?1:0;Td&&(ch*=Di/24),Ts.glyphOffsetArray.length>=Ft.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mn.sortKey!==void 0&&Ts.addToSortKeyRanges(Ts.symbolInstances.length,mn.sortKey),Ts.symbolInstances.emplaceBack(Qc.x,Qc.y,Lc.right>=0?Lc.right:-1,Lc.center>=0?Lc.center:-1,Lc.left>=0?Lc.left:-1,Lc.vertical||-1,gf,kh,Th,ci,In,Rc,_s,ef,tf,_h,yd,C,ws,qo,Xs,Ya,Td,0,ie,lh,qc,ch)}(vi,Nh,fd,Qi,ho,Au,mc,vi.layers[0],vi.collisionBoxArray,si.index,si.sourceLayerIndex,vi.index,wh,mh,Xh,hi,Oh,Zh,vh,zf,si,Eo,eh,Jc,Yo)};if(Mh==="line")for(var uh=0,Kh=Cn(si.geometry,0,0,8192,8192);uh<Kh.length;uh+=1)for(var Uh=Kh[uh],yh=0,Bh=xi(Uh,rh,Fh,Qi.vertical||Ff,ho,24,Mf,vi.overscaling,8192);yh<Bh.length;yh+=1){var Ph=Bh[yh];Ff&&N(vi,Ff.text,Yh,Ph)||nh(Uh,Ph)}else if(Mh==="line-center")for(var bh=0,Vh=si.geometry;bh<Vh.length;bh+=1){var Gh=Vh[bh];if(Gh.length>1){var Lh=Tu(Gh,Fh,Qi.vertical||Ff,ho,24,Mf);Lh&&nh(Gh,Lh)}}else if(si.type==="Polygon")for(var Rh=0,xh=k(si.geometry,0);Rh<xh.length;Rh+=1){var Ih=xh[Rh],Eh=Rn(Ih,16);nh(Ih[0],new xo(Eh.x,Eh.y,0))}else if(si.type==="LineString")for(var Uf=0,Dh=si.geometry;Uf<Dh.length;Uf+=1){var $h=Dh[Uf];nh($h,new xo($h[0].x,$h[0].y,0))}else if(si.type==="Point")for(var Jh=0,nd=si.geometry;Jh<nd.length;Jh+=1)for(var ad=0,id=nd[Jh];ad<id.length;ad+=1){var Qh=id[ad];nh([Qh],new xo(Qh.x,Qh.y,0))}}(e,Ir,Xn,rl,u,te,Ln,$n,Ta,uu,A)},dr=0,br=e.features;dr<br.length;dr+=1)tr();g&&e.generateCollisionDebugBuffers()},o.perspective=function(e,t,r,u,f){var g,A=1/Math.tan(t/2);return e[0]=A/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(g=1/(u-f)),e[14]=2*f*u*g):(e[10]=-1,e[14]=-2*u),e},o.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},o.plugin=as,o.polygonIntersectsPolygon=bu,o.postMapLoadEvent=pt,o.postTurnstileEvent=sr,o.potpack=zr,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Mn,o.registerForPluginStateChange=function(e){return e({pluginStatus:ko,pluginURL:fl}),uf.on("pluginStateChange",e),e},o.renderColorRamp=gs,o.rotate=function(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3],L=Math.sin(r),V=Math.cos(r);return e[0]=u*V+g*L,e[1]=f*V+A*L,e[2]=u*-L+g*V,e[3]=f*-L+A*V,e},o.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),g=t[4],A=t[5],L=t[6],V=t[7],te=t[8],de=t[9],Se=t[10],Oe=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*f+te*u,e[5]=A*f+de*u,e[6]=L*f+Se*u,e[7]=V*f+Oe*u,e[8]=te*f-g*u,e[9]=de*f-A*u,e[10]=Se*f-L*u,e[11]=Oe*f-V*u,e},o.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),g=t[0],A=t[1],L=t[2],V=t[3],te=t[4],de=t[5],Se=t[6],Oe=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*f+te*u,e[1]=A*f+de*u,e[2]=L*f+Se*u,e[3]=V*f+Oe*u,e[4]=te*f-g*u,e[5]=de*f-A*u,e[6]=Se*f-L*u,e[7]=Oe*f-V*u,e},o.scale=function(e,t,r){var u=r[0],f=r[1],g=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},o.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},o.setCacheLimits=function(e,t){At=e,mt=t},o.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),ko==="deferred"||ko==="loading"||ko==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");fl=ye.resolveURL(e),ko="deferred",$o=t,zl(),r||Rs()},o.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},o.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},o.styleSpec=Ge,o.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},o.symbolSize=os,o.transformMat3=function(e,t,r){var u=t[0],f=t[1],g=t[2];return e[0]=u*r[0]+f*r[3]+g*r[6],e[1]=u*r[1]+f*r[4]+g*r[7],e[2]=u*r[2]+f*r[5]+g*r[8],e},o.transformMat4=Gs,o.translate=function(e,t,r){var u,f,g,A,L,V,te,de,Se,Oe,it,Ct,xt=r[0],Wt=r[1],Ht=r[2];return t===e?(e[12]=t[0]*xt+t[4]*Wt+t[8]*Ht+t[12],e[13]=t[1]*xt+t[5]*Wt+t[9]*Ht+t[13],e[14]=t[2]*xt+t[6]*Wt+t[10]*Ht+t[14],e[15]=t[3]*xt+t[7]*Wt+t[11]*Ht+t[15]):(f=t[1],g=t[2],A=t[3],L=t[4],V=t[5],te=t[6],de=t[7],Se=t[8],Oe=t[9],it=t[10],Ct=t[11],e[0]=u=t[0],e[1]=f,e[2]=g,e[3]=A,e[4]=L,e[5]=V,e[6]=te,e[7]=de,e[8]=Se,e[9]=Oe,e[10]=it,e[11]=Ct,e[12]=u*xt+L*Wt+Se*Ht+t[12],e[13]=f*xt+V*Wt+Oe*Ht+t[13],e[14]=g*xt+te*Wt+it*Ht+t[14],e[15]=A*xt+de*Wt+Ct*Ht+t[15]),e},o.triggerPluginCompletionEvent=_l,o.uniqueId=Ze,o.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},o.validateLight=xf,o.validateStyle=ec,o.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},o.vectorTile=Ro,o.version="1.13.0",o.warnOnce=Le,o.webpSupported=Be,o.window=Y,o.wrap=dt}),z(["./shared"],function(o){"use strict";function Z(F){var W=typeof F;if(W==="number"||W==="boolean"||W==="string"||F==null)return JSON.stringify(F);if(Array.isArray(F)){for(var le="[",pe=0,at=F;pe<at.length;pe+=1)le+=Z(at[pe])+",";return le+"]"}for(var Tt=Object.keys(F).sort(),jt="{",Ge=0;Ge<Tt.length;Ge++)jt+=JSON.stringify(Tt[Ge])+":"+Z(F[Tt[Ge]])+",";return jt+"}"}function D(F){for(var W="",le=0,pe=o.refProperties;le<pe.length;le+=1)W+="/"+Z(F[pe[le]]);return W}var K=function(W){this.keyCache={},W&&this.replace(W)};K.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},K.prototype.update=function(F,W){for(var le=this,pe=0,at=F;pe<at.length;pe+=1){var Tt=at[pe];this._layerConfigs[Tt.id]=Tt;var jt=this._layers[Tt.id]=o.createStyleLayer(Tt);jt._featureFilter=o.featureFilter(jt.filter),this.keyCache[Tt.id]&&delete this.keyCache[Tt.id]}for(var Ge=0,wt=W;Ge<wt.length;Ge+=1){var ir=wt[Ge];delete this.keyCache[ir],delete this._layerConfigs[ir],delete this._layers[ir]}this.familiesBySource={};for(var Ur=0,Vr=function(dn,vn){for(var Sr={},Kr=0;Kr<dn.length;Kr++){var wn=vn&&vn[dn[Kr].id]||D(dn[Kr]);vn&&(vn[dn[Kr].id]=wn);var Ka=Sr[wn];Ka||(Ka=Sr[wn]=[]),Ka.push(dn[Kr])}var da=[];for(var Oa in Sr)da.push(Sr[Oa]);return da}(o.values(this._layerConfigs),this.keyCache);Ur<Vr.length;Ur+=1){var or=Vr[Ur].map(function(dn){return le._layers[dn.id]}),Fr=or[0];if(Fr.visibility!=="none"){var Sn=Fr.source||"",fn=this.familiesBySource[Sn];fn||(fn=this.familiesBySource[Sn]={});var Er=Fr.sourceLayer||"_geojsonTileLayer",Tn=fn[Er];Tn||(Tn=fn[Er]=[]),Tn.push(or)}}};var re=function(W){var le={},pe=[];for(var at in W){var Tt=W[at],jt=le[at]={};for(var Ge in Tt){var wt=Tt[+Ge];if(wt&&wt.bitmap.width!==0&&wt.bitmap.height!==0){var ir={x:0,y:0,w:wt.bitmap.width+2,h:wt.bitmap.height+2};pe.push(ir),jt[Ge]={rect:ir,metrics:wt.metrics}}}}var Ur=o.potpack(pe),Vr=new o.AlphaImage({width:Ur.w||1,height:Ur.h||1});for(var or in W){var Fr=W[or];for(var Sn in Fr){var fn=Fr[+Sn];if(fn&&fn.bitmap.width!==0&&fn.bitmap.height!==0){var Er=le[or][Sn].rect;o.AlphaImage.copy(fn.bitmap,Vr,{x:0,y:0},{x:Er.x+1,y:Er.y+1},fn.bitmap)}}}this.image=Vr,this.positions=le};o.register("GlyphAtlas",re);var fe=function(W){this.tileID=new o.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId};function Y(F,W,le){for(var pe=new o.EvaluationParameters(W),at=0,Tt=F;at<Tt.length;at+=1)Tt[at].recalculate(pe,le)}function Fe(F,W){var le=o.getArrayBuffer(F.request,function(pe,at,Tt,jt){pe?W(pe):at&&W(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(at)),rawData:at,cacheControl:Tt,expires:jt})});return function(){le.cancel(),W()}}fe.prototype.parse=function(F,W,le,pe,at){var Tt=this;this.status="parsing",this.data=F,this.collisionBoxArray=new o.CollisionBoxArray;var jt=new o.DictionaryCoder(Object.keys(F.layers).sort()),Ge=new o.FeatureIndex(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];var wt,ir,Ur,Vr,or={},Fr={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},Sn=W.familiesBySource[this.source];for(var fn in Sn){var Er=F.layers[fn];if(Er){Er.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+fn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Tn=jt.encode(fn),dn=[],vn=0;vn<Er.length;vn++){var Sr=Er.feature(vn),Kr=Ge.getId(Sr,fn);dn.push({feature:Sr,id:Kr,index:vn,sourceLayerIndex:Tn})}for(var wn=0,Ka=Sn[fn];wn<Ka.length;wn+=1){var da=Ka[wn],Oa=da[0];Oa.minzoom&&this.zoom<Math.floor(Oa.minzoom)||Oa.maxzoom&&this.zoom>=Oa.maxzoom||Oa.visibility!=="none"&&(Y(da,this.zoom,le),(or[Oa.id]=Oa.createBucket({index:Ge.bucketLayerIDs.length,layers:da,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tn,sourceID:this.source})).populate(dn,Fr,this.tileID.canonical),Ge.bucketLayerIDs.push(da.map(function(Ma){return Ma.id})))}}}var Ia=o.mapObject(Fr.glyphDependencies,function(Ma){return Object.keys(Ma).map(Number)});Object.keys(Ia).length?pe.send("getGlyphs",{uid:this.uid,stacks:Ia},function(Ma,ya){wt||(wt=Ma,ir=ya,gi.call(Tt))}):ir={};var Xi=Object.keys(Fr.iconDependencies);Xi.length?pe.send("getImages",{icons:Xi,source:this.source,tileID:this.tileID,type:"icons"},function(Ma,ya){wt||(wt=Ma,Ur=ya,gi.call(Tt))}):Ur={};var ha=Object.keys(Fr.patternDependencies);function gi(){if(wt)return at(wt);if(ir&&Ur&&Vr){var Ma=new re(ir),ya=new o.ImageAtlas(Ur,Vr);for(var la in or){var Li=or[la];Li instanceof o.SymbolBucket?(Y(Li.layers,this.zoom,le),o.performSymbolLayout(Li,ir,Ma.positions,Ur,ya.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Li.hasPattern&&(Li instanceof o.LineBucket||Li instanceof o.FillBucket||Li instanceof o.FillExtrusionBucket)&&(Y(Li.layers,this.zoom,le),Li.addFeatures(Fr,this.tileID.canonical,ya.patternPositions))}this.status="done",at(null,{buckets:o.values(or).filter(function(po){return!po.isEmpty()}),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ma.image,imageAtlas:ya,glyphMap:this.returnDependencies?ir:null,iconMap:this.returnDependencies?Ur:null,glyphPositions:this.returnDependencies?Ma.positions:null})}}ha.length?pe.send("getImages",{icons:ha,source:this.source,tileID:this.tileID,type:"patterns"},function(Ma,ya){wt||(wt=Ma,Vr=ya,gi.call(Tt))}):Vr={},gi.call(this)};var We=function(W,le,pe,at){this.actor=W,this.layerIndex=le,this.availableImages=pe,this.loadVectorData=at||Fe,this.loading={},this.loaded={}};We.prototype.loadTile=function(F,W){var le=this,pe=F.uid;this.loading||(this.loading={});var at=!!(F&&F.request&&F.request.collectResourceTiming)&&new o.RequestPerformance(F.request),Tt=this.loading[pe]=new fe(F);Tt.abort=this.loadVectorData(F,function(jt,Ge){if(delete le.loading[pe],jt||!Ge)return Tt.status="done",le.loaded[pe]=Tt,W(jt);var wt=Ge.rawData,ir={};Ge.expires&&(ir.expires=Ge.expires),Ge.cacheControl&&(ir.cacheControl=Ge.cacheControl);var Ur={};if(at){var Vr=at.finish();Vr&&(Ur.resourceTiming=JSON.parse(JSON.stringify(Vr)))}Tt.vectorTile=Ge.vectorTile,Tt.parse(Ge.vectorTile,le.layerIndex,le.availableImages,le.actor,function(or,Fr){if(or||!Fr)return W(or);W(null,o.extend({rawTileData:wt.slice(0)},Fr,ir,Ur))}),le.loaded=le.loaded||{},le.loaded[pe]=Tt})},We.prototype.reloadTile=function(F,W){var le=this,pe=this.loaded,at=F.uid,Tt=this;if(pe&&pe[at]){var jt=pe[at];jt.showCollisionBoxes=F.showCollisionBoxes;var Ge=function(ir,Ur){var Vr=jt.reloadCallback;Vr&&(delete jt.reloadCallback,jt.parse(jt.vectorTile,Tt.layerIndex,le.availableImages,Tt.actor,Vr)),W(ir,Ur)};jt.status==="parsing"?jt.reloadCallback=Ge:jt.status==="done"&&(jt.vectorTile?jt.parse(jt.vectorTile,this.layerIndex,this.availableImages,this.actor,Ge):Ge())}},We.prototype.abortTile=function(F,W){var le=this.loading,pe=F.uid;le&&le[pe]&&le[pe].abort&&(le[pe].abort(),delete le[pe]),W()},We.prototype.removeTile=function(F,W){var le=this.loaded,pe=F.uid;le&&le[pe]&&delete le[pe],W()};var ge=o.window.ImageBitmap,we=function(){this.loaded={}};function dt(F,W){if(F.length!==0){ke(F[0],W);for(var le=1;le<F.length;le++)ke(F[le],!W)}}function ke(F,W){for(var le=0,pe=0,at=F.length,Tt=at-1;pe<at;Tt=pe++)le+=(F[pe][0]-F[Tt][0])*(F[Tt][1]+F[pe][1]);le>=0!=!!W&&F.reverse()}we.prototype.loadTile=function(F,W){var le=F.uid,pe=F.encoding,at=F.rawImageData,Tt=ge&&at instanceof ge?this.getImageData(at):at,jt=new o.DEMData(le,Tt,pe);this.loaded=this.loaded||{},this.loaded[le]=jt,W(null,jt)},we.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:W.width,height:W.height},W.data)},we.prototype.removeTile=function(F){var W=this.loaded,le=F.uid;W&&W[le]&&delete W[le]};var Et=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ze=function(W){this._feature=W,this.extent=o.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))};Ze.prototype.loadGeometry=function(){if(this._feature.type===1){for(var F=[],W=0,le=this._feature.geometry;W<le.length;W+=1){var pe=le[W];F.push([new o.Point$1(pe[0],pe[1])])}return F}for(var at=[],Tt=0,jt=this._feature.geometry;Tt<jt.length;Tt+=1){for(var Ge=[],wt=0,ir=jt[Tt];wt<ir.length;wt+=1){var Ur=ir[wt];Ge.push(new o.Point$1(Ur[0],Ur[1]))}at.push(Ge)}return at},Ze.prototype.toGeoJSON=function(F,W,le){return Et.call(this,F,W,le)};var vt=function(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=W.length,this._features=W};vt.prototype.feature=function(F){return new Ze(this._features[F])};var Qe=o.vectorTile.VectorTileFeature,yt=_t;function _t(F,W){this.options=W||{},this.features=F,this.length=F.length}function De(F,W){this.id=typeof F.id=="number"?F.id:void 0,this.type=F.type,this.rawGeometry=F.type===1?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=W||4096}_t.prototype.feature=function(F){return new De(this.features[F],this.options.extent)},De.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var W=0;W<F.length;W++){for(var le=F[W],pe=[],at=0;at<le.length;at++)pe.push(new o.Point$1(le[at][0],le[at][1]));this.geometry.push(pe)}return this.geometry},De.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,W=1/0,le=-1/0,pe=1/0,at=-1/0,Tt=0;Tt<F.length;Tt++)for(var jt=F[Tt],Ge=0;Ge<jt.length;Ge++){var wt=jt[Ge];W=Math.min(W,wt.x),le=Math.max(le,wt.x),pe=Math.min(pe,wt.y),at=Math.max(at,wt.y)}return[W,pe,le,at]},De.prototype.toGeoJSON=Qe.prototype.toGeoJSON;var Ne=st,Ue=yt;function st(F){var W=new o.pbf;return function(le,pe){for(var at in le.layers)pe.writeMessage(3,Le,le.layers[at])}(F,W),W.finish()}function Le(F,W){var le;W.writeVarintField(15,F.version||1),W.writeStringField(1,F.name||""),W.writeVarintField(5,F.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<F.length;le++)pe.feature=F.feature(le),W.writeMessage(2,ut,pe);var at=pe.keys;for(le=0;le<at.length;le++)W.writeStringField(3,at[le]);var Tt=pe.values;for(le=0;le<Tt.length;le++)W.writeMessage(4,Q,Tt[le])}function ut(F,W){var le=F.feature;le.id!==void 0&&W.writeVarintField(1,le.id),W.writeMessage(2,Gt,F),W.writeVarintField(3,le.type),W.writeMessage(4,oe,le)}function Gt(F,W){var le=F.feature,pe=F.keys,at=F.values,Tt=F.keycache,jt=F.valuecache;for(var Ge in le.properties){var wt=Tt[Ge];wt===void 0&&(pe.push(Ge),Tt[Ge]=wt=pe.length-1),W.writeVarint(wt);var ir=le.properties[Ge],Ur=typeof ir;Ur!=="string"&&Ur!=="boolean"&&Ur!=="number"&&(ir=JSON.stringify(ir));var Vr=Ur+":"+ir,or=jt[Vr];or===void 0&&(at.push(ir),jt[Vr]=or=at.length-1),W.writeVarint(or)}}function Kt(F,W){return(W<<3)+(7&F)}function ar(F){return F<<1^F>>31}function oe(F,W){for(var le=F.loadGeometry(),pe=F.type,at=0,Tt=0,jt=le.length,Ge=0;Ge<jt;Ge++){var wt=le[Ge],ir=1;pe===1&&(ir=wt.length),W.writeVarint(Kt(1,ir));for(var Ur=pe===3?wt.length-1:wt.length,Vr=0;Vr<Ur;Vr++){Vr===1&&pe!==1&&W.writeVarint(Kt(2,Ur-1));var or=wt[Vr].x-at,Fr=wt[Vr].y-Tt;W.writeVarint(ar(or)),W.writeVarint(ar(Fr)),at+=or,Tt+=Fr}pe===3&&W.writeVarint(Kt(7,1))}}function Q(F,W){var le=typeof F;le==="string"?W.writeStringField(1,F):le==="boolean"?W.writeBooleanField(7,F):le==="number"&&(F%1!=0?W.writeDoubleField(3,F):F<0?W.writeSVarintField(6,F):W.writeVarintField(5,F))}function H(F,W,le,pe){Ce(F,le,pe),Ce(W,2*le,2*pe),Ce(W,2*le+1,2*pe+1)}function Ce(F,W,le){var pe=F[W];F[W]=F[le],F[le]=pe}function Ee(F,W,le,pe){var at=F-le,Tt=W-pe;return at*at+Tt*Tt}Ne.fromVectorTileJs=st,Ne.fromGeojsonVt=function(F,W){W=W||{};var le={};for(var pe in F)le[pe]=new yt(F[pe].features,W),le[pe].name=pe,le[pe].version=W.version,le[pe].extent=W.extent;return st({layers:le})},Ne.GeoJSONWrapper=Ue;var _e=function(W){return W[0]},ve=function(W){return W[1]},rt=function(W,le,pe,at,Tt){le===void 0&&(le=_e),pe===void 0&&(pe=ve),at===void 0&&(at=64),Tt===void 0&&(Tt=Float64Array),this.nodeSize=at,this.points=W;for(var jt=W.length<65536?Uint16Array:Uint32Array,Ge=this.ids=new jt(W.length),wt=this.coords=new Tt(2*W.length),ir=0;ir<W.length;ir++)Ge[ir]=ir,wt[2*ir]=le(W[ir]),wt[2*ir+1]=pe(W[ir]);!function Ur(Vr,or,Fr,Sn,fn,Er){if(!(fn-Sn<=Fr)){var Tn=Sn+fn>>1;!function dn(vn,Sr,Kr,wn,Ka,da){for(;Ka>wn;){if(Ka-wn>600){var Oa=Ka-wn+1,Ia=Kr-wn+1,Xi=Math.log(Oa),ha=.5*Math.exp(2*Xi/3),gi=.5*Math.sqrt(Xi*ha*(Oa-ha)/Oa)*(Ia-Oa/2<0?-1:1);dn(vn,Sr,Kr,Math.max(wn,Math.floor(Kr-Ia*ha/Oa+gi)),Math.min(Ka,Math.floor(Kr+(Oa-Ia)*ha/Oa+gi)),da)}var Ma=Sr[2*Kr+da],ya=wn,la=Ka;for(H(vn,Sr,wn,Kr),Sr[2*Ka+da]>Ma&&H(vn,Sr,wn,Ka);ya<la;){for(H(vn,Sr,ya,la),ya++,la--;Sr[2*ya+da]<Ma;)ya++;for(;Sr[2*la+da]>Ma;)la--}Sr[2*wn+da]===Ma?H(vn,Sr,wn,la):H(vn,Sr,++la,Ka),la<=Kr&&(wn=la+1),Kr<=la&&(Ka=la-1)}}(Vr,or,Tn,Sn,fn,Er%2),Ur(Vr,or,Fr,Sn,Tn-1,Er+1),Ur(Vr,or,Fr,Tn+1,fn,Er+1)}}(Ge,wt,at,0,Ge.length-1,0)};rt.prototype.range=function(F,W,le,pe){return function(at,Tt,jt,Ge,wt,ir,Ur){for(var Vr,or,Fr=[0,at.length-1,0],Sn=[];Fr.length;){var fn=Fr.pop(),Er=Fr.pop(),Tn=Fr.pop();if(Er-Tn<=Ur)for(var dn=Tn;dn<=Er;dn++)or=Tt[2*dn+1],(Vr=Tt[2*dn])>=jt&&Vr<=wt&&or>=Ge&&or<=ir&&Sn.push(at[dn]);else{var vn=Math.floor((Tn+Er)/2);or=Tt[2*vn+1],(Vr=Tt[2*vn])>=jt&&Vr<=wt&&or>=Ge&&or<=ir&&Sn.push(at[vn]);var Sr=(fn+1)%2;(fn===0?jt<=Vr:Ge<=or)&&(Fr.push(Tn),Fr.push(vn-1),Fr.push(Sr)),(fn===0?wt>=Vr:ir>=or)&&(Fr.push(vn+1),Fr.push(Er),Fr.push(Sr))}}return Sn}(this.ids,this.coords,F,W,le,pe,this.nodeSize)},rt.prototype.within=function(F,W,le){return function(pe,at,Tt,jt,Ge,wt){for(var ir=[0,pe.length-1,0],Ur=[],Vr=Ge*Ge;ir.length;){var or=ir.pop(),Fr=ir.pop(),Sn=ir.pop();if(Fr-Sn<=wt)for(var fn=Sn;fn<=Fr;fn++)Ee(at[2*fn],at[2*fn+1],Tt,jt)<=Vr&&Ur.push(pe[fn]);else{var Er=Math.floor((Sn+Fr)/2),Tn=at[2*Er],dn=at[2*Er+1];Ee(Tn,dn,Tt,jt)<=Vr&&Ur.push(pe[Er]);var vn=(or+1)%2;(or===0?Tt-Ge<=Tn:jt-Ge<=dn)&&(ir.push(Sn),ir.push(Er-1),ir.push(vn)),(or===0?Tt+Ge>=Tn:jt+Ge>=dn)&&(ir.push(Er+1),ir.push(Fr),ir.push(vn))}}return Ur}(this.ids,this.coords,F,W,le,this.nodeSize)};var $t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(W){return W}},St=function(W){this.options=w(Object.create($t),W),this.trees=new Array(this.options.maxZoom+1)};function ye(F,W,le,pe,at){return{x:F,y:W,zoom:1/0,id:le,parentId:-1,numPoints:pe,properties:at}}function be(F,W){var le=F.geometry.coordinates,pe=le[1];return{x:Pe(le[0]),y:ht(pe),zoom:1/0,index:W,parentId:-1}}function Be(F){return{type:"Feature",id:F.id,properties:lt(F),geometry:{type:"Point",coordinates:[(pe=F.x,360*(pe-.5)),(W=F.y,le=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var W,le,pe}function lt(F){var W=F.numPoints,le=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return w(w({},F.properties),{cluster:!0,cluster_id:F.id,point_count:W,point_count_abbreviated:le})}function Pe(F){return F/360+.5}function ht(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function w(F,W){for(var le in W)F[le]=W[le];return F}function I(F){return F.x}function q(F){return F.y}function ce(F,W,le,pe,at,Tt){var jt=at-le,Ge=Tt-pe;if(jt!==0||Ge!==0){var wt=((F-le)*jt+(W-pe)*Ge)/(jt*jt+Ge*Ge);wt>1?(le=at,pe=Tt):wt>0&&(le+=jt*wt,pe+=Ge*wt)}return(jt=F-le)*jt+(Ge=W-pe)*Ge}function Ve(F,W,le,pe){var at={id:F===void 0?null:F,type:W,geometry:le,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Tt){var jt=Tt.geometry,Ge=Tt.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")$e(Tt,jt);else if(Ge==="Polygon"||Ge==="MultiLineString")for(var wt=0;wt<jt.length;wt++)$e(Tt,jt[wt]);else if(Ge==="MultiPolygon")for(wt=0;wt<jt.length;wt++)for(var ir=0;ir<jt[wt].length;ir++)$e(Tt,jt[wt][ir])}(at),at}function $e(F,W){for(var le=0;le<W.length;le+=3)F.minX=Math.min(F.minX,W[le]),F.minY=Math.min(F.minY,W[le+1]),F.maxX=Math.max(F.maxX,W[le]),F.maxY=Math.max(F.maxY,W[le+1])}function gt(F,W,le,pe){if(W.geometry){var at=W.geometry.coordinates,Tt=W.geometry.type,jt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Ge=[],wt=W.id;if(le.promoteId?wt=W.properties[le.promoteId]:le.generateId&&(wt=pe||0),Tt==="Point")nt(at,Ge);else if(Tt==="MultiPoint")for(var ir=0;ir<at.length;ir++)nt(at[ir],Ge);else if(Tt==="LineString")kt(at,Ge,jt,!1);else if(Tt==="MultiLineString"){if(le.lineMetrics){for(ir=0;ir<at.length;ir++)kt(at[ir],Ge=[],jt,!1),F.push(Ve(wt,"LineString",Ge,W.properties));return}$(at,Ge,jt,!1)}else if(Tt==="Polygon")$(at,Ge,jt,!0);else{if(Tt!=="MultiPolygon"){if(Tt==="GeometryCollection"){for(ir=0;ir<W.geometry.geometries.length;ir++)gt(F,{id:wt,geometry:W.geometry.geometries[ir],properties:W.properties},le,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ir=0;ir<at.length;ir++){var Ur=[];$(at[ir],Ur,jt,!0),Ge.push(Ur)}}F.push(Ve(wt,Tt,Ge,W.properties))}}function nt(F,W){W.push(Ke(F[0])),W.push(ae(F[1])),W.push(0)}function kt(F,W,le,pe){for(var at,Tt,jt=0,Ge=0;Ge<F.length;Ge++){var wt=Ke(F[Ge][0]),ir=ae(F[Ge][1]);W.push(wt),W.push(ir),W.push(0),Ge>0&&(jt+=pe?(at*ir-wt*Tt)/2:Math.sqrt(Math.pow(wt-at,2)+Math.pow(ir-Tt,2))),at=wt,Tt=ir}var Ur=W.length-3;W[2]=1,function Vr(or,Fr,Sn,fn){for(var Er,Tn=fn,dn=Sn-Fr>>1,vn=Sn-Fr,Sr=or[Fr],Kr=or[Fr+1],wn=or[Sn],Ka=or[Sn+1],da=Fr+3;da<Sn;da+=3){var Oa=ce(or[da],or[da+1],Sr,Kr,wn,Ka);if(Oa>Tn)Er=da,Tn=Oa;else if(Oa===Tn){var Ia=Math.abs(da-dn);Ia<vn&&(Er=da,vn=Ia)}}Tn>fn&&(Er-Fr>3&&Vr(or,Fr,Er,fn),or[Er+2]=Tn,Sn-Er>3&&Vr(or,Er,Sn,fn))}(W,0,Ur,le),W[Ur+2]=1,W.size=Math.abs(jt),W.start=0,W.end=W.size}function $(F,W,le,pe){for(var at=0;at<F.length;at++){var Tt=[];kt(F[at],Tt,le,pe),W.push(Tt)}}function Ke(F){return F/360+.5}function ae(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function et(F,W,le,pe,at,Tt,jt,Ge){if(pe/=W,Tt>=(le/=W)&&jt<pe)return F;if(jt<le||Tt>=pe)return null;for(var wt=[],ir=0;ir<F.length;ir++){var Ur=F[ir],Vr=Ur.geometry,or=Ur.type,Fr=at===0?Ur.minX:Ur.minY,Sn=at===0?Ur.maxX:Ur.maxY;if(Fr>=le&&Sn<pe)wt.push(Ur);else if(!(Sn<le||Fr>=pe)){var fn=[];if(or==="Point"||or==="MultiPoint")zt(Vr,fn,le,pe,at);else if(or==="LineString")sr(Vr,fn,le,pe,at,!1,Ge.lineMetrics);else if(or==="MultiLineString")pt(Vr,fn,le,pe,at,!1);else if(or==="Polygon")pt(Vr,fn,le,pe,at,!0);else if(or==="MultiPolygon")for(var Er=0;Er<Vr.length;Er++){var Tn=[];pt(Vr[Er],Tn,le,pe,at,!0),Tn.length&&fn.push(Tn)}if(fn.length){if(Ge.lineMetrics&&or==="LineString"){for(Er=0;Er<fn.length;Er++)wt.push(Ve(Ur.id,or,fn[Er],Ur.tags));continue}or!=="LineString"&&or!=="MultiLineString"||(fn.length===1?(or="LineString",fn=fn[0]):or="MultiLineString"),or!=="Point"&&or!=="MultiPoint"||(or=fn.length===3?"Point":"MultiPoint"),wt.push(Ve(Ur.id,or,fn,Ur.tags))}}}return wt.length?wt:null}function zt(F,W,le,pe,at){for(var Tt=0;Tt<F.length;Tt+=3){var jt=F[Tt+at];jt>=le&&jt<=pe&&(W.push(F[Tt]),W.push(F[Tt+1]),W.push(F[Tt+2]))}}function sr(F,W,le,pe,at,Tt,jt){for(var Ge,wt,ir=ft(F),Ur=at===0?mt:Me,Vr=F.start,or=0;or<F.length-3;or+=3){var Fr=F[or],Sn=F[or+1],fn=F[or+2],Er=F[or+3],Tn=F[or+4],dn=at===0?Fr:Sn,vn=at===0?Er:Tn,Sr=!1;jt&&(Ge=Math.sqrt(Math.pow(Fr-Er,2)+Math.pow(Sn-Tn,2))),dn<le?vn>le&&(wt=Ur(ir,Fr,Sn,Er,Tn,le),jt&&(ir.start=Vr+Ge*wt)):dn>pe?vn<pe&&(wt=Ur(ir,Fr,Sn,Er,Tn,pe),jt&&(ir.start=Vr+Ge*wt)):At(ir,Fr,Sn,fn),vn<le&&dn>=le&&(wt=Ur(ir,Fr,Sn,Er,Tn,le),Sr=!0),vn>pe&&dn<=pe&&(wt=Ur(ir,Fr,Sn,Er,Tn,pe),Sr=!0),!Tt&&Sr&&(jt&&(ir.end=Vr+Ge*wt),W.push(ir),ir=ft(F)),jt&&(Vr+=Ge)}var Kr=F.length-3;Fr=F[Kr],Sn=F[Kr+1],fn=F[Kr+2],(dn=at===0?Fr:Sn)>=le&&dn<=pe&&At(ir,Fr,Sn,fn),Kr=ir.length-3,Tt&&Kr>=3&&(ir[Kr]!==ir[0]||ir[Kr+1]!==ir[1])&&At(ir,ir[0],ir[1],ir[2]),ir.length&&W.push(ir)}function ft(F){var W=[];return W.size=F.size,W.start=F.start,W.end=F.end,W}function pt(F,W,le,pe,at,Tt){for(var jt=0;jt<F.length;jt++)sr(F[jt],W,le,pe,at,Tt,!1)}function At(F,W,le,pe){F.push(W),F.push(le),F.push(pe)}function mt(F,W,le,pe,at,Tt){var jt=(Tt-W)/(pe-W);return F.push(Tt),F.push(le+(at-le)*jt),F.push(1),jt}function Me(F,W,le,pe,at,Tt){var jt=(Tt-le)/(at-le);return F.push(W+(pe-W)*jt),F.push(Tt),F.push(1),jt}function ct(F,W){for(var le=[],pe=0;pe<F.length;pe++){var at,Tt=F[pe],jt=Tt.type;if(jt==="Point"||jt==="MultiPoint"||jt==="LineString")at=qe(Tt.geometry,W);else if(jt==="MultiLineString"||jt==="Polygon"){at=[];for(var Ge=0;Ge<Tt.geometry.length;Ge++)at.push(qe(Tt.geometry[Ge],W))}else if(jt==="MultiPolygon")for(at=[],Ge=0;Ge<Tt.geometry.length;Ge++){for(var wt=[],ir=0;ir<Tt.geometry[Ge].length;ir++)wt.push(qe(Tt.geometry[Ge][ir],W));at.push(wt)}le.push(Ve(Tt.id,jt,at,Tt.tags))}return le}function qe(F,W){var le=[];le.size=F.size,F.start!==void 0&&(le.start=F.start,le.end=F.end);for(var pe=0;pe<F.length;pe+=3)le.push(F[pe]+W,F[pe+1],F[pe+2]);return le}function Vt(F,W){if(F.transformed)return F;var le,pe,at,Tt=1<<F.z,jt=F.x,Ge=F.y;for(le=0;le<F.features.length;le++){var wt=F.features[le],ir=wt.geometry,Ur=wt.type;if(wt.geometry=[],Ur===1)for(pe=0;pe<ir.length;pe+=2)wt.geometry.push(pr(ir[pe],ir[pe+1],W,Tt,jt,Ge));else for(pe=0;pe<ir.length;pe++){var Vr=[];for(at=0;at<ir[pe].length;at+=2)Vr.push(pr(ir[pe][at],ir[pe][at+1],W,Tt,jt,Ge));wt.geometry.push(Vr)}}return F.transformed=!0,F}function pr(F,W,le,pe,at,Tt){return[Math.round(le*(F*pe-at)),Math.round(le*(W*pe-Tt))]}function Gr(F,W,le,pe,at){for(var Tt=W===at.maxZoom?0:at.tolerance/((1<<W)*at.extent),jt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:pe,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ge=0;Ge<F.length;Ge++){jt.numFeatures++,ur(jt,F[Ge],Tt,at);var wt=F[Ge].minX,ir=F[Ge].minY,Ur=F[Ge].maxX,Vr=F[Ge].maxY;wt<jt.minX&&(jt.minX=wt),ir<jt.minY&&(jt.minY=ir),Ur>jt.maxX&&(jt.maxX=Ur),Vr>jt.maxY&&(jt.maxY=Vr)}return jt}function ur(F,W,le,pe){var at=W.geometry,Tt=W.type,jt=[];if(Tt==="Point"||Tt==="MultiPoint")for(var Ge=0;Ge<at.length;Ge+=3)jt.push(at[Ge]),jt.push(at[Ge+1]),F.numPoints++,F.numSimplified++;else if(Tt==="LineString")zn(jt,at,F,le,!1,!1);else if(Tt==="MultiLineString"||Tt==="Polygon")for(Ge=0;Ge<at.length;Ge++)zn(jt,at[Ge],F,le,Tt==="Polygon",Ge===0);else if(Tt==="MultiPolygon")for(var wt=0;wt<at.length;wt++){var ir=at[wt];for(Ge=0;Ge<ir.length;Ge++)zn(jt,ir[Ge],F,le,!0,Ge===0)}if(jt.length){var Ur=W.tags||null;if(Tt==="LineString"&&pe.lineMetrics){for(var Vr in Ur={},W.tags)Ur[Vr]=W.tags[Vr];Ur.mapbox_clip_start=at.start/at.size,Ur.mapbox_clip_end=at.end/at.size}var or={geometry:jt,type:Tt==="Polygon"||Tt==="MultiPolygon"?3:Tt==="LineString"||Tt==="MultiLineString"?2:1,tags:Ur};W.id!==null&&(or.id=W.id),F.features.push(or)}}function zn(F,W,le,pe,at,Tt){var jt=pe*pe;if(pe>0&&W.size<(at?jt:pe))le.numPoints+=W.length/3;else{for(var Ge=[],wt=0;wt<W.length;wt+=3)(pe===0||W[wt+2]>jt)&&(le.numSimplified++,Ge.push(W[wt]),Ge.push(W[wt+1])),le.numPoints++;at&&function(ir,Ur){for(var Vr=0,or=0,Fr=ir.length,Sn=Fr-2;or<Fr;Sn=or,or+=2)Vr+=(ir[or]-ir[Sn])*(ir[or+1]+ir[Sn+1]);if(Vr>0===Ur)for(or=0,Fr=ir.length;or<Fr/2;or+=2){var fn=ir[or],Er=ir[or+1];ir[or]=ir[Fr-2-or],ir[or+1]=ir[Fr-1-or],ir[Fr-2-or]=fn,ir[Fr-1-or]=Er}}(Ge,Tt),F.push(Ge)}}function xn(F,W){var le=(W=this.options=function(at,Tt){for(var jt in Tt)at[jt]=Tt[jt];return at}(Object.create(this.options),W)).debug;if(le&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var pe=function(at,Tt){var jt=[];if(at.type==="FeatureCollection")for(var Ge=0;Ge<at.features.length;Ge++)gt(jt,at.features[Ge],Tt,Ge);else gt(jt,at.type==="Feature"?at:{geometry:at},Tt);return jt}(F,W);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(pe=function(at,Tt){var jt=Tt.buffer/Tt.extent,Ge=at,wt=et(at,1,-1-jt,jt,0,-1,2,Tt),ir=et(at,1,1-jt,2+jt,0,-1,2,Tt);return(wt||ir)&&(Ge=et(at,1,-jt,1+jt,0,-1,2,Tt)||[],wt&&(Ge=ct(wt,1).concat(Ge)),ir&&(Ge=Ge.concat(ct(ir,-1)))),Ge}(pe,W)).length&&this.splitTile(pe,0,0,0),le&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function na(F,W,le){return 32*((1<<F)*le+W)+F}function fa(F,W){var le=F.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var pe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!pe)return W(null,null);var at=new vt(pe.features),Tt=Ne(at);Tt.byteOffset===0&&Tt.byteLength===Tt.buffer.byteLength||(Tt=new Uint8Array(Tt)),W(null,{vectorTile:at,rawData:Tt.buffer})}St.prototype.load=function(F){var W=this.options,le=W.log,pe=W.minZoom,at=W.maxZoom,Tt=W.nodeSize;le&&console.time("total time");var jt="prepare "+F.length+" points";le&&console.time(jt),this.points=F;for(var Ge=[],wt=0;wt<F.length;wt++)F[wt].geometry&&Ge.push(be(F[wt],wt));this.trees[at+1]=new rt(Ge,I,q,Tt,Float32Array),le&&console.timeEnd(jt);for(var ir=at;ir>=pe;ir--){var Ur=+Date.now();Ge=this._cluster(Ge,ir),this.trees[ir]=new rt(Ge,I,q,Tt,Float32Array),le&&console.log("z%d: %d clusters in %dms",ir,Ge.length,+Date.now()-Ur)}return le&&console.timeEnd("total time"),this},St.prototype.getClusters=function(F,W){var le=((F[0]+180)%360+360)%360-180,pe=Math.max(-90,Math.min(90,F[1])),at=F[2]===180?180:((F[2]+180)%360+360)%360-180,Tt=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)le=-180,at=180;else if(le>at){var jt=this.getClusters([le,pe,180,Tt],W),Ge=this.getClusters([-180,pe,at,Tt],W);return jt.concat(Ge)}for(var wt=this.trees[this._limitZoom(W)],ir=[],Ur=0,Vr=wt.range(Pe(le),ht(Tt),Pe(at),ht(pe));Ur<Vr.length;Ur+=1){var or=wt.points[Vr[Ur]];ir.push(or.numPoints?Be(or):this.points[or.index])}return ir},St.prototype.getChildren=function(F){var W=this._getOriginId(F),le=this._getOriginZoom(F),pe="No cluster with the specified id.",at=this.trees[le];if(!at)throw new Error(pe);var Tt=at.points[W];if(!Tt)throw new Error(pe);for(var jt=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Ge=[],wt=0,ir=at.within(Tt.x,Tt.y,jt);wt<ir.length;wt+=1){var Ur=at.points[ir[wt]];Ur.parentId===F&&Ge.push(Ur.numPoints?Be(Ur):this.points[Ur.index])}if(Ge.length===0)throw new Error(pe);return Ge},St.prototype.getLeaves=function(F,W,le){var pe=[];return this._appendLeaves(pe,F,W=W||10,le=le||0,0),pe},St.prototype.getTile=function(F,W,le){var pe=this.trees[this._limitZoom(F)],at=Math.pow(2,F),Tt=this.options,jt=Tt.radius/Tt.extent,Ge=(le-jt)/at,wt=(le+1+jt)/at,ir={features:[]};return this._addTileFeatures(pe.range((W-jt)/at,Ge,(W+1+jt)/at,wt),pe.points,W,le,at,ir),W===0&&this._addTileFeatures(pe.range(1-jt/at,Ge,1,wt),pe.points,at,le,at,ir),W===at-1&&this._addTileFeatures(pe.range(0,Ge,jt/at,wt),pe.points,-1,le,at,ir),ir.features.length?ir:null},St.prototype.getClusterExpansionZoom=function(F){for(var W=this._getOriginZoom(F)-1;W<=this.options.maxZoom;){var le=this.getChildren(F);if(W++,le.length!==1)break;F=le[0].properties.cluster_id}return W},St.prototype._appendLeaves=function(F,W,le,pe,at){for(var Tt=0,jt=this.getChildren(W);Tt<jt.length;Tt+=1){var Ge=jt[Tt],wt=Ge.properties;if(wt&&wt.cluster?at+wt.point_count<=pe?at+=wt.point_count:at=this._appendLeaves(F,wt.cluster_id,le,pe,at):at<pe?at++:F.push(Ge),F.length===le)break}return at},St.prototype._addTileFeatures=function(F,W,le,pe,at,Tt){for(var jt=0,Ge=F;jt<Ge.length;jt+=1){var wt=W[Ge[jt]],ir=wt.numPoints,Ur={type:1,geometry:[[Math.round(this.options.extent*(wt.x*at-le)),Math.round(this.options.extent*(wt.y*at-pe))]],tags:ir?lt(wt):this.points[wt.index].properties},Vr=void 0;ir?Vr=wt.id:this.options.generateId?Vr=wt.index:this.points[wt.index].id&&(Vr=this.points[wt.index].id),Vr!==void 0&&(Ur.id=Vr),Tt.features.push(Ur)}},St.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},St.prototype._cluster=function(F,W){for(var le=[],pe=this.options,at=pe.reduce,Tt=pe.minPoints,jt=pe.radius/(pe.extent*Math.pow(2,W)),Ge=0;Ge<F.length;Ge++){var wt=F[Ge];if(!(wt.zoom<=W)){wt.zoom=W;for(var ir=this.trees[W+1],Ur=ir.within(wt.x,wt.y,jt),Vr=wt.numPoints||1,or=Vr,Fr=0,Sn=Ur;Fr<Sn.length;Fr+=1){var fn=ir.points[Sn[Fr]];fn.zoom>W&&(or+=fn.numPoints||1)}if(or>=Tt){for(var Er=wt.x*Vr,Tn=wt.y*Vr,dn=at&&Vr>1?this._map(wt,!0):null,vn=(Ge<<5)+(W+1)+this.points.length,Sr=0,Kr=Ur;Sr<Kr.length;Sr+=1){var wn=ir.points[Kr[Sr]];if(!(wn.zoom<=W)){wn.zoom=W;var Ka=wn.numPoints||1;Er+=wn.x*Ka,Tn+=wn.y*Ka,wn.parentId=vn,at&&(dn||(dn=this._map(wt,!0)),at(dn,this._map(wn)))}}wt.parentId=vn,le.push(ye(Er/or,Tn/or,vn,or,dn))}else if(le.push(wt),or>1)for(var da=0,Oa=Ur;da<Oa.length;da+=1){var Ia=ir.points[Oa[da]];Ia.zoom<=W||(Ia.zoom=W,le.push(Ia))}}}return le},St.prototype._getOriginId=function(F){return F-this.points.length>>5},St.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},St.prototype._map=function(F,W){if(F.numPoints)return W?w({},F.properties):F.properties;var le=this.points[F.index].properties,pe=this.options.map(le);return W&&pe===le?w({},pe):pe},xn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xn.prototype.splitTile=function(F,W,le,pe,at,Tt,jt){for(var Ge=[F,W,le,pe],wt=this.options,ir=wt.debug;Ge.length;){pe=Ge.pop(),le=Ge.pop(),W=Ge.pop(),F=Ge.pop();var Ur=1<<W,Vr=na(W,le,pe),or=this.tiles[Vr];if(!or&&(ir>1&&console.time("creation"),or=this.tiles[Vr]=Gr(F,W,le,pe,wt),this.tileCoords.push({z:W,x:le,y:pe}),ir)){ir>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,le,pe,or.numFeatures,or.numPoints,or.numSimplified),console.timeEnd("creation"));var Fr="z"+W;this.stats[Fr]=(this.stats[Fr]||0)+1,this.total++}if(or.source=F,at){if(W===wt.maxZoom||W===at)continue;var Sn=1<<at-W;if(le!==Math.floor(Tt/Sn)||pe!==Math.floor(jt/Sn))continue}else if(W===wt.indexMaxZoom||or.numPoints<=wt.indexMaxPoints)continue;if(or.source=null,F.length!==0){ir>1&&console.time("clipping");var fn,Er,Tn,dn,vn,Sr,Kr=.5*wt.buffer/wt.extent,wn=.5-Kr,Ka=.5+Kr,da=1+Kr;fn=Er=Tn=dn=null,vn=et(F,Ur,le-Kr,le+Ka,0,or.minX,or.maxX,wt),Sr=et(F,Ur,le+wn,le+da,0,or.minX,or.maxX,wt),F=null,vn&&(fn=et(vn,Ur,pe-Kr,pe+Ka,1,or.minY,or.maxY,wt),Er=et(vn,Ur,pe+wn,pe+da,1,or.minY,or.maxY,wt),vn=null),Sr&&(Tn=et(Sr,Ur,pe-Kr,pe+Ka,1,or.minY,or.maxY,wt),dn=et(Sr,Ur,pe+wn,pe+da,1,or.minY,or.maxY,wt),Sr=null),ir>1&&console.timeEnd("clipping"),Ge.push(fn||[],W+1,2*le,2*pe),Ge.push(Er||[],W+1,2*le,2*pe+1),Ge.push(Tn||[],W+1,2*le+1,2*pe),Ge.push(dn||[],W+1,2*le+1,2*pe+1)}}},xn.prototype.getTile=function(F,W,le){var pe=this.options,at=pe.extent,Tt=pe.debug;if(F<0||F>24)return null;var jt=1<<F,Ge=na(F,W=(W%jt+jt)%jt,le);if(this.tiles[Ge])return Vt(this.tiles[Ge],at);Tt>1&&console.log("drilling down to z%d-%d-%d",F,W,le);for(var wt,ir=F,Ur=W,Vr=le;!wt&&ir>0;)ir--,Ur=Math.floor(Ur/2),Vr=Math.floor(Vr/2),wt=this.tiles[na(ir,Ur,Vr)];return wt&&wt.source?(Tt>1&&console.log("found parent tile z%d-%d-%d",ir,Ur,Vr),Tt>1&&console.time("drilling down"),this.splitTile(wt.source,ir,Ur,Vr,F,W,le),Tt>1&&console.timeEnd("drilling down"),this.tiles[Ge]?Vt(this.tiles[Ge],at):null):null};var Hn=function(F){function W(le,pe,at,Tt){F.call(this,le,pe,at,fa),Tt&&(this.loadGeoJSON=Tt)}return F&&(W.__proto__=F),(W.prototype=Object.create(F&&F.prototype)).constructor=W,W.prototype.loadData=function(le,pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=pe,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var pe=this._pendingCallback,at=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Tt=!!(at&&at.request&&at.request.collectResourceTiming)&&new o.RequestPerformance(at.request);this.loadGeoJSON(at,function(jt,Ge){if(jt||!Ge)return pe(jt);if(typeof Ge!="object")return pe(new Error("Input data given to '"+at.source+"' is not a valid GeoJSON object."));!function or(Fr,Sn){var fn,Er=Fr&&Fr.type;if(Er==="FeatureCollection")for(fn=0;fn<Fr.features.length;fn++)or(Fr.features[fn],Sn);else if(Er==="GeometryCollection")for(fn=0;fn<Fr.geometries.length;fn++)or(Fr.geometries[fn],Sn);else if(Er==="Feature")or(Fr.geometry,Sn);else if(Er==="Polygon")dt(Fr.coordinates,Sn);else if(Er==="MultiPolygon")for(fn=0;fn<Fr.coordinates.length;fn++)dt(Fr.coordinates[fn],Sn);return Fr}(Ge,!0);try{if(at.filter){var wt=o.createExpression(at.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(wt.result==="error")throw new Error(wt.value.map(function(or){return or.key+": "+or.message}).join(", "));var ir=Ge.features.filter(function(or){return wt.value.evaluate({zoom:0},or)});Ge={type:"FeatureCollection",features:ir}}le._geoJSONIndex=at.cluster?new St(function(or){var Fr=or.superclusterOptions,Sn=or.clusterProperties;if(!Sn||!Fr)return Fr;for(var fn={},Er={},Tn={accumulated:null,zoom:0},dn={properties:null},vn=Object.keys(Sn),Sr=0,Kr=vn;Sr<Kr.length;Sr+=1){var wn=Kr[Sr],Ka=Sn[wn],da=Ka[0],Oa=o.createExpression(Ka[1]),Ia=o.createExpression(typeof da=="string"?[da,["accumulated"],["get",wn]]:da);fn[wn]=Oa.value,Er[wn]=Ia.value}return Fr.map=function(Xi){dn.properties=Xi;for(var ha={},gi=0,Ma=vn;gi<Ma.length;gi+=1){var ya=Ma[gi];ha[ya]=fn[ya].evaluate(Tn,dn)}return ha},Fr.reduce=function(Xi,ha){dn.properties=ha;for(var gi=0,Ma=vn;gi<Ma.length;gi+=1){var ya=Ma[gi];Tn.accumulated=Xi[ya],Xi[ya]=Er[ya].evaluate(Tn,dn)}},Fr}(at)).load(Ge.features):function(or,Fr){return new xn(or,Fr)}(Ge,at.geojsonVtOptions)}catch(or){return pe(or)}le.loaded={};var Ur={};if(Tt){var Vr=Tt.finish();Vr&&(Ur.resourceTiming={},Ur.resourceTiming[at.source]=JSON.parse(JSON.stringify(Vr)))}pe(null,Ur)})}},W.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(le,pe){var at=this.loaded;return at&&at[le.uid]?F.prototype.reloadTile.call(this,le,pe):this.loadTile(le,pe)},W.prototype.loadGeoJSON=function(le,pe){if(le.request)o.getJSON(le.request,pe);else{if(typeof le.data!="string")return pe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return pe(null,JSON.parse(le.data))}catch(at){return pe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(le,pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),pe()},W.prototype.getClusterExpansionZoom=function(le,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(at){pe(at)}},W.prototype.getClusterChildren=function(le,pe){try{pe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(at){pe(at)}},W.prototype.getClusterLeaves=function(le,pe){try{pe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(at){pe(at)}},W}(We),Gn=function(W){var le=this;this.self=W,this.actor=new o.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:We,geojson:Hn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(pe,at){if(le.workerSourceTypes[pe])throw new Error('Worker source with name "'+pe+'" already registered.');le.workerSourceTypes[pe]=at},this.self.registerRTLTextPlugin=function(pe){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=pe.applyArabicShaping,o.plugin.processBidirectionalText=pe.processBidirectionalText,o.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}};return Gn.prototype.setReferrer=function(F,W){this.referrer=W},Gn.prototype.setImages=function(F,W,le){for(var pe in this.availableImages[F]=W,this.workerSources[F]){var at=this.workerSources[F][pe];for(var Tt in at)at[Tt].availableImages=W}le()},Gn.prototype.setLayers=function(F,W,le){this.getLayerIndex(F).replace(W),le()},Gn.prototype.updateLayers=function(F,W,le){this.getLayerIndex(F).update(W.layers,W.removedIds),le()},Gn.prototype.loadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).loadTile(W,le)},Gn.prototype.loadDEMTile=function(F,W,le){this.getDEMWorkerSource(F,W.source).loadTile(W,le)},Gn.prototype.reloadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).reloadTile(W,le)},Gn.prototype.abortTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).abortTile(W,le)},Gn.prototype.removeTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).removeTile(W,le)},Gn.prototype.removeDEMTile=function(F,W){this.getDEMWorkerSource(F,W.source).removeTile(W)},Gn.prototype.removeSource=function(F,W,le){if(this.workerSources[F]&&this.workerSources[F][W.type]&&this.workerSources[F][W.type][W.source]){var pe=this.workerSources[F][W.type][W.source];delete this.workerSources[F][W.type][W.source],pe.removeSource!==void 0?pe.removeSource(W,le):le()}},Gn.prototype.loadWorkerSource=function(F,W,le){try{this.self.importScripts(W.url),le()}catch(pe){le(pe.toString())}},Gn.prototype.syncRTLPluginState=function(F,W,le){try{o.plugin.setState(W);var pe=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&pe!=null){this.self.importScripts(pe);var at=o.plugin.isParsed();le(at?void 0:new Error("RTL Text Plugin failed to import scripts from "+pe),at)}}catch(Tt){le(Tt.toString())}},Gn.prototype.getAvailableImages=function(F){var W=this.availableImages[F];return W||(W=[]),W},Gn.prototype.getLayerIndex=function(F){var W=this.layerIndexes[F];return W||(W=this.layerIndexes[F]=new K),W},Gn.prototype.getWorkerSource=function(F,W,le){var pe=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][W]||(this.workerSources[F][W]={}),this.workerSources[F][W][le]||(this.workerSources[F][W][le]=new this.workerSourceTypes[W]({send:function(Tt,jt,Ge){pe.actor.send(Tt,jt,Ge,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][W][le]},Gn.prototype.getDEMWorkerSource=function(F,W){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][W]||(this.demWorkerSources[F][W]=new we),this.demWorkerSources[F][W]},Gn.prototype.enforceCacheSizeLimit=function(F,W){o.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Gn(self)),Gn}),z(["./shared"],function(o){"use strict";var Z=o.createCommonjsModule(function(s){function a(b){return!n(b)}function n(b){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var R,j,ue=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(ue);try{j=new Worker(Te),R=!0}catch(Xe){R=!1}return j&&j.terminate(),URL.revokeObjectURL(Te),R}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var R=document.createElement("canvas");R.width=R.height=1;var j=R.getContext("2d");if(!j)return!1;var ue=j.getImageData(0,0,1,1);return ue&&ue.width===R.width}()?(l[O=b&&b.failIfMajorPerformanceCaveat]===void 0&&(l[O]=function(R){var j=function(Te){var Xe=document.createElement("canvas"),Je=Object.create(a.webGLContextAttributes);return Je.failIfMajorPerformanceCaveat=Te,Xe.probablySupportsContext?Xe.probablySupportsContext("webgl",Je)||Xe.probablySupportsContext("experimental-webgl",Je):Xe.supportsContext?Xe.supportsContext("webgl",Je)||Xe.supportsContext("experimental-webgl",Je):Xe.getContext("webgl",Je)||Xe.getContext("experimental-webgl",Je)}(R);if(!j)return!1;var ue=j.createShader(j.VERTEX_SHADER);return!(!ue||j.isContextLost())&&(j.shaderSource(ue,"void main() {}"),j.compileShader(ue),j.getShaderParameter(ue,j.COMPILE_STATUS)===!0)}(O)),l[O]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var O}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var b=o.window.document.createElement(a);return n!==void 0&&(b.className=n),l&&l.appendChild(b),b},createNS:function(a,n){return o.window.document.createElementNS(a,n)}},K=o.window.document&&o.window.document.documentElement.style;function re(s){if(!K)return s[0];for(var a=0;a<s.length;a++)if(s[a]in K)return s[a];return s[0]}var fe,Y=re(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){K&&Y&&(fe=K[Y],K[Y]="none")},D.enableDrag=function(){K&&Y&&(K[Y]=fe)};var Fe=re(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[Fe]=a};var We=!1;try{var ge=Object.defineProperty({},"passive",{get:function(){We=!0}});o.window.addEventListener("test",ge,ge),o.window.removeEventListener("test",ge,ge)}catch(s){We=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&We?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&We?l:l.capture)};var we=function s(a){a.preventDefault(),a.stopPropagation(),o.window.removeEventListener("click",s,!0)};function dt(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){o.window.addEventListener("click",we,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",we,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new o.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],b=0;b<a.length;b++)l.push(new o.Point(a[b].clientX-n.left-s.clientLeft,a[b].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return o.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var ke=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,b=this.requestors;l<b.length;l+=1){var O=b[l];this._notify(O.ids,O.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var b=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),b=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),b=!1),this._validateContent(l.content,l)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),b=!1),b},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var b=0,O=0,R=n;O<R.length;O+=1){var j=R[O];if(j[0]<b||j[1]<j[0]||l<j[1])return!1;b=j[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var b=!0;if(!this.isLoaded())for(var O=0,R=n;O<R.length;O+=1)this.images[R[O]]||(b=!1);this.isLoaded()||b?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var b={},O=0,R=n;O<R.length;O+=1){var j=R[O];this.images[j]||this.fire(new o.Event("styleimagemissing",{id:j}));var ue=this.images[j];ue?b[j]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:o.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,b)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],b=this.getImage(n);if(!b)return null;if(l&&l.position.version===b.version)return l.position;if(l)l.position.version=b.version;else{var O={w:b.data.width+2,h:b.data.height+2,x:0,y:0},R=new o.ImagePosition(O,b);this.patterns[n]={bin:O,position:R}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var b=o.potpack(n),O=b.w,R=b.h,j=this.atlasImage;for(var ue in j.resize({width:O||1,height:R||1}),this.patterns){var Te=this.patterns[ue].bin,Xe=Te.x+1,Je=Te.y+1,tt=this.images[ue].data,Dt=tt.width,Lt=tt.height;o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Xe,y:Je},{width:Dt,height:Lt}),o.RGBAImage.copy(tt,j,{x:0,y:Lt-1},{x:Xe,y:Je-1},{width:Dt,height:1}),o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Xe,y:Je+Lt},{width:Dt,height:1}),o.RGBAImage.copy(tt,j,{x:Dt-1,y:0},{x:Xe-1,y:Je},{width:1,height:Lt}),o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Xe+Dt,y:Je},{width:1,height:Lt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,b=n;l<b.length;l+=1){var O=b[l];if(!this.callbackDispatchedThisFrame[O]){this.callbackDispatchedThisFrame[O]=!0;var R=this.images[O];dt(R)&&this.updateImage(O,R)}}},a}(o.Evented),Et=Qe,Ze=Qe,vt=1e20;function Qe(s,a,n,l,b,O){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=b||"sans-serif",this.fontWeight=O||"normal",this.radius=n||8;var R=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=R,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.d=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Int16Array(R),this.middle=Math.round(R/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function yt(s,a,n,l,b,O,R){for(var j=0;j<a;j++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+j];for(_t(l,b,O,R,n),ue=0;ue<n;ue++)s[ue*a+j]=b[ue]}for(ue=0;ue<n;ue++){for(j=0;j<a;j++)l[j]=s[ue*a+j];for(_t(l,b,O,R,a),j=0;j<a;j++)s[ue*a+j]=Math.sqrt(b[j])}}function _t(s,a,n,l,b){n[0]=0,l[0]=-vt,l[1]=+vt;for(var O=1,R=0;O<b;O++){for(var j=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);j<=l[R];)R--,j=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);n[++R]=O,l[R]=j,l[R+1]=+vt}for(O=0,R=0;O<b;O++){for(;l[R+1]<O;)R++;a[O]=(O-n[R])*(O-n[R])+s[n[R]]}}Qe.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var b=a.data[4*l+3]/255;this.gridOuter[l]=b===1?0:b===0?vt:Math.pow(Math.max(0,.5-b),2),this.gridInner[l]=b===1?vt:b===0?0:Math.pow(Math.max(0,b-.5),2)}for(yt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),yt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},Et.default=Ze;var De=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};De.prototype.setURL=function(s){this.url=s},De.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var b in s)for(var O=0,R=s[b];O<R.length;O+=1)l.push({stack:b,id:R[O]});o.asyncAll(l,function(j,ue){var Te=j.stack,Xe=j.id,Je=n.entries[Te];Je||(Je=n.entries[Te]={glyphs:{},requests:{},ranges:{}});var tt=Je.glyphs[Xe];if(tt===void 0){if(tt=n._tinySDF(Je,Te,Xe))return Je.glyphs[Xe]=tt,void ue(null,{stack:Te,id:Xe,glyph:tt});var Dt=Math.floor(Xe/256);if(256*Dt>65535)ue(new Error("glyphs > 65535 not supported"));else if(Je.ranges[Dt])ue(null,{stack:Te,id:Xe,glyph:tt});else{var Lt=Je.requests[Dt];Lt||(Lt=Je.requests[Dt]=[],De.loadGlyphRange(Te,Dt,n.url,n.requestManager,function(Zt,Rt){if(Rt){for(var Bt in Rt)n._doesCharSupportLocalGlyph(+Bt)||(Je.glyphs[+Bt]=Rt[+Bt]);Je.ranges[Dt]=!0}for(var qt=0,Qt=Lt;qt<Qt.length;qt+=1)(0,Qt[qt])(Zt,Rt);delete Je.requests[Dt]})),Lt.push(function(Zt,Rt){Zt?ue(Zt):Rt&&ue(null,{stack:Te,id:Xe,glyph:Rt[Xe]||null})})}}else ue(null,{stack:Te,id:Xe,glyph:tt})},function(j,ue){if(j)a(j);else if(ue){for(var Te={},Xe=0,Je=ue;Xe<Je.length;Xe+=1){var tt=Je[Xe],Dt=tt.stack,Lt=tt.id,Zt=tt.glyph;(Te[Dt]||(Te[Dt]={}))[Lt]=Zt&&{id:Zt.id,bitmap:Zt.bitmap.clone(),metrics:Zt.metrics}}a(null,Te)}})},De.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](s)||o.isChar["Hangul Syllables"](s)||o.isChar.Hiragana(s)||o.isChar.Katakana(s))},De.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var b=s.tinySDF;if(!b){var O="400";/bold/i.test(a)?O="900":/medium/i.test(a)?O="500":/light/i.test(a)&&(O="200"),b=s.tinySDF=new De.TinySDF(24,3,8,.25,l,O)}return{id:n,bitmap:new o.AlphaImage({width:30,height:30},b.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},De.loadGlyphRange=function(s,a,n,l,b){var O=256*a,R=O+255,j=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",O+"-"+R),o.ResourceType.Glyphs);o.getArrayBuffer(j,function(ue,Te){if(ue)b(ue);else if(Te){for(var Xe={},Je=0,tt=o.parseGlyphPBF(Te);Je<tt.length;Je+=1){var Dt=tt[Je];Xe[Dt.id]=Dt}b(null,Xe)}})},De.TinySDF=Et;var Ne=function(){this.specification=o.styleSpec.light.position};Ne.prototype.possiblyEvaluate=function(s,a){return o.sphericalToCartesian(s.expression.evaluate(a))},Ne.prototype.interpolate=function(s,a,n){return{x:o.number(s.x,a.x,n),y:o.number(s.y,a.y,n),z:o.number(s.z,a.z,n)}};var Ue=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new Ne,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),st=function(s){function a(n){s.call(this),this._transitionable=new o.Transitionable(Ue),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(o.validateLight,n,l))for(var b in n){var O=n[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-"-transition".length),O):this._transitionable.setValue(b,O)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,n.call(o.validateStyle,o.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},a}(o.Evented),Le=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Le.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Le.prototype.getDashRanges=function(s,a,n){var l=[],b=s.length%2==1?-s[s.length-1]*n:0,O=s[0]*n,R=!0;l.push({left:b,right:O,isDash:R,zeroLength:s[0]===0});for(var j=s[0],ue=1;ue<s.length;ue++){var Te=s[ue];l.push({left:b=j*n,right:O=(j+=Te)*n,isDash:R=!R,zeroLength:Te===0})}return l},Le.prototype.addRoundDash=function(s,a,n){for(var l=a/2,b=-n;b<=n;b++)for(var O=this.width*(this.nextRow+n+b),R=0,j=s[R],ue=0;ue<this.width;ue++){ue/j.right>1&&(j=s[++R]);var Te=Math.abs(ue-j.left),Xe=Math.abs(ue-j.right),Je=Math.min(Te,Xe),tt=void 0,Dt=b/n*(l+1);if(j.isDash){var Lt=l-Math.abs(Dt);tt=Math.sqrt(Je*Je+Lt*Lt)}else tt=l-Math.sqrt(Je*Je+Dt*Dt);this.data[O+ue]=Math.max(0,Math.min(255,tt+128))}},Le.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var b=s[0],O=s[s.length-1];b.isDash===O.isDash&&(b.left=O.left-this.width,O.right=b.right+this.width);for(var R=this.width*this.nextRow,j=0,ue=s[j],Te=0;Te<this.width;Te++){Te/ue.right>1&&(ue=s[++j]);var Xe=Math.abs(Te-ue.left),Je=Math.abs(Te-ue.right),tt=Math.min(Xe,Je);this.data[R+Te]=Math.max(0,Math.min(255,(ue.isDash?tt:-tt)+128))}},Le.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var b=0,O=0;O<s.length;O++)b+=s[O];if(b!==0){var R=this.width/b,j=this.getDashRanges(s,this.width,R);a?this.addRoundDash(j,R,n):this.addRegularDash(j)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:b};return this.nextRow+=l,this.dirty=!0,ue},Le.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ut=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var l=this.workerPool.acquire(this.id),b=0;b<l.length;b++){var O=new s.Actor(l[b],n,this.id);O.name="Worker "+b,this.actors.push(O)}};function Gt(s,a,n){var l=function(O,R){if(O)return n(O);if(R){var j=o.pick(o.extend(R,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(j.vectorLayers=R.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(ue){return ue.id})),j.tiles=a.canonicalizeTileset(j,s.url),n(null,j)}};return s.url?o.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),o.ResourceType.Source),l):o.browser.frame(function(){return l(null,s)})}ut.prototype.broadcast=function(s,a,n){o.asyncAll(this.actors,function(l,b){l.send(s,a,b)},n=n||function(){})},ut.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ut.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ut.Actor=o.Actor;var Kt=function(a,n,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Kt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Kt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*a),b=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*a),O=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<b&&s.y>=l&&s.y<O};var ar=function(s){function a(n,l,b,O){if(s.call(this),this.id=n,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(l,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,function(l,b){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):b&&(o.extend(n,b),b.bounds&&(n.tileBounds=new Kt(b.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(b.tiles,n.map._requestManager._customAccessToken),o.postMapLoadEvent(b.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.loadTile=function(n,l){var b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),O={request:this.map._requestManager.transformRequest(b,o.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function R(j,ue){return delete n.request,n.aborted?l(null):j&&j.status!==404?l(j):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",O,R.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",O,R.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(o.Evented),oe=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.dispatcher=b,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},l),o.extend(this,o.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,function(l,b){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):b&&(o.extend(n,b),b.bounds&&(n.tileBounds=new Kt(b.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(b.tiles),o.postMapLoadEvent(b.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var b=this,O=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=o.getImage(this.map._requestManager.transformRequest(O,o.ResourceType.Tile),function(R,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(j){b.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=b.map.painter.context,Te=ue.gl;n.texture=b.map.painter.getTileTexture(j.width),n.texture?n.texture.update(j,{useMipmap:!0}):(n.texture=new o.Texture(ue,j,Te.RGBA,{useMipmap:!0}),n.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Te.texParameterf(Te.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",o.cacheEntryPossiblyAdded(b.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Q=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function O(R,j){R&&(n.state="errored",l(R)),j&&(n.dem=j,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=o.getImage(this.map._requestManager.transformRequest(b,o.ResourceType.Tile),function(R,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(j){this.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=o.window.ImageBitmap&&j instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?j:o.browser.getImageData(j,1),Te={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Te,O.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,b=Math.pow(2,l.z),O=(l.x-1+b)%b,R=l.x===0?n.wrap-1:n.wrap,j=(l.x+1+b)%b,ue=l.x+1===b?n.wrap+1:n.wrap,Te={};return Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y).key]={backfilled:!1},l.y>0&&(Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y-1).key]={backfilled:!1}),l.y+1<b&&(Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y+1).key]={backfilled:!1}),Te},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=b.getActor(),this.setEventedParent(O),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var R=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*R,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*R,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius||50)*R,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new o.ErrorEvent(l));else{var b={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(b.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new o.Event("data",b))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)l.fire(new o.ErrorEvent(b));else{var O={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(O.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new o.Event("data",O))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,b,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:b},O),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var b=o.extend({},this.workerOptions),O=this._data;typeof O=="string"?(b.request=this.map._requestManager.transformRequest(o.browser.resolveURL(O),o.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(O),this.actor.send(this.type+".loadData",b,function(R,j){l._removed||j&&j.abandoned||(l._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[l.id]&&(l._resourceTiming=j.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:b.source},null),n(R))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var b=this,O=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(O,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(R,j){return delete n.request,n.unloadVectorData(),n.aborted?l(null):R?l(R):(n.loadVectorData(j,b.map.painter,O==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Ce=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ee=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.dispatcher=b,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var b=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(O,R){b._loaded=!0,O?b.fire(new o.ErrorEvent(O)):R&&(b.image=R,n&&(b.coordinates=n),l&&l(),b._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var b=n.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(R){for(var j=1/0,ue=1/0,Te=-1/0,Xe=-1/0,Je=0,tt=R;Je<tt.length;Je+=1){var Dt=tt[Je];j=Math.min(j,Dt.x),ue=Math.min(ue,Dt.y),Te=Math.max(Te,Dt.x),Xe=Math.max(Xe,Dt.y)}var Lt=Math.max(Te-j,Xe-ue),Zt=Math.max(0,Math.floor(-Math.log(Lt)/Math.LN2)),Rt=Math.pow(2,Zt);return new o.CanonicalTileID(Zt,Math.floor((j+Te)/2*Rt),Math.floor((ue+Xe)/2*Rt))}(b),this.minzoom=this.maxzoom=this.tileID.z;var O=b.map(function(R){return l.tileID.getTilePoint(R)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(O[2].x,O[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[b];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(o.Evented),_e=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var b=0,O=l.urls;b<O.length;b+=1)this.urls.push(this.map._requestManager.transformRequest(O[b],o.ResourceType.Source).url);o.getVideo(this.urls,function(R,j){n._loaded=!0,R?n.fire(new o.ErrorEvent(R)):j&&(n.video=j,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[b];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(Ee),ve=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(R){return!Array.isArray(R)||R.length!==2||R.some(function(j){return typeof j!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,b=l.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,b.RGBA,{premultiply:!0}),this.tiles){var R=this.tiles[O];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var b=l[n];if(isNaN(b)||b<=0)return!0}return!1},a}(Ee),rt={vector:ar,raster:oe,"raster-dem":Q,geojson:H,video:_e,image:Ee,canvas:ve};function $t(s,a){var n=o.identity([]);return o.translate(n,n,[1,1,0]),o.scale(n,n,[.5*s.width,.5*s.height,1]),o.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function St(s,a,n,l,b,O){var R=function(Zt,Rt,Bt){if(Zt)for(var qt=0,Qt=Zt;qt<Qt.length;qt+=1){var Pr=Rt[Qt[qt]];if(Pr&&Pr.source===Bt&&Pr.type==="fill-extrusion")return!0}else for(var fr in Rt){var Tr=Rt[fr];if(Tr.source===Bt&&Tr.type==="fill-extrusion")return!0}return!1}(b&&b.layers,a,s.id),j=O.maxPitchScaleFactor(),ue=s.tilesIn(l,j,R);ue.sort(ye);for(var Te=[],Xe=0,Je=ue;Xe<Je.length;Xe+=1){var tt=Je[Xe];Te.push({wrappedTileID:tt.tileID.wrapped().key,queryResults:tt.tile.queryRenderedFeatures(a,n,s._state,tt.queryGeometry,tt.cameraQueryGeometry,tt.scale,b,O,j,$t(s.transform,tt.tileID))})}var Dt=function(Zt){for(var Rt={},Bt={},qt=0,Qt=Zt;qt<Qt.length;qt+=1){var Pr=Qt[qt],fr=Pr.queryResults,Tr=Pr.wrappedTileID,Ar=Bt[Tr]=Bt[Tr]||{};for(var nn in fr)for(var Xr=fr[nn],gn=Ar[nn]=Ar[nn]||{},Pn=Rt[nn]=Rt[nn]||[],Jn=0,aa=Xr;Jn<aa.length;Jn+=1){var ba=aa[Jn];gn[ba.featureIndex]||(gn[ba.featureIndex]=!0,Pn.push(ba))}}return Rt}(Te);for(var Lt in Dt)Dt[Lt].forEach(function(Zt){var Rt=Zt.feature,Bt=s.getFeatureState(Rt.layer["source-layer"],Rt.id);Rt.source=Rt.layer.source,Rt.layer["source-layer"]&&(Rt.sourceLayer=Rt.layer["source-layer"]),Rt.state=Bt});return Dt}function ye(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var be=function(a,n){this.max=a,this.onRemove=n,this.reset()};be.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},be.prototype.add=function(s,a,n){var l=this,b=s.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);var O={value:a,timeout:void 0};if(n!==void 0&&(O.timeout=setTimeout(function(){l.remove(s,O)},n)),this.data[b].push(O),this.order.push(b),this.order.length>this.max){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},be.prototype.has=function(s){return s.wrapped().key in this.data},be.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},be.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},be.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},be.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},be.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),b=this.data[n][l];return this.data[n].splice(l,1),b.timeout&&clearTimeout(b.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(b.value),this.order.splice(this.order.indexOf(n),1),this},be.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},be.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,b=this.data[n];l<b.length;l+=1){var O=b[l];s(O.value)||a.push(O)}for(var R=0,j=a;R<j.length;R+=1){var ue=j[R];this.remove(ue.value.tileID,ue)}};var Be=function(a,n,l){this.context=a;var b=a.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Be.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Be.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Be.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var lt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Pe=function(a,n,l,b){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=b,this.context=a;var O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Pe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Pe.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Pe.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Pe.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var b=this.attributes[l],O=a.attributes[b.name];O!==void 0&&s.vertexAttribPointer(O,b.components,s[lt[b.type]],!1,this.itemSize,b.offset+this.itemSize*(n||0))}},Pe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ht=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ht.prototype.get=function(){return this.current},ht.prototype.set=function(s){},ht.prototype.getDefault=function(){return this.default},ht.prototype.setDefault=function(){this.set(this.default)};var w=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ht),I=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(ht),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(ht),ce=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ht),Ve=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(ht),$e=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(ht),gt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(ht),nt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(ht),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(ht),$=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ht),Ke=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(ht),ae=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(ht),et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(ht),zt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ht),sr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ht),ft=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(ht),pt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(ht),At=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(ht),mt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(ht),Me=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(ht),ct=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(ht),qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ht),Vt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(ht),pr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(ht),Gr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(ht),ur=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(ht),zn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(ht),xn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(ht),na=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(ht),fa=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(ht),Hn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(ht),Gn=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(ht),F=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(Gn),W=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(Gn),le=function(a,n,l,b){this.context=a,this.width=n,this.height=l;var O=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new F(a,O),b&&(this.depthAttachment=new W(a,O))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var pe=function(a,n,l){this.func=a,this.mask=n,this.range=l};pe.ReadOnly=!1,pe.ReadWrite=!0,pe.disabled=new pe(519,pe.ReadOnly,[0,1]);var at=function(a,n,l,b,O,R){this.test=a,this.ref=n,this.mask=l,this.fail=b,this.depthFail=O,this.pass=R};at.disabled=new at({func:519,mask:0},0,0,7680,7680,7680);var Tt=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};Tt.disabled=new Tt(Tt.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),Tt.unblended=new Tt(Tt.Replace,o.Color.transparent,[!0,!0,!0,!0]),Tt.alphaBlended=new Tt([1,771],o.Color.transparent,[!0,!0,!0,!0]);var jt=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};jt.disabled=new jt(!1,1029,2305),jt.backCCW=new jt(!0,1029,2305);var Ge=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new w(this),this.clearDepth=new I(this),this.clearStencil=new q(this),this.colorMask=new ce(this),this.depthMask=new Ve(this),this.stencilMask=new $e(this),this.stencilFunc=new gt(this),this.stencilOp=new nt(this),this.stencilTest=new kt(this),this.depthRange=new $(this),this.depthTest=new Ke(this),this.depthFunc=new ae(this),this.blend=new et(this),this.blendFunc=new zt(this),this.blendColor=new sr(this),this.blendEquation=new ft(this),this.cullFace=new pt(this),this.cullFaceSide=new At(this),this.frontFace=new mt(this),this.program=new Me(this),this.activeTexture=new ct(this),this.viewport=new qe(this),this.bindFramebuffer=new Vt(this),this.bindRenderbuffer=new pr(this),this.bindTexture=new Gr(this),this.bindVertexBuffer=new ur(this),this.bindElementBuffer=new zn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new xn(this),this.pixelStoreUnpack=new na(this),this.pixelStoreUnpackPremultiplyAlpha=new fa(this),this.pixelStoreUnpackFlipY=new Hn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};Ge.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ge.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ge.prototype.createIndexBuffer=function(s,a){return new Be(this,s,a)},Ge.prototype.createVertexBuffer=function(s,a,n){return new Pe(this,s,a,n)},Ge.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,b=l.createRenderbuffer();return this.bindRenderbuffer.set(b),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),b},Ge.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},Ge.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,b=0;a&&(b|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(b|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(b)},Ge.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Ge.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Ge.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Ge.prototype.setColorMode=function(s){o.deepEqual(s.blendFunction,Tt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Ge.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var wt=function(s){function a(n,l,b){var O=this;s.call(this),this.id=n,this.dispatcher=b,this.on("data",function(R){R.dataType==="source"&&R.sourceDataType==="metadata"&&(O._sourceLoaded=!0),O._sourceLoaded&&!O._paused&&R.dataType==="source"&&R.sourceDataType==="content"&&(O.reload(),O.transform&&O.update(O.transform))}),this.on("error",function(){O._sourceErrored=!0}),this._source=function(R,j,ue,Te){var Xe=new rt[j.type](R,j,ue,Te);if(Xe.id!==R)throw new Error("Expected Source id to be "+R+" instead of "+Xe.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Xe),Xe}(n,l,b,this),this._tiles={},this._cache=new be(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var b=this._tiles[l];b.upload(n),b.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return o.values(this._tiles).map(function(n){return n.tileID}).sort(ir).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,b=[];for(var O in this._tiles)this._isIdRenderable(O,n)&&b.push(this._tiles[O]);return n?b.sort(function(R,j){var ue=R.tileID,Te=j.tileID,Xe=new o.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),Je=new o.Point(Te.canonical.x,Te.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Te.overscaledZ||Je.y-Xe.y||Je.x-Xe.x}).map(function(R){return R.tileID.key}):b.map(function(R){return R.tileID}).sort(ir).map(function(R){return R.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var b=this._tiles[n];b&&(b.state!=="loading"&&(b.state=l),this._loadTile(b,this._tileLoaded.bind(this,b,n,l)))},a.prototype._tileLoaded=function(n,l,b,O){if(O)return n.state="errored",void(O.status!==404?this._source.fire(new o.ErrorEvent(O,{tile:n})):this.update(this.transform));n.timeAdded=o.browser.now(),b==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),b=0;b<l.length;b++){var O=l[b];if(n.neighboringTiles&&n.neighboringTiles[O]){var R=this.getTileByID(O);j(n,R),j(R,n)}}function j(ue,Te){ue.needsHillshadePrepare=!0;var Xe=Te.tileID.canonical.x-ue.tileID.canonical.x,Je=Te.tileID.canonical.y-ue.tileID.canonical.y,tt=Math.pow(2,ue.tileID.canonical.z),Dt=Te.tileID.key;Xe===0&&Je===0||Math.abs(Je)>1||(Math.abs(Xe)>1&&(Math.abs(Xe+tt)===1?Xe+=tt:Math.abs(Xe-tt)===1&&(Xe-=tt)),Te.dem&&ue.dem&&(ue.dem.backfillBorder(Te.dem,Xe,Je),ue.neighboringTiles&&ue.neighboringTiles[Dt]&&(ue.neighboringTiles[Dt].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,b,O){for(var R in this._tiles){var j=this._tiles[R];if(!(O[R]||!j.hasData()||j.tileID.overscaledZ<=l||j.tileID.overscaledZ>b)){for(var ue=j.tileID;j&&j.tileID.overscaledZ>l+1;){var Te=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[Te.key])&&j.hasData()&&(ue=Te)}for(var Xe=ue;Xe.overscaledZ>l;)if(n[(Xe=Xe.scaledTo(Xe.overscaledZ-1)).key]){O[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var b=this._loadedParentTiles[n.key];return b&&b.tileID.overscaledZ>=l?b:null}for(var O=n.overscaledZ-1;O>=l;O--){var R=n.scaledTo(O),j=this._getLoadedTile(R);if(j)return j}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,b=Math.ceil(n.height/this._source.tileSize)+1,O=Math.floor(l*b*5),R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(R)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var b={};for(var O in this._tiles){var R=this._tiles[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+l),b[R.tileID.key]=R}for(var j in this._tiles=b,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var b;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?b=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ar){return new o.OverscaledTileID(Ar.canonical.z,Ar.wrap,Ar.canonical.z,Ar.canonical.x,Ar.canonical.y)}):(b=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(b=b.filter(function(Ar){return l._source.hasTile(Ar)}))):b=[];var O=n.coveringZoomLevel(this._source),R=Math.max(O-a.maxOverzooming,this._source.minzoom),j=Math.max(O+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(b,O);if(Ur(this._source.type)){for(var Te={},Xe={},Je=0,tt=Object.keys(ue);Je<tt.length;Je+=1){var Dt=tt[Je],Lt=ue[Dt],Zt=this._tiles[Dt];if(Zt&&!(Zt.fadeEndTime&&Zt.fadeEndTime<=o.browser.now())){var Rt=this.findLoadedParent(Lt,R);Rt&&(this._addTile(Rt.tileID),Te[Rt.tileID.key]=Rt.tileID),Xe[Dt]=Lt}}for(var Bt in this._retainLoadedChildren(Xe,O,j,ue),Te)ue[Bt]||(this._coveredTiles[Bt]=!0,ue[Bt]=Te[Bt])}for(var qt in ue)this._tiles[qt].clearFadeHold();for(var Qt=0,Pr=o.keysDifference(this._tiles,ue);Qt<Pr.length;Qt+=1){var fr=Pr[Qt],Tr=this._tiles[fr];Tr.hasSymbolBuckets&&!Tr.holdingForFade()?Tr.setHoldDuration(this.map._fadeDuration):Tr.hasSymbolBuckets&&!Tr.symbolFadeFinished()||this._removeTile(fr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var b={},O={},R=Math.max(l-a.maxOverzooming,this._source.minzoom),j=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Te=0,Xe=n;Te<Xe.length;Te+=1){var Je=Xe[Te],tt=this._addTile(Je);b[Je.key]=Je,tt.hasData()||l<this._source.maxzoom&&(ue[Je.key]=Je)}this._retainLoadedChildren(ue,l,j,b);for(var Dt=0,Lt=n;Dt<Lt.length;Dt+=1){var Zt=Lt[Dt],Rt=this._tiles[Zt.key];if(!Rt.hasData()){if(l+1>this._source.maxzoom){var Bt=Zt.children(this._source.maxzoom)[0],qt=this.getTile(Bt);if(qt&&qt.hasData()){b[Bt.key]=Bt;continue}}else{var Qt=Zt.children(this._source.maxzoom);if(b[Qt[0].key]&&b[Qt[1].key]&&b[Qt[2].key]&&b[Qt[3].key])continue}for(var Pr=Rt.wasRequested(),fr=Zt.overscaledZ-1;fr>=R;--fr){var Tr=Zt.scaledTo(fr);if(O[Tr.key])break;if(O[Tr.key]=!0,!(Rt=this.getTile(Tr))&&Pr&&(Rt=this._addTile(Tr)),Rt&&(b[Tr.key]=Tr,Pr=Rt.wasRequested(),Rt.hasData()))break}}}return b},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],b=void 0,O=this._tiles[n].tileID;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){b=this._loadedParentTiles[O.key];break}l.push(O.key);var R=O.scaledTo(O.overscaledZ-1);if(b=this._getLoadedTile(R))break;O=R}for(var j=0,ue=l;j<ue.length;j+=1)this._loadedParentTiles[ue[j]]=b}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var b=Boolean(l);return b||(l=new o.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,b||this._source.fire(new o.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var b=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var O=l.getExpiryTimeout();O&&(this._timers[n]=setTimeout(function(){b._reloadTile(n,"expired"),delete b._timers[n]},O))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,b){var O=this,R=[],j=this.transform;if(!j)return R;for(var ue=b?j.getCameraQueryGeometry(n):n,Te=n.map(function(fr){return j.pointCoordinate(fr)}),Xe=ue.map(function(fr){return j.pointCoordinate(fr)}),Je=this.getIds(),tt=1/0,Dt=1/0,Lt=-1/0,Zt=-1/0,Rt=0,Bt=Xe;Rt<Bt.length;Rt+=1){var qt=Bt[Rt];tt=Math.min(tt,qt.x),Dt=Math.min(Dt,qt.y),Lt=Math.max(Lt,qt.x),Zt=Math.max(Zt,qt.y)}for(var Qt=function(Tr){var Ar=O._tiles[Je[Tr]];if(!Ar.holdingForFade()){var nn=Ar.tileID,Xr=Math.pow(2,j.zoom-Ar.tileID.overscaledZ),gn=l*Ar.queryPadding*o.EXTENT/Ar.tileSize/Xr,Pn=[nn.getTilePoint(new o.MercatorCoordinate(tt,Dt)),nn.getTilePoint(new o.MercatorCoordinate(Lt,Zt))];if(Pn[0].x-gn<o.EXTENT&&Pn[0].y-gn<o.EXTENT&&Pn[1].x+gn>=0&&Pn[1].y+gn>=0){var Jn=Te.map(function(ba){return nn.getTilePoint(ba)}),aa=Xe.map(function(ba){return nn.getTilePoint(ba)});R.push({tile:Ar,tileID:nn,queryGeometry:Jn,cameraQueryGeometry:aa,scale:Xr})}}},Pr=0;Pr<Je.length;Pr++)Qt(Pr);return R},a.prototype.getVisibleCoordinates=function(n){for(var l=this,b=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),O=0,R=b;O<R.length;O+=1){var j=R[O];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return b},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ur(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,b){this._state.updateState(n=n||"_geojsonTileLayer",l,b)},a.prototype.removeFeatureState=function(n,l,b){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,b)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,b){var O=this._tiles[n];O&&O.setDependencies(l,b)},a.prototype.reloadTilesForDependencies=function(n,l){for(var b in this._tiles)this._tiles[b].hasDependency(n,l)&&this._reloadTile(b,"reloading");this._cache.filter(function(O){return!O.hasDependency(n,l)})},a}(o.Evented);function ir(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function Ur(s){return s==="raster"||s==="image"||s==="video"}function Vr(){return new o.window.Worker(ic.workerUrl)}wt.maxOverzooming=10,wt.maxUnderzooming=3;var or="mapboxgl_preloaded_worker_pool",Fr=function(){this.active={}};Fr.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Fr.workerCount;)this.workers.push(new Vr);return this.active[s]=!0,this.workers.slice()},Fr.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Fr.prototype.isPreloaded=function(){return!!this.active[or]},Fr.prototype.numActive=function(){return Object.keys(this.active).length};var Sn,fn=Math.floor(o.browser.hardwareConcurrency/2);function Er(){return Sn||(Sn=new Fr),Sn}function Tn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return o.refProperties.forEach(function(b){b in a&&(n[b]=a[b])}),n}function dn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=Tn(s[l],a[s[l].ref]));return s}Fr.workerCount=Math.max(Math.min(fn,6),1);var vn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Sr(s,a,n){n.push({command:vn.addSource,args:[s,a[s]]})}function Kr(s,a,n){a.push({command:vn.removeSource,args:[s]}),n[s]=!0}function wn(s,a,n,l){Kr(s,n,l),Sr(s,a,n)}function Ka(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;return!0}function da(s,a,n,l,b,O){var R;for(R in a=a||{},s=s||{})s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],b]}));for(R in a)a.hasOwnProperty(R)&&!s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],b]}))}function Oa(s){return s.id}function Ia(s,a){return s[a.id]=a,s}var Xi=function(a,n){this.reset(a,n)};Xi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=o.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var b=a-1,O=this._distances[b],R=n-O,j=R>0?(l-O)/R:0;return this.points[b].mult(1-j).add(this.points[a].mult(j))};var ha=function(a,n,l){var b=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var R=0;R<this.xCellCount*this.yCellCount;R++)b.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function gi(s,a,n,l,b){var O=o.create();return a?(o.scale(O,O,[1/b,1/b,1]),n||o.rotateZ(O,O,l.angle)):o.multiply(O,l.labelPlaneMatrix,s),O}function Ma(s,a,n,l,b){if(a){var O=o.clone(s);return o.scale(O,O,[b,b,1]),n||o.rotateZ(O,O,-l.angle),O}return l.glCoordMatrix}function ya(s,a){var n=[s.x,s.y,0,1];Ki(n,n,a);var l=n[3];return{point:new o.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function la(s,a){return .5+s/a*.5}function Li(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function po(s,a,n,l,b,O,R,j){var ue=l?s.textSizeData:s.iconSizeData,Te=o.evaluateSizeForZoom(ue,n.transform.zoom),Xe=[256/n.width*2+1,256/n.height*2+1],Je=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;Je.clear();for(var tt=s.lineVertexArray,Dt=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Lt=n.transform.width/n.transform.height,Zt=!1,Rt=0;Rt<Dt.length;Rt++){var Bt=Dt.get(Rt);if(Bt.hidden||Bt.writingMode===o.WritingMode.vertical&&!Zt)ii(Bt.numGlyphs,Je);else{Zt=!1;var qt=[Bt.anchorX,Bt.anchorY,0,1];if(o.transformMat4(qt,qt,a),Li(qt,Xe)){var Qt=la(n.transform.cameraToCenterDistance,qt[3]),Pr=o.evaluateSizeForFeature(ue,Te,Bt),fr=R?Pr/Qt:Pr*Qt,Tr=new o.Point(Bt.anchorX,Bt.anchorY),Ar=ya(Tr,b).point,nn={},Xr=Gu(Bt,fr,!1,j,a,b,O,s.glyphOffsetArray,tt,Je,Ar,Tr,nn,Lt);Zt=Xr.useVertical,(Xr.notEnoughRoom||Zt||Xr.needsFlipping&&Gu(Bt,fr,!0,j,a,b,O,s.glyphOffsetArray,tt,Je,Ar,Tr,nn,Lt).notEnoughRoom)&&ii(Bt.numGlyphs,Je)}else ii(Bt.numGlyphs,Je)}}l?s.text.dynamicLayoutVertexBuffer.updateData(Je):s.icon.dynamicLayoutVertexBuffer.updateData(Je)}function Yi(s,a,n,l,b,O,R,j,ue,Te,Xe){var Je=j.glyphStartIndex+j.numGlyphs,tt=j.lineStartIndex,Dt=j.lineStartIndex+j.lineLength,Lt=a.getoffsetX(j.glyphStartIndex),Zt=a.getoffsetX(Je-1),Rt=Ai(s*Lt,n,l,b,O,R,j.segment,tt,Dt,ue,Te,Xe);if(!Rt)return null;var Bt=Ai(s*Zt,n,l,b,O,R,j.segment,tt,Dt,ue,Te,Xe);return Bt?{first:Rt,last:Bt}:null}function Ko(s,a,n,l){return s===o.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===o.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function Gu(s,a,n,l,b,O,R,j,ue,Te,Xe,Je,tt,Dt){var Lt,Zt=a/24,Rt=s.lineOffsetX*Zt,Bt=s.lineOffsetY*Zt;if(s.numGlyphs>1){var qt=s.glyphStartIndex+s.numGlyphs,Qt=s.lineStartIndex,Pr=s.lineStartIndex+s.lineLength,fr=Yi(Zt,j,Rt,Bt,n,Xe,Je,s,ue,O,tt);if(!fr)return{notEnoughRoom:!0};var Tr=ya(fr.first.point,R).point,Ar=ya(fr.last.point,R).point;if(l&&!n){var nn=Ko(s.writingMode,Tr,Ar,Dt);if(nn)return nn}Lt=[fr.first];for(var Xr=s.glyphStartIndex+1;Xr<qt-1;Xr++)Lt.push(Ai(Zt*j.getoffsetX(Xr),Rt,Bt,n,Xe,Je,s.segment,Qt,Pr,ue,O,tt));Lt.push(fr.last)}else{if(l&&!n){var gn=ya(Je,b).point,Pn=s.lineStartIndex+s.segment+1,Jn=new o.Point(ue.getx(Pn),ue.gety(Pn)),aa=ya(Jn,b),ba=aa.signedDistanceFromCamera>0?aa.point:Ba(Je,Jn,gn,1,b),Xa=Ko(s.writingMode,gn,ba,Dt);if(Xa)return Xa}var _n=Ai(Zt*j.getoffsetX(s.glyphStartIndex),Rt,Bt,n,Xe,Je,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,O,tt);if(!_n)return{notEnoughRoom:!0};Lt=[_n]}for(var ia=0,xa=Lt;ia<xa.length;ia+=1){var Wn=xa[ia];o.addDynamicAttributes(Te,Wn.point,Wn.angle)}return{}}function Ba(s,a,n,l,b){var O=ya(s.add(s.sub(a)._unit()),b).point,R=n.sub(O);return n.add(R._mult(l/R.mag()))}function Ai(s,a,n,l,b,O,R,j,ue,Te,Xe,Je){var tt=l?s-a:s+a,Dt=tt>0?1:-1,Lt=0;l&&(Dt*=-1,Lt=Math.PI),Dt<0&&(Lt+=Math.PI);for(var Zt=Dt>0?j+R:j+R+1,Rt=b,Bt=b,qt=0,Qt=0,Pr=Math.abs(tt),fr=[];qt+Qt<=Pr;){if((Zt+=Dt)<j||Zt>=ue)return null;if(Bt=Rt,fr.push(Rt),(Rt=Je[Zt])===void 0){var Tr=new o.Point(Te.getx(Zt),Te.gety(Zt)),Ar=ya(Tr,Xe);if(Ar.signedDistanceFromCamera>0)Rt=Je[Zt]=Ar.point;else{var nn=Zt-Dt;Rt=Ba(qt===0?O:new o.Point(Te.getx(nn),Te.gety(nn)),Tr,Bt,Pr-qt+1,Xe)}}qt+=Qt,Qt=Bt.dist(Rt)}var Xr=(Pr-qt)/Qt,gn=Rt.sub(Bt),Pn=gn.mult(Xr)._add(Bt);Pn._add(gn._unit()._perp()._mult(n*Dt));var Jn=Lt+Math.atan2(Rt.y-Bt.y,Rt.x-Bt.x);return fr.push(Pn),{point:Pn,angle:Jn,path:fr}}ha.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ha.prototype.insert=function(s,a,n,l,b){this._forEachCell(a,n,l,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(b)},ha.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},ha.prototype._insertBoxCell=function(s,a,n,l,b,O){this.boxCells[b].push(O)},ha.prototype._insertCircleCell=function(s,a,n,l,b,O){this.circleCells[b].push(O)},ha.prototype._query=function(s,a,n,l,b,O){if(n<0||s>this.width||l<0||a>this.height)return!b&&[];var R=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(b)return!0;for(var j=0;j<this.boxKeys.length;j++)R.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Te=this.circles[3*ue],Xe=this.circles[3*ue+1],Je=this.circles[3*ue+2];R.push({key:this.circleKeys[ue],x1:Te-Je,y1:Xe-Je,x2:Te+Je,y2:Xe+Je})}return O?R.filter(O):R}return this._forEachCell(s,a,n,l,this._queryCell,R,{hitTest:b,seenUids:{box:{},circle:{}}},O),b?R.length>0:R},ha.prototype._queryCircle=function(s,a,n,l,b){var O=s-n,R=s+n,j=a-n,ue=a+n;if(R<0||O>this.width||ue<0||j>this.height)return!l&&[];var Te=[];return this._forEachCell(O,j,R,ue,this._queryCellCircle,Te,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},b),l?Te.length>0:Te},ha.prototype.query=function(s,a,n,l,b){return this._query(s,a,n,l,!1,b)},ha.prototype.hitTest=function(s,a,n,l,b){return this._query(s,a,n,l,!0,b)},ha.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},ha.prototype._queryCell=function(s,a,n,l,b,O,R,j){var ue=R.seenUids,Te=this.boxCells[b];if(Te!==null)for(var Xe=this.bboxes,Je=0,tt=Te;Je<tt.length;Je+=1){var Dt=tt[Je];if(!ue.box[Dt]){ue.box[Dt]=!0;var Lt=4*Dt;if(s<=Xe[Lt+2]&&a<=Xe[Lt+3]&&n>=Xe[Lt+0]&&l>=Xe[Lt+1]&&(!j||j(this.boxKeys[Dt]))){if(R.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[Dt],x1:Xe[Lt],y1:Xe[Lt+1],x2:Xe[Lt+2],y2:Xe[Lt+3]})}}}var Zt=this.circleCells[b];if(Zt!==null)for(var Rt=this.circles,Bt=0,qt=Zt;Bt<qt.length;Bt+=1){var Qt=qt[Bt];if(!ue.circle[Qt]){ue.circle[Qt]=!0;var Pr=3*Qt;if(this._circleAndRectCollide(Rt[Pr],Rt[Pr+1],Rt[Pr+2],s,a,n,l)&&(!j||j(this.circleKeys[Qt]))){if(R.hitTest)return O.push(!0),!0;var fr=Rt[Pr],Tr=Rt[Pr+1],Ar=Rt[Pr+2];O.push({key:this.circleKeys[Qt],x1:fr-Ar,y1:Tr-Ar,x2:fr+Ar,y2:Tr+Ar})}}}},ha.prototype._queryCellCircle=function(s,a,n,l,b,O,R,j){var ue=R.circle,Te=R.seenUids,Xe=this.boxCells[b];if(Xe!==null)for(var Je=this.bboxes,tt=0,Dt=Xe;tt<Dt.length;tt+=1){var Lt=Dt[tt];if(!Te.box[Lt]){Te.box[Lt]=!0;var Zt=4*Lt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,Je[Zt+0],Je[Zt+1],Je[Zt+2],Je[Zt+3])&&(!j||j(this.boxKeys[Lt])))return O.push(!0),!0}}var Rt=this.circleCells[b];if(Rt!==null)for(var Bt=this.circles,qt=0,Qt=Rt;qt<Qt.length;qt+=1){var Pr=Qt[qt];if(!Te.circle[Pr]){Te.circle[Pr]=!0;var fr=3*Pr;if(this._circlesCollide(Bt[fr],Bt[fr+1],Bt[fr+2],ue.x,ue.y,ue.radius)&&(!j||j(this.circleKeys[Pr])))return O.push(!0),!0}}},ha.prototype._forEachCell=function(s,a,n,l,b,O,R,j){for(var ue=this._convertToXCellCoord(s),Te=this._convertToYCellCoord(a),Xe=this._convertToXCellCoord(n),Je=this._convertToYCellCoord(l),tt=ue;tt<=Xe;tt++)for(var Dt=Te;Dt<=Je;Dt++)if(b.call(this,s,a,n,l,this.xCellCount*Dt+tt,O,R,j))return},ha.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},ha.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},ha.prototype._circlesCollide=function(s,a,n,l,b,O){var R=l-s,j=b-a,ue=n+O;return ue*ue>R*R+j*j},ha.prototype._circleAndRectCollide=function(s,a,n,l,b,O,R){var j=(O-l)/2,ue=Math.abs(s-(l+j));if(ue>j+n)return!1;var Te=(R-b)/2,Xe=Math.abs(a-(b+Te));if(Xe>Te+n)return!1;if(ue<=j||Xe<=Te)return!0;var Je=ue-j,tt=Xe-Te;return Je*Je+tt*tt<=n*n};var es=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ii(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(es,3*l)}}function Ki(s,a,n){var l=a[0],b=a[1];return s[0]=n[0]*l+n[4]*b+n[12],s[1]=n[1]*l+n[5]*b+n[13],s[3]=n[3]*l+n[7]*b+n[15],s}var ts=function(a,n,l){n===void 0&&(n=new ha(a.width+200,a.height+200,25)),l===void 0&&(l=new ha(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function Ja(s,a,n){return a*(o.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}ts.prototype.placeCollisionBox=function(s,a,n,l,b){var O=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),R=n*O.perspectiveRatio,j=s.x1*R+O.point.x,ue=s.y1*R+O.point.y,Te=s.x2*R+O.point.x,Xe=s.y2*R+O.point.y;return!this.isInsideGrid(j,ue,Te,Xe)||!a&&this.grid.hitTest(j,ue,Te,Xe,b)?{box:[],offscreen:!1}:{box:[j,ue,Te,Xe],offscreen:this.isOffscreen(j,ue,Te,Xe)}},ts.prototype.placeCollisionCircles=function(s,a,n,l,b,O,R,j,ue,Te,Xe,Je,tt){var Dt=[],Lt=new o.Point(a.anchorX,a.anchorY),Zt=ya(Lt,O),Rt=la(this.transform.cameraToCenterDistance,Zt.signedDistanceFromCamera),Bt=(Te?b/Rt:b*Rt)/o.ONE_EM,qt=ya(Lt,R).point,Qt=Yi(Bt,l,a.lineOffsetX*Bt,a.lineOffsetY*Bt,!1,qt,Lt,a,n,R,{}),Pr=!1,fr=!1,Tr=!0;if(Qt){for(var Ar=.5*Je*Rt+tt,nn=new o.Point(-100,-100),Xr=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),gn=new Xi,Pn=Qt.first,Jn=Qt.last,aa=[],ba=Pn.path.length-1;ba>=1;ba--)aa.push(Pn.path[ba]);for(var Xa=1;Xa<Jn.path.length;Xa++)aa.push(Jn.path[Xa]);var _n=2.5*Ar;if(j){var ia=aa.map(function(As){return ya(As,j)});aa=ia.some(function(As){return As.signedDistanceFromCamera<=0})?[]:ia.map(function(As){return As.point})}var xa=[];if(aa.length>0){for(var Wn=aa[0].clone(),Aa=aa[0].clone(),ta=1;ta<aa.length;ta++)Wn.x=Math.min(Wn.x,aa[ta].x),Wn.y=Math.min(Wn.y,aa[ta].y),Aa.x=Math.max(Aa.x,aa[ta].x),Aa.y=Math.max(Aa.y,aa[ta].y);xa=Wn.x>=nn.x&&Aa.x<=Xr.x&&Wn.y>=nn.y&&Aa.y<=Xr.y?[aa]:Aa.x<nn.x||Wn.x>Xr.x||Aa.y<nn.y||Wn.y>Xr.y?[]:o.clipLine([aa],nn.x,nn.y,Xr.x,Xr.y)}for(var La=0,ja=xa;La<ja.length;La+=1){var Ji;gn.reset(ja[La],.25*Ar),Ji=gn.length<=.5*Ar?1:Math.ceil(gn.paddedLength/_n)+1;for(var wi=0;wi<Ji;wi++){var vo=wi/Math.max(Ji-1,1),_i=gn.lerp(vo),Wi=_i.x+100,Ns=_i.y+100;Dt.push(Wi,Ns,Ar,0);var go=Wi-Ar,bu=Ns-Ar,xu=Wi+Ar,zo=Ns+Ar;if(Tr=Tr&&this.isOffscreen(go,bu,xu,zo),fr=fr||this.isInsideGrid(go,bu,xu,zo),!s&&this.grid.hitTestCircle(Wi,Ns,Ar,Xe)&&(Pr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Pr}}}}return{circles:!ue&&Pr||!fr?[]:Dt,offscreen:Tr,collisionDetected:Pr}},ts.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,b=-1/0,O=-1/0,R=0,j=s;R<j.length;R+=1){var ue=j[R],Te=new o.Point(ue.x+100,ue.y+100);n=Math.min(n,Te.x),l=Math.min(l,Te.y),b=Math.max(b,Te.x),O=Math.max(O,Te.y),a.push(Te)}for(var Xe={},Je={},tt=0,Dt=this.grid.query(n,l,b,O).concat(this.ignoredGrid.query(n,l,b,O));tt<Dt.length;tt+=1){var Lt=Dt[tt],Zt=Lt.key;if(Xe[Zt.bucketInstanceId]===void 0&&(Xe[Zt.bucketInstanceId]={}),!Xe[Zt.bucketInstanceId][Zt.featureIndex]){var Rt=[new o.Point(Lt.x1,Lt.y1),new o.Point(Lt.x2,Lt.y1),new o.Point(Lt.x2,Lt.y2),new o.Point(Lt.x1,Lt.y2)];o.polygonIntersectsPolygon(a,Rt)&&(Xe[Zt.bucketInstanceId][Zt.featureIndex]=!0,Je[Zt.bucketInstanceId]===void 0&&(Je[Zt.bucketInstanceId]=[]),Je[Zt.bucketInstanceId].push(Zt.featureIndex))}}return Je},ts.prototype.insertCollisionBox=function(s,a,n,l,b){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:b},s[0],s[1],s[2],s[3])},ts.prototype.insertCollisionCircles=function(s,a,n,l,b){for(var O=a?this.ignoredGrid:this.grid,R={bucketInstanceId:n,featureIndex:l,collisionGroupID:b},j=0;j<s.length;j+=4)O.insertCircle(R,s[j],s[j+1],s[j+2])},ts.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Ki(l,l,s),{point:new o.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},ts.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},ts.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},ts.prototype.getViewportMatrix=function(){var s=o.identity([]);return o.translate(s,s,[-100,-100,0]),s};var oo=function(a,n,l,b){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):b&&l?1:0,this.placed=l};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(a,n,l,b,O){this.text=new oo(a?a.text:null,n,l,O),this.icon=new oo(a?a.icon:null,n,b,O)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ys=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},_o=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Zl=function(a,n,l,b,O){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=b,this.tileID=O},Ks=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function So(s,a,n,l,b){var O=o.getAnchorAlignment(s),R=-(O.horizontalAlign-.5)*a,j=-(O.verticalAlign-.5)*n,ue=o.evaluateVariableOffset(s,l);return new o.Point(R+ue[0]*b,j+ue[1]*b)}function Ut(s,a,n,l,b,O){var R=s.x1,j=s.x2,ue=s.y1,Te=s.y2,Xe=s.anchorPointX,Je=s.anchorPointY,tt=new o.Point(a,n);return l&&tt._rotate(b?O:-O),{x1:R+tt.x,y1:ue+tt.y,x2:j+tt.x,y2:Te+tt.y,anchorPointX:Xe,anchorPointY:Je}}Ks.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Ie=function(a,n,l,b){this.transform=a.clone(),this.collisionIndex=new ts(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Ks(l),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}};function Pt(s,a,n,l,b){s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0)}Ie.prototype.getBucketParts=function(s,a,n,l){var b=n.getBucket(a),O=n.latestFeatureIndex;if(b&&O&&a.id===b.layerIds[0]){var R=n.collisionBoxArray,j=b.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Te=n.tileSize/o.EXTENT,Xe=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),Je=j.get("text-pitch-alignment")==="map",tt=j.get("text-rotation-alignment")==="map",Dt=Ja(n,1,this.transform.zoom),Lt=gi(Xe,Je,tt,this.transform,Dt),Zt=null;if(Je){var Rt=Ma(Xe,Je,tt,this.transform,Dt);Zt=o.multiply([],this.transform.labelPlaneMatrix,Rt)}this.retainedQueryData[b.bucketInstanceId]=new Zl(b.bucketInstanceId,O,b.sourceLayerIndex,b.index,n.tileID);var Bt={bucket:b,layout:j,posMatrix:Xe,textLabelPlaneMatrix:Lt,labelToScreenMatrix:Zt,scale:ue,textPixelRatio:Te,holdingForFade:n.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(l)for(var qt=0,Qt=b.sortKeyRanges;qt<Qt.length;qt+=1){var Pr=Qt[qt];s.push({sortKey:Pr.sortKey,symbolInstanceStart:Pr.symbolInstanceStart,symbolInstanceEnd:Pr.symbolInstanceEnd,parameters:Bt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Bt})}},Ie.prototype.attemptAnchorPlacement=function(s,a,n,l,b,O,R,j,ue,Te,Xe,Je,tt,Dt,Lt){var Zt,Rt=[Je.textOffset0,Je.textOffset1],Bt=So(s,n,l,Rt,b),qt=this.collisionIndex.placeCollisionBox(Ut(a,Bt.x,Bt.y,O,R,this.transform.angle),Xe,j,ue,Te.predicate);if(!Lt||this.collisionIndex.placeCollisionBox(Ut(Lt,Bt.x,Bt.y,O,R,this.transform.angle),Xe,j,ue,Te.predicate).box.length!==0)return qt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID].text&&(Zt=this.prevPlacement.variableOffsets[Je.crossTileID].anchor),this.variableOffsets[Je.crossTileID]={textOffset:Rt,width:n,height:l,anchor:s,textBoxScale:b,prevAnchor:Zt},this.markUsedJustification(tt,s,Je,Dt),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,Dt,Je),this.placedOrientations[Je.crossTileID]=Dt),{shift:Bt,placedGlyphBoxes:qt}):void 0},Ie.prototype.placeLayerBucketPart=function(s,a,n){var l=this,b=s.parameters,O=b.bucket,R=b.layout,j=b.posMatrix,ue=b.textLabelPlaneMatrix,Te=b.labelToScreenMatrix,Xe=b.textPixelRatio,Je=b.holdingForFade,tt=b.collisionBoxArray,Dt=b.partiallyEvaluatedTextSize,Lt=b.collisionGroup,Zt=R.get("text-optional"),Rt=R.get("icon-optional"),Bt=R.get("text-allow-overlap"),qt=R.get("icon-allow-overlap"),Qt=R.get("text-rotation-alignment")==="map",Pr=R.get("text-pitch-alignment")==="map",fr=R.get("icon-text-fit")!=="none",Tr=R.get("symbol-z-order")==="viewport-y",Ar=Bt&&(qt||!O.hasIconData()||Rt),nn=qt&&(Bt||!O.hasTextData()||Zt);!O.collisionArrays&&tt&&O.deserializeCollisionBoxes(tt);var Xr=function(_n,ia){if(!a[_n.crossTileID])if(Je)l.placements[_n.crossTileID]=new Ys(!1,!1,!1);else{var xa,Wn=!1,Aa=!1,ta=!0,La=null,ja={box:null,offscreen:null},Ji={box:null,offscreen:null},wi=null,vo=null,_i=0,Wi=0,Ns=0;ia.textFeatureIndex?_i=ia.textFeatureIndex:_n.useRuntimeCollisionCircles&&(_i=_n.featureIndex),ia.verticalTextFeatureIndex&&(Wi=ia.verticalTextFeatureIndex);var go=ia.textBox;if(go){var bu=function(Jo){var yo=o.WritingMode.horizontal;if(O.allowVerticalPlacement&&!Jo&&l.prevPlacement){var Fo=l.prevPlacement.placedOrientations[_n.crossTileID];Fo&&(l.placedOrientations[_n.crossTileID]=Fo,l.markUsedOrientation(O,yo=Fo,_n))}return yo},xu=function(Jo,yo){if(O.allowVerticalPlacement&&_n.numVerticalGlyphVertices>0&&ia.verticalTextBox)for(var Fo=0,Gs=O.writingModes;Fo<Gs.length&&(Gs[Fo]===o.WritingMode.vertical?(ja=yo(),Ji=ja):ja=Jo(),!(ja&&ja.box&&ja.box.length));Fo+=1);else ja=Jo()};if(R.get("text-variable-anchor")){var zo=R.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[_n.crossTileID]){var As=l.prevPlacement.variableOffsets[_n.crossTileID];zo.indexOf(As.anchor)>0&&(zo=zo.filter(function(Po){return Po!==As.anchor})).unshift(As.anchor)}var Du=function(Jo,yo,Fo){for(var Gs=Jo.x2-Jo.x1,wl=Jo.y2-Jo.y1,Hc=_n.textBoxScale,Gl=fr&&!qt?yo:null,qu={box:[],offscreen:!1},ju=Bt?2*zo.length:zo.length,zu=0;zu<ju;++zu){var Hs=l.attemptAnchorPlacement(zo[zu%zo.length],Jo,Gs,wl,Hc,Qt,Pr,Xe,j,Lt,zu>=zo.length,_n,O,Fo,Gl);if(Hs&&(qu=Hs.placedGlyphBoxes)&&qu.box&&qu.box.length){Wn=!0,La=Hs.shift;break}}return qu};xu(function(){return Du(go,ia.iconBox,o.WritingMode.horizontal)},function(){var Po=ia.verticalTextBox;return O.allowVerticalPlacement&&!(ja&&ja.box&&ja.box.length)&&_n.numVerticalGlyphVertices>0&&Po?Du(Po,ia.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),ja&&(Wn=ja.box,ta=ja.offscreen);var oc=bu(ja&&ja.box);if(!Wn&&l.prevPlacement){var Qu=l.prevPlacement.variableOffsets[_n.crossTileID];Qu&&(l.variableOffsets[_n.crossTileID]=Qu,l.markUsedJustification(O,Qu.anchor,_n,oc))}}else{var sc=function(Jo,yo){var Fo=l.collisionIndex.placeCollisionBox(Jo,Bt,Xe,j,Lt.predicate);return Fo&&Fo.box&&Fo.box.length&&(l.markUsedOrientation(O,yo,_n),l.placedOrientations[_n.crossTileID]=yo),Fo};xu(function(){return sc(go,o.WritingMode.horizontal)},function(){var Po=ia.verticalTextBox;return O.allowVerticalPlacement&&_n.numVerticalGlyphVertices>0&&Po?sc(Po,o.WritingMode.vertical):{box:null,offscreen:null}}),bu(ja&&ja.box&&ja.box.length)}}if(Wn=(xa=ja)&&xa.box&&xa.box.length>0,ta=xa&&xa.offscreen,_n.useRuntimeCollisionCircles){var uc=O.text.placedSymbolArray.get(_n.centerJustifiedTextSymbolIndex),Nu=o.evaluateSizeForFeature(O.textSizeData,Dt,uc),pl=R.get("text-padding");wi=l.collisionIndex.placeCollisionCircles(Bt,uc,O.lineVertexArray,O.glyphOffsetArray,Nu,j,ue,Te,n,Pr,Lt.predicate,_n.collisionCircleDiameter,pl),Wn=Bt||wi.circles.length>0&&!wi.collisionDetected,ta=ta&&wi.offscreen}if(ia.iconFeatureIndex&&(Ns=ia.iconFeatureIndex),ia.iconBox){var Cs=function(Jo){var yo=fr&&La?Ut(Jo,La.x,La.y,Qt,Pr,l.transform.angle):Jo;return l.collisionIndex.placeCollisionBox(yo,qt,Xe,j,Lt.predicate)};Aa=Ji&&Ji.box&&Ji.box.length&&ia.verticalIconBox?(vo=Cs(ia.verticalIconBox)).box.length>0:(vo=Cs(ia.iconBox)).box.length>0,ta=ta&&vo.offscreen}var co=Zt||_n.numHorizontalGlyphVertices===0&&_n.numVerticalGlyphVertices===0,ku=Rt||_n.numIconVertices===0;if(co||ku?ku?co||(Aa=Aa&&Wn):Wn=Aa&&Wn:Aa=Wn=Aa&&Wn,Wn&&xa&&xa.box&&l.collisionIndex.insertCollisionBox(xa.box,R.get("text-ignore-placement"),O.bucketInstanceId,Ji&&Ji.box&&Wi?Wi:_i,Lt.ID),Aa&&vo&&l.collisionIndex.insertCollisionBox(vo.box,R.get("icon-ignore-placement"),O.bucketInstanceId,Ns,Lt.ID),wi&&(Wn&&l.collisionIndex.insertCollisionCircles(wi.circles,R.get("text-ignore-placement"),O.bucketInstanceId,_i,Lt.ID),n)){var Eu=O.bucketInstanceId,Oo=l.collisionCircleArrays[Eu];Oo===void 0&&(Oo=l.collisionCircleArrays[Eu]=new _o);for(var Mo=0;Mo<wi.circles.length;Mo+=4)Oo.circles.push(wi.circles[Mo+0]),Oo.circles.push(wi.circles[Mo+1]),Oo.circles.push(wi.circles[Mo+2]),Oo.circles.push(wi.collisionDetected?1:0)}l.placements[_n.crossTileID]=new Ys(Wn||Ar,Aa||nn,ta||O.justReloaded),a[_n.crossTileID]=!0}};if(Tr)for(var gn=O.getSortedSymbolIndexes(this.transform.angle),Pn=gn.length-1;Pn>=0;--Pn){var Jn=gn[Pn];Xr(O.symbolInstances.get(Jn),O.collisionArrays[Jn])}else for(var aa=s.symbolInstanceStart;aa<s.symbolInstanceEnd;aa++)Xr(O.symbolInstances.get(aa),O.collisionArrays[aa]);if(n&&O.bucketInstanceId in this.collisionCircleArrays){var ba=this.collisionCircleArrays[O.bucketInstanceId];o.invert(ba.invProjMatrix,j),ba.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Ie.prototype.markUsedJustification=function(s,a,n,l){var b;b=l===o.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(a)];for(var O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];O<R.length;O+=1){var j=R[O];j>=0&&(s.text.placedSymbolArray.get(j).crossTileID=b>=0&&j!==b?0:n.crossTileID)}},Ie.prototype.markUsedOrientation=function(s,a,n){for(var l=a===o.WritingMode.horizontal||a===o.WritingMode.horizontalOnly?a:0,b=a===o.WritingMode.vertical?a:0,O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];O<R.length;O+=1)s.text.placedSymbolArray.get(R[O]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=b)},Ie.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,b=a?a.opacities:{},O=a?a.variableOffsets:{},R=a?a.placedOrientations:{};for(var j in this.placements){var ue=this.placements[j],Te=b[j];Te?(this.opacities[j]=new so(Te,l,ue.text,ue.icon),n=n||ue.text!==Te.text.placed||ue.icon!==Te.icon.placed):(this.opacities[j]=new so(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var Xe in b){var Je=b[Xe];if(!this.opacities[Xe]){var tt=new so(Je,l,!1,!1);tt.isHidden()||(this.opacities[Xe]=tt,n=n||Je.text.placed||Je.icon.placed)}}for(var Dt in O)this.variableOffsets[Dt]||!this.opacities[Dt]||this.opacities[Dt].isHidden()||(this.variableOffsets[Dt]=O[Dt]);for(var Lt in R)this.placedOrientations[Lt]||!this.opacities[Lt]||this.opacities[Lt].isHidden()||(this.placedOrientations[Lt]=R[Lt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Ie.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,b=a;l<b.length;l+=1){var O=b[l],R=O.getBucket(s);R&&O.latestFeatureIndex&&s.id===R.layerIds[0]&&this.updateBucketOpacities(R,n,O.collisionBoxArray)}},Ie.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var b=s.layers[0].layout,O=new so(null,0,!1,!1,!0),R=b.get("text-allow-overlap"),j=b.get("icon-allow-overlap"),ue=b.get("text-variable-anchor"),Te=b.get("text-rotation-alignment")==="map",Xe=b.get("text-pitch-alignment")==="map",Je=b.get("icon-text-fit")!=="none",tt=new so(null,0,R&&(j||!s.hasIconData()||b.get("icon-optional")),j&&(R||!s.hasTextData()||b.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Dt=function(qt,Qt,Pr){for(var fr=0;fr<Qt/4;fr++)qt.opacityVertexArray.emplaceBack(Pr)},Lt=function(qt){var Qt=s.symbolInstances.get(qt),Pr=Qt.numHorizontalGlyphVertices,fr=Qt.numVerticalGlyphVertices,Tr=Qt.crossTileID,Ar=l.opacities[Tr];a[Tr]?Ar=O:Ar||(l.opacities[Tr]=Ar=tt),a[Tr]=!0;var nn=Qt.numIconVertices>0,Xr=l.placedOrientations[Qt.crossTileID],gn=Xr===o.WritingMode.vertical,Pn=Xr===o.WritingMode.horizontal||Xr===o.WritingMode.horizontalOnly;if(Pr>0||fr>0){var Jn=Do(Ar.text);Dt(s.text,Pr,gn?Hu:Jn),Dt(s.text,fr,Pn?Hu:Jn);var aa=Ar.text.isHidden();[Qt.rightJustifiedTextSymbolIndex,Qt.centerJustifiedTextSymbolIndex,Qt.leftJustifiedTextSymbolIndex].forEach(function(ja){ja>=0&&(s.text.placedSymbolArray.get(ja).hidden=aa||gn?1:0)}),Qt.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Qt.verticalPlacedTextSymbolIndex).hidden=aa||Pn?1:0);var ba=l.variableOffsets[Qt.crossTileID];ba&&l.markUsedJustification(s,ba.anchor,Qt,Xr);var Xa=l.placedOrientations[Qt.crossTileID];Xa&&(l.markUsedJustification(s,"left",Qt,Xa),l.markUsedOrientation(s,Xa,Qt))}if(nn){var _n=Do(Ar.icon),ia=!(Je&&Qt.verticalPlacedIconSymbolIndex&&gn);Qt.placedIconSymbolIndex>=0&&(Dt(s.icon,Qt.numIconVertices,ia?_n:Hu),s.icon.placedSymbolArray.get(Qt.placedIconSymbolIndex).hidden=Ar.icon.isHidden()),Qt.verticalPlacedIconSymbolIndex>=0&&(Dt(s.icon,Qt.numVerticalIconVertices,ia?Hu:_n),s.icon.placedSymbolArray.get(Qt.verticalPlacedIconSymbolIndex).hidden=Ar.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var xa=s.collisionArrays[qt];if(xa){var Wn=new o.Point(0,0);if(xa.textBox||xa.verticalTextBox){var Aa=!0;if(ue){var ta=l.variableOffsets[Tr];ta?(Wn=So(ta.anchor,ta.width,ta.height,ta.textOffset,ta.textBoxScale),Te&&Wn._rotate(Xe?l.transform.angle:-l.transform.angle)):Aa=!1}xa.textBox&&Pt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||gn,Wn.x,Wn.y),xa.verticalTextBox&&Pt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||Pn,Wn.x,Wn.y)}var La=Boolean(!Pn&&xa.verticalIconBox);xa.iconBox&&Pt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,La,Je?Wn.x:0,Je?Wn.y:0),xa.verticalIconBox&&Pt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,!La,Je?Wn.x:0,Je?Wn.y:0)}}},Zt=0;Zt<s.symbolInstances.length;Zt++)Lt(Zt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var Rt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Rt.invProjMatrix,s.placementViewportMatrix=Rt.viewportMatrix,s.collisionCircleArray=Rt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Ie.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ie.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Ie.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Ie.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Ie.prototype.setStale=function(){this.stale=!0};var cr=Math.pow(2,25),tn=Math.pow(2,24),En=Math.pow(2,17),Fn=Math.pow(2,16),Ri=Math.pow(2,9),to=Math.pow(2,8),mo=Math.pow(2,1);function Do(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*cr+a*tn+n*En+a*Fn+n*Ri+a*to+n*mo+a}var Hu=0,Xl=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Xl.prototype.continuePlacement=function(s,a,n,l,b){for(var O=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(O,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(function(R,j){return R.sortKey-j.sortKey}));this._currentPartIndex<O.length;)if(a.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,b())return!0;return!1};var $s=function(a,n,l,b,O,R,j){this.placement=new Ie(a,O,R,j),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=b,this._done=!1};$s.prototype.isDone=function(){return this._done},$s.prototype.continuePlacement=function(s,a,n){for(var l=this,b=o.browser.now(),O=function(){var Te=o.browser.now()-b;return!l._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var R=a[s[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=j)&&(!R.maxzoom||R.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new Xl(R)),this._inProgressLayer.continuePlacement(n[R.source],this.placement,this._showCollisionBoxes,R,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$s.prototype.commit=function(s){return this.placement.commit(s),this.placement};var Ic=512/o.EXTENT/2,Ll=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var b=0;b<n.length;b++){var O=n.get(b),R=O.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,a)})}};Ll.prototype.getScaledCoordinates=function(s,a){var n=Ic/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*o.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*o.EXTENT+s.anchorY)*n)}},Ll.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),b=0;b<s.length;b++){var O=s.get(b);if(!O.crossTileID){var R=this.indexedSymbolInstances[O.key];if(R)for(var j=this.getScaledCoordinates(O,a),ue=0,Te=R;ue<Te.length;ue+=1){var Xe=Te[ue];if(Math.abs(Xe.coord.x-j.x)<=l&&Math.abs(Xe.coord.y-j.y)<=l&&!n[Xe.crossTileID]){n[Xe.crossTileID]=!0,O.crossTileID=Xe.crossTileID;break}}}}};var fs=function(){this.maxCrossTileID=0};fs.prototype.generate=function(){return++this.maxCrossTileID};var ks=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ks.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],b={};for(var O in l){var R=l[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+a),b[R.tileID.key]=R}this.indexes[n]=b}this.lng=s},ks.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var b=this.usedCrossTileIDs[s.overscaledZ];for(var O in this.indexes){var R=this.indexes[O];if(Number(O)>s.overscaledZ)for(var j in R){var ue=R[j];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,b)}else{var Te=R[s.scaledTo(Number(O)).key];Te&&Te.findMatches(a.symbolInstances,s,b)}}for(var Xe=0;Xe<a.symbolInstances.length;Xe++){var Je=a.symbolInstances.get(Xe);Je.crossTileID||(Je.crossTileID=n.generate(),b[Je.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Ll(s,a.symbolInstances,a.bucketInstanceId),!0},ks.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,b=a.indexedSymbolInstances[n];l<b.length;l+=1)delete this.usedCrossTileIDs[s][b[l].crossTileID]},ks.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var b in l)s[l[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[b]),delete l[b],a=!0)}return a};var uo=function(){this.layerIndexes={},this.crossTileIDs=new fs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};uo.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new ks);var b=!1,O={};l.handleWrapJump(n);for(var R=0,j=a;R<j.length;R+=1){var ue=j[R],Te=ue.getBucket(s);Te&&s.id===Te.layerIds[0]&&(Te.bucketInstanceId||(Te.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Te,this.crossTileIDs)&&(b=!0),O[Te.bucketInstanceId]=!0)}return l.removeStaleBuckets(O)&&(b=!0),b},uo.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var hs=function(a,n){return o.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Js=o.pick(vn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),cu=o.pick(vn,["setCenter","setZoom","setBearing","setPitch"]),Yl=function(){var s={},a=o.styleSpec.$version;for(var n in o.styleSpec.$root){var l,b=o.styleSpec.$root[n];b.required&&((l=n==="version"?a:b.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),yi=function(s){function a(n,l){var b=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ut(Er(),this),this.imageManager=new ke,this.imageManager.setEventedParent(this),this.glyphManager=new De(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Le(256,512),this.crossTileSymbolIndex=new uo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var O=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(R){O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:R.pluginStatus,pluginURL:R.pluginURL},function(j,ue){if(o.triggerPluginCompletionEvent(j),ue&&ue.every(function(Xe){return Xe}))for(var Te in O.sourceCaches)O.sourceCaches[Te].reload()})}),this.on("data",function(R){if(R.dataType==="source"&&R.sourceDataType==="metadata"){var j=b.sourceCaches[R.sourceId];if(j){var ue=j.getSource();if(ue&&ue.vectorLayerIds)for(var Te in b._layers){var Xe=b._layers[Te];Xe.source===ue.id&&b._validateLayer(Xe)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var b=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var O=typeof l.validate=="boolean"?l.validate:!o.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var R=this.map._requestManager.transformRequest(n,o.ResourceType.Style);this._request=o.getJSON(R,function(j,ue){b._request=null,j?b.fire(new o.ErrorEvent(j)):ue&&b._load(ue,O)})},a.prototype.loadJSON=function(n,l){var b=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){b._request=null,b._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Yl,!1)},a.prototype._load=function(n,l){if(!l||!hs(this,o.validateStyle(n))){for(var b in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(b,n.sources[b],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var O=dn(this.stylesheet.layers);this._order=O.map(function(Te){return Te.id}),this._layers={},this._serializedLayers={};for(var R=0,j=O;R<j.length;R+=1){var ue=j[R];(ue=o.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new st(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(b,O,R){var j,ue,Te,Xe=o.browser.devicePixelRatio>1?"@2x":"",Je=o.getJSON(O.transformRequest(O.normalizeSpriteURL(b,Xe,".json"),o.ResourceType.SpriteJSON),function(Lt,Zt){Je=null,Te||(Te=Lt,j=Zt,Dt())}),tt=o.getImage(O.transformRequest(O.normalizeSpriteURL(b,Xe,".png"),o.ResourceType.SpriteImage),function(Lt,Zt){tt=null,Te||(Te=Lt,ue=Zt,Dt())});function Dt(){if(Te)R(Te);else if(j&&ue){var Lt=o.browser.getImageData(ue),Zt={};for(var Rt in j){var Bt=j[Rt],qt=Bt.width,Qt=Bt.height,Pr=Bt.x,fr=Bt.y,Tr=Bt.sdf,Ar=Bt.pixelRatio,nn=Bt.stretchX,Xr=Bt.stretchY,gn=Bt.content,Pn=new o.RGBAImage({width:qt,height:Qt});o.RGBAImage.copy(Lt,Pn,{x:Pr,y:fr},{x:0,y:0},{width:qt,height:Qt}),Zt[Rt]={data:Pn,pixelRatio:Ar,sdf:Tr,stretchX:nn,stretchY:Xr,content:gn}}R(null,Zt)}}return{cancel:function(){Je&&(Je.cancel(),Je=null),tt&&(tt.cancel(),tt=null)}}}(n,this.map._requestManager,function(b,O){if(l._spriteRequest=null,b)l.fire(new o.ErrorEvent(b));else if(O)for(var R in O)l.imageManager.addImage(R,O[R]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new o.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var b=n.sourceLayer;if(b){var O=l.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+b+'" does not exist on source "'+O.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],b=0,O=n;b<O.length;b+=1){var R=this._layers[O[b]];R.type!=="custom"&&l.push(R.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var b=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);for(var R in(b.length||O.length)&&this._updateWorkerLayers(b,O),this._updatedSources){var j=this._updatedSources[R];j==="reload"?this._reloadSource(R):j==="clear"&&this._clearSource(R)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Te={};for(var Xe in this.sourceCaches){var Je=this.sourceCaches[Xe];Te[Xe]=Je.used,Je.used=!1}for(var tt=0,Dt=this._order;tt<Dt.length;tt+=1){var Lt=this._layers[Dt[tt]];Lt.recalculate(n,this._availableImages),!Lt.isHidden(n.zoom)&&Lt.source&&(this.sourceCaches[Lt.source].used=!0)}for(var Zt in Te){var Rt=this.sourceCaches[Zt];Te[Zt]!==Rt.used&&Rt.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Zt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new o.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),hs(this,o.validateStyle(n)))return!1;(n=o.clone$1(n)).layers=dn(n.layers);var b=function(R,j){if(!R)return[{command:vn.setStyle,args:[j]}];var ue=[];try{if(!o.deepEqual(R.version,j.version))return[{command:vn.setStyle,args:[j]}];o.deepEqual(R.center,j.center)||ue.push({command:vn.setCenter,args:[j.center]}),o.deepEqual(R.zoom,j.zoom)||ue.push({command:vn.setZoom,args:[j.zoom]}),o.deepEqual(R.bearing,j.bearing)||ue.push({command:vn.setBearing,args:[j.bearing]}),o.deepEqual(R.pitch,j.pitch)||ue.push({command:vn.setPitch,args:[j.pitch]}),o.deepEqual(R.sprite,j.sprite)||ue.push({command:vn.setSprite,args:[j.sprite]}),o.deepEqual(R.glyphs,j.glyphs)||ue.push({command:vn.setGlyphs,args:[j.glyphs]}),o.deepEqual(R.transition,j.transition)||ue.push({command:vn.setTransition,args:[j.transition]}),o.deepEqual(R.light,j.light)||ue.push({command:vn.setLight,args:[j.light]});var Te={},Xe=[];!function(tt,Dt,Lt,Zt){var Rt;for(Rt in Dt=Dt||{},tt=tt||{})tt.hasOwnProperty(Rt)&&(Dt.hasOwnProperty(Rt)||Kr(Rt,Lt,Zt));for(Rt in Dt)Dt.hasOwnProperty(Rt)&&(tt.hasOwnProperty(Rt)?o.deepEqual(tt[Rt],Dt[Rt])||(tt[Rt].type==="geojson"&&Dt[Rt].type==="geojson"&&Ka(tt,Dt,Rt)?Lt.push({command:vn.setGeoJSONSourceData,args:[Rt,Dt[Rt].data]}):wn(Rt,Dt,Lt,Zt)):Sr(Rt,Dt,Lt))}(R.sources,j.sources,Xe,Te);var Je=[];R.layers&&R.layers.forEach(function(tt){Te[tt.source]?ue.push({command:vn.removeLayer,args:[tt.id]}):Je.push(tt)}),ue=ue.concat(Xe),function(tt,Dt,Lt){Dt=Dt||[];var Zt,Rt,Bt,qt,Qt,Pr,fr,Tr=(tt=tt||[]).map(Oa),Ar=Dt.map(Oa),nn=tt.reduce(Ia,{}),Xr=Dt.reduce(Ia,{}),gn=Tr.slice(),Pn=Object.create(null);for(Zt=0,Rt=0;Zt<Tr.length;Zt++)Xr.hasOwnProperty(Bt=Tr[Zt])?Rt++:(Lt.push({command:vn.removeLayer,args:[Bt]}),gn.splice(gn.indexOf(Bt,Rt),1));for(Zt=0,Rt=0;Zt<Ar.length;Zt++)gn[gn.length-1-Zt]!==(Bt=Ar[Ar.length-1-Zt])&&(nn.hasOwnProperty(Bt)?(Lt.push({command:vn.removeLayer,args:[Bt]}),gn.splice(gn.lastIndexOf(Bt,gn.length-Rt),1)):Rt++,Lt.push({command:vn.addLayer,args:[Xr[Bt],Pr=gn[gn.length-Zt]]}),gn.splice(gn.length-Zt,0,Bt),Pn[Bt]=!0);for(Zt=0;Zt<Ar.length;Zt++)if(qt=nn[Bt=Ar[Zt]],Qt=Xr[Bt],!Pn[Bt]&&!o.deepEqual(qt,Qt))if(o.deepEqual(qt.source,Qt.source)&&o.deepEqual(qt["source-layer"],Qt["source-layer"])&&o.deepEqual(qt.type,Qt.type)){for(fr in da(qt.layout,Qt.layout,Lt,Bt,null,vn.setLayoutProperty),da(qt.paint,Qt.paint,Lt,Bt,null,vn.setPaintProperty),o.deepEqual(qt.filter,Qt.filter)||Lt.push({command:vn.setFilter,args:[Bt,Qt.filter]}),o.deepEqual(qt.minzoom,Qt.minzoom)&&o.deepEqual(qt.maxzoom,Qt.maxzoom)||Lt.push({command:vn.setLayerZoomRange,args:[Bt,Qt.minzoom,Qt.maxzoom]}),qt)qt.hasOwnProperty(fr)&&fr!=="layout"&&fr!=="paint"&&fr!=="filter"&&fr!=="metadata"&&fr!=="minzoom"&&fr!=="maxzoom"&&(fr.indexOf("paint.")===0?da(qt[fr],Qt[fr],Lt,Bt,fr.slice(6),vn.setPaintProperty):o.deepEqual(qt[fr],Qt[fr])||Lt.push({command:vn.setLayerProperty,args:[Bt,fr,Qt[fr]]}));for(fr in Qt)Qt.hasOwnProperty(fr)&&!qt.hasOwnProperty(fr)&&fr!=="layout"&&fr!=="paint"&&fr!=="filter"&&fr!=="metadata"&&fr!=="minzoom"&&fr!=="maxzoom"&&(fr.indexOf("paint.")===0?da(qt[fr],Qt[fr],Lt,Bt,fr.slice(6),vn.setPaintProperty):o.deepEqual(qt[fr],Qt[fr])||Lt.push({command:vn.setLayerProperty,args:[Bt,fr,Qt[fr]]}))}else Lt.push({command:vn.removeLayer,args:[Bt]}),Pr=gn[gn.lastIndexOf(Bt)+1],Lt.push({command:vn.addLayer,args:[Qt,Pr]})}(Je,j.layers,ue)}catch(tt){console.warn("Unable to compute style diff:",tt),ue=[{command:vn.setStyle,args:[j]}]}return ue}(this.serialize(),n).filter(function(R){return!(R.command in cu)});if(b.length===0)return!1;var O=b.filter(function(R){return!(R.command in Js)});if(O.length>0)throw new Error("Unimplemented: "+O.map(function(R){return R.command}).join(", ")+".");return b.forEach(function(R){R.command!=="setTransition"&&l[R.command].apply(l,R.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,b){var O=this;if(b===void 0&&(b={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(o.validateStyle.source,"sources."+n,l,null,b))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var R=this.sourceCaches[n]=new wt(n,l,this.dispatcher);R.style=this,R.setEventedParent(this,function(){return{isSourceLoaded:O.loaded(),source:R.serialize(),sourceId:n}}),R.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new o.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var b=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],b.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,b){b===void 0&&(b={}),this._checkLoaded();var O=n.id;if(this.getLayer(O))this.fire(new o.ErrorEvent(new Error('Layer with id "'+O+'" already exists on this map')));else{var R;if(n.type==="custom"){if(hs(this,o.validateCustomStyleLayer(n)))return;R=o.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(O,n.source),n=o.clone$1(n),n=o.extend(n,{source:O})),this._validate(o.validateStyle.layer,"layers."+O,n,{arrayIndex:-1},b))return;R=o.createStyleLayer(n),this._validateLayer(R),R.setEventedParent(this,{layer:{id:O}}),this._serializedLayers[R.id]=R.serialize()}var j=l?this._order.indexOf(l):this._order.length;if(l&&j===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(j,0,O),this._layerOrderChanged=!0,this._layers[O]=R,this._removedLayers[O]&&R.source&&R.type!=="custom"){var ue=this._removedLayers[O];delete this._removedLayers[O],ue.type!==R.type?this._updatedSources[R.source]="clear":(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause())}this._updateLayer(R),R.onAdd&&R.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var b=this._order.indexOf(n);this._order.splice(b,1);var O=l?this._order.indexOf(l):this._order.length;l&&O===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(O,0,n),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var b=this._order.indexOf(n);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,b){this._checkLoaded();var O=this.getLayer(n);O?O.minzoom===l&&O.maxzoom===b||(l!=null&&(O.minzoom=l),b!=null&&(O.maxzoom=b),this._updateLayer(O)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,b){b===void 0&&(b={}),this._checkLoaded();var O=this.getLayer(n);if(O){if(!o.deepEqual(O.filter,l))return l==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(o.validateStyle.filter,"layers."+O.id+".filter",l,null,b)||(O.filter=o.clone$1(l),this._updateLayer(O)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return o.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,b,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getLayoutProperty(l),b)||(R.setLayoutProperty(l,b,O),this._updateLayer(R)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var b=this.getLayer(n);if(b)return b.getLayoutProperty(l);this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,b,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getPaintProperty(l),b)||(R.setPaintProperty(l,b,O)&&this._updateLayer(R),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var b=n.source,O=n.sourceLayer,R=this.sourceCaches[b];if(R!==void 0){var j=R.getSource().type;j==="geojson"&&O?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||O?(n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),R.setFeatureState(O,n.id,l)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var b=n.source,O=this.sourceCaches[b];if(O!==void 0){var R=O.getSource().type,j=R==="vector"?n.sourceLayer:void 0;R!=="vector"||j?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(j,n.id,l):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,b=n.sourceLayer,O=this.sourceCaches[l];if(O!==void 0){if(O.getSource().type!=="vector"||b)return n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),O.getFeatureState(b,n.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,b=function(Xr){return l._layers[Xr].type==="fill-extrusion"},O={},R=[],j=this._order.length-1;j>=0;j--){var ue=this._order[j];if(b(ue)){O[ue]=j;for(var Te=0,Xe=n;Te<Xe.length;Te+=1){var Je=Xe[Te][ue];if(Je)for(var tt=0,Dt=Je;tt<Dt.length;tt+=1)R.push(Dt[tt])}}}R.sort(function(nn,Xr){return Xr.intersectionZ-nn.intersectionZ});for(var Lt=[],Zt=this._order.length-1;Zt>=0;Zt--){var Rt=this._order[Zt];if(b(Rt))for(var Bt=R.length-1;Bt>=0;Bt--){var qt=R[Bt].feature;if(O[qt.layer.id]<Zt)break;Lt.push(qt),R.pop()}else for(var Qt=0,Pr=n;Qt<Pr.length;Qt+=1){var fr=Pr[Qt][Rt];if(fr)for(var Tr=0,Ar=fr;Tr<Ar.length;Tr+=1)Lt.push(Ar[Tr].feature)}}return Lt},a.prototype.queryRenderedFeatures=function(n,l,b){l&&l.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var O={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var R=0,j=l.layers;R<j.length;R+=1){var ue=j[R],Te=this._layers[ue];if(!Te)return this.fire(new o.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];O[Te.source]=!0}}var Xe=[];for(var Je in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!O[Je]||Xe.push(St(this.sourceCaches[Je],this._layers,this._serializedLayers,n,l,b));return this.placement&&Xe.push(function(tt,Dt,Lt,Zt,Rt,Bt,qt){for(var Qt={},Pr=Bt.queryRenderedSymbols(Zt),fr=[],Tr=0,Ar=Object.keys(Pr).map(Number);Tr<Ar.length;Tr+=1)fr.push(qt[Ar[Tr]]);fr.sort(ye);for(var nn=function(){var ba=gn[Xr],Xa=ba.featureIndex.lookupSymbolFeatures(Pr[ba.bucketInstanceId],Dt,ba.bucketIndex,ba.sourceLayerIndex,Rt.filter,Rt.layers,Rt.availableImages,tt);for(var _n in Xa){var ia=Qt[_n]=Qt[_n]||[],xa=Xa[_n];xa.sort(function(ta,La){var ja=ba.featureSortOrder;if(ja){var Ji=ja.indexOf(ta.featureIndex);return ja.indexOf(La.featureIndex)-Ji}return La.featureIndex-ta.featureIndex});for(var Wn=0,Aa=xa;Wn<Aa.length;Wn+=1)ia.push(Aa[Wn])}},Xr=0,gn=fr;Xr<gn.length;Xr+=1)nn();var Pn=function(ba){Qt[ba].forEach(function(Xa){var _n=Xa.feature,ia=Lt[tt[ba].source].getFeatureState(_n.layer["source-layer"],_n.id);_n.source=_n.layer.source,_n.layer["source-layer"]&&(_n.sourceLayer=_n.layer["source-layer"]),_n.state=ia})};for(var Jn in Qt)Pn(Jn);return Qt}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Xe)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var b=this.sourceCaches[n];return b?function(O,R){for(var j=O.getRenderableIds().map(function(Dt){return O.getTileByID(Dt)}),ue=[],Te={},Xe=0;Xe<j.length;Xe++){var Je=j[Xe],tt=Je.tileID.canonical.key;Te[tt]||(Te[tt]=!0,Je.querySourceFeatures(ue,R))}return ue}(b,l):[]},a.prototype.addSourceType=function(n,l,b){return a.getSourceType(n)?b(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},b):b(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var b=this.light.getLight(),O=!1;for(var R in n)if(!o.deepEqual(n[R],b[R])){O=!0;break}if(O){var j={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(j)}},a.prototype._validate=function(n,l,b,O,R){return R===void 0&&(R={}),(!R||R.validate!==!1)&&hs(this,n.call(o.validateStyle,o.extend({key:l,style:this.serialize(),value:b,styleSpec:o.styleSpec},O)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,b,O,R){R===void 0&&(R=!1);for(var j=!1,ue=!1,Te={},Xe=0,Je=this._order;Xe<Je.length;Xe+=1){var tt=this._layers[Je[Xe]];if(tt.type==="symbol"){if(!Te[tt.source]){var Dt=this.sourceCaches[tt.source];Te[tt.source]=Dt.getRenderableIds(!0).map(function(qt){return Dt.getTileByID(qt)}).sort(function(qt,Qt){return Qt.tileID.overscaledZ-qt.tileID.overscaledZ||(qt.tileID.isLessThan(Qt.tileID)?-1:1)})}var Lt=this.crossTileSymbolIndex.addLayer(tt,Te[tt.source],n.center.lng);j=j||Lt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((R=R||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),n.zoom))&&(this.pauseablePlacement=new $s(n,this._order,R,l,b,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Te),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),ue=!0),j&&this.pauseablePlacement.placement.setStale()),ue||j)for(var Zt=0,Rt=this._order;Zt<Rt.length;Zt+=1){var Bt=this._layers[Rt[Zt]];Bt.type==="symbol"&&this.placement.updateLayerOpacities(Bt,Te[Bt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,b){this.imageManager.getImages(l.icons,b),this._updateTilesForChangedImages();var O=this.sourceCaches[l.source];O&&O.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,b){this.glyphManager.getGlyphs(l.stacks,b)},a.prototype.getResource=function(n,l,b){return o.makeRequest(l,b)},a}(o.Evented);yi.getSourceType=function(s){return rt[s]},yi.setSourceType=function(s,a){rt[s]=a},yi.registerForPluginStateChange=o.registerForPluginStateChange;var Ni=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),vl=pi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),js=pi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ds=pi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ot=pi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),er=pi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Or=pi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Bn=pi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qa=pi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ii=pi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Gi=pi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),qa=pi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),bi=pi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ao=pi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),zs=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),di=pi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Kl=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),fu=pi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Os=pi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),gl=pi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),hu=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Wu=pi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Qs=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),nl=pi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),du=pi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),vc=pi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Pf=pi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function pi(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),b=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=O?O.concat(b):b,j={};return{fragmentSource:s=s.replace(n,function(ue,Te,Xe,Je,tt){return j[tt]=!0,Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
varying `+Xe+" "+Je+" "+tt+`;
#else
uniform `+Xe+" "+Je+" u_"+tt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+Je+" "+tt+" = u_"+tt+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Te,Xe,Je,tt){var Dt=Je==="float"?"vec2":"vec4",Lt=tt.match(/color/)?"color":Dt;return j[tt]?Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Xe+" "+Dt+" a_"+tt+`;
varying `+Xe+" "+Je+" "+tt+`;
#else
uniform `+Xe+" "+Je+" u_"+tt+`;
#endif
`:Lt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = a_"+tt+`;
#else
    `+Xe+" "+Je+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = unpack_mix_"+Lt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Xe+" "+Je+" "+tt+" = u_"+tt+`;
#endif
`:Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Xe+" "+Dt+" a_"+tt+`;
#else
uniform `+Xe+" "+Je+" u_"+tt+`;
#endif
`:Lt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+Je+" "+tt+" = a_"+tt+`;
#else
    `+Xe+" "+Je+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Xe+" "+Je+" "+tt+" = unpack_mix_"+Lt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Xe+" "+Je+" "+tt+" = u_"+tt+`;
#endif
`}),staticAttributes:l,staticUniforms:R}}var Dc=Object.freeze({__proto__:null,prelude:vl,background:js,backgroundPattern:ds,circle:Ot,clippingMask:er,heatmap:Or,heatmapTexture:Bn,collisionBox:Qa,collisionCircle:Ii,debug:Gi,fill:qa,fillOutline:bi,fillOutlinePattern:Ao,fillPattern:zs,fillExtrusion:di,fillExtrusionPattern:Kl,hillshadePrepare:fu,hillshade:Os,line:gl,lineGradient:hu,linePattern:Wu,lineSDF:Qs,raster:nl,symbolIcon:du,symbolSDF:vc,symbolTextAndIcon:Pf}),gc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function rf(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}gc.prototype.bind=function(s,a,n,l,b,O,R,j){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Te=0;!ue&&Te<l.length;Te++)this.boundPaintVertexBuffers[Te]!==l[Te]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===b&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===R&&this.boundDynamicVertexBuffer2===j?(s.bindVertexArrayOES.set(this.vao),R&&R.bind(),b&&b.dynamicDraw&&b.bind(),j&&j.bind()):this.freshBind(a,n,l,b,O,R,j)},gc.prototype.freshBind=function(s,a,n,l,b,O,R){var j,ue=s.numAttributes,Te=this.context,Xe=Te.gl;if(Te.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Te.extVertexArrayObject.createVertexArrayOES(),Te.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=R;else{j=Te.currentNumAttributes||0;for(var Je=ue;Je<j;Je++)Xe.disableVertexAttribArray(Je)}a.enableAttributes(Xe,s);for(var tt=0,Dt=n;tt<Dt.length;tt+=1)Dt[tt].enableAttributes(Xe,s);O&&O.enableAttributes(Xe,s),R&&R.enableAttributes(Xe,s),a.bind(),a.setVertexAttribPointers(Xe,s,b);for(var Lt=0,Zt=n;Lt<Zt.length;Lt+=1){var Rt=Zt[Lt];Rt.bind(),Rt.setVertexAttribPointers(Xe,s,b)}O&&(O.bind(),O.setVertexAttribPointers(Xe,s,b)),l&&l.bind(),R&&(R.bind(),R.setVertexAttribPointers(Xe,s,b)),Te.currentNumAttributes=ue},gc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var nf=function(a,n,l,b,O,R){var j=a.gl;this.program=j.createProgram();for(var ue=rf(l.staticAttributes),Te=b?b.getBinderAttributes():[],Xe=ue.concat(Te),Je=l.staticUniforms?rf(l.staticUniforms):[],tt=b?b.getBinderUniforms():[],Dt=[],Lt=0,Zt=Je.concat(tt);Lt<Zt.length;Lt+=1){var Rt=Zt[Lt];Dt.indexOf(Rt)<0&&Dt.push(Rt)}var Bt=b?b.defines():[];R&&Bt.push("#define OVERDRAW_INSPECTOR;");var qt=Bt.concat(vl.fragmentSource,l.fragmentSource).join(`
`),Qt=Bt.concat(vl.vertexSource,l.vertexSource).join(`
`),Pr=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(Pr,qt),j.compileShader(Pr),j.attachShader(this.program,Pr);var fr=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(fr,Qt),j.compileShader(fr),j.attachShader(this.program,fr),this.attributes={};var Tr={};this.numAttributes=Xe.length;for(var Ar=0;Ar<this.numAttributes;Ar++)Xe[Ar]&&(j.bindAttribLocation(this.program,Ar,Xe[Ar]),this.attributes[Xe[Ar]]=Ar);j.linkProgram(this.program),j.deleteShader(fr),j.deleteShader(Pr);for(var nn=0;nn<Dt.length;nn++){var Xr=Dt[nn];if(Xr&&!Tr[Xr]){var gn=j.getUniformLocation(this.program,Xr);gn&&(Tr[Xr]=gn)}}this.fixedUniforms=O(a,Tr),this.binderUniforms=b?b.getUniforms(a,Tr):[]}}};function af(s,a,n){var l=1/Ja(n,1,a.transform.tileZoom),b=Math.pow(2,n.tileID.overscaledZ),O=n.tileSize*Math.pow(2,a.transform.tileZoom)/b,R=O*(n.tileID.canonical.x+n.tileID.wrap*b),j=O*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[R>>16,j>>16],u_pixel_coord_lower:[65535&R,65535&j]}}nf.prototype.draw=function(s,a,n,l,b,O,R,j,ue,Te,Xe,Je,tt,Dt,Lt,Zt){var Rt,Bt=s.gl;if(!this.failedToCreate){for(var qt in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(b),s.setCullFace(O),this.fixedUniforms)this.fixedUniforms[qt].set(R[qt]);Dt&&Dt.setUniforms(s,this.binderUniforms,Je,{zoom:tt});for(var Qt=(Rt={},Rt[Bt.LINES]=2,Rt[Bt.TRIANGLES]=3,Rt[Bt.LINE_STRIP]=1,Rt)[a],Pr=0,fr=Xe.get();Pr<fr.length;Pr+=1){var Tr=fr[Pr],Ar=Tr.vaos||(Tr.vaos={});(Ar[j]||(Ar[j]=new gc)).bind(s,this,ue,Dt?Dt.getPaintVertexBuffers():[],Te,Tr.vertexOffset,Lt,Zt),Bt.drawElements(a,Tr.primitiveLength*Qt,Bt.UNSIGNED_SHORT,Tr.primitiveOffset*Qt*2)}}};var $i=function(a,n,l,b){var O=n.style.light,R=O.properties.get("position"),j=[R.x,R.y,R.z],ue=o.create$1();O.properties.get("anchor")==="viewport"&&o.fromRotation(ue,-n.transform.angle),o.transformMat3(j,j,ue);var Te=O.properties.get("color");return{u_matrix:a,u_lightpos:j,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+l,u_opacity:b}},Cu=function(a,n,l,b,O,R,j){return o.extend($i(a,n,l,b),af(R,n,j),{u_height_factor:-Math.pow(2,O.overscaledZ)/j.tileSize/8})},qs=function(a){return{u_matrix:a}},ps=function(a,n,l,b){return o.extend(qs(a),af(l,n,b))},Nc=function(a,n){return{u_matrix:a,u_world:n}},yc=function(a,n,l,b,O){return o.extend(ps(a,n,l,b),{u_world:O})},yl=function(a,n,l,b){var O,R,j=a.transform;if(b.paint.get("circle-pitch-alignment")==="map"){var ue=Ja(l,1,j.zoom);O=!0,R=[ue,ue]}else O=!1,R=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(b.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:R}},al=function(a,n,l){var b=Ja(l,1,n.zoom),O=Math.pow(2,n.zoom-l.tileID.overscaledZ),R=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:b,u_extrude_scale:[n.pixelsToGLUnits[0]/(b*O),n.pixelsToGLUnits[1]/(b*O)],u_overscale_factor:R}},bc=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},eu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},Zu=function(a){return{u_matrix:a}},kc=function(a,n,l,b){return{u_matrix:a,u_extrude_scale:Ja(n,1,l),u_intensity:b}},$l=function(a,n,l){var b=a.transform;return{u_matrix:zc(a,n,l),u_ratio:1/Ja(n,1,b.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Ci=function(a,n,l,b){return o.extend($l(a,n,l),{u_image:0,u_image_height:b})},jc=function(a,n,l,b){var O=a.transform,R=xc(n,O);return{u_matrix:zc(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Ja(n,1,O.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[R,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},Lf=function(a,n,l,b,O){var R=a.lineAtlas,j=xc(n,a.transform),ue=l.layout.get("line-cap")==="round",Te=R.getDash(b.from,ue),Xe=R.getDash(b.to,ue),Je=Te.width*O.fromScale,tt=Xe.width*O.toScale;return o.extend($l(a,n,l),{u_patternscale_a:[j/Je,-Te.height/2],u_patternscale_b:[j/tt,-Xe.height/2],u_sdfgamma:R.width/(256*Math.min(Je,tt)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Te.y,u_tex_y_b:Xe.y,u_mix:O.t})};function xc(s,a){return 1/Ja(s,1,a.tileZoom)}function zc(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Jl=function(a,n,l,b,O){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:b.mix,u_opacity:b.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(j=O.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(R=O.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Xu(O.paint.get("raster-hue-rotate"))};var R,j};function Xu(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var wu,Rl=function(a,n,l,b,O,R,j,ue,Te,Xe){var Je=O.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Je.cameraToCenterDistance,u_pitch:Je.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:Je.width/Je.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:R,u_label_plane_matrix:j,u_coord_matrix:ue,u_is_text:+Te,u_pitch_with_map:+b,u_texsize:Xe,u_texture:0}},No=function(a,n,l,b,O,R,j,ue,Te,Xe,Je){var tt=O.transform;return o.extend(Rl(a,n,l,b,O,R,j,ue,Te,Xe),{u_gamma_scale:b?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+Je})},Ql=function(a,n,l,b,O,R,j,ue,Te,Xe){return o.extend(No(a,n,l,b,O,R,j,ue,!0,Te,!0),{u_texsize_icon:Xe,u_texture_icon:1})},Il=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},bl=function(a,n,l,b,O,R){return o.extend(function(j,ue,Te,Xe){var Je=Te.imageManager.getPattern(j.from.toString()),tt=Te.imageManager.getPattern(j.to.toString()),Dt=Te.imageManager.getPixelSize(),Lt=Dt.width,Zt=Dt.height,Rt=Math.pow(2,Xe.tileID.overscaledZ),Bt=Xe.tileSize*Math.pow(2,Te.transform.tileZoom)/Rt,qt=Bt*(Xe.tileID.canonical.x+Xe.tileID.wrap*Rt),Qt=Bt*Xe.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Je.tl,u_pattern_br_a:Je.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[Lt,Zt],u_mix:ue.t,u_pattern_size_a:Je.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Ja(Xe,1,Te.transform.tileZoom),u_pixel_coord_upper:[qt>>16,Qt>>16],u_pixel_coord_lower:[65535&qt,65535&Qt]}}(b,R,l,O),{u_matrix:a,u_opacity:n})},Fc={fillExtrusion:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new o.Uniform1f(a,n.u_height_factor),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new o.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new o.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new o.UniformColor(a,n.u_color),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_overlay:new o.Uniform1i(a,n.u_overlay),u_overlay_scale:new o.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new o.Uniform1f(a,n.u_extrude_scale),u_intensity:new o.Uniform1f(a,n.u_intensity),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_color_ramp:new o.Uniform1i(a,n.u_color_ramp),u_opacity:new o.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_latrange:new o.Uniform2f(a,n.u_latrange),u_light:new o.Uniform2f(a,n.u_light),u_shadow:new o.UniformColor(a,n.u_shadow),u_highlight:new o.UniformColor(a,n.u_highlight),u_accent:new o.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_dimension:new o.Uniform2f(a,n.u_dimension),u_zoom:new o.Uniform1f(a,n.u_zoom),u_unpack:new o.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_image:new o.Uniform1i(a,n.u_image),u_image_height:new o.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_texsize:new o.Uniform2f(a,n.u_texsize),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_image:new o.Uniform1i(a,n.u_image),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new o.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new o.Uniform1f(a,n.u_sdfgamma),u_image:new o.Uniform1i(a,n.u_image),u_tex_y_a:new o.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new o.Uniform1f(a,n.u_tex_y_b),u_mix:new o.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new o.Uniform2f(a,n.u_tl_parent),u_scale_parent:new o.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new o.Uniform1f(a,n.u_buffer_scale),u_fade_t:new o.Uniform1f(a,n.u_fade_t),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image0:new o.Uniform1i(a,n.u_image0),u_image1:new o.Uniform1i(a,n.u_image1),u_brightness_low:new o.Uniform1f(a,n.u_brightness_low),u_brightness_high:new o.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new o.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new o.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new o.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texsize_icon:new o.Uniform2f(a,n.u_texsize_icon),u_texture:new o.Uniform1i(a,n.u_texture),u_texture_icon:new o.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_color:new o.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image:new o.Uniform1i(a,n.u_image),u_pattern_tl_a:new o.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(a,n.u_pattern_br_b),u_texsize:new o.Uniform2f(a,n.u_texsize),u_mix:new o.Uniform1f(a,n.u_mix),u_pattern_size_a:new o.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new o.Uniform1f(a,n.u_scale_a),u_scale_b:new o.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(a,n.u_tile_units_to_pixels)}}};function Dl(s,a,n,l,b,O,R){for(var j=s.context,ue=j.gl,Te=s.useProgram("collisionBox"),Xe=[],Je=0,tt=0,Dt=0;Dt<l.length;Dt++){var Lt=l[Dt],Zt=a.getTile(Lt),Rt=Zt.getBucket(n);if(Rt){var Bt=Lt.posMatrix;b[0]===0&&b[1]===0||(Bt=s.translatePosMatrix(Lt.posMatrix,Zt,b,O));var qt=R?Rt.textCollisionBox:Rt.iconCollisionBox,Qt=Rt.collisionCircleArray;if(Qt.length>0){var Pr=o.create(),fr=Bt;o.mul(Pr,Rt.placementInvProjMatrix,s.transform.glCoordMatrix),o.mul(Pr,Pr,Rt.placementViewportMatrix),Xe.push({circleArray:Qt,circleOffset:tt,transform:fr,invTransform:Pr}),tt=Je+=Qt.length/4}qt&&Te.draw(j,ue.LINES,pe.disabled,at.disabled,s.colorModeForRenderPass(),jt.disabled,al(Bt,s.transform,Zt),n.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,null,s.transform.zoom,null,null,qt.collisionVertexBuffer)}}if(R&&Xe.length){var Tr=s.useProgram("collisionCircle"),Ar=new o.StructArrayLayout2f1f2i16;Ar.resize(4*Je),Ar._trim();for(var nn=0,Xr=0,gn=Xe;Xr<gn.length;Xr+=1)for(var Pn=gn[Xr],Jn=0;Jn<Pn.circleArray.length/4;Jn++){var aa=4*Jn,ba=Pn.circleArray[aa+0],Xa=Pn.circleArray[aa+1],_n=Pn.circleArray[aa+2],ia=Pn.circleArray[aa+3];Ar.emplace(nn++,ba,Xa,_n,ia,0),Ar.emplace(nn++,ba,Xa,_n,ia,1),Ar.emplace(nn++,ba,Xa,_n,ia,2),Ar.emplace(nn++,ba,Xa,_n,ia,3)}(!wu||wu.length<2*Je)&&(wu=function(Ji){var wi=2*Ji,vo=new o.StructArrayLayout3ui6;vo.resize(wi),vo._trim();for(var _i=0;_i<wi;_i++){var Wi=6*_i;vo.uint16[Wi+0]=4*_i+0,vo.uint16[Wi+1]=4*_i+1,vo.uint16[Wi+2]=4*_i+2,vo.uint16[Wi+3]=4*_i+2,vo.uint16[Wi+4]=4*_i+3,vo.uint16[Wi+5]=4*_i+0}return vo}(Je));for(var xa=j.createIndexBuffer(wu,!0),Wn=j.createVertexBuffer(Ar,o.collisionCircleLayout.members,!0),Aa=0,ta=Xe;Aa<ta.length;Aa+=1){var La=ta[Aa],ja=bc(La.transform,La.invTransform,s.transform);Tr.draw(j,ue.TRIANGLES,pe.disabled,at.disabled,s.colorModeForRenderPass(),jt.disabled,ja,n.id,Wn,xa,o.SegmentVector.simpleSegment(0,2*La.circleOffset,La.circleArray.length,La.circleArray.length/2),null,s.transform.zoom,null,null,null)}Wn.destroy(),xa.destroy()}}var tu=o.identity(new Float32Array(16));function yf(s,a,n,l,b,O){var R=o.getAnchorAlignment(s),j=-(R.horizontalAlign-.5)*a,ue=-(R.verticalAlign-.5)*n,Te=o.evaluateVariableOffset(s,l);return new o.Point((j/b+Te[0])*O,(ue/b+Te[1])*O)}function bf(s,a,n,l,b,O,R,j,ue,Te,Xe){var Je=s.text.placedSymbolArray,tt=s.text.dynamicLayoutVertexArray,Dt=s.icon.dynamicLayoutVertexArray,Lt={};tt.clear();for(var Zt=0;Zt<Je.length;Zt++){var Rt=Je.get(Zt),Bt=Rt.hidden||!Rt.crossTileID||s.allowVerticalPlacement&&!Rt.placedOrientation?null:l[Rt.crossTileID];if(Bt){var qt=new o.Point(Rt.anchorX,Rt.anchorY),Qt=ya(qt,n?j:R),Pr=la(O.cameraToCenterDistance,Qt.signedDistanceFromCamera),fr=b.evaluateSizeForFeature(s.textSizeData,Te,Rt)*Pr/o.ONE_EM;n&&(fr*=s.tilePixelRatio/ue);for(var Tr=yf(Bt.anchor,Bt.width,Bt.height,Bt.textOffset,Bt.textBoxScale,fr),Ar=n?ya(qt.add(Tr),R).point:Qt.point.add(a?Tr.rotate(-O.angle):Tr),nn=s.allowVerticalPlacement&&Rt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<Rt.numGlyphs;Xr++)o.addDynamicAttributes(tt,Ar,nn);Xe&&Rt.associatedIconIndex>=0&&(Lt[Rt.associatedIconIndex]={shiftedAnchor:Ar,angle:nn})}else ii(Rt.numGlyphs,tt)}if(Xe){Dt.clear();for(var gn=s.icon.placedSymbolArray,Pn=0;Pn<gn.length;Pn++){var Jn=gn.get(Pn);if(Jn.hidden)ii(Jn.numGlyphs,Dt);else{var aa=Lt[Pn];if(aa)for(var ba=0;ba<Jn.numGlyphs;ba++)o.addDynamicAttributes(Dt,aa.shiftedAnchor,aa.angle);else ii(Jn.numGlyphs,Dt)}}s.icon.dynamicLayoutVertexBuffer.updateData(Dt)}s.text.dynamicLayoutVertexBuffer.updateData(tt)}function of(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function xl(s,a,n,l,b,O,R,j,ue,Te,Xe,Je){for(var tt=s.context,Dt=tt.gl,Lt=s.transform,Zt=j==="map",Rt=ue==="map",Bt=Zt&&n.layout.get("symbol-placement")!=="point",qt=Zt&&!Rt&&!Bt,Qt=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Pr=!1,fr=s.depthModeForSublayer(0,pe.ReadOnly),Tr=n.layout.get("text-variable-anchor"),Ar=[],nn=0,Xr=l;nn<Xr.length;nn+=1){var gn=Xr[nn],Pn=a.getTile(gn),Jn=Pn.getBucket(n);if(Jn){var aa=b?Jn.text:Jn.icon;if(aa&&aa.segments.get().length){var ba=aa.programConfigurations.get(n.id),Xa=b||Jn.sdfIcons,_n=b?Jn.textSizeData:Jn.iconSizeData,ia=Rt||Lt.pitch!==0,xa=s.useProgram(of(Xa,b,Jn),ba),Wn=o.evaluateSizeForZoom(_n,Lt.zoom),Aa=void 0,ta=[0,0],La=void 0,ja=void 0,Ji=null,wi=void 0;if(b)La=Pn.glyphAtlasTexture,ja=Dt.LINEAR,Aa=Pn.glyphAtlasTexture.size,Jn.iconsInText&&(ta=Pn.imageAtlasTexture.size,Ji=Pn.imageAtlasTexture,wi=ia||s.options.rotating||s.options.zooming||_n.kind==="composite"||_n.kind==="camera"?Dt.LINEAR:Dt.NEAREST);else{var vo=n.layout.get("icon-size").constantOr(0)!==1||Jn.iconsNeedLinear;La=Pn.imageAtlasTexture,ja=Xa||s.options.rotating||s.options.zooming||vo||ia?Dt.LINEAR:Dt.NEAREST,Aa=Pn.imageAtlasTexture.size}var _i=Ja(Pn,1,s.transform.zoom),Wi=gi(gn.posMatrix,Rt,Zt,s.transform,_i),Ns=Ma(gn.posMatrix,Rt,Zt,s.transform,_i),go=Tr&&Jn.hasTextData(),bu=n.layout.get("icon-text-fit")!=="none"&&go&&Jn.hasIconData();Bt&&po(Jn,gn.posMatrix,s,b,Wi,Ns,Rt,Te);var xu=s.translatePosMatrix(gn.posMatrix,Pn,O,R),zo=Bt||b&&Tr||bu?tu:Wi,As=s.translatePosMatrix(Ns,Pn,O,R,!0),Du=Xa&&n.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0,oc={program:xa,buffers:aa,uniformValues:Xa?Jn.iconsInText?Ql(_n.kind,Wn,qt,Rt,s,xu,zo,As,Aa,ta):No(_n.kind,Wn,qt,Rt,s,xu,zo,As,b,Aa,!0):Rl(_n.kind,Wn,qt,Rt,s,xu,zo,As,b,Aa),atlasTexture:La,atlasTextureIcon:Ji,atlasInterpolation:ja,atlasInterpolationIcon:wi,isSDF:Xa,hasHalo:Du};if(Qt&&Jn.canOverlap){Pr=!0;for(var Qu=0,sc=aa.segments.get();Qu<sc.length;Qu+=1){var uc=sc[Qu];Ar.push({segments:new o.SegmentVector([uc]),sortKey:uc.sortKey,state:oc})}}else Ar.push({segments:aa.segments,sortKey:0,state:oc})}}}Pr&&Ar.sort(function(Eu,Oo){return Eu.sortKey-Oo.sortKey});for(var Nu=0,pl=Ar;Nu<pl.length;Nu+=1){var Cs=pl[Nu],co=Cs.state;if(tt.activeTexture.set(Dt.TEXTURE0),co.atlasTexture.bind(co.atlasInterpolation,Dt.CLAMP_TO_EDGE),co.atlasTextureIcon&&(tt.activeTexture.set(Dt.TEXTURE1),co.atlasTextureIcon&&co.atlasTextureIcon.bind(co.atlasInterpolationIcon,Dt.CLAMP_TO_EDGE)),co.isSDF){var ku=co.uniformValues;co.hasHalo&&(ku.u_is_halo=1,ki(co.buffers,Cs.segments,n,s,co.program,fr,Xe,Je,ku)),ku.u_is_halo=0}ki(co.buffers,Cs.segments,n,s,co.program,fr,Xe,Je,co.uniformValues)}}function ki(s,a,n,l,b,O,R,j,ue){var Te=l.context;b.draw(Te,Te.gl.TRIANGLES,O,R,j,jt.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function il(s,a,n,l,b,O,R){var j,ue,Te,Xe,Je,tt=s.context.gl,Dt=n.paint.get("fill-pattern"),Lt=Dt&&Dt.constantOr(1),Zt=n.getCrossfadeParameters();R?(ue=Lt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=tt.LINES):(ue=Lt?"fillPattern":"fill",j=tt.TRIANGLES);for(var Rt=0,Bt=l;Rt<Bt.length;Rt+=1){var qt=Bt[Rt],Qt=a.getTile(qt);if(!Lt||Qt.patternsLoaded()){var Pr=Qt.getBucket(n);if(Pr){var fr=Pr.programConfigurations.get(n.id),Tr=s.useProgram(ue,fr);Lt&&(s.context.activeTexture.set(tt.TEXTURE0),Qt.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),fr.updatePaintBuffers(Zt));var Ar=Dt.constantOr(null);if(Ar&&Qt.imageAtlas){var nn=Qt.imageAtlas,Xr=nn.patternPositions[Ar.to.toString()],gn=nn.patternPositions[Ar.from.toString()];Xr&&gn&&fr.setConstantPatternPositions(Xr,gn)}var Pn=s.translatePosMatrix(qt.posMatrix,Qt,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(R){Xe=Pr.indexBuffer2,Je=Pr.segments2;var Jn=[tt.drawingBufferWidth,tt.drawingBufferHeight];Te=ue==="fillOutlinePattern"&&Lt?yc(Pn,s,Zt,Qt,Jn):Nc(Pn,Jn)}else Xe=Pr.indexBuffer,Je=Pr.segments,Te=Lt?ps(Pn,s,Zt,Qt):qs(Pn);Tr.draw(s.context,j,b,s.stencilModeForClipping(qt),O,jt.disabled,Te,n.id,Pr.layoutVertexBuffer,Xe,Je,n.paint,s.transform.zoom,fr)}}}}function Nl(s,a,n,l,b,O,R){for(var j=s.context,ue=j.gl,Te=n.paint.get("fill-extrusion-pattern"),Xe=Te.constantOr(1),Je=n.getCrossfadeParameters(),tt=n.paint.get("fill-extrusion-opacity"),Dt=0,Lt=l;Dt<Lt.length;Dt+=1){var Zt=Lt[Dt],Rt=a.getTile(Zt),Bt=Rt.getBucket(n);if(Bt){var qt=Bt.programConfigurations.get(n.id),Qt=s.useProgram(Xe?"fillExtrusionPattern":"fillExtrusion",qt);Xe&&(s.context.activeTexture.set(ue.TEXTURE0),Rt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),qt.updatePaintBuffers(Je));var Pr=Te.constantOr(null);if(Pr&&Rt.imageAtlas){var fr=Rt.imageAtlas,Tr=fr.patternPositions[Pr.to.toString()],Ar=fr.patternPositions[Pr.from.toString()];Tr&&Ar&&qt.setConstantPatternPositions(Tr,Ar)}var nn=s.translatePosMatrix(Zt.posMatrix,Rt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Xr=n.paint.get("fill-extrusion-vertical-gradient"),gn=Xe?Cu(nn,s,Xr,tt,Zt,Je,Rt):$i(nn,s,Xr,tt);Qt.draw(j,j.gl.TRIANGLES,b,O,R,jt.backCCW,gn,n.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,n.paint,s.transform.zoom,qt)}}}function Ec(s,a,n,l,b,O){var R=s.context,j=R.gl,ue=a.fbo;if(ue){var Te=s.useProgram("hillshade");R.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ue.colorAttachment.get());var Xe=function(Je,tt,Dt){var Lt=Dt.paint.get("hillshade-shadow-color"),Zt=Dt.paint.get("hillshade-highlight-color"),Rt=Dt.paint.get("hillshade-accent-color"),Bt=Dt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Dt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Bt-=Je.transform.angle);var qt,Qt,Pr,fr=!Je.options.moving;return{u_matrix:Je.transform.calculatePosMatrix(tt.tileID.toUnwrapped(),fr),u_image:0,u_latrange:(qt=tt.tileID,Qt=Math.pow(2,qt.canonical.z),Pr=qt.canonical.y,[new o.MercatorCoordinate(0,Pr/Qt).toLngLat().lat,new o.MercatorCoordinate(0,(Pr+1)/Qt).toLngLat().lat]),u_light:[Dt.paint.get("hillshade-exaggeration"),Bt],u_shadow:Lt,u_highlight:Zt,u_accent:Rt}}(s,a,n);Te.draw(R,j.TRIANGLES,l,b,O,jt.disabled,Xe,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function Uc(s,a,n,l,b,O){var R=s.context,j=R.gl,ue=a.dem;if(ue&&ue.data){var Te=ue.dim,Xe=ue.stride,Je=ue.getPixels();if(R.activeTexture.set(j.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture(Xe),a.demTexture){var tt=a.demTexture;tt.update(Je,{premultiply:!1}),tt.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else a.demTexture=new o.Texture(R,Je,j.RGBA,{premultiply:!1}),a.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);R.activeTexture.set(j.TEXTURE0);var Dt=a.fbo;if(!Dt){var Lt=new o.Texture(R,{width:Te,height:Te,data:null},j.RGBA);Lt.bind(j.LINEAR,j.CLAMP_TO_EDGE),(Dt=a.fbo=R.createFramebuffer(Te,Te,!0)).colorAttachment.set(Lt.texture)}R.bindFramebuffer.set(Dt.framebuffer),R.viewport.set([0,0,Te,Te]),s.useProgram("hillshadePrepare").draw(R,j.TRIANGLES,l,b,O,jt.disabled,function(Zt,Rt){var Bt=Rt.stride,qt=o.create();return o.ortho(qt,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(qt,qt,[0,-o.EXTENT,0]),{u_matrix:qt,u_image:1,u_dimension:[Bt,Bt],u_zoom:Zt.overscaledZ,u_unpack:Rt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function kl(s,a,n,l,b){var O=l.paint.get("raster-fade-duration");if(O>0){var R=o.browser.now(),j=(R-s.timeAdded)/O,ue=a?(R-a.timeAdded)/O:-1,Te=n.getSource(),Xe=b.coveringZoomLevel({tileSize:Te.tileSize,roundZoom:Te.roundZoom}),Je=!a||Math.abs(a.tileID.overscaledZ-Xe)>Math.abs(s.tileID.overscaledZ-Xe),tt=Je&&s.refreshedUponExpiration?1:o.clamp(Je?j:1-ue,0,1);return s.refreshedUponExpiration&&j>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-tt}:{opacity:tt,mix:0}}return{opacity:1,mix:0}}var Rf=new o.Color(1,0,0,1),If=new o.Color(0,1,0,1),sf=new o.Color(0,0,1,1),El=new o.Color(1,0,1,1),ql=new o.Color(0,1,1,1);function Ou(s,a,n,l){ol(s,0,a+n/2,s.transform.width,n,l)}function Fs(s,a,n,l){ol(s,a-n/2,0,n,s.transform.height,l)}function ol(s,a,n,l,b,O){var R=s.context,j=R.gl;j.enable(j.SCISSOR_TEST),j.scissor(a*o.browser.devicePixelRatio,n*o.browser.devicePixelRatio,l*o.browser.devicePixelRatio,b*o.browser.devicePixelRatio),R.clear({color:O}),j.disable(j.SCISSOR_TEST)}function Bc(s,a,n){var l=s.context,b=l.gl,O=n.posMatrix,R=s.useProgram("debug"),j=pe.disabled,ue=at.disabled,Te=s.colorModeForRenderPass();l.activeTexture.set(b.TEXTURE0),s.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),R.draw(l,b.LINE_STRIP,j,ue,Te,jt.disabled,eu(O,o.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var Xe=a.getTileByID(n.key).latestRawTileData,Je=Math.floor((Xe&&Xe.byteLength||0)/1024),tt=a.getTile(n).tileSize,Dt=512/Math.min(tt,512)*(n.overscaledZ/s.transform.zoom)*.5,Lt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Lt+=" => "+n.overscaledZ),function(Zt,Rt){Zt.initDebugOverlayCanvas();var Bt=Zt.debugOverlayCanvas,qt=Zt.context.gl,Qt=Zt.debugOverlayCanvas.getContext("2d");Qt.clearRect(0,0,Bt.width,Bt.height),Qt.shadowColor="white",Qt.shadowBlur=2,Qt.lineWidth=1.5,Qt.strokeStyle="white",Qt.textBaseline="top",Qt.font="bold 36px Open Sans, sans-serif",Qt.fillText(Rt,5,5),Qt.strokeText(Rt,5,5),Zt.debugOverlayTexture.update(Bt),Zt.debugOverlayTexture.bind(qt.LINEAR,qt.CLAMP_TO_EDGE)}(s,Lt+" "+Je+"kb"),R.draw(l,b.TRIANGLES,j,ue,Tt.alphaBlended,jt.disabled,eu(O,o.Color.transparent,Dt),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var Yu={symbol:function(a,n,l,b,O){if(a.renderPass==="translucent"){var R=at.disabled,j=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Te,Xe,Je,tt,Dt,Lt){for(var Zt=Te.transform,Rt=tt==="map",Bt=Dt==="map",qt=0,Qt=ue;qt<Qt.length;qt+=1){var Pr=Qt[qt],fr=Je.getTile(Pr),Tr=fr.getBucket(Xe);if(Tr&&Tr.text&&Tr.text.segments.get().length){var Ar=o.evaluateSizeForZoom(Tr.textSizeData,Zt.zoom),nn=Ja(fr,1,Te.transform.zoom),Xr=gi(Pr.posMatrix,Bt,Rt,Te.transform,nn),gn=Xe.layout.get("icon-text-fit")!=="none"&&Tr.hasIconData();if(Ar){var Pn=Math.pow(2,Zt.zoom-fr.tileID.overscaledZ);bf(Tr,Rt,Bt,Lt,o.symbolSize,Zt,Xr,Pr.posMatrix,Pn,Ar,gn)}}}}(b,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),O),l.paint.get("icon-opacity").constantOr(1)!==0&&xl(a,n,l,b,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),R,j),l.paint.get("text-opacity").constantOr(1)!==0&&xl(a,n,l,b,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),R,j),n.map.showCollisionBoxes&&(Dl(a,n,l,b,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Dl(a,n,l,b,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,b){if(a.renderPass==="translucent"){var O=l.paint.get("circle-opacity"),R=l.paint.get("circle-stroke-width"),j=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||R.constantOr(1)!==0&&j.constantOr(1)!==0){for(var Te=a.context,Xe=Te.gl,Je=a.depthModeForSublayer(0,pe.ReadOnly),tt=at.disabled,Dt=a.colorModeForRenderPass(),Lt=[],Zt=0;Zt<b.length;Zt++){var Rt=b[Zt],Bt=n.getTile(Rt),qt=Bt.getBucket(l);if(qt){var Qt=qt.programConfigurations.get(l.id),Pr={programConfiguration:Qt,program:a.useProgram("circle",Qt),layoutVertexBuffer:qt.layoutVertexBuffer,indexBuffer:qt.indexBuffer,uniformValues:yl(a,Rt,Bt,l)};if(ue)for(var fr=0,Tr=qt.segments.get();fr<Tr.length;fr+=1){var Ar=Tr[fr];Lt.push({segments:new o.SegmentVector([Ar]),sortKey:Ar.sortKey,state:Pr})}else Lt.push({segments:qt.segments,sortKey:0,state:Pr})}}ue&&Lt.sort(function(Jn,aa){return Jn.sortKey-aa.sortKey});for(var nn=0,Xr=Lt;nn<Xr.length;nn+=1){var gn=Xr[nn],Pn=gn.state;Pn.program.draw(Te,Xe.TRIANGLES,Je,tt,Dt,jt.disabled,Pn.uniformValues,l.id,Pn.layoutVertexBuffer,Pn.indexBuffer,gn.segments,l.paint,a.transform.zoom,Pn.programConfiguration)}}}},heatmap:function(a,n,l,b){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var O=a.context,R=O.gl,j=at.disabled,ue=new Tt([R.ONE,R.ONE],o.Color.transparent,[!0,!0,!0,!0]);!function(Lt,Zt,Rt){var Bt=Lt.gl;Lt.activeTexture.set(Bt.TEXTURE1),Lt.viewport.set([0,0,Zt.width/4,Zt.height/4]);var qt=Rt.heatmapFbo;if(qt)Bt.bindTexture(Bt.TEXTURE_2D,qt.colorAttachment.get()),Lt.bindFramebuffer.set(qt.framebuffer);else{var Qt=Bt.createTexture();Bt.bindTexture(Bt.TEXTURE_2D,Qt),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_S,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_T,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MAG_FILTER,Bt.LINEAR),qt=Rt.heatmapFbo=Lt.createFramebuffer(Zt.width/4,Zt.height/4,!1),function(Pr,fr,Tr,Ar){var nn=Pr.gl;nn.texImage2D(nn.TEXTURE_2D,0,nn.RGBA,fr.width/4,fr.height/4,0,nn.RGBA,Pr.extRenderToTextureHalfFloat?Pr.extTextureHalfFloat.HALF_FLOAT_OES:nn.UNSIGNED_BYTE,null),Ar.colorAttachment.set(Tr)}(Lt,Zt,Qt,qt)}}(O,a,l),O.clear({color:o.Color.transparent});for(var Te=0;Te<b.length;Te++){var Xe=b[Te];if(!n.hasRenderableParent(Xe)){var Je=n.getTile(Xe),tt=Je.getBucket(l);if(tt){var Dt=tt.programConfigurations.get(l.id);a.useProgram("heatmap",Dt).draw(O,R.TRIANGLES,pe.disabled,j,ue,jt.disabled,kc(Xe.posMatrix,Je,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,l.paint,a.transform.zoom,Dt)}}}O.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Lt,Zt){var Rt=Lt.context,Bt=Rt.gl,qt=Zt.heatmapFbo;if(qt){Rt.activeTexture.set(Bt.TEXTURE0),Bt.bindTexture(Bt.TEXTURE_2D,qt.colorAttachment.get()),Rt.activeTexture.set(Bt.TEXTURE1);var Qt=Zt.colorRampTexture;Qt||(Qt=Zt.colorRampTexture=new o.Texture(Rt,Zt.colorRamp,Bt.RGBA)),Qt.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE),Lt.useProgram("heatmapTexture").draw(Rt,Bt.TRIANGLES,pe.disabled,at.disabled,Lt.colorModeForRenderPass(),jt.disabled,function(Pr,fr,Tr,Ar){var nn=o.create();o.ortho(nn,0,Pr.width,Pr.height,0,0,1);var Xr=Pr.context.gl;return{u_matrix:nn,u_world:[Xr.drawingBufferWidth,Xr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:fr.paint.get("heatmap-opacity")}}(Lt,Zt),Zt.id,Lt.viewportBuffer,Lt.quadTriangleIndexBuffer,Lt.viewportSegments,Zt.paint,Lt.transform.zoom)}}(a,l))},line:function(a,n,l,b){if(a.renderPass==="translucent"){var O=l.paint.get("line-opacity"),R=l.paint.get("line-width");if(O.constantOr(1)!==0&&R.constantOr(1)!==0)for(var j=a.depthModeForSublayer(0,pe.ReadOnly),ue=a.colorModeForRenderPass(),Te=l.paint.get("line-dasharray"),Xe=l.paint.get("line-pattern"),Je=Xe.constantOr(1),tt=l.paint.get("line-gradient"),Dt=l.getCrossfadeParameters(),Lt=Je?"linePattern":Te?"lineSDF":tt?"lineGradient":"line",Zt=a.context,Rt=Zt.gl,Bt=!0,qt=0,Qt=b;qt<Qt.length;qt+=1){var Pr=Qt[qt],fr=n.getTile(Pr);if(!Je||fr.patternsLoaded()){var Tr=fr.getBucket(l);if(Tr){var Ar=Tr.programConfigurations.get(l.id),nn=a.context.program.get(),Xr=a.useProgram(Lt,Ar),gn=Bt||Xr.program!==nn,Pn=Xe.constantOr(null);if(Pn&&fr.imageAtlas){var Jn=fr.imageAtlas,aa=Jn.patternPositions[Pn.to.toString()],ba=Jn.patternPositions[Pn.from.toString()];aa&&ba&&Ar.setConstantPatternPositions(aa,ba)}var Xa=Je?jc(a,fr,l,Dt):Te?Lf(a,fr,l,Te,Dt):tt?Ci(a,fr,l,Tr.lineClipsArray.length):$l(a,fr,l);if(Je)Zt.activeTexture.set(Rt.TEXTURE0),fr.imageAtlasTexture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Dt);else if(Te&&(gn||a.lineAtlas.dirty))Zt.activeTexture.set(Rt.TEXTURE0),a.lineAtlas.bind(Zt);else if(tt){var _n=Tr.gradients[l.id],ia=_n.texture;if(l.gradientVersion!==_n.version){var xa=256;if(l.stepInterpolant){var Wn=n.getSource().maxzoom,Aa=Pr.canonical.z===Wn?Math.ceil(1<<a.transform.maxZoom-Pr.canonical.z):1;xa=o.clamp(o.nextPowerOfTwo(Tr.maxLineLength/o.EXTENT*1024*Aa),256,Zt.maxTextureSize)}_n.gradient=o.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:xa,image:_n.gradient||void 0,clips:Tr.lineClipsArray}),_n.texture?_n.texture.update(_n.gradient):_n.texture=new o.Texture(Zt,_n.gradient,Rt.RGBA),_n.version=l.gradientVersion,ia=_n.texture}Zt.activeTexture.set(Rt.TEXTURE0),ia.bind(l.stepInterpolant?Rt.NEAREST:Rt.LINEAR,Rt.CLAMP_TO_EDGE)}Xr.draw(Zt,Rt.TRIANGLES,j,a.stencilModeForClipping(Pr),ue,jt.disabled,Xa,l.id,Tr.layoutVertexBuffer,Tr.indexBuffer,Tr.segments,l.paint,a.transform.zoom,Ar,Tr.layoutVertexBuffer2),Bt=!1}}}}},fill:function(a,n,l,b){var O=l.paint.get("fill-color"),R=l.paint.get("fill-opacity");if(R.constantOr(1)!==0){var j=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Te=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&O.constantOr(o.Color.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Te){var Xe=a.depthModeForSublayer(1,a.renderPass==="opaque"?pe.ReadWrite:pe.ReadOnly);il(a,n,l,b,Xe,j,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var Je=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,pe.ReadOnly);il(a,n,l,b,Je,j,!0)}}},"fill-extrusion":function(a,n,l,b){var O=l.paint.get("fill-extrusion-opacity");if(O!==0&&a.renderPass==="translucent"){var R=new pe(a.context.gl.LEQUAL,pe.ReadWrite,a.depthRangeFor3D);if(O!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Nl(a,n,l,b,R,at.disabled,Tt.disabled),Nl(a,n,l,b,R,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var j=a.colorModeForRenderPass();Nl(a,n,l,b,R,at.disabled,j)}}},hillshade:function(a,n,l,b){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var O=a.context,R=a.depthModeForSublayer(0,pe.ReadOnly),j=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(b):[{},b],Te=ue[0],Xe=0,Je=ue[1];Xe<Je.length;Xe+=1){var tt=Je[Xe],Dt=n.getTile(tt);Dt.needsHillshadePrepare&&a.renderPass==="offscreen"?Uc(a,Dt,l,R,at.disabled,j):a.renderPass==="translucent"&&Ec(a,Dt,l,R,Te[tt.overscaledZ],j)}O.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,b){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&b.length)for(var O=a.context,R=O.gl,j=n.getSource(),ue=a.useProgram("raster"),Te=a.colorModeForRenderPass(),Xe=j instanceof Ee?[{},b]:a.stencilConfigForOverlap(b),Je=Xe[0],tt=Xe[1],Dt=tt[tt.length-1].overscaledZ,Lt=!a.options.moving,Zt=0,Rt=tt;Zt<Rt.length;Zt+=1){var Bt=Rt[Zt],qt=a.depthModeForSublayer(Bt.overscaledZ-Dt,l.paint.get("raster-opacity")===1?pe.ReadWrite:pe.ReadOnly,R.LESS),Qt=n.getTile(Bt),Pr=a.transform.calculatePosMatrix(Bt.toUnwrapped(),Lt);Qt.registerFadeDuration(l.paint.get("raster-fade-duration"));var fr=n.findLoadedParent(Bt,0),Tr=kl(Qt,fr,n,l,a.transform),Ar=void 0,nn=void 0,Xr=l.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;O.activeTexture.set(R.TEXTURE0),Qt.texture.bind(Xr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(R.TEXTURE1),fr?(fr.texture.bind(Xr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,fr.tileID.overscaledZ-Qt.tileID.overscaledZ),nn=[Qt.tileID.canonical.x*Ar%1,Qt.tileID.canonical.y*Ar%1]):Qt.texture.bind(Xr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);var gn=Jl(Pr,nn||[0,0],Ar||1,Tr,l);j instanceof Ee?ue.draw(O,R.TRIANGLES,qt,at.disabled,Te,jt.disabled,gn,l.id,j.boundsBuffer,a.quadTriangleIndexBuffer,j.boundsSegments):ue.draw(O,R.TRIANGLES,qt,Je[Bt.overscaledZ],Te,jt.disabled,gn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var b=l.paint.get("background-color"),O=l.paint.get("background-opacity");if(O!==0){var R=a.context,j=R.gl,ue=a.transform,Te=ue.tileSize,Xe=l.paint.get("background-pattern");if(!a.isPatternMissing(Xe)){var Je=!Xe&&b.a===1&&O===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===Je){var tt=at.disabled,Dt=a.depthModeForSublayer(0,Je==="opaque"?pe.ReadWrite:pe.ReadOnly),Lt=a.colorModeForRenderPass(),Zt=a.useProgram(Xe?"backgroundPattern":"background"),Rt=ue.coveringTiles({tileSize:Te});Xe&&(R.activeTexture.set(j.TEXTURE0),a.imageManager.bind(a.context));for(var Bt=l.getCrossfadeParameters(),qt=0,Qt=Rt;qt<Qt.length;qt+=1){var Pr=Qt[qt],fr=a.transform.calculatePosMatrix(Pr.toUnwrapped()),Tr=Xe?bl(fr,O,a,Xe,{tileID:Pr,tileSize:Te},Bt):Il(fr,O,b);Zt.draw(R,j.TRIANGLES,Dt,tt,Lt,jt.disabled,Tr,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var b=0;b<l.length;b++)Bc(a,n,l[b])},custom:function(a,n,l){var b=a.context,O=l.implementation;if(a.renderPass==="offscreen"){var R=O.prerender;R&&(a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),R.call(O,b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),b.setStencilMode(at.disabled);var j=O.renderingMode==="3d"?new pe(a.context.gl.LEQUAL,pe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,pe.ReadOnly);b.setDepthMode(j),O.render(b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState(),b.bindFramebuffer.set(null)}}},ji=function(a,n){this.context=new Ge(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=wt.maxUnderzooming+wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new uo,this.gpuTimers={}};ji.prototype.resize=function(s,a){if(this.width=s*o.browser.devicePixelRatio,this.height=a*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},ji.prototype.setup=function(){var s=this.context,a=new o.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(o.EXTENT,0),a.emplaceBack(0,o.EXTENT),a.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Ni.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var n=new o.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(o.EXTENT,0),n.emplaceBack(0,o.EXTENT),n.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Ni.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var l=new o.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(o.EXTENT,0,o.EXTENT,0),l.emplaceBack(0,o.EXTENT,0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Ce.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(b,Ni.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var O=new o.StructArrayLayout1ui2;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(O);var R=new o.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(R),this.emptyTexture=new o.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new at({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},ji.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=o.create();o.ortho(n,0,this.width,this.height,0,0,1),o.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,pe.disabled,this.stencilClearMode,Tt.disabled,jt.disabled,Zu(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ji.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(Tt.disabled),n.setDepthMode(pe.disabled);var b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var O=0,R=a;O<R.length;O+=1){var j=R[O],ue=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;b.draw(n,l.TRIANGLES,pe.disabled,new at({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),Tt.disabled,jt.disabled,Zu(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ji.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new at({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},ji.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new at({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},ji.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Te){return Te.overscaledZ-ue.overscaledZ}),b=l[l.length-1].overscaledZ,O=l[0].overscaledZ-b+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();for(var R={},j=0;j<O;j++)R[j+b]=new at({func:n.GEQUAL,mask:255},j+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=O,[R,l]}return[(a={},a[b]=at.disabled,a),l]},ji.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new Tt([s.CONSTANT_COLOR,s.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Tt.unblended:Tt.alphaBlended},ji.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return pe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new pe(n||this.context.gl.LEQUAL,a,[l,l])},ji.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ji.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var l=this.style._order,b=this.style.sourceCaches;for(var O in b){var R=b[O];R.used&&R.prepare(this.context)}var j,ue,Te={},Xe={},Je={};for(var tt in b){var Dt=b[tt];Te[tt]=Dt.getVisibleCoordinates(),Xe[tt]=Te[tt].slice().reverse(),Je[tt]=Dt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Lt=0;Lt<l.length;Lt++)if(this.style._layers[l[Lt]].is3D()){this.opaquePassCutoff=Lt;break}this.renderPass="offscreen";for(var Zt=0,Rt=l;Zt<Rt.length;Zt+=1){var Bt=this.style._layers[Rt[Zt]];if(Bt.hasOffscreenPass()&&!Bt.isHidden(this.transform.zoom)){var qt=Xe[Bt.source];(Bt.type==="custom"||qt.length)&&this.renderLayer(this,b[Bt.source],Bt,qt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var Qt=this.style._layers[l[this.currentLayer]],Pr=b[Qt.source],fr=Te[Qt.source];this._renderTileClippingMasks(Qt,fr),this.renderLayer(this,Pr,Qt,fr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Tr=this.style._layers[l[this.currentLayer]],Ar=b[Tr.source],nn=(Tr.type==="symbol"?Je:Xe)[Tr.source];this._renderTileClippingMasks(Tr,Te[Tr.source]),this.renderLayer(this,Ar,Tr,nn)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(n.transform.zoom)&&(Xr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Xr.source]),(!j||j.getSource().maxzoom<ue.getSource().maxzoom)&&(j=ue))}),j&&Yu.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var gn=Xr.transform.padding;Ou(Xr,Xr.transform.height-(gn.top||0),3,Rf),Ou(Xr,gn.bottom||0,3,If),Fs(Xr,gn.left||0,3,sf),Fs(Xr,Xr.transform.width-(gn.right||0),3,El);var Pn=Xr.transform.centerPoint;!function(Jn,aa,ba,Xa){ol(Jn,aa-1,ba-10,2,20,Xa),ol(Jn,aa-10,ba-1,20,2,Xa)}(Xr,Pn.x,Xr.transform.height-Pn.y,ql)}(this),this.context.setDefault()},ji.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),Yu[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},ji.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},ji.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},ji.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},ji.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],b=this.context.extTimerQuery,O=b.getQueryObjectEXT(l.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(l.query),a[n]=O}return a},ji.prototype.translatePosMatrix=function(s,a,n,l,b){if(!n[0]&&!n[1])return s;var O=b?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(O){var R=Math.sin(O),j=Math.cos(O);n=[n[0]*j-n[1]*R,n[0]*R+n[1]*j]}var ue=[b?n[0]:Ja(a,n[0],this.transform.zoom),b?n[1]:Ja(a,n[1],this.transform.zoom),0],Te=new Float32Array(16);return o.translate(Te,s,ue),Te},ji.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},ji.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},ji.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},ji.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new nf(this.context,s,Dc[s],a,Fc[s],this._showOverdrawInspector)),this.cache[n]},ji.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ji.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},ji.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},ji.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var pu=function(a,n){this.points=a,this.planes=n};pu.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(R){return o.transformMat4([],R,s)}).map(function(R){return o.scale$1([],R,1/R[3]/a*l)}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(R){var j=o.sub([],b[R[0]],b[R[1]]),ue=o.sub([],b[R[2]],b[R[1]]),Te=o.normalize([],o.cross([],j,ue)),Xe=-o.dot(Te,b[R[1]]);return Te.concat(Xe)});return new pu(b,O)};var sl=function(a,n){this.min=a,this.max=n,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};sl.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=o.clone$2(this.min),l=o.clone$2(this.max),b=0;b<a.length;b++)n[b]=a[b]?this.min[b]:this.center[b],l[b]=a[b]?this.center[b]:this.max[b];return l[2]=this.max[2],new sl(n,l)},sl.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},sl.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},sl.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var b=s.planes[l],O=0,R=0;R<a.length;R++)O+=o.dot$1(b,a[R])>=0;if(O===0)return 0;O!==a.length&&(n=!1)}if(n)return 2;for(var j=0;j<3;j++){for(var ue=Number.MAX_VALUE,Te=-Number.MAX_VALUE,Xe=0;Xe<s.points.length;Xe++){var Je=s.points[Xe][j]-this.min[j];ue=Math.min(ue,Je),Te=Math.max(Te,Je)}if(Te<0||ue>this.max[j]-this.min[j])return 0}return 1};var ul=function(a,n,l,b){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),b===void 0&&(b=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=b};ul.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=o.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=o.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=o.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=o.number(s.right,a.right,n)),this},ul.prototype.getCenter=function(s,a){var n=o.clamp((this.left+s-this.right)/2,0,s),l=o.clamp((this.top+a-this.bottom)/2,0,a);return new o.Point(n,l)},ul.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},ul.prototype.clone=function(){return new ul(this.top,this.bottom,this.left,this.right)},ul.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Da=function(a,n,l,b,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=b==null?60:b,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ul,this._posMatrixCache={},this._alignedPosMatrixCache={}},mi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Da.prototype.clone=function(){var s=new Da(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},mi.minZoom.get=function(){return this._minZoom},mi.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},mi.maxZoom.get=function(){return this._maxZoom},mi.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},mi.minPitch.get=function(){return this._minPitch},mi.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},mi.maxPitch.get=function(){return this._maxPitch},mi.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},mi.renderWorldCopies.get=function(){return this._renderWorldCopies},mi.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},mi.worldSize.get=function(){return this.tileSize*this.scale},mi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},mi.size.get=function(){return new o.Point(this.width,this.height)},mi.bearing.get=function(){return-this.angle/Math.PI*180},mi.bearing.set=function(s){var a=-o.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},mi.pitch.get=function(){return this._pitch/Math.PI*180},mi.pitch.set=function(s){var a=o.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},mi.fov.get=function(){return this._fov/Math.PI*180},mi.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},mi.zoom.get=function(){return this._zoom},mi.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},mi.center.get=function(){return this._center},mi.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},mi.padding.get=function(){return this._edgeInsets.toJSON()},mi.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},mi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Da.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},Da.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},Da.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},Da.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new o.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new o.Point(0,0)),l=this.pointCoordinate(new o.Point(this.width,0)),b=this.pointCoordinate(new o.Point(this.width,this.height)),O=this.pointCoordinate(new o.Point(0,this.height)),R=Math.floor(Math.min(n.x,l.x,b.x,O.x)),j=Math.floor(Math.max(n.x,l.x,b.x,O.x)),ue=R-1;ue<=j+1;ue++)ue!==0&&a.push(new o.UnwrappedTileID(ue,s));return a},Da.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=o.MercatorCoordinate.fromLngLat(this.center),b=Math.pow(2,a),O=[b*l.x,b*l.y,0],R=pu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),j=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=a);var ue=function(gn){return{aabb:new sl([gn*b,0,0],[(gn+1)*b,b,0]),zoom:0,x:0,y:0,wrap:gn,fullyVisible:!1}},Te=[],Xe=[],Je=a,tt=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Dt=1;Dt<=3;Dt++)Te.push(ue(-Dt)),Te.push(ue(Dt));for(Te.push(ue(0));Te.length>0;){var Lt=Te.pop(),Zt=Lt.x,Rt=Lt.y,Bt=Lt.fullyVisible;if(!Bt){var qt=Lt.aabb.intersects(R);if(qt===0)continue;Bt=qt===2}var Qt=Lt.aabb.distanceX(O),Pr=Lt.aabb.distanceY(O),fr=Math.max(Math.abs(Qt),Math.abs(Pr));if(Lt.zoom===Je||fr>3+(1<<Je-Lt.zoom)-2&&Lt.zoom>=j)Xe.push({tileID:new o.OverscaledTileID(Lt.zoom===Je?tt:Lt.zoom,Lt.wrap,Lt.zoom,Zt,Rt),distanceSq:o.sqrLen([O[0]-.5-Zt,O[1]-.5-Rt])});else for(var Tr=0;Tr<4;Tr++){var Ar=(Zt<<1)+Tr%2,nn=(Rt<<1)+(Tr>>1);Te.push({aabb:Lt.aabb.quadrant(Tr),zoom:Lt.zoom+1,x:Ar,y:nn,wrap:Lt.wrap,fullyVisible:Bt})}}return Xe.sort(function(Xr,gn){return Xr.distanceSq-gn.distanceSq}).map(function(Xr){return Xr.tileID})},Da.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},mi.unmodified.get=function(){return this._unmodified},Da.prototype.zoomScale=function(s){return Math.pow(2,s)},Da.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},Da.prototype.project=function(s){var a=o.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(s.lng)*this.worldSize,o.mercatorYfromLat(a)*this.worldSize)},Da.prototype.unproject=function(s){return new o.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},mi.point.get=function(){return this.project(this.center)},Da.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(s),O=new o.MercatorCoordinate(b.x-(n.x-l.x),b.y-(n.y-l.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())},Da.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},Da.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},Da.prototype.locationCoordinate=function(s){return o.MercatorCoordinate.fromLngLat(s)},Da.prototype.coordinateLocation=function(s){return s.toLngLat()},Da.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];o.transformMat4(a,a,this.pixelMatrixInverse),o.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],b=n[3],O=a[1]/l,R=n[1]/b,j=a[2]/l,ue=n[2]/b,Te=j===ue?0:(0-j)/(ue-j);return new o.MercatorCoordinate(o.number(a[0]/l,n[0]/b,Te)/this.worldSize,o.number(O,R,Te)/this.worldSize)},Da.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix),new o.Point(a[0]/a[3],a[1]/a[3])},Da.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},Da.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Da.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Da.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var b=s.canonical,O=this.worldSize/this.zoomScale(b.z),R=b.x+Math.pow(2,b.z)*s.wrap,j=o.identity(new Float64Array(16));return o.translate(j,j,[R*O,b.y*O,0]),o.scale(j,j,[O/o.EXTENT,O/o.EXTENT,1]),o.multiply(j,a?this.alignedProjMatrix:this.projMatrix,j),l[n]=new Float32Array(j),l[n]},Da.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Da.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,b=-90,O=90,R=-180,j=180,ue=this.size,Te=this._unmodified;if(this.latRange){var Xe=this.latRange;b=o.mercatorYfromLat(Xe[1])*this.worldSize,s=(O=o.mercatorYfromLat(Xe[0])*this.worldSize)-b<ue.y?ue.y/(O-b):0}if(this.lngRange){var Je=this.lngRange;R=o.mercatorXfromLng(Je[0])*this.worldSize,a=(j=o.mercatorXfromLng(Je[1])*this.worldSize)-R<ue.x?ue.x/(j-R):0}var tt=this.point,Dt=Math.max(a||0,s||0);if(Dt)return this.center=this.unproject(new o.Point(a?(j+R)/2:tt.x,s?(O+b)/2:tt.y)),this.zoom+=this.scaleZoom(Dt),this._unmodified=Te,void(this._constraining=!1);if(this.latRange){var Lt=tt.y,Zt=ue.y/2;Lt-Zt<b&&(l=b+Zt),Lt+Zt>O&&(l=O-Zt)}if(this.lngRange){var Rt=tt.x,Bt=ue.x/2;Rt-Bt<R&&(n=R+Bt),Rt+Bt>j&&(n=j-Bt)}n===void 0&&l===void 0||(this.center=this.unproject(new o.Point(n!==void 0?n:tt.x,l!==void 0?l:tt.y))),this._unmodified=Te,this._constraining=!1}},Da.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-a-n,.01,Math.PI-.01)),b=this.point,O=b.x,R=b.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Te=new Float64Array(16);o.perspective(Te,this._fov,this.width/this.height,ue,j),Te[8]=2*-s.x/this.width,Te[9]=2*s.y/this.height,o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[0,0,-this.cameraToCenterDistance]),o.rotateX(Te,Te,this._pitch),o.rotateZ(Te,Te,this.angle),o.translate(Te,Te,[-O,-R,0]),this.mercatorMatrix=o.scale([],Te,[this.worldSize,this.worldSize,this.worldSize]),o.scale(Te,Te,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Te,this.invProjMatrix=o.invert([],this.projMatrix);var Xe=this.width%2/2,Je=this.height%2/2,tt=Math.cos(this.angle),Dt=Math.sin(this.angle),Lt=O-Math.round(O)+tt*Xe+Dt*Je,Zt=R-Math.round(R)+tt*Je+Dt*Xe,Rt=new Float64Array(Te);if(o.translate(Rt,Rt,[Lt>.5?Lt-1:Lt,Zt>.5?Zt-1:Zt,0]),this.alignedProjMatrix=Rt,Te=o.create(),o.scale(Te,Te,[this.width/2,-this.height/2,1]),o.translate(Te,Te,[1,-1,0]),this.labelPlaneMatrix=Te,Te=o.create(),o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[-1,-1,0]),o.scale(Te,Te,[2/this.width,2/this.height,1]),this.glCoordMatrix=Te,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Te=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Te,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Da.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new o.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Da.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,s))},Da.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,b=a.x,O=a.y,R=0,j=s;R<j.length;R+=1){var ue=j[R];n=Math.min(n,ue.x),l=Math.min(l,ue.y),b=Math.max(b,ue.x),O=Math.max(O,ue.y)}return[new o.Point(n,l),new o.Point(b,l),new o.Point(b,O),new o.Point(n,O),new o.Point(n,l)]},Object.defineProperties(Da.prototype,mi);var Ms=function(a){var n,l,b,O;this._hashName=a&&encodeURIComponent(a),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,b=null,O=function(){b=null,l&&(n(),b=setTimeout(O,300),l=!1)},function(){return l=!0,b||O(),b})};Ms.prototype.addTo=function(s){return this._map=s,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ms.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ms.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,l),O=Math.round(a.lng*b)/b,R=Math.round(a.lat*b)/b,j=this._map.getBearing(),ue=this._map.getPitch(),Te="";if(Te+=s?"/"+O+"/"+R+"/"+n:n+"/"+R+"/"+O,(j||ue)&&(Te+="/"+Math.round(10*j)/10),ue&&(Te+="/"+Math.round(ue)),this._hashName){var Xe=this._hashName,Je=!1,tt=o.window.location.hash.slice(1).split("&").map(function(Dt){var Lt=Dt.split("=")[0];return Lt===Xe?(Je=!0,Lt+"="+Te):Dt}).filter(function(Dt){return Dt});return Je||tt.push(Xe+"="+Te),"#"+tt.join("&")}return"#"+Te},Ms.prototype._getCurrentHash=function(){var s,a=this,n=o.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},Ms.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},Ms.prototype._updateHashUnthrottled=function(){var s=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,s)}catch(a){}};var Ti={linearity:.3,easing:o.bezier(0,0,.3,1)},Wa=o.extend({deceleration:2500,maxSpeed:1400},Ti),ec=o.extend({deceleration:20,maxSpeed:1400},Ti),xf=o.extend({deceleration:1e3,maxSpeed:360},Ti),rs=o.extend({deceleration:1e3,maxSpeed:90},Ti),ll=function(a){this._map=a,this.clear()};function mu(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function Ku(s,a,n){var l=n.maxSpeed,b=n.linearity,O=n.deceleration,R=o.clamp(s*b/(a/1e3),-l,l),j=Math.abs(R)/(O*b);return{easing:n.easing,duration:1e3*j,amount:R*(j/2)}}ll.prototype.clear=function(){this._inertiaBuffer=[]},ll.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:s})},ll.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=o.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},ll.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var b=l[n].settings;a.zoom+=b.zoomDelta||0,a.bearing+=b.bearingDelta||0,a.pitch+=b.pitchDelta||0,b.panDelta&&a.pan._add(b.panDelta),b.around&&(a.around=b.around),b.pinchAround&&(a.pinchAround=b.pinchAround)}var O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,R={};if(a.pan.mag()){var j=Ku(a.pan.mag(),O,o.extend({},Wa,s||{}));R.offset=a.pan.mult(j.amount/a.pan.mag()),R.center=this._map.transform.center,mu(R,j)}if(a.zoom){var ue=Ku(a.zoom,O,ec);R.zoom=this._map.transform.zoom+ue.amount,mu(R,ue)}if(a.bearing){var Te=Ku(a.bearing,O,xf);R.bearing=this._map.transform.bearing+o.clamp(Te.amount,-179,179),mu(R,Te)}if(a.pitch){var Xe=Ku(a.pitch,O,rs);R.pitch=this._map.transform.pitch+Xe.amount,mu(R,Xe)}if(R.zoom||R.bearing){var Je=a.pinchAround===void 0?a.around:a.pinchAround;R.around=Je?this._map.unproject(Je):this._map.getCenter()}return this.clear(),o.extend(R,{noMoveStart:!0})}};var ro=function(s){function a(l,b,O,R){R===void 0&&(R={});var j=D.mousePos(b.getCanvasContainer(),O),ue=b.unproject(j);s.call(this,l,o.extend({point:j,lngLat:ue,originalEvent:O},R)),this._defaultPrevented=!1,this.target=b}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),ns=function(s){function a(l,b,O){var R=l==="touchend"?O.changedTouches:O.touches,j=D.touchPos(b.getCanvasContainer(),R),ue=j.map(function(Je){return b.unproject(Je)}),Te=j.reduce(function(Je,tt,Dt,Lt){return Je.add(tt.div(Lt.length))},new o.Point(0,0)),Xe=b.unproject(Te);s.call(this,l,{points:j,point:Te,lngLats:ue,lngLat:Xe,originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),jl=function(s){function a(l,b,O){s.call(this,l,{originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),lo=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};lo.prototype.reset=function(){delete this._mousedownPos},lo.prototype.wheel=function(s){return this._firePreventable(new jl(s.type,this._map,s))},lo.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new ro(s.type,this._map,s))},lo.prototype.mouseup=function(s){this._map.fire(new ro(s.type,this._map,s))},lo.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ro(s.type,this._map,s))},lo.prototype.dblclick=function(s){return this._firePreventable(new ro(s.type,this._map,s))},lo.prototype.mouseover=function(s){this._map.fire(new ro(s.type,this._map,s))},lo.prototype.mouseout=function(s){this._map.fire(new ro(s.type,this._map,s))},lo.prototype.touchstart=function(s){return this._firePreventable(new ns(s.type,this._map,s))},lo.prototype.touchmove=function(s){this._map.fire(new ns(s.type,this._map,s))},lo.prototype.touchend=function(s){this._map.fire(new ns(s.type,this._map,s))},lo.prototype.touchcancel=function(s){this._map.fire(new ns(s.type,this._map,s))},lo.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},lo.prototype.isEnabled=function(){return!0},lo.prototype.isActive=function(){return!1},lo.prototype.enable=function(){},lo.prototype.disable=function(){};var Mn=function(a){this._map=a};Mn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Mn.prototype.mousemove=function(s){this._map.fire(new ro(s.type,this._map,s))},Mn.prototype.mousedown=function(){this._delayContextMenu=!0},Mn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ro("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Mn.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new ro(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},Mn.prototype.isEnabled=function(){return!0},Mn.prototype.isActive=function(){return!1},Mn.prototype.enable=function(){},Mn.prototype.disable=function(){};var Us=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function Tc(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}Us.prototype.isEnabled=function(){return!!this._enabled},Us.prototype.isActive=function(){return!!this._active},Us.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Us.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Us.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Us.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var b=Math.min(l.x,n.x),O=Math.max(l.x,n.x),R=Math.min(l.y,n.y),j=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+b+"px,"+R+"px)"),this._box.style.width=O-b+"px",this._box.style.height=j-R+"px"}}},Us.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,b=a;if(this.reset(),D.suppressClick(),l.x!==b.x||l.y!==b.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(R){return R.fitScreenCoordinates(l,b,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},Us.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},Us.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},Us.prototype._fireEvent=function(s,a){return this._map.fire(new o.Event(s,{originalEvent:a}))};var Tl=function(a){this.reset(),this.numTouches=a.numTouches};Tl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Tl.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var b=new o.Point(0,0),O=0,R=l;O<R.length;O+=1)b._add(R[O]);return b.div(l.length)}(a),this.touches=Tc(n,a)))},Tl.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=Tc(n,a);for(var b in this.touches){var O=l[b];(!O||O.dist(this.touches[b])>30)&&(this.aborted=!0)}}},Tl.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var Mu=function(a){this.singleTap=new Tl(a),this.numTaps=a.numTaps,this.reset()};Mu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Mu.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},Mu.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},Mu.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var b=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(l)<30;if(b&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Bs=function(){this._zoomIn=new Mu({numTouches:1,numTaps:2}),this._zoomOut=new Mu({numTouches:2,numTaps:1}),this.reset()};Bs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Bs.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},Bs.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},Bs.prototype.touchend=function(s,a,n){var l=this,b=this._zoomIn.touchend(s,a,n),O=this._zoomOut.touchend(s,a,n);return b?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(b)},{originalEvent:s})}}):O?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(O)},{originalEvent:s})}}):void 0},Bs.prototype.touchcancel=function(){this.reset()},Bs.prototype.enable=function(){this._enabled=!0},Bs.prototype.disable=function(){this._enabled=!1,this.reset()},Bs.prototype.isEnabled=function(){return this._enabled},Bs.prototype.isActive=function(){return this._active};var ei={0:1,2:2},qr=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};qr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qr.prototype._correctButton=function(s,a){return!1},qr.prototype._move=function(s,a){return{}},qr.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},qr.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,b){var O=ei[b];return l.buttons===void 0||(l.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},qr.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},qr.prototype.enable=function(){this._enabled=!0},qr.prototype.disable=function(){this._enabled=!1,this.reset()},qr.prototype.isEnabled=function(){return this._enabled},qr.prototype.isActive=function(){return this._active};var Vc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(qr),_c=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var b=.8*(l.x-n.x);if(b)return this._active=!0,{bearingDelta:b}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),cl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var b=-.5*(l.y-n.y);if(b)return this._active=!0,{pitchDelta:b}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),vu=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};vu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},vu.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},vu.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},vu.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},vu.prototype.touchcancel=function(){this.reset()},vu.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=Tc(n,a),b=new o.Point(0,0),O=new o.Point(0,0),R=0;for(var j in l){var ue=l[j],Te=this._touches[j];Te&&(b._add(ue),O._add(ue.sub(Te)),R++,l[j]=ue)}if(this._touches=l,!(R<this._minTouches)&&O.mag()){var Xe=O.div(R);if(this._sum._add(Xe),!(this._sum.mag()<this._clickTolerance))return{around:b.div(R),panDelta:Xe}}},vu.prototype.enable=function(){this._enabled=!0},vu.prototype.disable=function(){this._enabled=!1,this.reset()},vu.prototype.isEnabled=function(){return this._enabled},vu.prototype.isActive=function(){return this._active};var Ps=function(){this.reset()};function Ls(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function $o(s,a){return Math.log(s/a)/Math.LN2}Ps.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ps.prototype._start=function(s){},Ps.prototype._move=function(s,a,n){return{}},Ps.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Ps.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,b=l[1],O=Ls(n,a,l[0]),R=Ls(n,a,b);if(O&&R){var j=this._aroundCenter?null:O.add(R).div(2);return this._move([O,R],j,s)}}},Ps.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,b=l[1],O=Ls(n,a,l[0]),R=Ls(n,a,b);O&&R||(this._active&&D.suppressClick(),this.reset())}},Ps.prototype.touchcancel=function(){this.reset()},Ps.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Ps.prototype.disable=function(){this._enabled=!1,this.reset()},Ps.prototype.isEnabled=function(){return this._enabled},Ps.prototype.isActive=function(){return this._active};var ko=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var b=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs($o(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$o(this._distance,b),pinchAround:l}},a}(Ps);function fl(s,a){return 180*s.angleWith(a)/Math.PI}var _l=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var b=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fl(this._vector,b),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,b=fl(n,this._startVector);return Math.abs(b)<l},a}(Ps);function zl(s){return Math.abs(s.y)>Math.abs(s.x)}var uf=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,zl(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,b){var O=n[0].sub(this._lastPoints[0]),R=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(O,R,b.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(O.y+R.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,b){if(this._valid!==void 0)return this._valid;var O=n.mag()>=2,R=l.mag()>=2;if(O||R){if(!O||!R)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;var j=n.y>0==l.y>0;return zl(n)&&zl(l)&&j}},a}(Ps),Fl={panStep:100,bearingStep:15,pitchStep:10},Rs=function(){var a=Fl;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function as(s){return s*(2-s)}Rs.prototype.reset=function(){this._active=!1},Rs.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,b=0,O=0,R=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),O=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),O=1);break;case 38:s.shiftKey?b=1:(s.preventDefault(),R=-1);break;case 40:s.shiftKey?b=-1:(s.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(l=0,b=0),{cameraAnimation:function(ue){var Te=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:as,zoom:n?Math.round(Te)+n*(s.shiftKey?2:1):Te,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+b*a._pitchStep,offset:[-O*a._panStep,-R*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},Rs.prototype.enable=function(){this._enabled=!0},Rs.prototype.disable=function(){this._enabled=!1,this.reset()},Rs.prototype.isEnabled=function(){return this._enabled},Rs.prototype.isActive=function(){return this._active},Rs.prototype.disableRotation=function(){this._rotationDisabled=!0},Rs.prototype.enableRotation=function(){this._rotationDisabled=!1};var Pa=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};Pa.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Pa.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Pa.prototype.isEnabled=function(){return!!this._enabled},Pa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Pa.prototype.isZooming=function(){return!!this._zooming},Pa.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Pa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pa.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=o.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Pa.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Pa.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Pa.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var b=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(b*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var O,R=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,j=this._startZoom,ue=this._easing,Te=!1;if(this._type==="wheel"&&j&&ue){var Xe=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),Je=ue(Xe);O=o.number(j,R,Je),Xe<1?this._frameId||(this._frameId=!0):Te=!0}else O=R,Te=!0;return this._active=!0,Te&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Te,zoomDelta:O-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Pa.prototype._smoothOutEasing=function(s){var a=o.ease;if(this._prevEase){var n=this._prevEase,l=(o.browser.now()-n.start)/n.duration,b=n.easing(l+.01)-n.easing(l),O=.27/Math.sqrt(b*b+1e-4)*.01,R=Math.sqrt(.0729-O*O);a=o.bezier(O,R,.25,1)}return this._prevEase={start:o.browser.now(),duration:s,easing:a},a},Pa.prototype.reset=function(){this._active=!1};var $u=function(a,n){this._clickZoom=a,this._tapZoom=n};$u.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},$u.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},$u.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},$u.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var zi=function(){this.reset()};zi.prototype.reset=function(){this._active=!1},zi.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},zi.prototype.enable=function(){this._enabled=!0},zi.prototype.disable=function(){this._enabled=!1,this.reset()},zi.prototype.isEnabled=function(){return this._enabled},zi.prototype.isActive=function(){return this._active};var Co=function(){this._tap=new Mu({numTouches:1,numTaps:1}),this.reset()};Co.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Co.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},Co.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],b=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,a,n)},Co.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},Co.prototype.touchcancel=function(){this.reset()},Co.prototype.enable=function(){this._enabled=!0},Co.prototype.disable=function(){this._enabled=!1,this.reset()},Co.prototype.isEnabled=function(){return this._enabled},Co.prototype.isActive=function(){return this._active};var Sl=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};Sl.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Sl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Sl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Sl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var gu=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};gu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},gu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},gu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},gu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var yu=function(a,n,l,b){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0};yu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},yu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},yu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},yu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},yu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},yu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ss=function(a){return a.zoom||a.drag||a.pitch||a.rotate},Sc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(o.Event);function Yn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var Nn=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ll(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),o.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[o.window,"blur",void 0]];for(var b=0,O=this._listeners;b<O.length;b+=1){var R=O[b],j=R[0];D.addEventListener(j,R[1],j===o.window.document?this.handleWindowEvent:this.handleEvent,R[2])}};Nn.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===o.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Nn.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new lo(a,s));var l=a.boxZoom=new Us(a,s);this._add("boxZoom",l);var b=new Bs,O=new zi;a.doubleClickZoom=new $u(O,b),this._add("tapZoom",b),this._add("clickZoom",O);var R=new Co;this._add("tapDragZoom",R);var j=a.touchPitch=new uf;this._add("touchPitch",j);var ue=new _c(s),Te=new cl(s);a.dragRotate=new gu(s,ue,Te),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Te,["mouseRotate"]);var Xe=new Vc(s),Je=new vu(s);a.dragPan=new Sl(n,Xe,Je),this._add("mousePan",Xe),this._add("touchPan",Je,["touchZoom","touchRotate"]);var tt=new _l,Dt=new ko;a.touchZoomRotate=new yu(n,Dt,tt,R),this._add("touchRotate",tt,["touchPan","touchZoom"]),this._add("touchZoom",Dt,["touchPan","touchRotate"]);var Lt=a.scrollZoom=new Pa(a,this);this._add("scrollZoom",Lt,["mousePan"]);var Zt=a.keyboard=new Rs;this._add("keyboard",Zt),this._add("blockableMapEvent",new Mn(a));for(var Rt=0,Bt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Rt<Bt.length;Rt+=1){var qt=Bt[Rt];s.interactive&&s[qt]&&a[qt].enable(s[qt])}},Nn.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},Nn.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},Nn.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},Nn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Nn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Nn.prototype.isMoving=function(){return Boolean(Ss(this._eventsInProgress))||this.isZooming()},Nn.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},Nn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},Nn.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var b=l[n];this._el.contains(b.target)&&a.push(b)}return a},Nn.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},b={},O={},R=s.touches?this._getMapTouches(s.touches):void 0,j=R?D.touchPos(this._el,R):D.mousePos(this._el,s),ue=0,Te=this._handlers;ue<Te.length;ue+=1){var Xe=Te[ue],Je=Xe.handlerName,tt=Xe.handler,Dt=Xe.allowed;if(tt.isEnabled()){var Lt=void 0;this._blockedByActive(O,Dt,Je)?tt.reset():tt[a||s.type]&&(Lt=tt[a||s.type](s,j,R),this.mergeHandlerResult(l,b,Lt,Je,n),Lt&&Lt.needsRenderFrame&&this._triggerRenderFrame()),(Lt||tt.isActive())&&(O[Je]=tt)}}var Zt={};for(var Rt in this._previousActiveHandlers)O[Rt]||(Zt[Rt]=n);this._previousActiveHandlers=O,(Object.keys(Zt).length||Yn(l))&&(this._changes.push([l,b,Zt]),this._triggerRenderFrame()),(Object.keys(O).length||Yn(l))&&this._map._stop(!0),this._updatingCamera=!1;var Bt=l.cameraAnimation;Bt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Bt(this._map))}else this.stop(!0)},Nn.prototype.mergeHandlerResult=function(s,a,n,l,b){if(n){o.extend(s,n);var O={handlerName:l,originalEvent:n.originalEvent||b};n.zoomDelta!==void 0&&(a.zoom=O),n.panDelta!==void 0&&(a.drag=O),n.pitchDelta!==void 0&&(a.pitch=O),n.bearingDelta!==void 0&&(a.rotate=O)}},Nn.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,b=this._changes;l<b.length;l+=1){var O=b[l],R=O[0],j=O[1],ue=O[2];R.panDelta&&(s.panDelta=(s.panDelta||new o.Point(0,0))._add(R.panDelta)),R.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+R.zoomDelta),R.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+R.bearingDelta),R.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+R.pitchDelta),R.around!==void 0&&(s.around=R.around),R.pinchAround!==void 0&&(s.pinchAround=R.pinchAround),R.noInertia&&(s.noInertia=R.noInertia),o.extend(a,j),o.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},Nn.prototype._updateMapTransform=function(s,a,n){var l=this._map,b=l.transform;if(!Yn(s))return this._fireEvents(a,n,!0);var O=s.panDelta,R=s.zoomDelta,j=s.bearingDelta,ue=s.pitchDelta,Te=s.around,Xe=s.pinchAround;Xe!==void 0&&(Te=Xe),l._stop(!0),Te=Te||l.transform.centerPoint;var Je=b.pointLocation(O?Te.sub(O):Te);j&&(b.bearing+=j),ue&&(b.pitch+=ue),R&&(b.zoom+=R),b.setLocationAtPoint(Je,Te),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},Nn.prototype._fireEvents=function(s,a,n){var l=this,b=Ss(this._eventsInProgress),O=Ss(s),R={};for(var j in s)this._eventsInProgress[j]||(R[j+"start"]=s[j].originalEvent),this._eventsInProgress[j]=s[j];for(var ue in!b&&O&&this._fireEvent("movestart",O.originalEvent),R)this._fireEvent(ue,R[ue]);for(var Te in O&&this._fireEvent("move",O.originalEvent),s)this._fireEvent(Te,s[Te].originalEvent);var Xe,Je={};for(var tt in this._eventsInProgress){var Dt=this._eventsInProgress[tt],Lt=Dt.handlerName,Zt=Dt.originalEvent;this._handlersById[Lt].isActive()||(delete this._eventsInProgress[tt],Je[tt+"end"]=Xe=a[Lt]||Zt)}for(var Rt in Je)this._fireEvent(Rt,Je[Rt]);var Bt=Ss(this._eventsInProgress);if(n&&(b||O)&&!Bt){this._updatingCamera=!0;var qt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Qt=function(fr){return fr!==0&&-l._bearingSnap<fr&&fr<l._bearingSnap};qt?(Qt(qt.bearing||this._map.getBearing())&&(qt.bearing=0),this._map.easeTo(qt,{originalEvent:Xe})):(this._map.fire(new o.Event("moveend",{originalEvent:Xe})),Qt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Nn.prototype._fireEvent=function(s,a){this._map.fire(new o.Event(s,a?{originalEvent:a}:{}))},Nn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new Sc("renderFrame",{timeStamp:a})),s._applyChanges()})},Nn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Ac=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,b){return n=o.Point.convert(n).mult(-1),this.panTo(this.transform.center,o.extend({offset:n},l),b)},a.prototype.panTo=function(n,l,b){return this.easeTo(o.extend({center:n},l),b)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,b){return this.easeTo(o.extend({zoom:n},l),b)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,b){return this.easeTo(o.extend({bearing:n},l),b)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,o.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){n=o.LngLatBounds.convert(n);var b=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),b,l)},a.prototype._cameraForBoxAndBearing=function(n,l,b,O){var R={top:0,bottom:0,right:0,left:0};if(typeof(O=o.extend({padding:R,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){var j=O.padding;O.padding={top:j,bottom:j,right:j,left:j}}O.padding=o.extend(R,O.padding);var ue=this.transform,Te=ue.padding,Xe=ue.project(o.LngLat.convert(n)),Je=ue.project(o.LngLat.convert(l)),tt=Xe.rotate(-b*Math.PI/180),Dt=Je.rotate(-b*Math.PI/180),Lt=new o.Point(Math.max(tt.x,Dt.x),Math.max(tt.y,Dt.y)),Zt=new o.Point(Math.min(tt.x,Dt.x),Math.min(tt.y,Dt.y)),Rt=Lt.sub(Zt),Bt=(ue.width-(Te.left+Te.right+O.padding.left+O.padding.right))/Rt.x,qt=(ue.height-(Te.top+Te.bottom+O.padding.top+O.padding.bottom))/Rt.y;if(!(qt<0||Bt<0)){var Qt=Math.min(ue.scaleZoom(ue.scale*Math.min(Bt,qt)),O.maxZoom),Pr=typeof O.offset.x=="number"?new o.Point(O.offset.x,O.offset.y):o.Point.convert(O.offset),fr=new o.Point((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(b*Math.PI/180),Tr=Pr.add(fr).mult(ue.scale/ue.zoomScale(Qt));return{center:ue.unproject(Xe.add(Je).div(2).sub(Tr)),zoom:Qt,bearing:b}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,b){return this._fitInternal(this.cameraForBounds(n,l),l,b)},a.prototype.fitScreenCoordinates=function(n,l,b,O,R){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(n)),this.transform.pointLocation(o.Point.convert(l)),b,O),O,R)},a.prototype._fitInternal=function(n,l,b){return n?(delete(l=o.extend(n,l)).padding,l.linear?this.easeTo(l,b):this.flyTo(l,b)):this},a.prototype.jumpTo=function(n,l){this.stop();var b=this.transform,O=!1,R=!1,j=!1;return"zoom"in n&&b.zoom!==+n.zoom&&(O=!0,b.zoom=+n.zoom),n.center!==void 0&&(b.center=o.LngLat.convert(n.center)),"bearing"in n&&b.bearing!==+n.bearing&&(R=!0,b.bearing=+n.bearing),"pitch"in n&&b.pitch!==+n.pitch&&(j=!0,b.pitch=+n.pitch),n.padding==null||b.isPaddingEqual(n.padding)||(b.padding=n.padding),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),O&&this.fire(new o.Event("zoomstart",l)).fire(new o.Event("zoom",l)).fire(new o.Event("zoomend",l)),R&&this.fire(new o.Event("rotatestart",l)).fire(new o.Event("rotate",l)).fire(new o.Event("rotateend",l)),j&&this.fire(new o.Event("pitchstart",l)).fire(new o.Event("pitch",l)).fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))},a.prototype.easeTo=function(n,l){var b=this;this._stop(!1,n.easeId),((n=o.extend({offset:[0,0],duration:500,easing:o.ease},n)).animate===!1||!n.essential&&o.browser.prefersReducedMotion)&&(n.duration=0);var O=this.transform,R=this.getZoom(),j=this.getBearing(),ue=this.getPitch(),Te=this.getPadding(),Xe="zoom"in n?+n.zoom:R,Je="bearing"in n?this._normalizeBearing(n.bearing,j):j,tt="pitch"in n?+n.pitch:ue,Dt="padding"in n?n.padding:O.padding,Lt=o.Point.convert(n.offset),Zt=O.centerPoint.add(Lt),Rt=O.pointLocation(Zt),Bt=o.LngLat.convert(n.center||Rt);this._normalizeCenter(Bt);var qt,Qt,Pr=O.project(Rt),fr=O.project(Bt).sub(Pr),Tr=O.zoomScale(Xe-R);n.around&&(qt=o.LngLat.convert(n.around),Qt=O.locationPoint(qt));var Ar={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Xe!==R,this._rotating=this._rotating||j!==Je,this._pitching=this._pitching||tt!==ue,this._padding=!O.isPaddingEqual(Dt),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Ar),this._ease(function(nn){if(b._zooming&&(O.zoom=o.number(R,Xe,nn)),b._rotating&&(O.bearing=o.number(j,Je,nn)),b._pitching&&(O.pitch=o.number(ue,tt,nn)),b._padding&&(O.interpolatePadding(Te,Dt,nn),Zt=O.centerPoint.add(Lt)),qt)O.setLocationAtPoint(qt,Qt);else{var Xr=O.zoomScale(O.zoom-R),gn=Xe>R?Math.min(2,Tr):Math.max(.5,Tr),Pn=Math.pow(gn,1-nn),Jn=O.unproject(Pr.add(fr.mult(nn*Pn)).mult(Xr));O.setLocationAtPoint(O.renderWorldCopies?Jn.wrap():Jn,Zt)}b._fireMoveEvents(l)},function(nn){b._afterEase(l,nn)},n),this},a.prototype._prepareEase=function(n,l,b){b===void 0&&(b={}),this._moving=!0,l||b.moving||this.fire(new o.Event("movestart",n)),this._zooming&&!b.zooming&&this.fire(new o.Event("zoomstart",n)),this._rotating&&!b.rotating&&this.fire(new o.Event("rotatestart",n)),this._pitching&&!b.pitching&&this.fire(new o.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new o.Event("move",n)),this._zooming&&this.fire(new o.Event("zoom",n)),this._rotating&&this.fire(new o.Event("rotate",n)),this._pitching&&this.fire(new o.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var b=this._zooming,O=this._rotating,R=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new o.Event("zoomend",n)),O&&this.fire(new o.Event("rotateend",n)),R&&this.fire(new o.Event("pitchend",n)),this.fire(new o.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var b=this;if(!n.essential&&o.browser.prefersReducedMotion){var O=o.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(O,l)}this.stop(),n=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},n);var R=this.transform,j=this.getZoom(),ue=this.getBearing(),Te=this.getPitch(),Xe=this.getPadding(),Je="zoom"in n?o.clamp(+n.zoom,R.minZoom,R.maxZoom):j,tt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Dt="pitch"in n?+n.pitch:Te,Lt="padding"in n?n.padding:R.padding,Zt=R.zoomScale(Je-j),Rt=o.Point.convert(n.offset),Bt=R.centerPoint.add(Rt),qt=R.pointLocation(Bt),Qt=o.LngLat.convert(n.center||qt);this._normalizeCenter(Qt);var Pr=R.project(qt),fr=R.project(Qt).sub(Pr),Tr=n.curve,Ar=Math.max(R.width,R.height),nn=Ar/Zt,Xr=fr.mag();if("minZoom"in n){var gn=o.clamp(Math.min(n.minZoom,j,Je),R.minZoom,R.maxZoom),Pn=Ar/R.zoomScale(gn-j);Tr=Math.sqrt(Pn/Xr*2)}var Jn=Tr*Tr;function aa(ta){var La=(nn*nn-Ar*Ar+(ta?-1:1)*Jn*Jn*Xr*Xr)/(2*(ta?nn:Ar)*Jn*Xr);return Math.log(Math.sqrt(La*La+1)-La)}function ba(ta){return(Math.exp(ta)-Math.exp(-ta))/2}function Xa(ta){return(Math.exp(ta)+Math.exp(-ta))/2}var _n=aa(0),ia=function(La){return Xa(_n)/Xa(_n+Tr*La)},xa=function(La){return Ar*((Xa(_n)*(ba(ja=_n+Tr*La)/Xa(ja))-ba(_n))/Jn)/Xr;var ja},Wn=(aa(1)-_n)/Tr;if(Math.abs(Xr)<1e-6||!isFinite(Wn)){if(Math.abs(Ar-nn)<1e-6)return this.easeTo(n,l);var Aa=nn<Ar?-1:1;Wn=Math.abs(Math.log(nn/Ar))/Tr,xa=function(){return 0},ia=function(La){return Math.exp(Aa*Tr*La)}}return n.duration="duration"in n?+n.duration:1e3*Wn/("screenSpeed"in n?+n.screenSpeed/Tr:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==tt,this._pitching=Dt!==Te,this._padding=!R.isPaddingEqual(Lt),this._prepareEase(l,!1),this._ease(function(ta){var La=ta*Wn,ja=1/ia(La);R.zoom=ta===1?Je:j+R.scaleZoom(ja),b._rotating&&(R.bearing=o.number(ue,tt,ta)),b._pitching&&(R.pitch=o.number(Te,Dt,ta)),b._padding&&(R.interpolatePadding(Xe,Lt,ta),Bt=R.centerPoint.add(Rt));var Ji=ta===1?Qt:R.unproject(Pr.add(fr.mult(xa(La))).mult(ja));R.setLocationAtPoint(R.renderWorldCopies?Ji.wrap():Ji,Bt),b._fireMoveEvents(l)},function(){return b._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,l)}if(!n){var O=this.handlers;O&&O.stop(!1)}return this},a.prototype._ease=function(n,l,b){b.animate===!1||b.duration===0?(n(1),l()):(this._easeStart=o.browser.now(),this._easeOptions=b,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=o.wrap(n,-180,180);var b=Math.abs(n-l);return Math.abs(n-360-l)<b&&(n-=360),Math.abs(n+360-l)<b&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var b=n.lng-l.center.lng;n.lng+=b>180?-360:b<-180?360:0}},a}(o.Evented),ms=function(a){a===void 0&&(a={}),this.options=a,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ms.prototype.getDefaultPosition=function(){return"bottom-right"},ms.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ms.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ms.prototype._setElementTitle=function(s,a){var n=this._map._getUIString("AttributionControl."+a);s.title=n,s.setAttribute("aria-label",n)},ms.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ms.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,b,O){return b.value&&(l+=b.key+"="+b.value+(O<a.length-1?"&":"")),l},"?");s.href=o.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},ms.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ms.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var b=n[l];if(b.used){var O=b.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort(function(j,ue){return j.length-ue.length});var R=(s=s.filter(function(j,ue){for(var Te=ue+1;Te<s.length;Te++)if(s[Te].indexOf(j)>=0)return!1;return!0})).join(" | ");R!==this._attribHTML&&(this._attribHTML=R,s.length?(this._innerContainer.innerHTML=R,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ms.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var jo=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};jo.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},jo.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},jo.prototype.getDefaultPosition=function(){return"bottom-left"},jo.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},jo.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},jo.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var wo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};wo.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},wo.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var b=l[n];if(b.id===s)return void(b.cancelled=!0)}},wo.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var b=l[n];if(!b.cancelled&&(b.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},wo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ru={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Pu=o.window.HTMLImageElement,tc=o.window.HTMLElement,Za=o.window.ImageBitmap,Hi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},hl=function(s){function a(l){var b=this;if((l=o.extend({},Hi,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var O=new Da(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,O,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new wo,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},ru,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof tc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return b._update(!1)}),this.on("moveend",function(){return b._update(!1)}),this.on("zoom",function(){return b._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Nn(this,l),this._hash=l.hash&&new Ms(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new ms({customAttribution:l.customAttribution})),this.addControl(new jo,l.logoPosition),this.on("style.load",function(){b.transform.unmodified&&b.jumpTo(b.style.stylesheet)}),this.on("data",function(R){b._update(R.dataType==="style"),b.fire(new o.Event(R.dataType+"data",R))}),this.on("dataloading",function(R){b.fire(new o.Event(R.dataType+"dataloading",R))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,b){if(b===void 0&&(b=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var O=l.onAdd(this);this._controls.push(l);var R=this._controlPositions[b];return b.indexOf("bottom")!==-1?R.insertBefore(O,R.firstChild):R.appendChild(O),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var b=this._controls.indexOf(l);return b>-1&&this._controls.splice(b,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var b=this._containerDimensions(),O=b[0],R=b[1];this._resizeCanvas(O,R),this.transform.resize(O,R),this.painter.resize(O,R);var j=!this._moving;return j&&(this.stop(),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l))),this.fire(new o.Event("resize",l)),j&&this.fire(new o.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(o.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(o.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,b,O){var R,j=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:b,listener:O,delegates:{mousemove:function(Je){var tt=j.getLayer(b)?j.queryRenderedFeatures(Je.point,{layers:[b]}):[];tt.length?ue||(ue=!0,O.call(j,new ro(l,j,Je.originalEvent,{features:tt}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Te=!1;return{layer:b,listener:O,delegates:{mousemove:function(Je){(j.getLayer(b)?j.queryRenderedFeatures(Je.point,{layers:[b]}):[]).length?Te=!0:Te&&(Te=!1,O.call(j,new ro(l,j,Je.originalEvent)))},mouseout:function(Je){Te&&(Te=!1,O.call(j,new ro(l,j,Je.originalEvent)))}}}}return{layer:b,listener:O,delegates:(R={},R[l]=function(Xe){var Je=j.getLayer(b)?j.queryRenderedFeatures(Xe.point,{layers:[b]}):[];Je.length&&(Xe.features=Je,O.call(j,Xe),delete Xe.features)},R)}},a.prototype.on=function(l,b,O){if(O===void 0)return s.prototype.on.call(this,l,b);var R=this._createDelegatedListener(l,b,O);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(R),R.delegates)this.on(j,R.delegates[j]);return this},a.prototype.once=function(l,b,O){if(O===void 0)return s.prototype.once.call(this,l,b);var R=this._createDelegatedListener(l,b,O);for(var j in R.delegates)this.once(j,R.delegates[j]);return this},a.prototype.off=function(l,b,O){var R=this;return O===void 0?s.prototype.off.call(this,l,b):(this._delegatedListeners&&this._delegatedListeners[l]&&function(j){for(var ue=j[l],Te=0;Te<ue.length;Te++){var Xe=ue[Te];if(Xe.layer===b&&Xe.listener===O){for(var Je in Xe.delegates)R.off(Je,Xe.delegates[Je]);return ue.splice(Te,1),R}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,b){if(!this.style)return[];var O;if(b!==void 0||l===void 0||l instanceof o.Point||Array.isArray(l)||(b=l,l=void 0),b=b||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof l[0]=="number")O=[o.Point.convert(l)];else{var R=o.Point.convert(l[0]),j=o.Point.convert(l[1]);O=[R,new o.Point(j.x,R.y),j,new o.Point(R.x,j.y),R]}return this.style.queryRenderedFeatures(O,b,this.transform)},a.prototype.querySourceFeatures=function(l,b){return this.style.querySourceFeatures(l,b)},a.prototype.setStyle=function(l,b){return(b=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff!==!1&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(l,b))},a.prototype._getUIString=function(l){var b=this._locale[l];if(b==null)throw new Error("Missing UI string '"+l+"'");return b},a.prototype._updateStyle=function(l,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new yi(this,b||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new yi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,b){var O=this;if(typeof l=="string"){var R=this._requestManager.normalizeStyleURL(l),j=this._requestManager.transformRequest(R,o.ResourceType.Style);o.getJSON(j,function(ue,Te){ue?O.fire(new o.ErrorEvent(ue)):Te&&O._updateDiff(Te,b)})}else typeof l=="object"&&this._updateDiff(l,b)},a.prototype._updateDiff=function(l,b){try{this.style.setState(l)&&this._update(!0)}catch(O){o.warnOnce("Unable to perform style diff: "+(O.message||O.error||O)+".  Rebuilding the style from scratch."),this._updateStyle(l,b)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,b){return this._lazyInitEmptyStyle(),this.style.addSource(l,b),this._update(!0)},a.prototype.isSourceLoaded=function(l){var b=this.style&&this.style.sourceCaches[l];if(b!==void 0)return b.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var b in l){var O=l[b]._tiles;for(var R in O){var j=O[R];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,b,O){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,b,O)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,b,O){O===void 0&&(O={});var R=O.pixelRatio;R===void 0&&(R=1);var j=O.sdf;j===void 0&&(j=!1);var ue=O.stretchX,Te=O.stretchY,Xe=O.content;if(this._lazyInitEmptyStyle(),b instanceof Pu||Za&&b instanceof Za){var Je=o.browser.getImageData(b);this.style.addImage(l,{data:new o.RGBAImage({width:Je.width,height:Je.height},Je.data),pixelRatio:R,stretchX:ue,stretchY:Te,content:Xe,sdf:j,version:0})}else{if(b.width===void 0||b.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var tt=b;this.style.addImage(l,{data:new o.RGBAImage({width:b.width,height:b.height},new Uint8Array(b.data)),pixelRatio:R,stretchX:ue,stretchY:Te,content:Xe,sdf:j,version:0,userImage:tt}),tt.onAdd&&tt.onAdd(this,l)}},a.prototype.updateImage=function(l,b){var O=this.style.getImage(l);if(!O)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var R=b instanceof Pu||Za&&b instanceof Za?o.browser.getImageData(b):b,j=R.width,ue=R.height,Te=R.data;return j===void 0||ue===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==O.data.width||ue!==O.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(O.data.replace(Te,!(b instanceof Pu||Za&&b instanceof Za)),void this.style.updateImage(l,O))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,b){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),b)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,b){return this._lazyInitEmptyStyle(),this.style.addLayer(l,b),this._update(!0)},a.prototype.moveLayer=function(l,b){return this.style.moveLayer(l,b),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,b,O){return this.style.setLayerZoomRange(l,b,O),this._update(!0)},a.prototype.setFilter=function(l,b,O){return O===void 0&&(O={}),this.style.setFilter(l,b,O),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,b,O,R){return R===void 0&&(R={}),this.style.setPaintProperty(l,b,O,R),this._update(!0)},a.prototype.getPaintProperty=function(l,b){return this.style.getPaintProperty(l,b)},a.prototype.setLayoutProperty=function(l,b,O,R){return R===void 0&&(R={}),this.style.setLayoutProperty(l,b,O,R),this._update(!0)},a.prototype.getLayoutProperty=function(l,b){return this.style.getLayoutProperty(l,b)},a.prototype.setLight=function(l,b){return b===void 0&&(b={}),this._lazyInitEmptyStyle(),this.style.setLight(l,b),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,b){return this.style.setFeatureState(l,b),this._update()},a.prototype.removeFeatureState=function(l,b){return this.style.removeFeatureState(l,b),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,b=0;return this._container&&(l=this._container.clientWidth||400,b=this._container.clientHeight||300),[l,b]},a.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var O=this._containerDimensions();this._resizeCanvas(O[0],O[1]);var R=this._controlContainer=D.create("div","mapboxgl-control-container",l),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){j[ue]=D.create("div","mapboxgl-ctrl-"+ue,R)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,b){var O=o.browser.devicePixelRatio||1;this._canvas.width=O*l,this._canvas.height=O*b,this._canvas.style.width=l+"px",this._canvas.style.height=b+"px"},a.prototype._setupPainter=function(){var l=o.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);b?(this.painter=new ji(b,this.transform),o.webpSupported.testSupport(b)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var b,O=this,R=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(b=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,b),R=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Te=this.transform.zoom,Xe=o.browser.now();this.style.zoomHistory.update(Te,Xe);var Je=new o.EvaluationParameters(Te,{now:Xe,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),tt=Je.crossFadingFactor();tt===1&&tt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=tt),this.style.update(Je)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Dt=o.browser.now()-R;j.endQueryEXT(j.TIME_ELAPSED_EXT,b),setTimeout(function(){var Rt=j.getQueryObjectEXT(b,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(b),O.fire(new o.Event("gpu-timing-frame",{cpuTime:Dt,gpuTime:Rt}))},50)}if(this.listens("gpu-timing-layer")){var Lt=this.painter.collectGpuTimers();setTimeout(function(){var Rt=O.painter.queryGpuTimers(Lt);O.fire(new o.Event("gpu-timing-layer",{layerTimes:Rt}))},50)}var Zt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Zt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Zt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,b=this._controls;l<b.length;l+=1)b[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var O=this.painter.context.gl.getExtension("WEBGL_lose_context");O&&O.loseContext(),dl(this._canvasContainer),dl(this._controlContainer),dl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(b){l._frame=null,l._render(b)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,b){o.setCacheLimits(l,b)},n.version.get=function(){return o.version},Object.defineProperties(a.prototype,n),a}(Ac);function dl(s){s.parentNode&&s.parentNode.removeChild(s)}var rc={showCompass:!0,showZoom:!0,visualizePitch:!1},Lu=function(a){var n=this;this.options=o.extend({},rc,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Lu.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),a=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Lu.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Lu.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Is(this._map,this._compass,this.options.visualizePitch)),this._container},Lu.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Lu.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Lu.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var Is=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new _c({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new cl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Ul(s,a,n){if(s=new o.LngLat(s.lng,s.lat),a){var l=new o.LngLat(s.lng-360,s.lat),b=new o.LngLat(s.lng+360,s.lat),O=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<O?s=l:n.locationPoint(b).distSqr(a)<O&&(s=b)}for(;Math.abs(s.lng-n.center.lng)>180;){var R=n.locationPoint(s);if(R.x>=0&&R.y>=0&&R.x<=n.width&&R.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Is.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},Is.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var b=this.mousePitch.mousemoveWindow(s,a);b&&b.pitchDelta&&n.setPitch(n.getPitch()+b.pitchDelta)}},Is.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Is.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(o.window,"mousemove",this.mousemove),D.removeEventListener(o.window,"mouseup",this.mouseup)},Is.prototype.mousedown=function(s){this.down(o.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(o.window,"mousemove",this.mousemove),D.addEventListener(o.window,"mouseup",this.mouseup)},Is.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},Is.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Is.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Is.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Is.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var vs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ef(s,a,n){var l=s.classList;for(var b in vs)l.remove("mapboxgl-"+n+"-anchor-"+b);l.add("mapboxgl-"+n+"-anchor-"+a)}var Bl,Gc=function(s){function a(n,l){if(s.call(this),(n instanceof o.window.HTMLElement||l)&&(n=o.extend({element:n},l)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=o.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var b=D.createNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS(null,"display","block"),b.setAttributeNS(null,"height","41px"),b.setAttributeNS(null,"width","27px"),b.setAttributeNS(null,"viewBox","0 0 27 41");var O=D.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"stroke","none"),O.setAttributeNS(null,"stroke-width","1"),O.setAttributeNS(null,"fill","none"),O.setAttributeNS(null,"fill-rule","evenodd");var R=D.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");var j=D.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(3.0, 29.0)"),j.setAttributeNS(null,"fill","#000000");for(var ue=0,Te=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Te.length;ue+=1){var Xe=Te[ue],Je=D.createNS("http://www.w3.org/2000/svg","ellipse");Je.setAttributeNS(null,"opacity","0.04"),Je.setAttributeNS(null,"cx","10.5"),Je.setAttributeNS(null,"cy","5.80029008"),Je.setAttributeNS(null,"rx",Xe.rx),Je.setAttributeNS(null,"ry",Xe.ry),j.appendChild(Je)}var tt=D.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"fill",this._color);var Dt=D.createNS("http://www.w3.org/2000/svg","path");Dt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),tt.appendChild(Dt);var Lt=D.createNS("http://www.w3.org/2000/svg","g");Lt.setAttributeNS(null,"opacity","0.25"),Lt.setAttributeNS(null,"fill","#000000");var Zt=D.createNS("http://www.w3.org/2000/svg","path");Zt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Lt.appendChild(Zt);var Rt=D.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Rt.setAttributeNS(null,"fill","#FFFFFF");var Bt=D.createNS("http://www.w3.org/2000/svg","g");Bt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var qt=D.createNS("http://www.w3.org/2000/svg","circle");qt.setAttributeNS(null,"fill","#000000"),qt.setAttributeNS(null,"opacity","0.25"),qt.setAttributeNS(null,"cx","5.5"),qt.setAttributeNS(null,"cy","5.5"),qt.setAttributeNS(null,"r","5.4999962");var Qt=D.createNS("http://www.w3.org/2000/svg","circle");Qt.setAttributeNS(null,"fill","#FFFFFF"),Qt.setAttributeNS(null,"cx","5.5"),Qt.setAttributeNS(null,"cy","5.5"),Qt.setAttributeNS(null,"r","5.4999962"),Bt.appendChild(qt),Bt.appendChild(Qt),R.appendChild(j),R.appendChild(tt),R.appendChild(Lt),R.appendChild(Rt),R.appendChild(Bt),b.appendChild(R),b.setAttributeNS(null,"height",41*this._scale+"px"),b.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(b),this._offset=o.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Pr){Pr.preventDefault()}),this._element.addEventListener("mousedown",function(Pr){Pr.preventDefault()}),Ef(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,b=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&b!==32&&b!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,b=this._element;this._popup&&(l===b||b.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ul(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,vs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=o.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(o.Evented),Tf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Vs=0,Al=!1,Vl=function(s){function a(n){s.call(this),this.options=o.extend({},Tf,n),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Bl!==void 0?l(Bl):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(b){l(Bl=b.state!=="denied")}):l(Bl=!!o.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Vs=0,Al=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),b=n.coords;return l&&(b.longitude<l.getWest()||b.longitude>l.getEast()||b.latitude<l.getSouth()||b.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude),b=n.coords.accuracy,O=this._map.getBearing(),R=o.extend({bearing:O},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(b),R,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),b=this._map.unproject([1,n]),O=l.distanceTo(b),R=Math.ceil(2*this._accuracy/O);this._circleElement.style.width=R+"px",this._circleElement.style.height=R+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Al)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var O=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Gc(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Gc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(R){R.geolocateSource||l._watchState!=="ACTIVE_LOCK"||R.originalEvent&&R.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new o.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Vs--,Al=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Vs>1?(n={maximumAge:6e5,timeout:0},Al=!0):(n=this.options.positionOptions,Al=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(o.Evented),Ru={maxWidth:100,unit:"metric"},Iu=function(a){this.options=o.extend({},Ru,a),o.bindAll(["_onMove","setUnit"],this)};function Cl(s,a,n){var l=n&&n.maxWidth||100,b=s._container.clientHeight/2,O=s.unproject([0,b]),R=s.unproject([l,b]),j=O.distanceTo(R);if(n&&n.unit==="imperial"){var ue=3.2808*j;ue>5280?Ju(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):Ju(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Ju(a,l,j/1852,s._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Ju(a,l,j/1e3,s._getUIString("ScaleControl.Kilometers")):Ju(a,l,j,s._getUIString("ScaleControl.Meters"))}function Ju(s,a,n,l){var b,O,R,j=(b=n,(O=Math.pow(10,(""+Math.floor(b)).length-1))*(R=(R=b/O)>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(ue){var Te=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Te)/Te}(R)));s.style.width=a*(j/n)+"px",s.innerHTML=j+"&nbsp;"+l}Iu.prototype.getDefaultPosition=function(){return"bottom-left"},Iu.prototype._onMove=function(){Cl(this._map,this._container,this.options)},Iu.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Iu.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Iu.prototype.setUnit=function(s){this.options.unit=s,Cl(this._map,this._container,this.options)};var Ds=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof o.window.HTMLElement?this._container=a.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ds.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ds.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Ds.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ds.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ds.prototype._isFullscreen=function(){return this._fullscreen},Ds.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ds.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Cc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},nc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ac=function(s){function a(n){s.call(this),this.options=o.extend(Object.create(Cc),n),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(o.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,b=o.window.document.createDocumentFragment(),O=o.window.document.createElement("body");for(O.innerHTML=n;l=O.firstChild;)b.appendChild(l);return this.setDOMContent(b)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Je){return l._container.classList.add(Je)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ul(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var b=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),O=this.options.anchor,R=function Je(tt){if(tt){if(typeof tt=="number"){var Dt=Math.round(Math.sqrt(.5*Math.pow(tt,2)));return{center:new o.Point(0,0),top:new o.Point(0,tt),"top-left":new o.Point(Dt,Dt),"top-right":new o.Point(-Dt,Dt),bottom:new o.Point(0,-tt),"bottom-left":new o.Point(Dt,-Dt),"bottom-right":new o.Point(-Dt,-Dt),left:new o.Point(tt,0),right:new o.Point(-tt,0)}}if(tt instanceof o.Point||Array.isArray(tt)){var Lt=o.Point.convert(tt);return{center:Lt,top:Lt,"top-left":Lt,"top-right":Lt,bottom:Lt,"bottom-left":Lt,"bottom-right":Lt,left:Lt,right:Lt}}return{center:o.Point.convert(tt.center||[0,0]),top:o.Point.convert(tt.top||[0,0]),"top-left":o.Point.convert(tt["top-left"]||[0,0]),"top-right":o.Point.convert(tt["top-right"]||[0,0]),bottom:o.Point.convert(tt.bottom||[0,0]),"bottom-left":o.Point.convert(tt["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(tt["bottom-right"]||[0,0]),left:o.Point.convert(tt.left||[0,0]),right:o.Point.convert(tt.right||[0,0])}}return Je(new o.Point(0,0))}(this.options.offset);if(!O){var j,ue=this._container.offsetWidth,Te=this._container.offsetHeight;j=b.y+R.bottom.y<Te?["top"]:b.y>this._map.transform.height-Te?["bottom"]:[],b.x<ue/2?j.push("left"):b.x>this._map.transform.width-ue/2&&j.push("right"),O=j.length===0?"bottom":j.join("-")}var Xe=b.add(R[O]).round();D.setTransform(this._container,vs[O]+" translate("+Xe.x+"px,"+Xe.y+"px)"),Ef(this._container,O,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(nc);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(o.Evented),ic={version:o.version,supported:Z,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:hl,NavigationControl:Lu,GeolocateControl:Vl,AttributionControl:ms,ScaleControl:Iu,FullscreenControl:Ds,Popup:ac,Marker:Gc,Style:yi,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Er().acquire(or)},clearPrewarmedResources:function(){var a=Sn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(or),Sn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(s){o.config.ACCESS_TOKEN=s},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(s){o.config.API_URL=s},get workerCount(){return Fr.workerCount},set workerCount(s){Fr.workerCount=s},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){o.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){o.clearTileCache(a)},workerUrl:""};return ic}),X})},"4cb6":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm");E.METADATA_KEY=T;var m=i("9Fde");E.Container=m.Container;var X=i("FV85");E.BindingScopeEnum=X.BindingScopeEnum,E.BindingTypeEnum=X.BindingTypeEnum,E.TargetTypeEnum=X.TargetTypeEnum;var z=i("dxzI");E.AsyncContainerModule=z.AsyncContainerModule,E.ContainerModule=z.ContainerModule;var o=i("cZ5Q");E.injectable=o.injectable;var Z=i("0gSV");E.tagged=Z.tagged;var D=i("ZzCi");E.named=D.named;var K=i("Yk9n");E.inject=K.inject,E.LazyServiceIdentifer=K.LazyServiceIdentifer;var re=i("jYx5");E.optional=re.optional;var fe=i("n2J3");E.unmanaged=fe.unmanaged;var Y=i("jIg/");E.multiInject=Y.multiInject;var Fe=i("oaX6");E.targetName=Fe.targetName;var We=i("Sk89");E.postConstruct=We.postConstruct;var ge=i("wnjb");E.MetadataReader=ge.MetadataReader;var we=i("d9O0");E.id=we.id;var dt=i("Ztfv");E.decorate=dt.decorate;var ke=i("RR/i");E.traverseAncerstors=ke.traverseAncerstors,E.taggedConstraint=ke.taggedConstraint,E.namedConstraint=ke.namedConstraint,E.typeConstraint=ke.typeConstraint;var Et=i("ujMp");E.getServiceIdentifierAsString=Et.getServiceIdentifierAsString;var Ze=i("78VC");E.multiBindToService=Ze.multiBindToService},"4qC0":function(Re,E,i){var T=i("NykK"),m=i("Z0cm"),X=i("ExA7"),z="[object String]";function o(Z){return typeof Z=="string"||!m(Z)&&X(Z)&&T(Z)==z}Re.exports=o},"5Tg0":function(Re,E,i){(function(T){var m=i("Kz5y"),X=E&&!E.nodeType&&E,z=X&&typeof T=="object"&&T&&!T.nodeType&&T,o=z&&z.exports===X,Z=o?m.Buffer:void 0,D=Z?Z.allocUnsafe:void 0;function K(re,fe){if(fe)return re.slice();var Y=re.length,Fe=D?D(Y):new re.constructor(Y);return re.copy(Fe),Fe}T.exports=K}).call(this,i("YuTi")(Re))},"5gLl":function(Re,E,i){"use strict";i.d(E,"a",function(){return Y});var T=i("lSNA"),m=i.n(T),X=i("LvWW"),z=i.n(X),o=i("AKIq"),Z=i.n(o),D=i("cWyK"),K=i.n(D);function re(Fe,We){var ge=Object.keys(Fe);if(Object.getOwnPropertySymbols){var we=Object.getOwnPropertySymbols(Fe);We&&(we=we.filter(function(dt){return Object.getOwnPropertyDescriptor(Fe,dt).enumerable})),ge.push.apply(ge,we)}return ge}function fe(Fe){for(var We=1;We<arguments.length;We++){var ge=arguments[We]!=null?arguments[We]:{};We%2?re(Object(ge),!0).forEach(function(we){m()(Fe,we,ge[we])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Fe,Object.getOwnPropertyDescriptors(ge)):re(Object(ge)).forEach(function(we){Object.defineProperty(Fe,we,Object.getOwnPropertyDescriptor(ge,we))})}return Fe}function Y(Fe,We){var ge=[],we={};if(Fe.features=Fe.features.filter(function(ke){var Et=ke.geometry;return ke!=null&&Et&&Et.type&&Et.coordinates&&Et.coordinates.length>0}),z()(Fe,!0),Fe.features.length===0)return{dataArray:[],featureKeys:we};var dt=0;return D.flattenEach(Fe,function(ke,Et){var Ze=Object(o.getCoords)(ke),vt=Et,Qe=fe(fe({},ke.properties),{},{coordinates:Ze,_id:vt});ge.push(Qe)}),{dataArray:ge,featureKeys:we}}},"5ku3":function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return z});var m=i("U8pU"),X=i("I0ug");function z(){var Z=(typeof T=="undefined"?"undefined":Object(m.a)(T))==="object"&&String(T)==="[object process]"&&!T.browser;return!Z||Object(X.a)()}function o(){return z()&&typeof document!="undefined"}}).call(this,i("Q2Ig"))},"5zYK":function(Re,E,i){"use strict";i.d(E,"a",function(){return re});var T=i("lSNA"),m=i.n(T),X=i("RIqP"),z=i.n(X),o=i("LvWW"),Z=i.n(o);function D(fe,Y){var Fe=Object.keys(fe);if(Object.getOwnPropertySymbols){var We=Object.getOwnPropertySymbols(fe);Y&&(We=We.filter(function(ge){return Object.getOwnPropertyDescriptor(fe,ge).enumerable})),Fe.push.apply(Fe,We)}return Fe}function K(fe){for(var Y=1;Y<arguments.length;Y++){var Fe=arguments[Y]!=null?arguments[Y]:{};Y%2?D(Object(Fe),!0).forEach(function(We){m()(fe,We,Fe[We])}):Object.getOwnPropertyDescriptors?Object.defineProperties(fe,Object.getOwnPropertyDescriptors(Fe)):D(Object(Fe)).forEach(function(We){Object.defineProperty(fe,We,Object.getOwnPropertyDescriptor(Fe,We))})}return fe}function re(fe,Y){var Fe=Y.x,We=Y.y,ge=Y.x1,we=Y.y1,dt=Y.coordinates,ke=[];return fe.forEach(function(Et,Ze){var vt=[];if(Fe&&We&&(vt=[parseFloat(Et[Fe]),parseFloat(Et[We])]),Fe&&We&&ge&&we){var Qe=[parseFloat(Et[Fe]),parseFloat(Et[We])],yt=[parseFloat(Et[ge]),parseFloat(Et[we])];vt=[Qe,yt]}if(dt){var _t="Polygon";Array.isArray(dt[0])||(_t="Point"),Array.isArray(dt[0])&&!Array.isArray(dt[0][0])&&(_t="LineString");var De={type:_t,coordinates:z()(Et[dt])};Z()(De,!0),vt=De.coordinates}var Ne=K(K({},Et),{},{_id:Ze,coordinates:vt});ke.push(Ne)}),{dataArray:ke}}},"6AGu":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("LKzl"),X=function(){function z(o){this._binding=o}return z.prototype.inRequestScope=function(){return this._binding.scope=T.BindingScopeEnum.Request,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inSingletonScope=function(){return this._binding.scope=T.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inTransientScope=function(){return this._binding.scope=T.BindingScopeEnum.Transient,new m.BindingWhenOnSyntax(this._binding)},z}();E.BindingInSyntax=X},"6D9b":function(Re,E,i){Re.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(Re,E){},"6acW":function(Re,E,i){var T=i("dt0z"),m=i("gQMU");function X(z){return m(T(z).toLowerCase())}Re.exports=X},"6nK8":function(Re,E,i){var T=i("dVn5"),m=i("fo6e"),X=i("dt0z"),z=i("9NmV");function o(Z,D,K){return Z=X(Z),D=K?void 0:D,D===void 0?m(Z)?z(Z):T(Z):Z.match(D)||[]}Re.exports=o},"711d":function(Re,E){function i(T){return function(m){return m==null?void 0:m[T]}}Re.exports=i},"78VC":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiBindToService=function(T){return function(m){return function(){for(var X=[],z=0;z<arguments.length;z++)X[z]=arguments[z];return X.forEach(function(o){return T.bind(o).toService(m)})}}}},"7Ix3":function(Re,E){function i(T){var m=[];if(T!=null)for(var X in Object(T))m.push(X);return m}Re.exports=i},"7tbW":function(Re,E,i){var T=i("LGYb");function m(X){return X&&X.length?T(X):[]}Re.exports=m},"8/Fi":function(Re,E,i){"use strict";var T=i("J4zp"),m=i.n(T),X=i("9nhX"),z=i.n(X),o=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Z(ut){return o.indexOf(ut)}var D=2,K=4,re=64,fe=128,Y=256,Fe=512,We=8192,ge=16384,we=32768,dt=32768*2,ke=131072,Et=262144,Ze=524288,vt=1048576,Qe=2097152,yt=4194304,_t=8388608,De=16777216,Ne=16777216*2;function Ue(ut,Gt){return ut=z()(Math.floor(ut),0,255),Gt=z()(Math.floor(Gt),0,255),256*ut+Gt}function st(ut){var Gt=ut.color,Kt=ut.radius,ar=ut.tileX,oe=ut.tileY,Q=ut.shape,H=ut.opacity,Ce=ut.stroke,Ee=ut.strokeWidth,_e=ut.strokeOpacity,ve=[],rt=[],$t=[],St=[Ue(Gt[0],Gt[1]),Ue(Gt[2],Gt[3])],ye=[Ue(Ce[0],Ce[1]),Ue(Ce[2],Ce[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(be){var Be=m()(be,2),lt=Be[0],Pe=Be[1];ve.push([].concat(St,[(lt+1)*_t+(Pe+1)*Qe+Z(Q)*ke+Kt,(ar+512)*Ze+(oe+512)*re])),rt.push([].concat(ye,[Ee,_e])),$t.push([H,0,0,0])}),{packedBuffer:ve,packedBuffer2:rt,packedBuffer3:$t}}function Le(ut,Gt){if(ut===0&&!Gt)return 0;if(ut===1&&Gt)return 4294967295;var Kt=Gt?1:0,ar=Math.floor(ut*127);return ar*Ne+Kt*De+ar*ke+Kt*dt+ar*Fe+Kt*Y+ar*D+Kt}},"88Gu":function(Re,E){var i=800,T=16,m=Date.now;function X(z){var o=0,Z=0;return function(){var D=m(),K=T-(D-Z);if(Z=D,K>0){if(++o>=i)return arguments[0]}else o=0;return z.apply(void 0,arguments)}}Re.exports=X},"8ml+":function(Re,E,i){"use strict";var T=i("h1nZ");i.o(T,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return T.CityBuildingLayer}),i.o(T,"Control")&&i.d(E,"Control",function(){return T.Control}),i.o(T,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return T.HeatmapLayer}),i.o(T,"ImageLayer")&&i.d(E,"ImageLayer",function(){return T.ImageLayer}),i.o(T,"LineLayer")&&i.d(E,"LineLayer",function(){return T.LineLayer}),i.o(T,"Logo")&&i.d(E,"Logo",function(){return T.Logo}),i.o(T,"Marker")&&i.d(E,"Marker",function(){return T.Marker}),i.o(T,"PointLayer")&&i.d(E,"PointLayer",function(){return T.PointLayer}),i.o(T,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return T.PolygonLayer}),i.o(T,"Popup")&&i.d(E,"Popup",function(){return T.Popup}),i.o(T,"RasterLayer")&&i.d(E,"RasterLayer",function(){return T.RasterLayer}),i.o(T,"Scale")&&i.d(E,"Scale",function(){return T.Scale}),i.o(T,"Scene")&&i.d(E,"Scene",function(){return T.Scene}),i.o(T,"Zoom")&&i.d(E,"Zoom",function(){return T.Zoom});var m=i("kQ+U");i.d(E,"Scene",function(){return m.a});var X=i("sxDa");i.d(E,"CityBuildingLayer",function(){return X.a}),i.d(E,"HeatmapLayer",function(){return X.b}),i.d(E,"ImageLayer",function(){return X.c}),i.d(E,"LineLayer",function(){return X.d}),i.d(E,"PointLayer",function(){return X.e}),i.d(E,"PolygonLayer",function(){return X.f}),i.d(E,"RasterLayer",function(){return X.g});var z=i("k5/I");i.d(E,"Control",function(){return z.a}),i.d(E,"Logo",function(){return z.b}),i.d(E,"Marker",function(){return z.c}),i.d(E,"Popup",function(){return z.d}),i.d(E,"Scale",function(){return z.e}),i.d(E,"Zoom",function(){return z.f});var o=i("Hel2"),Z=i("RL2/")},"8uyu":function(Re,E){},"9Fde":function(Re,E,i){"use strict";var T=this&&this.__awaiter||function(dt,ke,Et,Ze){return new(Et||(Et=Promise))(function(vt,Qe){function yt(Ne){try{De(Ze.next(Ne))}catch(Ue){Qe(Ue)}}function _t(Ne){try{De(Ze.throw(Ne))}catch(Ue){Qe(Ue)}}function De(Ne){Ne.done?vt(Ne.value):new Et(function(Ue){Ue(Ne.value)}).then(yt,_t)}De((Ze=Ze.apply(dt,ke||[])).next())})},m=this&&this.__generator||function(dt,ke){var Et={label:0,sent:function(){if(Qe[0]&1)throw Qe[1];return Qe[1]},trys:[],ops:[]},Ze,vt,Qe,yt;return yt={next:_t(0),throw:_t(1),return:_t(2)},typeof Symbol=="function"&&(yt[Symbol.iterator]=function(){return this}),yt;function _t(Ne){return function(Ue){return De([Ne,Ue])}}function De(Ne){if(Ze)throw new TypeError("Generator is already executing.");for(;Et;)try{if(Ze=1,vt&&(Qe=vt[Ne[0]&2?"return":Ne[0]?"throw":"next"])&&!(Qe=Qe.call(vt,Ne[1])).done)return Qe;(vt=0,Qe)&&(Ne=[0,Qe.value]);switch(Ne[0]){case 0:case 1:Qe=Ne;break;case 4:return Et.label++,{value:Ne[1],done:!1};case 5:Et.label++,vt=Ne[1],Ne=[0];continue;case 7:Ne=Et.ops.pop(),Et.trys.pop();continue;default:if(!(Qe=Et.trys,Qe=Qe.length>0&&Qe[Qe.length-1])&&(Ne[0]===6||Ne[0]===2)){Et=0;continue}if(Ne[0]===3&&(!Qe||Ne[1]>Qe[0]&&Ne[1]<Qe[3])){Et.label=Ne[1];break}if(Ne[0]===6&&Et.label<Qe[1]){Et.label=Qe[1],Qe=Ne;break}if(Qe&&Et.label<Qe[2]){Et.label=Qe[2],Et.ops.push(Ne);break}Qe[2]&&Et.ops.pop(),Et.trys.pop();continue}Ne=ke.call(dt,Et)}catch(Ue){Ne=[6,Ue],vt=0}finally{Ze=Qe=0}if(Ne[0]&5)throw Ne[1];return{value:Ne[0]?Ne[1]:void 0,done:!0}}};Object.defineProperty(E,"__esModule",{value:!0});var X=i("LgvC"),z=i("MON2"),o=i("FV85"),Z=i("xfSm"),D=i("wnjb"),K=i("h7MG"),re=i("aPG5"),fe=i("gzZq"),Y=i("d9O0"),Fe=i("ujMp"),We=i("HpQ9"),ge=i("AwBQ"),we=function(){function dt(ke){var Et=ke||{};if(typeof Et!="object")throw new Error(""+z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Et.defaultScope===void 0)Et.defaultScope=o.BindingScopeEnum.Transient;else if(Et.defaultScope!==o.BindingScopeEnum.Singleton&&Et.defaultScope!==o.BindingScopeEnum.Transient&&Et.defaultScope!==o.BindingScopeEnum.Request)throw new Error(""+z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Et.autoBindInjectable===void 0)Et.autoBindInjectable=!1;else if(typeof Et.autoBindInjectable!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Et.skipBaseClassChecks===void 0)Et.skipBaseClassChecks=!1;else if(typeof Et.skipBaseClassChecks!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Et.autoBindInjectable,defaultScope:Et.defaultScope,skipBaseClassChecks:Et.skipBaseClassChecks},this.id=Y.id(),this._bindingDictionary=new ge.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return dt.merge=function(ke,Et){var Ze=new dt,vt=K.getBindingDictionary(Ze),Qe=K.getBindingDictionary(ke),yt=K.getBindingDictionary(Et);function _t(De,Ne){De.traverse(function(Ue,st){st.forEach(function(Le){Ne.add(Le.serviceIdentifier,Le.clone())})})}return _t(Qe,vt),_t(yt,vt),Ze},dt.prototype.load=function(){for(var ke=[],Et=0;Et<arguments.length;Et++)ke[Et]=arguments[Et];for(var Ze=this._getContainerModuleHelpersFactory(),vt=0,Qe=ke;vt<Qe.length;vt++){var yt=Qe[vt],_t=Ze(yt.id);yt.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)}},dt.prototype.loadAsync=function(){for(var ke=[],Et=0;Et<arguments.length;Et++)ke[Et]=arguments[Et];return T(this,void 0,void 0,function(){var Ze,vt,Qe,yt,_t;return m(this,function(De){switch(De.label){case 0:Ze=this._getContainerModuleHelpersFactory(),vt=0,Qe=ke,De.label=1;case 1:return vt<Qe.length?(yt=Qe[vt],_t=Ze(yt.id),[4,yt.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)]):[3,4];case 2:De.sent(),De.label=3;case 3:return vt++,[3,1];case 4:return[2]}})})},dt.prototype.unload=function(){for(var ke=this,Et=[],Ze=0;Ze<arguments.length;Ze++)Et[Ze]=arguments[Ze];var vt=function(yt){return function(_t){return _t.moduleId===yt}};Et.forEach(function(Qe){var yt=vt(Qe.id);ke._bindingDictionary.removeByCondition(yt)})},dt.prototype.bind=function(ke){var Et=this.options.defaultScope||o.BindingScopeEnum.Transient,Ze=new X.Binding(ke,Et);return this._bindingDictionary.add(ke,Ze),new fe.BindingToSyntax(Ze)},dt.prototype.rebind=function(ke){return this.unbind(ke),this.bind(ke)},dt.prototype.unbind=function(ke){try{this._bindingDictionary.remove(ke)}catch(Et){throw new Error(z.CANNOT_UNBIND+" "+Fe.getServiceIdentifierAsString(ke))}},dt.prototype.unbindAll=function(){this._bindingDictionary=new ge.Lookup},dt.prototype.isBound=function(ke){var Et=this._bindingDictionary.hasKey(ke);return!Et&&this.parent&&(Et=this.parent.isBound(ke)),Et},dt.prototype.isBoundNamed=function(ke,Et){return this.isBoundTagged(ke,Z.NAMED_TAG,Et)},dt.prototype.isBoundTagged=function(ke,Et,Ze){var vt=!1;if(this._bindingDictionary.hasKey(ke)){var Qe=this._bindingDictionary.get(ke),yt=K.createMockRequest(this,ke,Et,Ze);vt=Qe.some(function(_t){return _t.constraint(yt)})}return!vt&&this.parent&&(vt=this.parent.isBoundTagged(ke,Et,Ze)),vt},dt.prototype.snapshot=function(){this._snapshots.push(We.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},dt.prototype.restore=function(){var ke=this._snapshots.pop();if(ke===void 0)throw new Error(z.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=ke.bindings,this._middleware=ke.middleware},dt.prototype.createChild=function(ke){var Et=new dt(ke||this.options);return Et.parent=this,Et},dt.prototype.applyMiddleware=function(){for(var ke=[],Et=0;Et<arguments.length;Et++)ke[Et]=arguments[Et];var Ze=this._middleware?this._middleware:this._planAndResolve();this._middleware=ke.reduce(function(vt,Qe){return Qe(vt)},Ze)},dt.prototype.applyCustomMetadataReader=function(ke){this._metadataReader=ke},dt.prototype.get=function(ke){return this._get(!1,!1,o.TargetTypeEnum.Variable,ke)},dt.prototype.getTagged=function(ke,Et,Ze){return this._get(!1,!1,o.TargetTypeEnum.Variable,ke,Et,Ze)},dt.prototype.getNamed=function(ke,Et){return this.getTagged(ke,Z.NAMED_TAG,Et)},dt.prototype.getAll=function(ke){return this._get(!0,!0,o.TargetTypeEnum.Variable,ke)},dt.prototype.getAllTagged=function(ke,Et,Ze){return this._get(!1,!0,o.TargetTypeEnum.Variable,ke,Et,Ze)},dt.prototype.getAllNamed=function(ke,Et){return this.getAllTagged(ke,Z.NAMED_TAG,Et)},dt.prototype.resolve=function(ke){var Et=this.createChild();return Et.bind(ke).toSelf(),Et.get(ke)},dt.prototype._getContainerModuleHelpersFactory=function(){var ke=this,Et=function(De,Ne){De._binding.moduleId=Ne},Ze=function(De){return function(Ne){var Ue=ke.bind.bind(ke),st=Ue(Ne);return Et(st,De),st}},vt=function(De){return function(Ne){var Ue=ke.unbind.bind(ke);Ue(Ne)}},Qe=function(De){return function(Ne){var Ue=ke.isBound.bind(ke);return Ue(Ne)}},yt=function(De){return function(Ne){var Ue=ke.rebind.bind(ke),st=Ue(Ne);return Et(st,De),st}};return function(_t){return{bindFunction:Ze(_t),isboundFunction:Qe(_t),rebindFunction:yt(_t),unbindFunction:vt(_t)}}},dt.prototype._get=function(ke,Et,Ze,vt,Qe,yt){var _t=null,De={avoidConstraints:ke,contextInterceptor:function(Ue){return Ue},isMultiInject:Et,key:Qe,serviceIdentifier:vt,targetType:Ze,value:yt};if(this._middleware){if(_t=this._middleware(De),_t==null)throw new Error(z.INVALID_MIDDLEWARE_RETURN)}else _t=this._planAndResolve()(De);return _t},dt.prototype._planAndResolve=function(){var ke=this;return function(Et){var Ze=K.plan(ke._metadataReader,ke,Et.isMultiInject,Et.targetType,Et.serviceIdentifier,Et.key,Et.value,Et.avoidConstraints);Ze=Et.contextInterceptor(Ze);var vt=re.resolve(Ze);return vt}},dt}();E.Container=we},"9NmV":function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\u2700-\\u27bf",Z="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",K="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",re="\\u2000-\\u206f",fe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Y="A-Z\\xc0-\\xd6\\xd8-\\xde",Fe="\\ufe0e\\ufe0f",We=D+K+re+fe,ge="['\u2019]",we="["+We+"]",dt="["+z+"]",ke="\\d+",Et="["+o+"]",Ze="["+Z+"]",vt="[^"+i+We+ke+o+Z+Y+"]",Qe="\\ud83c[\\udffb-\\udfff]",yt="(?:"+dt+"|"+Qe+")",_t="[^"+i+"]",De="(?:\\ud83c[\\udde6-\\uddff]){2}",Ne="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="["+Y+"]",st="\\u200d",Le="(?:"+Ze+"|"+vt+")",ut="(?:"+Ue+"|"+vt+")",Gt="(?:"+ge+"(?:d|ll|m|re|s|t|ve))?",Kt="(?:"+ge+"(?:D|LL|M|RE|S|T|VE))?",ar=yt+"?",oe="["+Fe+"]?",Q="(?:"+st+"(?:"+[_t,De,Ne].join("|")+")"+oe+ar+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ce="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ee=oe+ar+Q,_e="(?:"+[Et,De,Ne].join("|")+")"+Ee,ve=RegExp([Ue+"?"+Ze+"+"+Gt+"(?="+[we,Ue,"$"].join("|")+")",ut+"+"+Kt+"(?="+[we,Ue+Le,"$"].join("|")+")",Ue+"?"+Le+"+"+Gt,Ue+"+"+Kt,Ce,H,ke,_e].join("|"),"g");function rt($t){return $t.match(ve)||[]}Re.exports=rt},"9lTW":function(Re,E,i){"use strict";(function(T){var m=i("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function X(Le,ut){if(Le===ut)return 0;for(var Gt=Le.length,Kt=ut.length,ar=0,oe=Math.min(Gt,Kt);ar<oe;++ar)if(Le[ar]!==ut[ar]){Gt=Le[ar],Kt=ut[ar];break}return Gt<Kt?-1:Kt<Gt?1:0}function z(Le){return T.Buffer&&typeof T.Buffer.isBuffer=="function"?T.Buffer.isBuffer(Le):!!(Le!=null&&Le._isBuffer)}var o=i("MCLT"),Z=Object.prototype.hasOwnProperty,D=Array.prototype.slice,K=function(){return function(){}.name==="foo"}();function re(Le){return Object.prototype.toString.call(Le)}function fe(Le){return z(Le)||typeof T.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Le):Le?Le instanceof DataView?!0:!!(Le.buffer&&Le.buffer instanceof ArrayBuffer):!1}var Y=Re.exports=Et,Fe=/\s*function\s+([^\(\s]*)\s*/;function We(Le){if(!o.isFunction(Le))return;if(K)return Le.name;var ut=Le.toString(),Gt=ut.match(Fe);return Gt&&Gt[1]}Y.AssertionError=function(ut){this.name="AssertionError",this.actual=ut.actual,this.expected=ut.expected,this.operator=ut.operator,ut.message?(this.message=ut.message,this.generatedMessage=!1):(this.message=dt(this),this.generatedMessage=!0);var Gt=ut.stackStartFunction||ke;if(Error.captureStackTrace)Error.captureStackTrace(this,Gt);else{var Kt=new Error;if(Kt.stack){var ar=Kt.stack,oe=We(Gt),Q=ar.indexOf(`
`+oe);if(Q>=0){var H=ar.indexOf(`
`,Q+1);ar=ar.substring(H+1)}this.stack=ar}}},o.inherits(Y.AssertionError,Error);function ge(Le,ut){return typeof Le=="string"?Le.length<ut?Le:Le.slice(0,ut):Le}function we(Le){if(K||!o.isFunction(Le))return o.inspect(Le);var ut=We(Le),Gt=ut?": "+ut:"";return"[Function"+Gt+"]"}function dt(Le){return ge(we(Le.actual),128)+" "+Le.operator+" "+ge(we(Le.expected),128)}function ke(Le,ut,Gt,Kt,ar){throw new Y.AssertionError({message:Gt,actual:Le,expected:ut,operator:Kt,stackStartFunction:ar})}Y.fail=ke;function Et(Le,ut){Le||ke(Le,!0,ut,"==",Y.ok)}Y.ok=Et,Y.equal=function(ut,Gt,Kt){ut!=Gt&&ke(ut,Gt,Kt,"==",Y.equal)},Y.notEqual=function(ut,Gt,Kt){ut==Gt&&ke(ut,Gt,Kt,"!=",Y.notEqual)},Y.deepEqual=function(ut,Gt,Kt){Ze(ut,Gt,!1)||ke(ut,Gt,Kt,"deepEqual",Y.deepEqual)},Y.deepStrictEqual=function(ut,Gt,Kt){Ze(ut,Gt,!0)||ke(ut,Gt,Kt,"deepStrictEqual",Y.deepStrictEqual)};function Ze(Le,ut,Gt,Kt){if(Le===ut)return!0;if(z(Le)&&z(ut))return X(Le,ut)===0;if(o.isDate(Le)&&o.isDate(ut))return Le.getTime()===ut.getTime();if(o.isRegExp(Le)&&o.isRegExp(ut))return Le.source===ut.source&&Le.global===ut.global&&Le.multiline===ut.multiline&&Le.lastIndex===ut.lastIndex&&Le.ignoreCase===ut.ignoreCase;if((Le===null||typeof Le!="object")&&(ut===null||typeof ut!="object"))return Gt?Le===ut:Le==ut;if(fe(Le)&&fe(ut)&&re(Le)===re(ut)&&!(Le instanceof Float32Array||Le instanceof Float64Array))return X(new Uint8Array(Le.buffer),new Uint8Array(ut.buffer))===0;if(z(Le)!==z(ut))return!1;Kt=Kt||{actual:[],expected:[]};var ar=Kt.actual.indexOf(Le);return ar!==-1&&ar===Kt.expected.indexOf(ut)?!0:(Kt.actual.push(Le),Kt.expected.push(ut),Qe(Le,ut,Gt,Kt))}function vt(Le){return Object.prototype.toString.call(Le)=="[object Arguments]"}function Qe(Le,ut,Gt,Kt){if(Le==null||ut===null||ut===void 0)return!1;if(o.isPrimitive(Le)||o.isPrimitive(ut))return Le===ut;if(Gt&&Object.getPrototypeOf(Le)!==Object.getPrototypeOf(ut))return!1;var ar=vt(Le),oe=vt(ut);if(ar&&!oe||!ar&&oe)return!1;if(ar)return Le=D.call(Le),ut=D.call(ut),Ze(Le,ut,Gt);var Q=st(Le),H=st(ut),Ce,Ee;if(Q.length!==H.length)return!1;for(Q.sort(),H.sort(),Ee=Q.length-1;Ee>=0;Ee--)if(Q[Ee]!==H[Ee])return!1;for(Ee=Q.length-1;Ee>=0;Ee--)if(Ce=Q[Ee],!Ze(Le[Ce],ut[Ce],Gt,Kt))return!1;return!0}Y.notDeepEqual=function(ut,Gt,Kt){Ze(ut,Gt,!1)&&ke(ut,Gt,Kt,"notDeepEqual",Y.notDeepEqual)},Y.notDeepStrictEqual=yt;function yt(Le,ut,Gt){Ze(Le,ut,!0)&&ke(Le,ut,Gt,"notDeepStrictEqual",yt)}Y.strictEqual=function(ut,Gt,Kt){ut!==Gt&&ke(ut,Gt,Kt,"===",Y.strictEqual)},Y.notStrictEqual=function(ut,Gt,Kt){ut===Gt&&ke(ut,Gt,Kt,"!==",Y.notStrictEqual)};function _t(Le,ut){if(!Le||!ut)return!1;if(Object.prototype.toString.call(ut)=="[object RegExp]")return ut.test(Le);try{if(Le instanceof ut)return!0}catch(Gt){}return Error.isPrototypeOf(ut)?!1:ut.call({},Le)===!0}function De(Le){var ut;try{Le()}catch(Gt){ut=Gt}return ut}function Ne(Le,ut,Gt,Kt){var ar;if(typeof ut!="function")throw new TypeError('"block" argument must be a function');typeof Gt=="string"&&(Kt=Gt,Gt=null),ar=De(ut),Kt=(Gt&&Gt.name?" ("+Gt.name+").":".")+(Kt?" "+Kt:"."),Le&&!ar&&ke(ar,Gt,"Missing expected exception"+Kt);var oe=typeof Kt=="string",Q=!Le&&o.isError(ar),H=!Le&&ar&&!Gt;if((Q&&oe&&_t(ar,Gt)||H)&&ke(ar,Gt,"Got unwanted exception"+Kt),Le&&ar&&Gt&&!_t(ar,Gt)||!Le&&ar)throw ar}Y.throws=function(Le,ut,Gt){Ne(!0,Le,ut,Gt)},Y.doesNotThrow=function(Le,ut,Gt){Ne(!1,Le,ut,Gt)},Y.ifError=function(Le){if(Le)throw Le};function Ue(Le,ut){Le||ke(Le,!0,ut,"==",Ue)}Y.strict=m(Ue,Y,{equal:Y.strictEqual,deepEqual:Y.deepStrictEqual,notEqual:Y.notStrictEqual,notDeepEqual:Y.notDeepStrictEqual}),Y.strict.strict=Y.strict;var st=Object.keys||function(Le){var ut=[];for(var Gt in Le)Z.call(Le,Gt)&&ut.push(Gt);return ut}}).call(this,i("yLpj"))},"9nhX":function(Re,E,i){var T=i("g4R6"),m=i("tLB3");function X(z,o,Z){return Z===void 0&&(Z=o,o=void 0),Z!==void 0&&(Z=m(Z),Z=Z===Z?Z:0),o!==void 0&&(o=m(o),o=o===o?o:0),T(m(z),o,Z)}Re.exports=X},AFH1:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.TOPRIGHT="topright",m.TOPLEFT="topleft",m.BOTTOMRIGHT="bottomright",m.BOTTOMLEFT="bottomleft"})(T||(T={}))},AKIq:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(fe){if(!fe)throw new Error("coord is required");if(!Array.isArray(fe)){if(fe.type==="Feature"&&fe.geometry!==null&&fe.geometry.type==="Point")return fe.geometry.coordinates;if(fe.type==="Point")return fe.coordinates}if(Array.isArray(fe)&&fe.length>=2&&!Array.isArray(fe[0])&&!Array.isArray(fe[1]))return fe;throw new Error("coord must be GeoJSON Point or an Array of numbers")}E.getCoord=m;function X(fe){if(Array.isArray(fe))return fe;if(fe.type==="Feature"){if(fe.geometry!==null)return fe.geometry.coordinates}else if(fe.coordinates)return fe.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}E.getCoords=X;function z(fe){if(fe.length>1&&T.isNumber(fe[0])&&T.isNumber(fe[1]))return!0;if(Array.isArray(fe[0])&&fe[0].length)return z(fe[0]);throw new Error("coordinates must only contain numbers")}E.containsNumber=z;function o(fe,Y,Fe){if(!Y||!Fe)throw new Error("type and name required");if(!fe||fe.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+fe.type)}E.geojsonType=o;function Z(fe,Y,Fe){if(!fe)throw new Error("No feature passed");if(!Fe)throw new Error(".featureOf() requires a name");if(!fe||fe.type!=="Feature"||!fe.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!fe.geometry||fe.geometry.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+fe.geometry.type)}E.featureOf=Z;function D(fe,Y,Fe){if(!fe)throw new Error("No featureCollection passed");if(!Fe)throw new Error(".collectionOf() requires a name");if(!fe||fe.type!=="FeatureCollection")throw new Error("Invalid input to "+Fe+", FeatureCollection required");for(var We=0,ge=fe.features;We<ge.length;We++){var we=ge[We];if(!we||we.type!=="Feature"||!we.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!we.geometry||we.geometry.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+we.geometry.type)}}E.collectionOf=D;function K(fe){return fe.type==="Feature"?fe.geometry:fe}E.getGeom=K;function re(fe,Y){return fe.type==="FeatureCollection"?"FeatureCollection":fe.type==="GeometryCollection"?"GeometryCollection":fe.type==="Feature"&&fe.geometry!==null?fe.geometry.type:fe.type}E.getType=re},APxj:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Ucsi");function m(X,z){z===void 0&&(z=!0);var o=T.makePropertyInjectDecorator(X,z),Z=T.makePropertyInjectNamedDecorator(X,z),D=T.makePropertyInjectTaggedDecorator(X,z),K=T.makePropertyMultiInjectDecorator(X,z);return{lazyInject:o,lazyInjectNamed:Z,lazyInjectTagged:D,lazyMultiInject:K}}E.default=m},AwBQ:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=function(){function X(){this._map=new Map}return X.prototype.getMap=function(){return this._map},X.prototype.add=function(z,o){if(z==null)throw new Error(T.NULL_ARGUMENT);if(o==null)throw new Error(T.NULL_ARGUMENT);var Z=this._map.get(z);Z!==void 0?(Z.push(o),this._map.set(z,Z)):this._map.set(z,[o])},X.prototype.get=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);var o=this._map.get(z);if(o!==void 0)return o;throw new Error(T.KEY_NOT_FOUND)},X.prototype.remove=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);if(!this._map.delete(z))throw new Error(T.KEY_NOT_FOUND)},X.prototype.removeByCondition=function(z){var o=this;this._map.forEach(function(Z,D){var K=Z.filter(function(re){return!z(re)});K.length>0?o._map.set(D,K):o._map.delete(D)})},X.prototype.hasKey=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);return this._map.has(z)},X.prototype.clone=function(){var z=new X;return this._map.forEach(function(o,Z){o.forEach(function(D){return z.add(Z,D.clone())})}),z},X.prototype.traverse=function(z){this._map.forEach(function(o,Z){z(Z,o)})},X}();E.Lookup=m},"B6l+":function(Re,E,i){var T=i("Sq3C"),m=i("Z1HP"),X=i("Sxd8"),z=i("dt0z");function o(Z,D,K){Z=z(Z),D=X(D);var re=D?m(Z):0;return D&&re<D?Z+T(D-re,K):Z}Re.exports=o},BGjm:function(Re,E){Re.exports=i;function i(T,m){m||(m=document);var X=m.head||m.getElementsByTagName("head")[0];if(!X){X=m.createElement("head");var z=m.body||m.getElementsByTagName("body")[0];z?z.parentNode.insertBefore(X,z):m.documentElement.appendChild(X)}var o=m.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=T:o.appendChild(m.createTextNode(T)),X.appendChild(o),o}},BMrR:function(Re,E,i){"use strict";var T=i("qrJ5");E.a=T.a},BkRI:function(Re,E,i){var T=i("OBhP"),m=1,X=4;function z(o){return T(o,m|X)}Re.exports=z},BpBL:function(Re,E,i){"use strict";i.d(E,"a",function(){return m});var T=i("Hel2");function m(z,o){var Z=o.extent,D=new Promise(function(re){X(z,function(fe){re(fe)})}),K={images:D,_id:1,dataArray:[{_id:0,coordinates:[[Z[0],Z[1]],[Z[2],Z[3]]]}]};return K}function X(z,o){var Z=z,D=[];if(typeof Z=="string")Object(T.o)({url:Z},function(fe,Y){D.push(Y),o(D)});else{var K=Z.length,re=0;Z.forEach(function(fe){Object(T.o)({url:fe},function(Y,Fe){re++,D.push(Fe),re===K&&o(D)})})}return m}},CIdX:function(Re,E,i){Re.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(Re,E){function i(T,m,X){for(var z=X-1,o=T.length;++z<o;)if(T[z]===m)return z;return-1}Re.exports=i},"D+ow":function(Re,E){},D9lx:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("6AGu"),m=i("406g"),X=i("z4Hk"),z=function(){function o(Z){this._binding=Z,this._bindingWhenSyntax=new X.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new m.BindingOnSyntax(this._binding),this._bindingInSyntax=new T.BindingInSyntax(Z)}return o.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},o.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},o.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},o.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},o.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},o.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},o.prototype.whenTargetTagged=function(Z,D){return this._bindingWhenSyntax.whenTargetTagged(Z,D)},o.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},o.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},o.prototype.whenParentTagged=function(Z,D){return this._bindingWhenSyntax.whenParentTagged(Z,D)},o.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},o.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},o.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},o.prototype.whenAnyAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,D)},o.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},o.prototype.whenNoAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,D)},o.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},o.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},o.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},o}();E.BindingInWhenOnSyntax=z},"Dw+G":function(Re,E,i){var T=i("juv8"),m=i("mTTR");function X(z,o){return z&&T(o,m(o),z)}Re.exports=X},DzJC:function(Re,E,i){var T=i("sEfC"),m=i("GoyQ"),X="Expected a function";function z(o,Z,D){var K=!0,re=!0;if(typeof o!="function")throw new TypeError(X);return m(D)&&(K="leading"in D?!!D.leading:K,re="trailing"in D?!!D.trailing:re),T(o,Z,{leading:K,maxWait:Z,trailing:re})}Re.exports=z},EA7m:function(Re,E,i){var T=i("zZ0H"),m=i("Ioao"),X=i("wclG");function z(o,Z){return X(m(o,Z,T),o+"")}Re.exports=z},EEGq:function(Re,E,i){var T=i("juv8"),m=i("oCl/");function X(z,o){return T(z,m(z),o)}Re.exports=X},EfZ0:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Re,E,i){var T=i("bahg"),m=i("quyA"),X=i("0JQy");function z(o){return m(o)?X(o):T(o)}Re.exports=z},FI6e:function(Re,E){},FV85:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={Request:"Request",Singleton:"Singleton",Transient:"Transient"};E.BindingScopeEnum=T;var m={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};E.BindingTypeEnum=m;var X={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};E.TargetTypeEnum=X},FmoU:function(Re,E,i){"use strict";i.d(E,"a",function(){return vt}),i.d(E,"b",function(){return De});var T=function(Q,H,Ce){Q.prototype=H.prototype=Ce,Ce.constructor=Q};function m(Q,H){var Ce=Object.create(Q.prototype);for(var Ee in H)Ce[Ee]=H[Ee];return Ce}function X(){}var z=.7,o=1/z,Z="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",re=/^#([0-9a-f]{3,8})$/,fe=new RegExp("^rgb\\("+[Z,Z,Z]+"\\)$"),Y=new RegExp("^rgb\\("+[K,K,K]+"\\)$"),Fe=new RegExp("^rgba\\("+[Z,Z,Z,D]+"\\)$"),We=new RegExp("^rgba\\("+[K,K,K,D]+"\\)$"),ge=new RegExp("^hsl\\("+[D,K,K]+"\\)$"),we=new RegExp("^hsla\\("+[D,K,K,D]+"\\)$"),dt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};T(X,vt,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:ke,formatHex:ke,formatHsl:Et,formatRgb:Ze,toString:Ze});function ke(){return this.rgb().formatHex()}function Et(){return Gt(this).formatHsl()}function Ze(){return this.rgb().formatRgb()}function vt(Q){var H,Ce;return Q=(Q+"").trim().toLowerCase(),(H=re.exec(Q))?(Ce=H[1].length,H=parseInt(H[1],16),Ce===6?Qe(H):Ce===3?new Ne(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Ce===8?yt(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Ce===4?yt(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=fe.exec(Q))?new Ne(H[1],H[2],H[3],1):(H=Y.exec(Q))?new Ne(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=Fe.exec(Q))?yt(H[1],H[2],H[3],H[4]):(H=We.exec(Q))?yt(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=ge.exec(Q))?ut(H[1],H[2]/100,H[3]/100,1):(H=we.exec(Q))?ut(H[1],H[2]/100,H[3]/100,H[4]):dt.hasOwnProperty(Q)?Qe(dt[Q]):Q==="transparent"?new Ne(NaN,NaN,NaN,0):null}function Qe(Q){return new Ne(Q>>16&255,Q>>8&255,Q&255,1)}function yt(Q,H,Ce,Ee){return Ee<=0&&(Q=H=Ce=NaN),new Ne(Q,H,Ce,Ee)}function _t(Q){return Q instanceof X||(Q=vt(Q)),Q?(Q=Q.rgb(),new Ne(Q.r,Q.g,Q.b,Q.opacity)):new Ne}function De(Q,H,Ce,Ee){return arguments.length===1?_t(Q):new Ne(Q,H,Ce,Ee==null?1:Ee)}function Ne(Q,H,Ce,Ee){this.r=+Q,this.g=+H,this.b=+Ce,this.opacity=+Ee}T(Ne,De,m(X,{brighter:function(H){return H=H==null?o:Math.pow(o,H),new Ne(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new Ne(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ue,formatHex:Ue,formatRgb:st,toString:st}));function Ue(){return"#"+Le(this.r)+Le(this.g)+Le(this.b)}function st(){var Q=this.opacity;return Q=isNaN(Q)?1:Math.max(0,Math.min(1,Q)),(Q===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Q===1?")":", "+Q+")")}function Le(Q){return Q=Math.max(0,Math.min(255,Math.round(Q)||0)),(Q<16?"0":"")+Q.toString(16)}function ut(Q,H,Ce,Ee){return Ee<=0?Q=H=Ce=NaN:Ce<=0||Ce>=1?Q=H=NaN:H<=0&&(Q=NaN),new ar(Q,H,Ce,Ee)}function Gt(Q){if(Q instanceof ar)return new ar(Q.h,Q.s,Q.l,Q.opacity);if(Q instanceof X||(Q=vt(Q)),!Q)return new ar;if(Q instanceof ar)return Q;Q=Q.rgb();var H=Q.r/255,Ce=Q.g/255,Ee=Q.b/255,_e=Math.min(H,Ce,Ee),ve=Math.max(H,Ce,Ee),rt=NaN,$t=ve-_e,St=(ve+_e)/2;return $t?(H===ve?rt=(Ce-Ee)/$t+(Ce<Ee)*6:Ce===ve?rt=(Ee-H)/$t+2:rt=(H-Ce)/$t+4,$t/=St<.5?ve+_e:2-ve-_e,rt*=60):$t=St>0&&St<1?0:rt,new ar(rt,$t,St,Q.opacity)}function Kt(Q,H,Ce,Ee){return arguments.length===1?Gt(Q):new ar(Q,H,Ce,Ee==null?1:Ee)}function ar(Q,H,Ce,Ee){this.h=+Q,this.s=+H,this.l=+Ce,this.opacity=+Ee}T(ar,Kt,m(X,{brighter:function(H){return H=H==null?o:Math.pow(o,H),new ar(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new ar(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Ce=isNaN(H)||isNaN(this.s)?0:this.s,Ee=this.l,_e=Ee+(Ee<.5?Ee:1-Ee)*Ce,ve=2*Ee-_e;return new Ne(oe(H>=240?H-240:H+120,ve,_e),oe(H,ve,_e),oe(H<120?H+240:H-120,ve,_e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe(Q,H,Ce){return(Q<60?H+(Ce-H)*Q/60:Q<180?Ce:Q<240?H+(Ce-H)*(240-Q)/60:H)*255}},G6z8:function(Re,E,i){var T=i("fR/l"),m=i("oCl/"),X=i("mTTR");function z(o){return T(o,X,m)}Re.exports=z},GXnB:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function X(z,o){this.key=z,this.value=o}return X.prototype.toString=function(){return this.key===T.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},X}();E.Metadata=m},Gi0A:function(Re,E,i){var T=i("QqLw"),m=i("ExA7"),X="[object Map]";function z(o){return m(o)&&T(o)==X}Re.exports=z},"H+7v":function(Re,E,i){Re.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},HTcj:function(Re,E,i){"use strict";var T=i("GNNt"),m=i("wEI+"),X=i("kZZr"),z=i.n(X),o=i("q1tI"),Z=i.n(o),D=i("TSYQ"),K=i.n(D),re=i("jYQm"),fe=function(Fe){var We=Object(o.useContext)(re.a),ge=Fe.children,we=Fe.contentWidth,dt=Fe.className,ke=Fe.style,Et=Object(o.useContext)(m.b.ConfigContext),Ze=Et.getPrefixCls,vt=Fe.prefixCls||Ze("pro"),Qe=we||We.contentWidth,yt="".concat(vt,"-grid-content");return Z.a.createElement("div",{className:K()(yt,dt,{wide:Qe==="Fixed"}),style:ke},Z.a.createElement("div",{className:"".concat(vt,"-grid-content-children")},ge))};E.a=fe},Hel2:function(Re,E,i){"use strict";i.d(E,"o",function(){return St}),i.d(E,"m",function(){return Pe}),i.d(E,"p",function(){return q}),i.d(E,"d",function(){return nt}),i.d(E,"q",function(){return $}),i.d(E,"r",function(){return ae}),i.d(E,"j",function(){return et}),i.d(E,"h",function(){return zt}),i.d(E,"b",function(){return sr}),i.d(E,"i",function(){return ft}),i.d(E,"s",function(){return At}),i.d(E,"k",function(){return mt}),i.d(E,"l",function(){return Me}),i.d(E,"n",function(){return ct}),i.d(E,"f",function(){return qe}),i.d(E,"e",function(){return Vt}),i.d(E,"g",function(){return pr}),i.d(E,"a",function(){return T}),i.d(E,"c",function(){return m});var T={};i.r(T),i.d(T,"getContainer",function(){return Z}),i.d(T,"trim",function(){return D}),i.d(T,"splitWords",function(){return K}),i.d(T,"create",function(){return fe}),i.d(T,"remove",function(){return Y}),i.d(T,"addClass",function(){return Fe}),i.d(T,"removeClass",function(){return We}),i.d(T,"hasClass",function(){return ge}),i.d(T,"setClass",function(){return we}),i.d(T,"getClass",function(){return dt}),i.d(T,"empty",function(){return ke}),i.d(T,"setTransform",function(){return Ze}),i.d(T,"triggerResize",function(){return vt}),i.d(T,"printCanvas",function(){return Qe});var m={};i.r(m),i.d(m,"sum",function(){return zn}),i.d(m,"max",function(){return Gr}),i.d(m,"min",function(){return ur}),i.d(m,"mean",function(){return xn}),i.d(m,"mode",function(){return na}),i.d(m,"statMap",function(){return fa}),i.d(m,"getColumn",function(){return Hn}),i.d(m,"getSatByColumn",function(){return Gn});function X(F){var W=131,le=137,pe=0;F+="x";for(var at=Math.floor(9007199254740991/le),Tt=0;Tt<F.length;Tt++)pe>at&&(pe=Math.floor(pe/le)),pe=pe*W+F.charCodeAt(Tt);return pe}function z(F){F=F.toString();for(var W=5381,le=F.length;le;)W=W*33^F.charCodeAt(--le);return W>>>0}var o=window.document.documentElement.style;function Z(F){var W=F;return typeof F=="string"&&(W=document.getElementById(F)),W}function D(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function K(F){return D(F).split(/\s+/)}function re(F){if(!o)return F[0];for(var W in F)if(F[W]&&F[W]in o)return F[W];return F[0]}function fe(F,W,le){var pe=document.createElement(F);return pe.className=W||"",le&&le.appendChild(pe),pe}function Y(F){var W=F.parentNode;W&&W.removeChild(F)}function Fe(F,W){if(F.classList!==void 0)for(var le=K(W),pe=0,at=le.length;pe<at;pe++)F.classList.add(le[pe]);else if(!ge(F,W)){var Tt=dt(F);we(F,(Tt?Tt+" ":"")+W)}}function We(F,W){F.classList!==void 0?F.classList.remove(W):we(F,D((" "+dt(F)+" ").replace(" "+W+" "," ")))}function ge(F,W){if(F.classList!==void 0)return F.classList.contains(W);var le=dt(F);return le.length>0&&new RegExp("(^|\\s)"+W+"(\\s|$)").test(le)}function we(F,W){F instanceof HTMLElement?F.className=W:F.className.baseVal=W}function dt(F){return F instanceof SVGElement&&(F=F.correspondingElement),F.className.baseVal===void 0?F.className:F.className.baseVal}function ke(F){for(;F&&F.firstChild;)F.removeChild(F.firstChild)}var Et=re(["transform","WebkitTransform"]);function Ze(F,W){F.style[Et]=W}function vt(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var F=window.document.createEvent("UIEvents");F.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(F)}}function Qe(F){var W=["padding: "+(F.height/2-8)+"px "+F.width/2+"px;","line-height: "+F.height+"px;","background-image: url("+F.toDataURL()+");"];console.log(`%c
`,W.join(""))}var yt=i("lwsE"),_t=i.n(yt),De=i("W8MJ"),Ne=i.n(De),Ue=i("7W2i"),st=i.n(Ue),Le=i("a1gu"),ut=i.n(Le),Gt=i("Nsbk"),Kt=i.n(Gt),ar=i("oShl"),oe=i.n(ar);function Q(F){var W=H();return function(){var pe=Kt()(F),at;if(W){var Tt=Kt()(this).constructor;at=Reflect.construct(pe,arguments,Tt)}else at=pe.apply(this,arguments);return ut()(this,at)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(F){return!1}}var Ce=function(F){st()(le,F);var W=Q(le);function le(pe,at,Tt){var jt;return _t()(this,le),jt=W.call(this,pe),jt.status=void 0,jt.url=void 0,jt.status=at,jt.url=Tt,jt.name=jt.constructor.name,jt.message=pe,jt}return Ne()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function Ee(F){var W=new XMLHttpRequest;W.open("GET",F.url,!0);for(var le in F.headers)F.headers.hasOwnProperty(le)&&W.setRequestHeader(le,F.headers[le]);return W.withCredentials=F.credentials==="include",W}var _e=function(W,le){var pe=Ee(W);return pe.setRequestHeader("Accept","application/json"),pe.onerror=function(){le(new Error(pe.statusText))},pe.onload=function(){if(pe.status>=200&&pe.status<300&&pe.response){var at;try{at=JSON.parse(pe.response)}catch(Tt){return le(Tt)}le(null,at)}else pe.status===401?le(new Ce("".concat(pe.statusText),pe.status,W.url)):le(new Ce(pe.statusText,pe.status,W.url))},pe.send(),pe},ve=function(W,le){var pe=Ee(W);return pe.responseType="arraybuffer",pe.onerror=function(){le(new Error(pe.statusText))},pe.onload=function(){var at=pe.response;if(at.byteLength===0&&pe.status===200)return le(new Error("http status 200 returned without content."));pe.status>=200&&pe.status<300&&pe.response?le(null,{data:at,cacheControl:pe.getResponseHeader("Cache-Control"),expires:pe.getResponseHeader("Expires")}):le(new Ce(pe.statusText,pe.status,W.url))},pe.send(),pe};function rt(F){var W=window.document.createElement("a");return W.href=F,W.protocol===window.document.location.protocol&&W.host===window.document.location.host}var $t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",St=function(W,le){return ve(W,function(pe,at){if(pe)le(pe);else if(at){var Tt=new window.Image;Tt.crossOrigin="anonymous";var jt=window.URL||window.webkitURL;Tt.onload=function(){le(null,Tt),jt.revokeObjectURL(Tt.src)};var Ge=new window.Blob([new Uint8Array(at.data)],{type:"image/png"});Tt.src=at.data.byteLength?jt.createObjectURL(Ge):$t}})},ye=i("J4zp"),be=i.n(ye),Be=i("/rf6"),lt=2*Math.PI*6378137/2;function Pe(F){var W=[Infinity,Infinity,-Infinity,-Infinity];return F.forEach(function(le){var pe=le.coordinates;ht(W,pe)}),W}function ht(F,W){return Array.isArray(W[0])?W.forEach(function(le){ht(F,le)}):(F[0]>W[0]&&(F[0]=W[0]),F[1]>W[1]&&(F[1]=W[1]),F[2]<W[0]&&(F[2]=W[0]),F[3]<W[1]&&(F[3]=W[1])),F}function w(F,W){return I(F,W)}function I(F,W){return Array.isArray(F[0])?F.map(function(le){return I(le,W)}):W(F)}function q(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};F=gt(F,W);var pe=F[0],at=F[1],Tt=pe*lt/180,jt=Math.log(Math.tan((90+at)*Math.PI/360))/(Math.PI/180);return jt=jt*lt/180,le.enable&&(Tt=Number(Tt.toFixed(le.decimal)),jt=Number(jt.toFixed(le.decimal))),F.length===3?[Tt,jt,F[2]]:[Tt,jt]}function ce(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=F[0],pe=F[1],at=le/lt*180,Tt=pe/lt*180;return Tt=180/Math.PI*(2*Math.atan(Math.exp(Tt*Math.PI/180))-Math.PI/2),W!=null&&(at=Number(at.toFixed(W)),Tt=Number(Tt.toFixed(W))),F.length===3?[at,Tt,F[2]]:[at,Tt]}function Ve(F){if(F==null)throw new Error("lng is required");return(F>180||F<-180)&&(F=F%360,F>180&&(F=-360+F),F<-180&&(F=360+F),F===0&&(F=0)),F}function $e(F){if(F==null)throw new Error("lat is required");return(F>90||F<-90)&&(F=F%180,F>90&&(F=-180+F),F<-90&&(F=180+F),F===0&&(F=0)),F}function gt(F,W){if(W===!1)return F;var le=Ve(F[0]),pe=$e(F[1]);return pe>85&&(pe=85),pe<-85&&(pe=-85),F.length===3?[le,pe,F[2]]:[le,pe]}function nt(F){var W=85.0511287798,le=Math.max(Math.min(W,F[1]),-W),pe=256<<20,at=Math.PI/180,Tt=F[0]*at,jt=le*at;jt=Math.log(Math.tan(Math.PI/4+jt/2));var Ge=.5/Math.PI,wt=.5,ir=-.5/Math.PI;return at=.5,Tt=pe*(Ge*Tt+wt),jt=pe*(ir*jt+at),[Math.floor(Tt),Math.floor(jt)]}function kt(F){var W=.5/Math.PI,le=.5,pe=-.5/Math.PI,at=.5,Tt=256<<20,jt=be()(F,2),Ge=jt[0],wt=jt[1];Ge=(Ge/Tt-le)/W,wt=(wt/Tt-at)/pe,wt=(Math.atan(Math.pow(Math.E,wt))-Math.PI/4)*2,at=Math.PI/180;var ir=wt/at,Ur=Ge/at;return[Ur,ir]}function $(F,W,le){var pe=Object(Be.degreesToRadians)(W[1]-F[1]),at=Object(Be.degreesToRadians)(W[0]-F[0]),Tt=Object(Be.degreesToRadians)(F[1]),jt=Object(Be.degreesToRadians)(W[1]),Ge=Math.pow(Math.sin(pe/2),2)+Math.pow(Math.sin(at/2),2)*Math.cos(Tt)*Math.cos(jt);return Object(Be.radiansToLength)(2*Math.atan2(Math.sqrt(Ge),Math.sqrt(1-Ge)),le="meters")}function Ke(F){var W=Math.PI/180,le=85.0511287798,pe=6378137,at=Math.max(Math.min(le,F[1]),-le),Tt=Math.sin(at*W),jt=pe*F[0]*W,Ge=pe*Math.log((1+Tt)/(1-Tt))/2;return[jt,Ge]}function ae(F,W){var le=Math.abs(F[1][1]-F[0][1])*W,pe=Math.abs(F[1][0]-F[0][0])*W;return[[F[0][0]-pe,F[0][1]-le],[F[1][0]+pe,F[1][1]+le]]}function et(F,W){return F[0][0]<=W[0][0]&&F[0][1]<=W[0][1]&&F[1][0]>=W[1][0]&&F[1][1]>=W[1][1]}function zt(F){return[[F[0],F[1]],[F[2],F[3]]]}var sr=function(){function F(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;_t()(this,F),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=W,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return Ne()(F,[{key:"clear",value:function(){var le=this;this.order.forEach(function(pe){le.delete(pe)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var pe=this.cache[le];return pe&&(this.deleteOrder(le),this.appendOrder(le)),pe}},{key:"set",value:function(le,pe){this.cache[le]?(this.delete(le),this.cache[le]=pe,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=pe,this.appendOrder(le))}},{key:"delete",value:function(le){var pe=this.cache[le];pe&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(pe,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var pe=this.order.findIndex(function(at){return at===le});pe>=0&&this.order.splice(pe,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,pe){return null}}]),F}();function ft(F,W){F.forEach(function(le){if(!W[le])return;W[le]=W[le].bind(W)})}var pt=i("FmoU");function At(F){var W=pt.a(F),le=[0,0,0,0];return W!=null&&(le[0]=W.r/255,le[1]=W.g/255,le[2]=W.b/255,le[3]=W.opacity),le}function mt(F){var W=F&&F[0],le=F&&F[1],pe=F&&F[2],at=W+le*256+pe*65536-1;return at}function Me(F){return[F+1&255,F+1>>8&255,F+1>>8>>8&255]}function ct(F){var W=document.createElement("canvas"),le=W.getContext("2d");W.width=256,W.height=1;for(var pe=le.createLinearGradient(0,0,256,1),at=null,Tt=F.positions[0],jt=F.positions[F.positions.length-1],Ge=0;Ge<F.colors.length;++Ge){var wt=(F.positions[Ge]-Tt)/(jt-Tt);pe.addColorStop(wt,F.colors[Ge])}return le.fillStyle=pe,le.fillRect(0,0,256,1),at=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(at,256,1)}var qe;(function(F){F.CENTER="center",F.TOP="top",F["TOP-LEFT"]="top-left",F["TOP-RIGHT"]="top-right",F.BOTTOM="bottom",F["BOTTOM-LEFT"]="bottom-left",F.LEFT="left",F.RIGHT="right"})(qe||(qe={}));var Vt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pr(F,W,le){var pe=F.classList;for(var at in Vt)Vt.hasOwnProperty(at)&&pe.remove("l7-".concat(le,"-anchor-").concat(at));pe.add("l7-".concat(le,"-anchor-").concat(W))}function Gr(F){if(F.length===0)throw new Error("max requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]>W&&(W=F[le]);return W*1}function ur(F){if(F.length===0)throw new Error("min requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]<W&&(W=F[le]);return W*1}function zn(F){if(F.length===0)return 0;for(var W=F[0]*1,le=1;le<F.length;le++)W+=F[le]*1;return W}function xn(F){if(F.length===0)throw new Error("mean requires at least one data point");return zn(F)/F.length}function na(F){if(F.length===0)throw new Error("mean requires at least one data point");if(F.length<3)return F[0];F.sort();for(var W=F[0],le=NaN,pe=0,at=1,Tt=1;Tt<F.length+1;Tt++)F[Tt]!==W?(at>pe&&(pe=at,le=W),at=1,W=F[Tt]):at++;return le*1}var fa={min:ur,max:Gr,mean:xn,sum:zn,mode:na};function Hn(F,W){return F.map(function(le){return le[W]})}function Gn(F,W){return fa[F](W)}},HpQ9:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(){}return m.of=function(X,z){var o=new m;return o.bindings=X,o.middleware=z,o},m}();E.ContainerSnapshot=T},HthE:function(Re,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return m});var T;(function(X){X[X.LNGLAT=1]="LNGLAT",X[X.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",X[X.VECTOR_TILE=3]="VECTOR_TILE",X[X.IDENTITY=4]="IDENTITY",X[X.P20=5]="P20",X[X.P20_OFFSET=6]="P20_OFFSET",X[X.METER_OFFSET=7]="METER_OFFSET"})(T||(T={}));var m={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return X});var m=i("U8pU");function X(z){if(typeof window!="undefined"&&Object(m.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof T!="undefined"&&Object(m.a)(T.versions)==="object"&&Boolean(T.versions.electron))return!0;var o=(typeof navigator=="undefined"?"undefined":Object(m.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Z=z||o;return!!(Z&&Z.indexOf("Electron")>=0)}}).call(this,i("Q2Ig"))},IOcx:function(Re,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return ut}),i.d(E,"c",function(){return Gt}),i.d(E,"d",function(){return Kt}),i.d(E,"e",function(){return ar});var T={};i.r(T),i.d(T,"create",function(){return X}),i.d(T,"clone",function(){return z}),i.d(T,"copy",function(){return o}),i.d(T,"identity",function(){return Z}),i.d(T,"fromValues",function(){return D}),i.d(T,"set",function(){return K}),i.d(T,"transpose",function(){return re}),i.d(T,"invert",function(){return fe}),i.d(T,"adjoint",function(){return Y}),i.d(T,"determinant",function(){return Fe}),i.d(T,"multiply",function(){return We}),i.d(T,"rotate",function(){return ge}),i.d(T,"scale",function(){return we}),i.d(T,"fromRotation",function(){return dt}),i.d(T,"fromScaling",function(){return ke}),i.d(T,"str",function(){return Et}),i.d(T,"frob",function(){return Ze}),i.d(T,"LDU",function(){return vt}),i.d(T,"add",function(){return Qe}),i.d(T,"subtract",function(){return yt}),i.d(T,"exactEquals",function(){return _t}),i.d(T,"equals",function(){return De}),i.d(T,"multiplyScalar",function(){return Ne}),i.d(T,"multiplyScalarAndAdd",function(){return Ue}),i.d(T,"mul",function(){return st}),i.d(T,"sub",function(){return Le});var m=i("yU0y");function X(){var oe=new m.a(4);return m.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function z(oe){var Q=new m.a(4);return Q[0]=oe[0],Q[1]=oe[1],Q[2]=oe[2],Q[3]=oe[3],Q}function o(oe,Q){return oe[0]=Q[0],oe[1]=Q[1],oe[2]=Q[2],oe[3]=Q[3],oe}function Z(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,Q,H,Ce){var Ee=new m.a(4);return Ee[0]=oe,Ee[1]=Q,Ee[2]=H,Ee[3]=Ce,Ee}function K(oe,Q,H,Ce,Ee){return oe[0]=Q,oe[1]=H,oe[2]=Ce,oe[3]=Ee,oe}function re(oe,Q){if(oe===Q){var H=Q[1];oe[1]=Q[2],oe[2]=H}else oe[0]=Q[0],oe[1]=Q[2],oe[2]=Q[1],oe[3]=Q[3];return oe}function fe(oe,Q){var H=Q[0],Ce=Q[1],Ee=Q[2],_e=Q[3],ve=H*_e-Ee*Ce;return ve?(ve=1/ve,oe[0]=_e*ve,oe[1]=-Ce*ve,oe[2]=-Ee*ve,oe[3]=H*ve,oe):null}function Y(oe,Q){var H=Q[0];return oe[0]=Q[3],oe[1]=-Q[1],oe[2]=-Q[2],oe[3]=H,oe}function Fe(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function We(oe,Q,H){var Ce=Q[0],Ee=Q[1],_e=Q[2],ve=Q[3],rt=H[0],$t=H[1],St=H[2],ye=H[3];return oe[0]=Ce*rt+_e*$t,oe[1]=Ee*rt+ve*$t,oe[2]=Ce*St+_e*ye,oe[3]=Ee*St+ve*ye,oe}function ge(oe,Q,H){var Ce=Q[0],Ee=Q[1],_e=Q[2],ve=Q[3],rt=Math.sin(H),$t=Math.cos(H);return oe[0]=Ce*$t+_e*rt,oe[1]=Ee*$t+ve*rt,oe[2]=Ce*-rt+_e*$t,oe[3]=Ee*-rt+ve*$t,oe}function we(oe,Q,H){var Ce=Q[0],Ee=Q[1],_e=Q[2],ve=Q[3],rt=H[0],$t=H[1];return oe[0]=Ce*rt,oe[1]=Ee*rt,oe[2]=_e*$t,oe[3]=ve*$t,oe}function dt(oe,Q){var H=Math.sin(Q),Ce=Math.cos(Q);return oe[0]=Ce,oe[1]=H,oe[2]=-H,oe[3]=Ce,oe}function ke(oe,Q){return oe[0]=Q[0],oe[1]=0,oe[2]=0,oe[3]=Q[1],oe}function Et(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function Ze(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function vt(oe,Q,H,Ce){return oe[2]=Ce[2]/Ce[0],H[0]=Ce[0],H[1]=Ce[1],H[3]=Ce[3]-oe[2]*H[1],[oe,Q,H]}function Qe(oe,Q,H){return oe[0]=Q[0]+H[0],oe[1]=Q[1]+H[1],oe[2]=Q[2]+H[2],oe[3]=Q[3]+H[3],oe}function yt(oe,Q,H){return oe[0]=Q[0]-H[0],oe[1]=Q[1]-H[1],oe[2]=Q[2]-H[2],oe[3]=Q[3]-H[3],oe}function _t(oe,Q){return oe[0]===Q[0]&&oe[1]===Q[1]&&oe[2]===Q[2]&&oe[3]===Q[3]}function De(oe,Q){var H=oe[0],Ce=oe[1],Ee=oe[2],_e=oe[3],ve=Q[0],rt=Q[1],$t=Q[2],St=Q[3];return Math.abs(H-ve)<=m.b*Math.max(1,Math.abs(H),Math.abs(ve))&&Math.abs(Ce-rt)<=m.b*Math.max(1,Math.abs(Ce),Math.abs(rt))&&Math.abs(Ee-$t)<=m.b*Math.max(1,Math.abs(Ee),Math.abs($t))&&Math.abs(_e-St)<=m.b*Math.max(1,Math.abs(_e),Math.abs(St))}function Ne(oe,Q,H){return oe[0]=Q[0]*H,oe[1]=Q[1]*H,oe[2]=Q[2]*H,oe[3]=Q[3]*H,oe}function Ue(oe,Q,H,Ce){return oe[0]=Q[0]+H[0]*Ce,oe[1]=Q[1]+H[1]*Ce,oe[2]=Q[2]+H[2]*Ce,oe[3]=Q[3]+H[3]*Ce,oe}var st=We,Le=yt,ut=i("ZaHm"),Gt=i("ZxFD"),Kt=i("n+fv"),ar=i("bl9R")},ISu3:function(Re,E,i){"use strict";i.d(E,"a",function(){return X}),i.d(E,"c",function(){return z}),i.d(E,"b",function(){return o}),i.d(E,"d",function(){return Z});var T={},m={},X=function(K){return m[K]},z=function(K,re){m[K]=re},o=function(K){return T[K]},Z=function(K,re){T[K]=re}},Ioao:function(Re,E,i){var T=i("heNW"),m=Math.max;function X(z,o,Z){return o=m(o===void 0?z.length-1:o,0),function(){for(var D=arguments,K=-1,re=m(D.length-o,0),fe=Array(re);++K<re;)fe[K]=D[o+K];K=-1;for(var Y=Array(o+1);++K<o;)Y[K]=D[K];return Y[o]=Z(fe),T(z,this,Y)}}Re.exports=X},J2iB:function(Re,E){function i(T){return T==null}Re.exports=i},J7lC:function(Re,E){},K9nA:function(Re,E,i){"use strict";(function(T,m){i.d(E,"b",function(){return Z}),i.d(E,"a",function(){return re});var X=i("U8pU"),z={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof T!="undefined"&&T,document:typeof document!="undefined"&&document,process:(typeof m=="undefined"?"undefined":Object(X.a)(m))==="object"&&m},o=z.self||z.window||z.global,Z=z.window||z.self||z.global,D=z.global||z.self||z.window,K=z.document||{},re=z.process||{},fe=console}).call(this,i("yLpj"),i("Q2Ig"))},KKCa:function(Re,E){typeof Object.create=="function"?Re.exports=function(T,m){T.super_=m,T.prototype=Object.create(m.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}})}:Re.exports=function(T,m){T.super_=m;var X=function(){};X.prototype=m.prototype,T.prototype=new X,T.prototype.constructor=T}},KwMD:function(Re,E){function i(T,m,X,z){for(var o=T.length,Z=X+(z?1:-1);z?Z--:++Z<o;)if(m(T[Z],Z,T))return Z;return-1}Re.exports=i},KxBF:function(Re,E){function i(T,m,X){var z=-1,o=T.length;m<0&&(m=-m>o?0:o+m),X=X>o?o:X,X<0&&(X+=o),o=m>X?0:X-m>>>0,m>>>=0;for(var Z=Array(o);++z<o;)Z[z]=T[z+m];return Z}Re.exports=i},L56e:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T=["mapload"]},LGYb:function(Re,E,i){var T=i("1hJj"),m=i("jbM+"),X=i("Xt/L"),z=i("xYSL"),o=i("dQpi"),Z=i("rEGp"),D=200;function K(re,fe,Y){var Fe=-1,We=m,ge=re.length,we=!0,dt=[],ke=dt;if(Y)we=!1,We=X;else if(ge>=D){var Et=fe?null:o(re);if(Et)return Z(Et);we=!1,We=z,ke=new T}else ke=fe?[]:dt;e:for(;++Fe<ge;){var Ze=re[Fe],vt=fe?fe(Ze):Ze;if(Ze=Y||Ze!==0?Ze:0,we&&vt===vt){for(var Qe=ke.length;Qe--;)if(ke[Qe]===vt)continue e;fe&&ke.push(vt),dt.push(Ze)}else We(ke,vt,Y)||(ke!==dt&&ke.push(vt),dt.push(Ze))}return dt}Re.exports=K},LKzl:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("z4Hk"),X=function(){function z(o){this._binding=o,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new T.BindingOnSyntax(this._binding)}return z.prototype.when=function(o){return this._bindingWhenSyntax.when(o)},z.prototype.whenTargetNamed=function(o){return this._bindingWhenSyntax.whenTargetNamed(o)},z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},z.prototype.whenTargetTagged=function(o,Z){return this._bindingWhenSyntax.whenTargetTagged(o,Z)},z.prototype.whenInjectedInto=function(o){return this._bindingWhenSyntax.whenInjectedInto(o)},z.prototype.whenParentNamed=function(o){return this._bindingWhenSyntax.whenParentNamed(o)},z.prototype.whenParentTagged=function(o,Z){return this._bindingWhenSyntax.whenParentTagged(o,Z)},z.prototype.whenAnyAncestorIs=function(o){return this._bindingWhenSyntax.whenAnyAncestorIs(o)},z.prototype.whenNoAncestorIs=function(o){return this._bindingWhenSyntax.whenNoAncestorIs(o)},z.prototype.whenAnyAncestorNamed=function(o){return this._bindingWhenSyntax.whenAnyAncestorNamed(o)},z.prototype.whenAnyAncestorTagged=function(o,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(o,Z)},z.prototype.whenNoAncestorNamed=function(o){return this._bindingWhenSyntax.whenNoAncestorNamed(o)},z.prototype.whenNoAncestorTagged=function(o,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(o,Z)},z.prototype.whenAnyAncestorMatches=function(o){return this._bindingWhenSyntax.whenAnyAncestorMatches(o)},z.prototype.whenNoAncestorMatches=function(o){return this._bindingWhenSyntax.whenNoAncestorMatches(o)},z.prototype.onActivation=function(o){return this._bindingOnSyntax.onActivation(o)},z}();E.BindingWhenOnSyntax=X},LcsW:function(Re,E,i){var T=i("kekF"),m=T(Object.getPrototypeOf,Object);Re.exports=m},LgvC:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("d9O0"),X=function(){function z(o,Z){this.id=m.id(),this.activated=!1,this.serviceIdentifier=o,this.scope=Z,this.type=T.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return z.prototype.clone=function(){var o=new z(this.serviceIdentifier,this.scope);return o.activated=!1,o.implementationType=this.implementationType,o.dynamicValue=this.dynamicValue,o.scope=this.scope,o.type=this.type,o.factory=this.factory,o.provider=this.provider,o.constraint=this.constraint,o.onActivation=this.onActivation,o.cache=this.cache,o},z}();E.Binding=X},LsHQ:function(Re,E,i){var T=i("EA7m"),m=i("mv/X");function X(z){return T(function(o,Z){var D=-1,K=Z.length,re=K>1?Z[K-1]:void 0,fe=K>2?Z[2]:void 0;for(re=z.length>3&&typeof re=="function"?(K--,re):void 0,fe&&m(Z[0],Z[1],fe)&&(re=K<3?void 0:re,K=1),o=Object(o);++D<K;){var Y=Z[D];Y&&z(o,Y,D,re)}return o})}Re.exports=X},LvWW:function(Re,E,i){var T=i("mhV4");Re.exports=m;function m(K,re){switch(K&&K.type||null){case"FeatureCollection":return K.features=K.features.map(X(m,re)),K;case"GeometryCollection":return K.geometries=K.geometries.map(X(m,re)),K;case"Feature":return K.geometry=m(K.geometry,re),K;case"Polygon":case"MultiPolygon":return z(K,re);default:return K}}function X(K,re){return function(fe){return K(fe,re)}}function z(K,re){return K.type==="Polygon"?K.coordinates=o(K.coordinates,re):K.type==="MultiPolygon"&&(K.coordinates=K.coordinates.map(X(o,re))),K}function o(K,re){re=!!re,K[0]=Z(K[0],re);for(var fe=1;fe<K.length;fe++)K[fe]=Z(K[fe],!re);return K}function Z(K,re){return D(K)===re?K:K.reverse()}function D(K){return T.ring(K)>=0}},MCLT:function(Re,E,i){(function(T){var m=Object.getOwnPropertyDescriptors||function(ve){for(var rt=Object.keys(ve),$t={},St=0;St<rt.length;St++)$t[rt[St]]=Object.getOwnPropertyDescriptor(ve,rt[St]);return $t},X=/%[sdj%]/g;E.format=function(_e){if(!Qe(_e)){for(var ve=[],rt=0;rt<arguments.length;rt++)ve.push(Z(arguments[rt]));return ve.join(" ")}for(var rt=1,$t=arguments,St=$t.length,ye=String(_e).replace(X,function(Be){if(Be==="%%")return"%";if(rt>=St)return Be;switch(Be){case"%s":return String($t[rt++]);case"%d":return Number($t[rt++]);case"%j":try{return JSON.stringify($t[rt++])}catch(lt){return"[Circular]"}default:return Be}}),be=$t[rt];rt<St;be=$t[++rt])Et(be)||!Ne(be)?ye+=" "+be:ye+=" "+Z(be);return ye},E.deprecate=function(_e,ve){if(typeof T!="undefined"&&T.noDeprecation===!0)return _e;if(typeof T=="undefined")return function(){return E.deprecate(_e,ve).apply(this,arguments)};var rt=!1;function $t(){if(!rt){if(T.throwDeprecation)throw new Error(ve);T.traceDeprecation?console.trace(ve):console.error(ve),rt=!0}return _e.apply(this,arguments)}return $t};var z={},o;E.debuglog=function(_e){if(_t(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),_e=_e.toUpperCase(),!z[_e])if(new RegExp("\\b"+_e+"\\b","i").test(o)){var ve=T.pid;z[_e]=function(){var rt=E.format.apply(E,arguments);console.error("%s %d: %s",_e,ve,rt)}}else z[_e]=function(){};return z[_e]};function Z(_e,ve){var rt={seen:[],stylize:K};return arguments.length>=3&&(rt.depth=arguments[2]),arguments.length>=4&&(rt.colors=arguments[3]),ke(ve)?rt.showHidden=ve:ve&&E._extend(rt,ve),_t(rt.showHidden)&&(rt.showHidden=!1),_t(rt.depth)&&(rt.depth=2),_t(rt.colors)&&(rt.colors=!1),_t(rt.customInspect)&&(rt.customInspect=!0),rt.colors&&(rt.stylize=D),fe(rt,_e,rt.depth)}E.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(_e,ve){var rt=Z.styles[ve];return rt?"["+Z.colors[rt][0]+"m"+_e+"["+Z.colors[rt][1]+"m":_e}function K(_e,ve){return _e}function re(_e){var ve={};return _e.forEach(function(rt,$t){ve[rt]=!0}),ve}function fe(_e,ve,rt){if(_e.customInspect&&ve&&Le(ve.inspect)&&ve.inspect!==E.inspect&&!(ve.constructor&&ve.constructor.prototype===ve)){var $t=ve.inspect(rt,_e);return Qe($t)||($t=fe(_e,$t,rt)),$t}var St=Y(_e,ve);if(St)return St;var ye=Object.keys(ve),be=re(ye);if(_e.showHidden&&(ye=Object.getOwnPropertyNames(ve)),st(ve)&&(ye.indexOf("message")>=0||ye.indexOf("description")>=0))return Fe(ve);if(ye.length===0){if(Le(ve)){var Be=ve.name?": "+ve.name:"";return _e.stylize("[Function"+Be+"]","special")}if(De(ve))return _e.stylize(RegExp.prototype.toString.call(ve),"regexp");if(Ue(ve))return _e.stylize(Date.prototype.toString.call(ve),"date");if(st(ve))return Fe(ve)}var lt="",Pe=!1,ht=["{","}"];if(dt(ve)&&(Pe=!0,ht=["[","]"]),Le(ve)){var w=ve.name?": "+ve.name:"";lt=" [Function"+w+"]"}if(De(ve)&&(lt=" "+RegExp.prototype.toString.call(ve)),Ue(ve)&&(lt=" "+Date.prototype.toUTCString.call(ve)),st(ve)&&(lt=" "+Fe(ve)),ye.length===0&&(!Pe||ve.length==0))return ht[0]+lt+ht[1];if(rt<0)return De(ve)?_e.stylize(RegExp.prototype.toString.call(ve),"regexp"):_e.stylize("[Object]","special");_e.seen.push(ve);var I;return Pe?I=We(_e,ve,rt,be,ye):I=ye.map(function(q){return ge(_e,ve,rt,be,q,Pe)}),_e.seen.pop(),we(I,lt,ht)}function Y(_e,ve){if(_t(ve))return _e.stylize("undefined","undefined");if(Qe(ve)){var rt="'"+JSON.stringify(ve).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _e.stylize(rt,"string")}if(vt(ve))return _e.stylize(""+ve,"number");if(ke(ve))return _e.stylize(""+ve,"boolean");if(Et(ve))return _e.stylize("null","null")}function Fe(_e){return"["+Error.prototype.toString.call(_e)+"]"}function We(_e,ve,rt,$t,St){for(var ye=[],be=0,Be=ve.length;be<Be;++be)Q(ve,String(be))?ye.push(ge(_e,ve,rt,$t,String(be),!0)):ye.push("");return St.forEach(function(lt){lt.match(/^\d+$/)||ye.push(ge(_e,ve,rt,$t,lt,!0))}),ye}function ge(_e,ve,rt,$t,St,ye){var be,Be,lt;if(lt=Object.getOwnPropertyDescriptor(ve,St)||{value:ve[St]},lt.get?lt.set?Be=_e.stylize("[Getter/Setter]","special"):Be=_e.stylize("[Getter]","special"):lt.set&&(Be=_e.stylize("[Setter]","special")),Q($t,St)||(be="["+St+"]"),Be||(_e.seen.indexOf(lt.value)<0?(Et(rt)?Be=fe(_e,lt.value,null):Be=fe(_e,lt.value,rt-1),Be.indexOf(`
`)>-1&&(ye?Be=Be.split(`
`).map(function(Pe){return"  "+Pe}).join(`
`).substr(2):Be=`
`+Be.split(`
`).map(function(Pe){return"   "+Pe}).join(`
`))):Be=_e.stylize("[Circular]","special")),_t(be)){if(ye&&St.match(/^\d+$/))return Be;be=JSON.stringify(""+St),be.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(be=be.substr(1,be.length-2),be=_e.stylize(be,"name")):(be=be.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),be=_e.stylize(be,"string"))}return be+": "+Be}function we(_e,ve,rt){var $t=0,St=_e.reduce(function(ye,be){return $t++,be.indexOf(`
`)>=0&&$t++,ye+be.replace(/\u001b\[\d\d?m/g,"").length+1},0);return St>60?rt[0]+(ve===""?"":ve+`
 `)+" "+_e.join(`,
  `)+" "+rt[1]:rt[0]+ve+" "+_e.join(", ")+" "+rt[1]}function dt(_e){return Array.isArray(_e)}E.isArray=dt;function ke(_e){return typeof _e=="boolean"}E.isBoolean=ke;function Et(_e){return _e===null}E.isNull=Et;function Ze(_e){return _e==null}E.isNullOrUndefined=Ze;function vt(_e){return typeof _e=="number"}E.isNumber=vt;function Qe(_e){return typeof _e=="string"}E.isString=Qe;function yt(_e){return typeof _e=="symbol"}E.isSymbol=yt;function _t(_e){return _e===void 0}E.isUndefined=_t;function De(_e){return Ne(_e)&&Gt(_e)==="[object RegExp]"}E.isRegExp=De;function Ne(_e){return typeof _e=="object"&&_e!==null}E.isObject=Ne;function Ue(_e){return Ne(_e)&&Gt(_e)==="[object Date]"}E.isDate=Ue;function st(_e){return Ne(_e)&&(Gt(_e)==="[object Error]"||_e instanceof Error)}E.isError=st;function Le(_e){return typeof _e=="function"}E.isFunction=Le;function ut(_e){return _e===null||typeof _e=="boolean"||typeof _e=="number"||typeof _e=="string"||typeof _e=="symbol"||typeof _e=="undefined"}E.isPrimitive=ut,E.isBuffer=i("1gqn");function Gt(_e){return Object.prototype.toString.call(_e)}function Kt(_e){return _e<10?"0"+_e.toString(10):_e.toString(10)}var ar=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var _e=new Date,ve=[Kt(_e.getHours()),Kt(_e.getMinutes()),Kt(_e.getSeconds())].join(":");return[_e.getDate(),ar[_e.getMonth()],ve].join(" ")}E.log=function(){console.log("%s - %s",oe(),E.format.apply(E,arguments))},E.inherits=i("KKCa"),E._extend=function(_e,ve){if(!ve||!Ne(ve))return _e;for(var rt=Object.keys(ve),$t=rt.length;$t--;)_e[rt[$t]]=ve[rt[$t]];return _e};function Q(_e,ve){return Object.prototype.hasOwnProperty.call(_e,ve)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;E.promisify=function(ve){if(typeof ve!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&ve[H]){var rt=ve[H];if(typeof rt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(rt,H,{value:rt,enumerable:!1,writable:!1,configurable:!0}),rt}function rt(){for(var $t,St,ye=new Promise(function(lt,Pe){$t=lt,St=Pe}),be=[],Be=0;Be<arguments.length;Be++)be.push(arguments[Be]);be.push(function(lt,Pe){lt?St(lt):$t(Pe)});try{ve.apply(this,be)}catch(lt){St(lt)}return ye}return Object.setPrototypeOf(rt,Object.getPrototypeOf(ve)),H&&Object.defineProperty(rt,H,{value:rt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(rt,m(ve))},E.promisify.custom=H;function Ce(_e,ve){if(!_e){var rt=new Error("Promise was rejected with a falsy value");rt.reason=_e,_e=rt}return ve(_e)}function Ee(_e){if(typeof _e!="function")throw new TypeError('The "original" argument must be of type Function');function ve(){for(var rt=[],$t=0;$t<arguments.length;$t++)rt.push(arguments[$t]);var St=rt.pop();if(typeof St!="function")throw new TypeError("The last argument must be of type Function");var ye=this,be=function(){return St.apply(ye,arguments)};_e.apply(this,rt).then(function(Be){T.nextTick(be,null,Be)},function(Be){T.nextTick(Ce,Be,be)})}return Object.setPrototypeOf(ve,Object.getPrototypeOf(_e)),Object.defineProperties(ve,m(_e)),ve}E.callbackify=Ee}).call(this,i("Q2Ig"))},MON2:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",E.UNDEFINED_INJECT_ANNOTATION=function(T){return"@inject called with undefined this could mean that the class "+T+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",E.ARGUMENTS_LENGTH_MISMATCH=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"The number of constructor arguments in the derived class "+(T[0]+" must be >= than the number of constructor arguments of its base class.")},E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",E.POST_CONSTRUCT_ERROR=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"@postConstruct error in class "+T[0]+": "+T[1]},E.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"It looks like there is a circular dependency "+("in one of the '"+T[0]+"' bindings. Please investigate bindings with")+("service identifier '"+T[1]+"'.")},E.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Re,E,i){var T=i("hypo"),m=i("ljhN"),X=Object.prototype,z=X.hasOwnProperty;function o(Z,D,K){var re=Z[D];(!(z.call(Z,D)&&m(re,K))||K===void 0&&!(D in Z))&&T(Z,D,K)}Re.exports=o},O0oS:function(Re,E,i){var T=i("Cwc5"),m=function(){try{var X=T(Object,"defineProperty");return X({},"",{}),X}catch(z){}}();Re.exports=m},O1je:function(Re,E){},OBhP:function(Re,E,i){var T=i("fmRc"),m=i("gFfm"),X=i("MrPd"),z=i("WwFo"),o=i("Dw+G"),Z=i("5Tg0"),D=i("Q1l4"),K=i("VOtZ"),re=i("EEGq"),fe=i("qZTm"),Y=i("G6z8"),Fe=i("QqLw"),We=i("yHx3"),ge=i("wrZu"),we=i("+iFO"),dt=i("Z0cm"),ke=i("DSRE"),Et=i("zEVN"),Ze=i("GoyQ"),vt=i("1+5i"),Qe=i("7GkX"),yt=i("mTTR"),_t=1,De=2,Ne=4,Ue="[object Arguments]",st="[object Array]",Le="[object Boolean]",ut="[object Date]",Gt="[object Error]",Kt="[object Function]",ar="[object GeneratorFunction]",oe="[object Map]",Q="[object Number]",H="[object Object]",Ce="[object RegExp]",Ee="[object Set]",_e="[object String]",ve="[object Symbol]",rt="[object WeakMap]",$t="[object ArrayBuffer]",St="[object DataView]",ye="[object Float32Array]",be="[object Float64Array]",Be="[object Int8Array]",lt="[object Int16Array]",Pe="[object Int32Array]",ht="[object Uint8Array]",w="[object Uint8ClampedArray]",I="[object Uint16Array]",q="[object Uint32Array]",ce={};ce[Ue]=ce[st]=ce[$t]=ce[St]=ce[Le]=ce[ut]=ce[ye]=ce[be]=ce[Be]=ce[lt]=ce[Pe]=ce[oe]=ce[Q]=ce[H]=ce[Ce]=ce[Ee]=ce[_e]=ce[ve]=ce[ht]=ce[w]=ce[I]=ce[q]=!0,ce[Gt]=ce[Kt]=ce[rt]=!1;function Ve($e,gt,nt,kt,$,Ke){var ae,et=gt&_t,zt=gt&De,sr=gt&Ne;if(nt&&(ae=$?nt($e,kt,$,Ke):nt($e)),ae!==void 0)return ae;if(!Ze($e))return $e;var ft=dt($e);if(ft){if(ae=We($e),!et)return D($e,ae)}else{var pt=Fe($e),At=pt==Kt||pt==ar;if(ke($e))return Z($e,et);if(pt==H||pt==Ue||At&&!$){if(ae=zt||At?{}:we($e),!et)return zt?re($e,o(ae,$e)):K($e,z(ae,$e))}else{if(!ce[pt])return $?$e:{};ae=ge($e,pt,et)}}Ke||(Ke=new T);var mt=Ke.get($e);if(mt)return mt;Ke.set($e,ae),vt($e)?$e.forEach(function(qe){ae.add(Ve(qe,gt,nt,qe,$e,Ke))}):Et($e)&&$e.forEach(function(qe,Vt){ae.set(Vt,Ve(qe,gt,nt,Vt,$e,Ke))});var Me=sr?zt?Y:fe:zt?yt:Qe,ct=ft?void 0:Me($e);return m(ct||$e,function(qe,Vt){ct&&(Vt=qe,qe=$e[Vt]),X(ae,Vt,Ve(qe,gt,nt,Vt,$e,Ke))}),ae}Re.exports=Ve},PSsN:function(Re,E){},PUg6:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.normal="normal",m.additive="additive",m.subtractive="subtractive",m.min="min",m.max="max",m.none="none"})(T||(T={}))},Q1l4:function(Re,E){function i(T,m){var X=-1,z=T.length;for(m||(m=Array(z));++X<z;)m[X]=T[X];return m}Re.exports=i},QGbF:function(Re,E){},"QQZ/":function(Re,E,i){var T=i("Sq3C"),m=i("Z1HP"),X=i("Sxd8"),z=i("dt0z");function o(Z,D,K){Z=z(Z),D=X(D);var re=D?m(Z):0;return D&&re<D?T(D-re,K)+Z:Z}Re.exports=o},QcOe:function(Re,E,i){var T=i("GoyQ"),m=i("6sVZ"),X=i("7Ix3"),z=Object.prototype,o=z.hasOwnProperty;function Z(D){if(!T(D))return X(D);var K=m(D),re=[];for(var fe in D)fe=="constructor"&&(K||!o.call(D,fe))||re.push(fe);return re}Re.exports=Z},QkVN:function(Re,E,i){var T=i("+Qka"),m=i("LsHQ"),X=m(function(z,o,Z){T(z,o,Z)});Re.exports=X},"R/W3":function(Re,E,i){var T=i("KwMD"),m=i("2ajD"),X=i("CZoQ");function z(o,Z,D){return Z===Z?X(o,Z,D):T(o,m,D)}Re.exports=z},"RL2/":function(Re,E,i){"use strict";var T="2.3.0"},RMtq:function(Re,E){},"RR/i":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=function D(K,re){var fe=K.parentRequest;return fe!==null?re(fe)?!0:D(fe,re):!1};E.traverseAncerstors=X;var z=function(K){return function(re){var fe=function(Fe){return Fe!==null&&Fe.target!==null&&Fe.target.matchesTag(K)(re)};return fe.metaData=new m.Metadata(K,re),fe}};E.taggedConstraint=z;var o=z(T.NAMED_TAG);E.namedConstraint=o;var Z=function(K){return function(re){var fe=null;if(re!==null)if(fe=re.bindings[0],typeof K=="string"){var Y=fe.serviceIdentifier;return Y===K}else{var Fe=re.bindings[0].implementationType;return K===Fe}return!1}};E.typeConstraint=Z},Sk89:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),X=i("GXnB");function z(){return function(o,Z,D){var K=new X.Metadata(m.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(m.POST_CONSTRUCT,o.constructor))throw new Error(T.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(m.POST_CONSTRUCT,K,o.constructor)}}E.postConstruct=z},Sq3C:function(Re,E,i){var T=i("sKgW"),m=i("zoYe"),X=i("wy8a"),z=i("quyA"),o=i("Z1HP"),Z=i("Em2t"),D=Math.ceil;function K(re,fe){fe=fe===void 0?" ":m(fe);var Y=fe.length;if(Y<2)return Y?T(fe,re):fe;var Fe=T(fe,D(re/o(fe)));return z(fe)?X(Z(Fe),0,re).join(""):Fe.slice(0,re)}Re.exports=K},Sxd8:function(Re,E,i){var T=i("ZCgT");function m(X){var z=T(X),o=z%1;return z===z?o?z-o:z:0}Re.exports=m},T1AV:function(Re,E,i){var T=i("t2Dn"),m=i("5Tg0"),X=i("yP5f"),z=i("Q1l4"),o=i("+iFO"),Z=i("03A+"),D=i("Z0cm"),K=i("3L66"),re=i("DSRE"),fe=i("lSCD"),Y=i("GoyQ"),Fe=i("YO3V"),We=i("c6wG"),ge=i("itsj"),we=i("jeLo");function dt(ke,Et,Ze,vt,Qe,yt,_t){var De=ge(ke,Ze),Ne=ge(Et,Ze),Ue=_t.get(Ne);if(Ue){T(ke,Ze,Ue);return}var st=yt?yt(De,Ne,Ze+"",ke,Et,_t):void 0,Le=st===void 0;if(Le){var ut=D(Ne),Gt=!ut&&re(Ne),Kt=!ut&&!Gt&&We(Ne);st=Ne,ut||Gt||Kt?D(De)?st=De:K(De)?st=z(De):Gt?(Le=!1,st=m(Ne,!0)):Kt?(Le=!1,st=X(Ne,!0)):st=[]:Fe(Ne)||Z(Ne)?(st=De,Z(De)?st=we(De):(!Y(De)||fe(De))&&(st=o(Ne))):Le=!1}Le&&(_t.set(Ne,st),Qe(st,Ne,vt,yt,_t),_t.delete(Ne)),T(ke,Ze,st)}Re.exports=dt},TKrE:function(Re,E,i){var T=i("qRkn"),m=i("dt0z"),X=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,z="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",D=z+o+Z,K="["+D+"]",re=RegExp(K,"g");function fe(Y){return Y=m(Y),Y&&Y.replace(X,T).replace(re,"")}Re.exports=fe},"U+yc":function(Re,E){function i(T,m,X,z,o){var Z={};return Object.keys(z).forEach(function(D){Z[D]=z[D]}),Z.enumerable=!!Z.enumerable,Z.configurable=!!Z.configurable,("value"in Z||Z.initializer)&&(Z.writable=!0),Z=X.slice().reverse().reduce(function(D,K){return K(T,m,D)||D},Z),o&&Z.initializer!==void 0&&(Z.value=Z.initializer?Z.initializer.call(o):void 0,Z.initializer=void 0),Z.initializer===void 0&&(Object.defineProperty(T,m,Z),Z=null),Z}Re.exports=i},U1ZX:function(Re,E){},UB5X:function(Re,E,i){var T=i("NykK"),m=i("ExA7"),X="[object Number]";function z(o){return typeof o=="number"||m(o)&&T(o)==X}Re.exports=z},Ucsi:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=Symbol.for("INJECTION");function m(D,K,re,fe){function Y(){return fe&&!Reflect.hasMetadata(T,this,K)&&Reflect.defineMetadata(T,re(),this,K),Reflect.hasMetadata(T,this,K)?Reflect.getMetadata(T,this,K):re()}function Fe(We){Reflect.defineMetadata(T,We,this,K)}Object.defineProperty(D,K,{configurable:!0,enumerable:!0,get:Y,set:Fe})}function X(D,K){return function(re){return function(fe,Y){var Fe=function(){return D.get(re)};m(fe,Y,Fe,K)}}}E.makePropertyInjectDecorator=X;function z(D,K){return function(re,fe){return function(Y,Fe){var We=function(){return D.getNamed(re,fe)};m(Y,Fe,We,K)}}}E.makePropertyInjectNamedDecorator=z;function o(D,K){return function(re,fe,Y){return function(Fe,We){var ge=function(){return D.getTagged(re,fe,Y)};m(Fe,We,ge,K)}}}E.makePropertyInjectTaggedDecorator=o;function Z(D,K){return function(re){return function(fe,Y){var Fe=function(){return D.getAll(re)};m(fe,Y,Fe,K)}}}E.makePropertyMultiInjectDecorator=Z},V1cb:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Hover="hover",m.Click="click",m.Select="select",m.Active="active",m.Drag="drag"})(T||(T={}))},VIsB:function(Re,E,i){"use strict";i.d(E,"a",function(){return Z});var T=i("Hel2");function m(Fe,We){var ge;if(typeof Symbol=="undefined"||Fe[Symbol.iterator]==null){if(Array.isArray(Fe)||(ge=X(Fe))||We&&Fe&&typeof Fe.length=="number"){ge&&(Fe=ge);var we=0,dt=function(){};return{s:dt,n:function(){return we>=Fe.length?{done:!0}:{done:!1,value:Fe[we++]}},e:function(Qe){throw Qe},f:dt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ke=!0,Et=!1,Ze;return{s:function(){ge=Fe[Symbol.iterator]()},n:function(){var Qe=ge.next();return ke=Qe.done,Qe},e:function(Qe){Et=!0,Ze=Qe},f:function(){try{!ke&&ge.return!=null&&ge.return()}finally{if(Et)throw Ze}}}}function X(Fe,We){if(!Fe)return;if(typeof Fe=="string")return z(Fe,We);var ge=Object.prototype.toString.call(Fe).slice(8,-1);if(ge==="Object"&&Fe.constructor&&(ge=Fe.constructor.name),ge==="Map"||ge==="Set")return Array.from(Fe);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return z(Fe,We)}function z(Fe,We){(We==null||We>Fe.length)&&(We=Fe.length);for(var ge=0,we=new Array(We);ge<We;ge++)we[ge]=Fe[ge];return we}var o=6378e3;function Z(Fe,We){var ge=Fe.dataArray,we=We.size,dt=we===void 0?10:we,ke=dt/(2*Math.PI*o)*(256<<20)/2,Et=D(ge,dt),Ze=Et.gridHash,vt=Et.gridOffset,Qe=Y(Ze,vt,We);return{yOffset:ke,xOffset:ke,radius:ke,type:"grid",dataArray:Qe}}function D(Fe,We){var ge=Infinity,we=-Infinity,dt,ke=m(Fe),Et;try{for(ke.s();!(Et=ke.n()).done;){var Ze=Et.value;dt=Ze.coordinates[1],Number.isFinite(dt)&&(ge=dt<ge?dt:ge,we=dt>we?dt:we)}}catch(Kt){ke.e(Kt)}finally{ke.f()}var vt=(ge+we)/2,Qe=K(We,vt);if(Qe.xOffset<=0||Qe.yOffset<=0)return{gridHash:{},gridOffset:Qe};var yt={},_t=m(Fe),De;try{for(_t.s();!(De=_t.n()).done;){var Ne=De.value,Ue=Ne.coordinates[1],st=Ne.coordinates[0];if(Number.isFinite(Ue)&&Number.isFinite(st)){var Le=Math.floor((Ue+90)/Qe.yOffset),ut=Math.floor((st+180)/Qe.xOffset),Gt="".concat(Le,"-").concat(ut);yt[Gt]=yt[Gt]||{count:0,points:[]},yt[Gt].count+=1,yt[Gt].points.push(Ne)}}}catch(Kt){_t.e(Kt)}finally{_t.f()}return{gridHash:yt,gridOffset:Qe}}function K(Fe,We){var ge=re(Fe),we=fe(We,Fe);return{yOffset:ge,xOffset:we}}function re(Fe){return Fe/o*(180/Math.PI)}function fe(Fe,We){return We/o*(180/Math.PI)/Math.cos(Fe*Math.PI/180)}function Y(Fe,We,ge){return Object.keys(Fe).reduce(function(we,dt,ke){var Et=dt.split("-"),Ze=parseInt(Et[0],10),vt=parseInt(Et[1],10),Qe={};if(ge.field&&ge.method){var yt=T.c.getColumn(Fe[dt].points,ge.field);Qe[ge.method]=T.c.statMap[ge.method](yt)}return Object.assign(Qe,{_id:ke,coordinates:Object(T.d)([-180+We.xOffset*(vt+.5),-90+We.yOffset*(Ze+.5)]),rawData:Fe[dt].points,count:Fe[dt].count}),we.push(Qe),we},[])}},VOtZ:function(Re,E,i){var T=i("juv8"),m=i("MvSz");function X(z,o){return T(z,m(z),o)}Re.exports=X},VmRL:function(Re,E,i){"use strict";Re.exports=T,Re.exports.default=T;function T(oe,Q,H){H=H||2;var Ce=Q&&Q.length,Ee=Ce?Q[0]*H:oe.length,_e=m(oe,0,Ee,H,!0),ve=[];if(!_e||_e.next===_e.prev)return ve;var rt,$t,St,ye,be,Be,lt;if(Ce&&(_e=re(oe,Q,_e,H)),oe.length>80*H){rt=St=oe[0],$t=ye=oe[1];for(var Pe=H;Pe<Ee;Pe+=H)be=oe[Pe],Be=oe[Pe+1],be<rt&&(rt=be),Be<$t&&($t=Be),be>St&&(St=be),Be>ye&&(ye=Be);lt=Math.max(St-rt,ye-$t),lt=lt!==0?1/lt:0}return z(_e,ve,H,rt,$t,lt),ve}function m(oe,Q,H,Ce,Ee){var _e,ve;if(Ee===ar(oe,Q,H,Ce)>0)for(_e=Q;_e<H;_e+=Ce)ve=ut(_e,oe[_e],oe[_e+1],ve);else for(_e=H-Ce;_e>=Q;_e-=Ce)ve=ut(_e,oe[_e],oe[_e+1],ve);return ve&&Qe(ve,ve.next)&&(Gt(ve),ve=ve.next),ve}function X(oe,Q){if(!oe)return oe;Q||(Q=oe);var H=oe,Ce;do if(Ce=!1,!H.steiner&&(Qe(H,H.next)||vt(H.prev,H,H.next)===0)){if(Gt(H),H=Q=H.prev,H===H.next)break;Ce=!0}else H=H.next;while(Ce||H!==Q);return Q}function z(oe,Q,H,Ce,Ee,_e,ve){if(!oe)return;!ve&&_e&&ge(oe,Ce,Ee,_e);for(var rt=oe,$t,St;oe.prev!==oe.next;){if($t=oe.prev,St=oe.next,_e?Z(oe,Ce,Ee,_e):o(oe)){Q.push($t.i/H),Q.push(oe.i/H),Q.push(St.i/H),Gt(oe),oe=St.next,rt=St.next;continue}if(oe=St,oe===rt){ve?ve===1?(oe=D(X(oe),Q,H),z(oe,Q,H,Ce,Ee,_e,2)):ve===2&&K(oe,Q,H,Ce,Ee,_e):z(X(oe),Q,H,Ce,Ee,_e,1);break}}}function o(oe){var Q=oe.prev,H=oe,Ce=oe.next;if(vt(Q,H,Ce)>=0)return!1;for(var Ee=oe.next.next;Ee!==oe.prev;){if(Et(Q.x,Q.y,H.x,H.y,Ce.x,Ce.y,Ee.x,Ee.y)&&vt(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.next}return!0}function Z(oe,Q,H,Ce){var Ee=oe.prev,_e=oe,ve=oe.next;if(vt(Ee,_e,ve)>=0)return!1;for(var rt=Ee.x<_e.x?Ee.x<ve.x?Ee.x:ve.x:_e.x<ve.x?_e.x:ve.x,$t=Ee.y<_e.y?Ee.y<ve.y?Ee.y:ve.y:_e.y<ve.y?_e.y:ve.y,St=Ee.x>_e.x?Ee.x>ve.x?Ee.x:ve.x:_e.x>ve.x?_e.x:ve.x,ye=Ee.y>_e.y?Ee.y>ve.y?Ee.y:ve.y:_e.y>ve.y?_e.y:ve.y,be=dt(rt,$t,Q,H,Ce),Be=dt(St,ye,Q,H,Ce),lt=oe.prevZ,Pe=oe.nextZ;lt&&lt.z>=be&&Pe&&Pe.z<=Be;){if(lt!==oe.prev&&lt!==oe.next&&Et(Ee.x,Ee.y,_e.x,_e.y,ve.x,ve.y,lt.x,lt.y)&&vt(lt.prev,lt,lt.next)>=0)return!1;if(lt=lt.prevZ,Pe!==oe.prev&&Pe!==oe.next&&Et(Ee.x,Ee.y,_e.x,_e.y,ve.x,ve.y,Pe.x,Pe.y)&&vt(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}for(;lt&&lt.z>=be;){if(lt!==oe.prev&&lt!==oe.next&&Et(Ee.x,Ee.y,_e.x,_e.y,ve.x,ve.y,lt.x,lt.y)&&vt(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;Pe&&Pe.z<=Be;){if(Pe!==oe.prev&&Pe!==oe.next&&Et(Ee.x,Ee.y,_e.x,_e.y,ve.x,ve.y,Pe.x,Pe.y)&&vt(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}return!0}function D(oe,Q,H){var Ce=oe;do{var Ee=Ce.prev,_e=Ce.next.next;!Qe(Ee,_e)&&yt(Ee,Ce,Ce.next,_e)&&Ue(Ee,_e)&&Ue(_e,Ee)&&(Q.push(Ee.i/H),Q.push(Ce.i/H),Q.push(_e.i/H),Gt(Ce),Gt(Ce.next),Ce=oe=_e),Ce=Ce.next}while(Ce!==oe);return X(Ce)}function K(oe,Q,H,Ce,Ee,_e){var ve=oe;do{for(var rt=ve.next.next;rt!==ve.prev;){if(ve.i!==rt.i&&Ze(ve,rt)){var $t=Le(ve,rt);ve=X(ve,ve.next),$t=X($t,$t.next),z(ve,Q,H,Ce,Ee,_e),z($t,Q,H,Ce,Ee,_e);return}rt=rt.next}ve=ve.next}while(ve!==oe)}function re(oe,Q,H,Ce){var Ee=[],_e,ve,rt,$t,St;for(_e=0,ve=Q.length;_e<ve;_e++)rt=Q[_e]*Ce,$t=_e<ve-1?Q[_e+1]*Ce:oe.length,St=m(oe,rt,$t,Ce,!1),St===St.next&&(St.steiner=!0),Ee.push(ke(St));for(Ee.sort(fe),_e=0;_e<Ee.length;_e++)Y(Ee[_e],H),H=X(H,H.next);return H}function fe(oe,Q){return oe.x-Q.x}function Y(oe,Q){if(Q=Fe(oe,Q),Q){var H=Le(Q,oe);X(Q,Q.next),X(H,H.next)}}function Fe(oe,Q){var H=Q,Ce=oe.x,Ee=oe.y,_e=-Infinity,ve;do{if(Ee<=H.y&&Ee>=H.next.y&&H.next.y!==H.y){var rt=H.x+(Ee-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(rt<=Ce&&rt>_e){if(_e=rt,rt===Ce){if(Ee===H.y)return H;if(Ee===H.next.y)return H.next}ve=H.x<H.next.x?H:H.next}}H=H.next}while(H!==Q);if(!ve)return null;if(Ce===_e)return ve;var $t=ve,St=ve.x,ye=ve.y,be=Infinity,Be;H=ve;do Ce>=H.x&&H.x>=St&&Ce!==H.x&&Et(Ee<ye?Ce:_e,Ee,St,ye,Ee<ye?_e:Ce,Ee,H.x,H.y)&&(Be=Math.abs(Ee-H.y)/(Ce-H.x),Ue(H,oe)&&(Be<be||Be===be&&(H.x>ve.x||H.x===ve.x&&We(ve,H)))&&(ve=H,be=Be)),H=H.next;while(H!==$t);return ve}function We(oe,Q){return vt(oe.prev,oe,Q.prev)<0&&vt(Q.next,oe,oe.next)<0}function ge(oe,Q,H,Ce){var Ee=oe;do Ee.z===null&&(Ee.z=dt(Ee.x,Ee.y,Q,H,Ce)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next;while(Ee!==oe);Ee.prevZ.nextZ=null,Ee.prevZ=null,we(Ee)}function we(oe){var Q,H,Ce,Ee,_e,ve,rt,$t,St=1;do{for(H=oe,oe=null,_e=null,ve=0;H;){for(ve++,Ce=H,rt=0,Q=0;Q<St&&!(rt++,Ce=Ce.nextZ,!Ce);Q++);for($t=St;rt>0||$t>0&&Ce;)rt!==0&&($t===0||!Ce||H.z<=Ce.z)?(Ee=H,H=H.nextZ,rt--):(Ee=Ce,Ce=Ce.nextZ,$t--),_e?_e.nextZ=Ee:oe=Ee,Ee.prevZ=_e,_e=Ee;H=Ce}_e.nextZ=null,St*=2}while(ve>1);return oe}function dt(oe,Q,H,Ce,Ee){return oe=32767*(oe-H)*Ee,Q=32767*(Q-Ce)*Ee,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,oe|Q<<1}function ke(oe){var Q=oe,H=oe;do(Q.x<H.x||Q.x===H.x&&Q.y<H.y)&&(H=Q),Q=Q.next;while(Q!==oe);return H}function Et(oe,Q,H,Ce,Ee,_e,ve,rt){return(Ee-ve)*(Q-rt)-(oe-ve)*(_e-rt)>=0&&(oe-ve)*(Ce-rt)-(H-ve)*(Q-rt)>=0&&(H-ve)*(_e-rt)-(Ee-ve)*(Ce-rt)>=0}function Ze(oe,Q){return oe.next.i!==Q.i&&oe.prev.i!==Q.i&&!Ne(oe,Q)&&(Ue(oe,Q)&&Ue(Q,oe)&&st(oe,Q)&&(vt(oe.prev,oe,Q.prev)||vt(oe,Q.prev,Q))||Qe(oe,Q)&&vt(oe.prev,oe,oe.next)>0&&vt(Q.prev,Q,Q.next)>0)}function vt(oe,Q,H){return(Q.y-oe.y)*(H.x-Q.x)-(Q.x-oe.x)*(H.y-Q.y)}function Qe(oe,Q){return oe.x===Q.x&&oe.y===Q.y}function yt(oe,Q,H,Ce){var Ee=De(vt(oe,Q,H)),_e=De(vt(oe,Q,Ce)),ve=De(vt(H,Ce,oe)),rt=De(vt(H,Ce,Q));return Ee!==_e&&ve!==rt||(Ee===0&&_t(oe,H,Q)||(_e===0&&_t(oe,Ce,Q)||ve===0&&_t(H,oe,Ce)))?!0:!!(rt===0&&_t(H,Q,Ce))}function _t(oe,Q,H){return Q.x<=Math.max(oe.x,H.x)&&Q.x>=Math.min(oe.x,H.x)&&Q.y<=Math.max(oe.y,H.y)&&Q.y>=Math.min(oe.y,H.y)}function De(oe){return oe>0?1:oe<0?-1:0}function Ne(oe,Q){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==Q.i&&H.next.i!==Q.i&&yt(H,H.next,oe,Q))return!0;H=H.next}while(H!==oe);return!1}function Ue(oe,Q){return vt(oe.prev,oe,oe.next)<0?vt(oe,Q,oe.next)>=0&&vt(oe,oe.prev,Q)>=0:vt(oe,Q,oe.prev)<0||vt(oe,oe.next,Q)<0}function st(oe,Q){var H=oe,Ce=!1,Ee=(oe.x+Q.x)/2,_e=(oe.y+Q.y)/2;do H.y>_e!==H.next.y>_e&&H.next.y!==H.y&&Ee<(H.next.x-H.x)*(_e-H.y)/(H.next.y-H.y)+H.x&&(Ce=!Ce),H=H.next;while(H!==oe);return Ce}function Le(oe,Q){var H=new Kt(oe.i,oe.x,oe.y),Ce=new Kt(Q.i,Q.x,Q.y),Ee=oe.next,_e=Q.prev;return oe.next=Q,Q.prev=oe,H.next=Ee,Ee.prev=H,Ce.next=H,H.prev=Ce,_e.next=Ce,Ce.prev=_e,Ce}function ut(oe,Q,H,Ce){var Ee=new Kt(oe,Q,H);return Ce?(Ee.next=Ce.next,Ee.prev=Ce,Ce.next.prev=Ee,Ce.next=Ee):(Ee.prev=Ee,Ee.next=Ee),Ee}function Gt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Kt(oe,Q,H){this.i=oe,this.x=Q,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}T.deviation=function(oe,Q,H,Ce){var Ee=Q&&Q.length,_e=Ee?Q[0]*H:oe.length,ve=Math.abs(ar(oe,0,_e,H));if(Ee)for(var rt=0,$t=Q.length;rt<$t;rt++){var St=Q[rt]*H,ye=rt<$t-1?Q[rt+1]*H:oe.length;ve-=Math.abs(ar(oe,St,ye,H))}var be=0;for(rt=0;rt<Ce.length;rt+=3){var Be=Ce[rt]*H,lt=Ce[rt+1]*H,Pe=Ce[rt+2]*H;be+=Math.abs((oe[Be]-oe[Pe])*(oe[lt+1]-oe[Be+1])-(oe[Be]-oe[lt])*(oe[Pe+1]-oe[Be+1]))}return ve===0&&be===0?0:Math.abs((be-ve)/ve)};function ar(oe,Q,H,Ce){for(var Ee=0,_e=Q,ve=H-Ce;_e<H;_e+=Ce)Ee+=(oe[ve]-oe[_e])*(oe[_e+1]+oe[ve+1]),ve=_e;return Ee}T.flatten=function(oe){for(var Q=oe[0][0].length,H={vertices:[],holes:[],dimensions:Q},Ce=0,Ee=0;Ee<oe.length;Ee++){for(var _e=0;_e<oe[Ee].length;_e++)for(var ve=0;ve<Q;ve++)H.vertices.push(oe[Ee][_e][ve]);Ee>0&&(Ce+=oe[Ee-1].length,H.holes.push(Ce))}return H}},WFAs:function(Re,E){var i=Array.isArray;Re.exports=i},Wnft:function(Re,E,i){Re.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(Re,E,i){var T=i("juv8"),m=i("7GkX");function X(z,o){return z&&T(o,m(o),z)}Re.exports=X},XYm9:function(Re,E,i){var T=i("+K+b");function m(X,z){var o=z?T(X.buffer):X.buffer;return new X.constructor(o,X.byteOffset,X.byteLength)}Re.exports=m},"Xt/L":function(Re,E){function i(T,m,X){for(var z=-1,o=T==null?0:T.length;++z<o;)if(X(m,T[z]))return!0;return!1}Re.exports=i},Y8BV:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.callback;return z&&(m.dataArray=m.dataArray.filter(z)),m}},YO3V:function(Re,E,i){var T=i("NykK"),m=i("LcsW"),X=i("ExA7"),z="[object Object]",o=Function.prototype,Z=Object.prototype,D=o.toString,K=Z.hasOwnProperty,re=D.call(Object);function fe(Y){if(!X(Y)||T(Y)!=z)return!1;var Fe=m(Y);if(Fe===null)return!0;var We=K.call(Fe,"constructor")&&Fe.constructor;return typeof We=="function"&&We instanceof We&&D.call(We)==re}Re.exports=fe},Yk9n:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),X=i("GXnB"),z=i("Ztfv"),o=function(){function D(K){this._cb=K}return D.prototype.unwrap=function(){return this._cb()},D}();E.LazyServiceIdentifer=o;function Z(D){return function(K,re,fe){if(D===void 0)throw new Error(T.UNDEFINED_INJECT_ANNOTATION(K.name));var Y=new X.Metadata(m.INJECT_TAG,D);typeof fe=="number"?z.tagParameter(K,re,fe,Y):z.tagProperty(K,re,Y)}}E.inject=Z},Z1HP:function(Re,E,i){var T=i("ycre"),m=i("quyA"),X=i("q4HE");function z(o){return m(o)?X(o):T(o)}Re.exports=z},ZCgT:function(Re,E,i){var T=i("tLB3"),m=1/0,X=17976931348623157e292;function z(o){if(!o)return o===0?o:0;if(o=T(o),o===m||o===-m){var Z=o<0?-1:1;return Z*X}return o===o?o:0}Re.exports=z},ZK94:function(Re,E){Re.exports.RADIUS=6378137,Re.exports.FLATTENING=1/298.257223563,Re.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"copy",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"identity",function(){return D}),i.d(E,"transpose",function(){return K}),i.d(E,"invert",function(){return re}),i.d(E,"adjoint",function(){return fe}),i.d(E,"determinant",function(){return Y}),i.d(E,"multiply",function(){return Fe}),i.d(E,"translate",function(){return We}),i.d(E,"scale",function(){return ge}),i.d(E,"rotate",function(){return we}),i.d(E,"rotateX",function(){return dt}),i.d(E,"rotateY",function(){return ke}),i.d(E,"rotateZ",function(){return Et}),i.d(E,"fromTranslation",function(){return Ze}),i.d(E,"fromScaling",function(){return vt}),i.d(E,"fromRotation",function(){return Qe}),i.d(E,"fromXRotation",function(){return yt}),i.d(E,"fromYRotation",function(){return _t}),i.d(E,"fromZRotation",function(){return De}),i.d(E,"fromRotationTranslation",function(){return Ne}),i.d(E,"fromQuat2",function(){return Ue}),i.d(E,"getTranslation",function(){return st}),i.d(E,"getScaling",function(){return Le}),i.d(E,"getRotation",function(){return ut}),i.d(E,"fromRotationTranslationScale",function(){return Gt}),i.d(E,"fromRotationTranslationScaleOrigin",function(){return Kt}),i.d(E,"fromQuat",function(){return ar}),i.d(E,"frustum",function(){return oe}),i.d(E,"perspective",function(){return Q}),i.d(E,"perspectiveFromFieldOfView",function(){return H}),i.d(E,"ortho",function(){return Ce}),i.d(E,"lookAt",function(){return Ee}),i.d(E,"targetTo",function(){return _e}),i.d(E,"str",function(){return ve}),i.d(E,"frob",function(){return rt}),i.d(E,"add",function(){return $t}),i.d(E,"subtract",function(){return St}),i.d(E,"multiplyScalar",function(){return ye}),i.d(E,"multiplyScalarAndAdd",function(){return be}),i.d(E,"exactEquals",function(){return Be}),i.d(E,"equals",function(){return lt}),i.d(E,"mul",function(){return Pe}),i.d(E,"sub",function(){return ht});var T=i("yU0y");function m(){var w=new T.a(16);return T.a!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w}function X(w){var I=new T.a(16);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I[8]=w[8],I[9]=w[9],I[10]=w[10],I[11]=w[11],I[12]=w[12],I[13]=w[13],I[14]=w[14],I[15]=w[15],I}function z(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function o(w,I,q,ce,Ve,$e,gt,nt,kt,$,Ke,ae,et,zt,sr,ft){var pt=new T.a(16);return pt[0]=w,pt[1]=I,pt[2]=q,pt[3]=ce,pt[4]=Ve,pt[5]=$e,pt[6]=gt,pt[7]=nt,pt[8]=kt,pt[9]=$,pt[10]=Ke,pt[11]=ae,pt[12]=et,pt[13]=zt,pt[14]=sr,pt[15]=ft,pt}function Z(w,I,q,ce,Ve,$e,gt,nt,kt,$,Ke,ae,et,zt,sr,ft,pt){return w[0]=I,w[1]=q,w[2]=ce,w[3]=Ve,w[4]=$e,w[5]=gt,w[6]=nt,w[7]=kt,w[8]=$,w[9]=Ke,w[10]=ae,w[11]=et,w[12]=zt,w[13]=sr,w[14]=ft,w[15]=pt,w}function D(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function K(w,I){if(w===I){var q=I[1],ce=I[2],Ve=I[3],$e=I[6],gt=I[7],nt=I[11];w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=q,w[6]=I[9],w[7]=I[13],w[8]=ce,w[9]=$e,w[11]=I[14],w[12]=Ve,w[13]=gt,w[14]=nt}else w[0]=I[0],w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=I[1],w[5]=I[5],w[6]=I[9],w[7]=I[13],w[8]=I[2],w[9]=I[6],w[10]=I[10],w[11]=I[14],w[12]=I[3],w[13]=I[7],w[14]=I[11],w[15]=I[15];return w}function re(w,I){var q=I[0],ce=I[1],Ve=I[2],$e=I[3],gt=I[4],nt=I[5],kt=I[6],$=I[7],Ke=I[8],ae=I[9],et=I[10],zt=I[11],sr=I[12],ft=I[13],pt=I[14],At=I[15],mt=q*nt-ce*gt,Me=q*kt-Ve*gt,ct=q*$-$e*gt,qe=ce*kt-Ve*nt,Vt=ce*$-$e*nt,pr=Ve*$-$e*kt,Gr=Ke*ft-ae*sr,ur=Ke*pt-et*sr,zn=Ke*At-zt*sr,xn=ae*pt-et*ft,na=ae*At-zt*ft,fa=et*At-zt*pt,Hn=mt*fa-Me*na+ct*xn+qe*zn-Vt*ur+pr*Gr;return Hn?(Hn=1/Hn,w[0]=(nt*fa-kt*na+$*xn)*Hn,w[1]=(Ve*na-ce*fa-$e*xn)*Hn,w[2]=(ft*pr-pt*Vt+At*qe)*Hn,w[3]=(et*Vt-ae*pr-zt*qe)*Hn,w[4]=(kt*zn-gt*fa-$*ur)*Hn,w[5]=(q*fa-Ve*zn+$e*ur)*Hn,w[6]=(pt*ct-sr*pr-At*Me)*Hn,w[7]=(Ke*pr-et*ct+zt*Me)*Hn,w[8]=(gt*na-nt*zn+$*Gr)*Hn,w[9]=(ce*zn-q*na-$e*Gr)*Hn,w[10]=(sr*Vt-ft*ct+At*mt)*Hn,w[11]=(ae*ct-Ke*Vt-zt*mt)*Hn,w[12]=(nt*ur-gt*xn-kt*Gr)*Hn,w[13]=(q*xn-ce*ur+Ve*Gr)*Hn,w[14]=(ft*Me-sr*qe-pt*mt)*Hn,w[15]=(Ke*qe-ae*Me+et*mt)*Hn,w):null}function fe(w,I){var q=I[0],ce=I[1],Ve=I[2],$e=I[3],gt=I[4],nt=I[5],kt=I[6],$=I[7],Ke=I[8],ae=I[9],et=I[10],zt=I[11],sr=I[12],ft=I[13],pt=I[14],At=I[15];return w[0]=nt*(et*At-zt*pt)-ae*(kt*At-$*pt)+ft*(kt*zt-$*et),w[1]=-(ce*(et*At-zt*pt)-ae*(Ve*At-$e*pt)+ft*(Ve*zt-$e*et)),w[2]=ce*(kt*At-$*pt)-nt*(Ve*At-$e*pt)+ft*(Ve*$-$e*kt),w[3]=-(ce*(kt*zt-$*et)-nt*(Ve*zt-$e*et)+ae*(Ve*$-$e*kt)),w[4]=-(gt*(et*At-zt*pt)-Ke*(kt*At-$*pt)+sr*(kt*zt-$*et)),w[5]=q*(et*At-zt*pt)-Ke*(Ve*At-$e*pt)+sr*(Ve*zt-$e*et),w[6]=-(q*(kt*At-$*pt)-gt*(Ve*At-$e*pt)+sr*(Ve*$-$e*kt)),w[7]=q*(kt*zt-$*et)-gt*(Ve*zt-$e*et)+Ke*(Ve*$-$e*kt),w[8]=gt*(ae*At-zt*ft)-Ke*(nt*At-$*ft)+sr*(nt*zt-$*ae),w[9]=-(q*(ae*At-zt*ft)-Ke*(ce*At-$e*ft)+sr*(ce*zt-$e*ae)),w[10]=q*(nt*At-$*ft)-gt*(ce*At-$e*ft)+sr*(ce*$-$e*nt),w[11]=-(q*(nt*zt-$*ae)-gt*(ce*zt-$e*ae)+Ke*(ce*$-$e*nt)),w[12]=-(gt*(ae*pt-et*ft)-Ke*(nt*pt-kt*ft)+sr*(nt*et-kt*ae)),w[13]=q*(ae*pt-et*ft)-Ke*(ce*pt-Ve*ft)+sr*(ce*et-Ve*ae),w[14]=-(q*(nt*pt-kt*ft)-gt*(ce*pt-Ve*ft)+sr*(ce*kt-Ve*nt)),w[15]=q*(nt*et-kt*ae)-gt*(ce*et-Ve*ae)+Ke*(ce*kt-Ve*nt),w}function Y(w){var I=w[0],q=w[1],ce=w[2],Ve=w[3],$e=w[4],gt=w[5],nt=w[6],kt=w[7],$=w[8],Ke=w[9],ae=w[10],et=w[11],zt=w[12],sr=w[13],ft=w[14],pt=w[15],At=I*gt-q*$e,mt=I*nt-ce*$e,Me=I*kt-Ve*$e,ct=q*nt-ce*gt,qe=q*kt-Ve*gt,Vt=ce*kt-Ve*nt,pr=$*sr-Ke*zt,Gr=$*ft-ae*zt,ur=$*pt-et*zt,zn=Ke*ft-ae*sr,xn=Ke*pt-et*sr,na=ae*pt-et*ft;return At*na-mt*xn+Me*zn+ct*ur-qe*Gr+Vt*pr}function Fe(w,I,q){var ce=I[0],Ve=I[1],$e=I[2],gt=I[3],nt=I[4],kt=I[5],$=I[6],Ke=I[7],ae=I[8],et=I[9],zt=I[10],sr=I[11],ft=I[12],pt=I[13],At=I[14],mt=I[15],Me=q[0],ct=q[1],qe=q[2],Vt=q[3];return w[0]=Me*ce+ct*nt+qe*ae+Vt*ft,w[1]=Me*Ve+ct*kt+qe*et+Vt*pt,w[2]=Me*$e+ct*$+qe*zt+Vt*At,w[3]=Me*gt+ct*Ke+qe*sr+Vt*mt,Me=q[4],ct=q[5],qe=q[6],Vt=q[7],w[4]=Me*ce+ct*nt+qe*ae+Vt*ft,w[5]=Me*Ve+ct*kt+qe*et+Vt*pt,w[6]=Me*$e+ct*$+qe*zt+Vt*At,w[7]=Me*gt+ct*Ke+qe*sr+Vt*mt,Me=q[8],ct=q[9],qe=q[10],Vt=q[11],w[8]=Me*ce+ct*nt+qe*ae+Vt*ft,w[9]=Me*Ve+ct*kt+qe*et+Vt*pt,w[10]=Me*$e+ct*$+qe*zt+Vt*At,w[11]=Me*gt+ct*Ke+qe*sr+Vt*mt,Me=q[12],ct=q[13],qe=q[14],Vt=q[15],w[12]=Me*ce+ct*nt+qe*ae+Vt*ft,w[13]=Me*Ve+ct*kt+qe*et+Vt*pt,w[14]=Me*$e+ct*$+qe*zt+Vt*At,w[15]=Me*gt+ct*Ke+qe*sr+Vt*mt,w}function We(w,I,q){var ce=q[0],Ve=q[1],$e=q[2],gt,nt,kt,$,Ke,ae,et,zt,sr,ft,pt,At;return I===w?(w[12]=I[0]*ce+I[4]*Ve+I[8]*$e+I[12],w[13]=I[1]*ce+I[5]*Ve+I[9]*$e+I[13],w[14]=I[2]*ce+I[6]*Ve+I[10]*$e+I[14],w[15]=I[3]*ce+I[7]*Ve+I[11]*$e+I[15]):(gt=I[0],nt=I[1],kt=I[2],$=I[3],Ke=I[4],ae=I[5],et=I[6],zt=I[7],sr=I[8],ft=I[9],pt=I[10],At=I[11],w[0]=gt,w[1]=nt,w[2]=kt,w[3]=$,w[4]=Ke,w[5]=ae,w[6]=et,w[7]=zt,w[8]=sr,w[9]=ft,w[10]=pt,w[11]=At,w[12]=gt*ce+Ke*Ve+sr*$e+I[12],w[13]=nt*ce+ae*Ve+ft*$e+I[13],w[14]=kt*ce+et*Ve+pt*$e+I[14],w[15]=$*ce+zt*Ve+At*$e+I[15]),w}function ge(w,I,q){var ce=q[0],Ve=q[1],$e=q[2];return w[0]=I[0]*ce,w[1]=I[1]*ce,w[2]=I[2]*ce,w[3]=I[3]*ce,w[4]=I[4]*Ve,w[5]=I[5]*Ve,w[6]=I[6]*Ve,w[7]=I[7]*Ve,w[8]=I[8]*$e,w[9]=I[9]*$e,w[10]=I[10]*$e,w[11]=I[11]*$e,w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function we(w,I,q,ce){var Ve=ce[0],$e=ce[1],gt=ce[2],nt=Math.hypot(Ve,$e,gt),kt,$,Ke,ae,et,zt,sr,ft,pt,At,mt,Me,ct,qe,Vt,pr,Gr,ur,zn,xn,na,fa,Hn,Gn;return nt<T.b?null:(nt=1/nt,Ve*=nt,$e*=nt,gt*=nt,kt=Math.sin(q),$=Math.cos(q),Ke=1-$,ae=I[0],et=I[1],zt=I[2],sr=I[3],ft=I[4],pt=I[5],At=I[6],mt=I[7],Me=I[8],ct=I[9],qe=I[10],Vt=I[11],pr=Ve*Ve*Ke+$,Gr=$e*Ve*Ke+gt*kt,ur=gt*Ve*Ke-$e*kt,zn=Ve*$e*Ke-gt*kt,xn=$e*$e*Ke+$,na=gt*$e*Ke+Ve*kt,fa=Ve*gt*Ke+$e*kt,Hn=$e*gt*Ke-Ve*kt,Gn=gt*gt*Ke+$,w[0]=ae*pr+ft*Gr+Me*ur,w[1]=et*pr+pt*Gr+ct*ur,w[2]=zt*pr+At*Gr+qe*ur,w[3]=sr*pr+mt*Gr+Vt*ur,w[4]=ae*zn+ft*xn+Me*na,w[5]=et*zn+pt*xn+ct*na,w[6]=zt*zn+At*xn+qe*na,w[7]=sr*zn+mt*xn+Vt*na,w[8]=ae*fa+ft*Hn+Me*Gn,w[9]=et*fa+pt*Hn+ct*Gn,w[10]=zt*fa+At*Hn+qe*Gn,w[11]=sr*fa+mt*Hn+Vt*Gn,I!==w&&(w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w)}function dt(w,I,q){var ce=Math.sin(q),Ve=Math.cos(q),$e=I[4],gt=I[5],nt=I[6],kt=I[7],$=I[8],Ke=I[9],ae=I[10],et=I[11];return I!==w&&(w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[4]=$e*Ve+$*ce,w[5]=gt*Ve+Ke*ce,w[6]=nt*Ve+ae*ce,w[7]=kt*Ve+et*ce,w[8]=$*Ve-$e*ce,w[9]=Ke*Ve-gt*ce,w[10]=ae*Ve-nt*ce,w[11]=et*Ve-kt*ce,w}function ke(w,I,q){var ce=Math.sin(q),Ve=Math.cos(q),$e=I[0],gt=I[1],nt=I[2],kt=I[3],$=I[8],Ke=I[9],ae=I[10],et=I[11];return I!==w&&(w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=$e*Ve-$*ce,w[1]=gt*Ve-Ke*ce,w[2]=nt*Ve-ae*ce,w[3]=kt*Ve-et*ce,w[8]=$e*ce+$*Ve,w[9]=gt*ce+Ke*Ve,w[10]=nt*ce+ae*Ve,w[11]=kt*ce+et*Ve,w}function Et(w,I,q){var ce=Math.sin(q),Ve=Math.cos(q),$e=I[0],gt=I[1],nt=I[2],kt=I[3],$=I[4],Ke=I[5],ae=I[6],et=I[7];return I!==w&&(w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=$e*Ve+$*ce,w[1]=gt*Ve+Ke*ce,w[2]=nt*Ve+ae*ce,w[3]=kt*Ve+et*ce,w[4]=$*Ve-$e*ce,w[5]=Ke*Ve-gt*ce,w[6]=ae*Ve-nt*ce,w[7]=et*Ve-kt*ce,w}function Ze(w,I){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=I[0],w[13]=I[1],w[14]=I[2],w[15]=1,w}function vt(w,I){return w[0]=I[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=I[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Qe(w,I,q){var ce=q[0],Ve=q[1],$e=q[2],gt=Math.hypot(ce,Ve,$e),nt,kt,$;return gt<T.b?null:(gt=1/gt,ce*=gt,Ve*=gt,$e*=gt,nt=Math.sin(I),kt=Math.cos(I),$=1-kt,w[0]=ce*ce*$+kt,w[1]=Ve*ce*$+$e*nt,w[2]=$e*ce*$-Ve*nt,w[3]=0,w[4]=ce*Ve*$-$e*nt,w[5]=Ve*Ve*$+kt,w[6]=$e*Ve*$+ce*nt,w[7]=0,w[8]=ce*$e*$+Ve*nt,w[9]=Ve*$e*$-ce*nt,w[10]=$e*$e*$+kt,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)}function yt(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ce,w[6]=q,w[7]=0,w[8]=0,w[9]=-q,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function _t(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=0,w[2]=-q,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=q,w[9]=0,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function De(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=q,w[2]=0,w[3]=0,w[4]=-q,w[5]=ce,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Ne(w,I,q){var ce=I[0],Ve=I[1],$e=I[2],gt=I[3],nt=ce+ce,kt=Ve+Ve,$=$e+$e,Ke=ce*nt,ae=ce*kt,et=ce*$,zt=Ve*kt,sr=Ve*$,ft=$e*$,pt=gt*nt,At=gt*kt,mt=gt*$;return w[0]=1-(zt+ft),w[1]=ae+mt,w[2]=et-At,w[3]=0,w[4]=ae-mt,w[5]=1-(Ke+ft),w[6]=sr+pt,w[7]=0,w[8]=et+At,w[9]=sr-pt,w[10]=1-(Ke+zt),w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function Ue(w,I){var q=new T.a(3),ce=-I[0],Ve=-I[1],$e=-I[2],gt=I[3],nt=I[4],kt=I[5],$=I[6],Ke=I[7],ae=ce*ce+Ve*Ve+$e*$e+gt*gt;return ae>0?(q[0]=(nt*gt+Ke*ce+kt*$e-$*Ve)*2/ae,q[1]=(kt*gt+Ke*Ve+$*ce-nt*$e)*2/ae,q[2]=($*gt+Ke*$e+nt*Ve-kt*ce)*2/ae):(q[0]=(nt*gt+Ke*ce+kt*$e-$*Ve)*2,q[1]=(kt*gt+Ke*Ve+$*ce-nt*$e)*2,q[2]=($*gt+Ke*$e+nt*Ve-kt*ce)*2),Ne(w,I,q),w}function st(w,I){return w[0]=I[12],w[1]=I[13],w[2]=I[14],w}function Le(w,I){var q=I[0],ce=I[1],Ve=I[2],$e=I[4],gt=I[5],nt=I[6],kt=I[8],$=I[9],Ke=I[10];return w[0]=Math.hypot(q,ce,Ve),w[1]=Math.hypot($e,gt,nt),w[2]=Math.hypot(kt,$,Ke),w}function ut(w,I){var q=new T.a(3);Le(q,I);var ce=1/q[0],Ve=1/q[1],$e=1/q[2],gt=I[0]*ce,nt=I[1]*Ve,kt=I[2]*$e,$=I[4]*ce,Ke=I[5]*Ve,ae=I[6]*$e,et=I[8]*ce,zt=I[9]*Ve,sr=I[10]*$e,ft=gt+Ke+sr,pt=0;return ft>0?(pt=Math.sqrt(ft+1)*2,w[3]=.25*pt,w[0]=(ae-zt)/pt,w[1]=(et-kt)/pt,w[2]=(nt-$)/pt):gt>Ke&&gt>sr?(pt=Math.sqrt(1+gt-Ke-sr)*2,w[3]=(ae-zt)/pt,w[0]=.25*pt,w[1]=(nt+$)/pt,w[2]=(et+kt)/pt):Ke>sr?(pt=Math.sqrt(1+Ke-gt-sr)*2,w[3]=(et-kt)/pt,w[0]=(nt+$)/pt,w[1]=.25*pt,w[2]=(ae+zt)/pt):(pt=Math.sqrt(1+sr-gt-Ke)*2,w[3]=(nt-$)/pt,w[0]=(et+kt)/pt,w[1]=(ae+zt)/pt,w[2]=.25*pt),w}function Gt(w,I,q,ce){var Ve=I[0],$e=I[1],gt=I[2],nt=I[3],kt=Ve+Ve,$=$e+$e,Ke=gt+gt,ae=Ve*kt,et=Ve*$,zt=Ve*Ke,sr=$e*$,ft=$e*Ke,pt=gt*Ke,At=nt*kt,mt=nt*$,Me=nt*Ke,ct=ce[0],qe=ce[1],Vt=ce[2];return w[0]=(1-(sr+pt))*ct,w[1]=(et+Me)*ct,w[2]=(zt-mt)*ct,w[3]=0,w[4]=(et-Me)*qe,w[5]=(1-(ae+pt))*qe,w[6]=(ft+At)*qe,w[7]=0,w[8]=(zt+mt)*Vt,w[9]=(ft-At)*Vt,w[10]=(1-(ae+sr))*Vt,w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function Kt(w,I,q,ce,Ve){var $e=I[0],gt=I[1],nt=I[2],kt=I[3],$=$e+$e,Ke=gt+gt,ae=nt+nt,et=$e*$,zt=$e*Ke,sr=$e*ae,ft=gt*Ke,pt=gt*ae,At=nt*ae,mt=kt*$,Me=kt*Ke,ct=kt*ae,qe=ce[0],Vt=ce[1],pr=ce[2],Gr=Ve[0],ur=Ve[1],zn=Ve[2],xn=(1-(ft+At))*qe,na=(zt+ct)*qe,fa=(sr-Me)*qe,Hn=(zt-ct)*Vt,Gn=(1-(et+At))*Vt,F=(pt+mt)*Vt,W=(sr+Me)*pr,le=(pt-mt)*pr,pe=(1-(et+ft))*pr;return w[0]=xn,w[1]=na,w[2]=fa,w[3]=0,w[4]=Hn,w[5]=Gn,w[6]=F,w[7]=0,w[8]=W,w[9]=le,w[10]=pe,w[11]=0,w[12]=q[0]+Gr-(xn*Gr+Hn*ur+W*zn),w[13]=q[1]+ur-(na*Gr+Gn*ur+le*zn),w[14]=q[2]+zn-(fa*Gr+F*ur+pe*zn),w[15]=1,w}function ar(w,I){var q=I[0],ce=I[1],Ve=I[2],$e=I[3],gt=q+q,nt=ce+ce,kt=Ve+Ve,$=q*gt,Ke=ce*gt,ae=ce*nt,et=Ve*gt,zt=Ve*nt,sr=Ve*kt,ft=$e*gt,pt=$e*nt,At=$e*kt;return w[0]=1-ae-sr,w[1]=Ke+At,w[2]=et-pt,w[3]=0,w[4]=Ke-At,w[5]=1-$-sr,w[6]=zt+ft,w[7]=0,w[8]=et+pt,w[9]=zt-ft,w[10]=1-$-ae,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function oe(w,I,q,ce,Ve,$e,gt){var nt=1/(q-I),kt=1/(Ve-ce),$=1/($e-gt);return w[0]=$e*2*nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$e*2*kt,w[6]=0,w[7]=0,w[8]=(q+I)*nt,w[9]=(Ve+ce)*kt,w[10]=(gt+$e)*$,w[11]=-1,w[12]=0,w[13]=0,w[14]=gt*$e*2*$,w[15]=0,w}function Q(w,I,q,ce,Ve){var $e=1/Math.tan(I/2),gt;return w[0]=$e/q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$e,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,Ve!=null&&Ve!==Infinity?(gt=1/(ce-Ve),w[10]=(Ve+ce)*gt,w[14]=2*Ve*ce*gt):(w[10]=-1,w[14]=-2*ce),w}function H(w,I,q,ce){var Ve=Math.tan(I.upDegrees*Math.PI/180),$e=Math.tan(I.downDegrees*Math.PI/180),gt=Math.tan(I.leftDegrees*Math.PI/180),nt=Math.tan(I.rightDegrees*Math.PI/180),kt=2/(gt+nt),$=2/(Ve+$e);return w[0]=kt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$,w[6]=0,w[7]=0,w[8]=-((gt-nt)*kt*.5),w[9]=(Ve-$e)*$*.5,w[10]=ce/(q-ce),w[11]=-1,w[12]=0,w[13]=0,w[14]=ce*q/(q-ce),w[15]=0,w}function Ce(w,I,q,ce,Ve,$e,gt){var nt=1/(I-q),kt=1/(ce-Ve),$=1/($e-gt);return w[0]=-2*nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*kt,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*$,w[11]=0,w[12]=(I+q)*nt,w[13]=(Ve+ce)*kt,w[14]=(gt+$e)*$,w[15]=1,w}function Ee(w,I,q,ce){var Ve,$e,gt,nt,kt,$,Ke,ae,et,zt,sr=I[0],ft=I[1],pt=I[2],At=ce[0],mt=ce[1],Me=ce[2],ct=q[0],qe=q[1],Vt=q[2];return Math.abs(sr-ct)<T.b&&Math.abs(ft-qe)<T.b&&Math.abs(pt-Vt)<T.b?D(w):(Ke=sr-ct,ae=ft-qe,et=pt-Vt,zt=1/Math.hypot(Ke,ae,et),Ke*=zt,ae*=zt,et*=zt,Ve=mt*et-Me*ae,$e=Me*Ke-At*et,gt=At*ae-mt*Ke,zt=Math.hypot(Ve,$e,gt),zt?(zt=1/zt,Ve*=zt,$e*=zt,gt*=zt):(Ve=0,$e=0,gt=0),nt=ae*gt-et*$e,kt=et*Ve-Ke*gt,$=Ke*$e-ae*Ve,zt=Math.hypot(nt,kt,$),zt?(zt=1/zt,nt*=zt,kt*=zt,$*=zt):(nt=0,kt=0,$=0),w[0]=Ve,w[1]=nt,w[2]=Ke,w[3]=0,w[4]=$e,w[5]=kt,w[6]=ae,w[7]=0,w[8]=gt,w[9]=$,w[10]=et,w[11]=0,w[12]=-(Ve*sr+$e*ft+gt*pt),w[13]=-(nt*sr+kt*ft+$*pt),w[14]=-(Ke*sr+ae*ft+et*pt),w[15]=1,w)}function _e(w,I,q,ce){var Ve=I[0],$e=I[1],gt=I[2],nt=ce[0],kt=ce[1],$=ce[2],Ke=Ve-q[0],ae=$e-q[1],et=gt-q[2],zt=Ke*Ke+ae*ae+et*et;zt>0&&(zt=1/Math.sqrt(zt),Ke*=zt,ae*=zt,et*=zt);var sr=kt*et-$*ae,ft=$*Ke-nt*et,pt=nt*ae-kt*Ke;return zt=sr*sr+ft*ft+pt*pt,zt>0&&(zt=1/Math.sqrt(zt),sr*=zt,ft*=zt,pt*=zt),w[0]=sr,w[1]=ft,w[2]=pt,w[3]=0,w[4]=ae*pt-et*ft,w[5]=et*sr-Ke*pt,w[6]=Ke*ft-ae*sr,w[7]=0,w[8]=Ke,w[9]=ae,w[10]=et,w[11]=0,w[12]=Ve,w[13]=$e,w[14]=gt,w[15]=1,w}function ve(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"}function rt(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])}function $t(w,I,q){return w[0]=I[0]+q[0],w[1]=I[1]+q[1],w[2]=I[2]+q[2],w[3]=I[3]+q[3],w[4]=I[4]+q[4],w[5]=I[5]+q[5],w[6]=I[6]+q[6],w[7]=I[7]+q[7],w[8]=I[8]+q[8],w[9]=I[9]+q[9],w[10]=I[10]+q[10],w[11]=I[11]+q[11],w[12]=I[12]+q[12],w[13]=I[13]+q[13],w[14]=I[14]+q[14],w[15]=I[15]+q[15],w}function St(w,I,q){return w[0]=I[0]-q[0],w[1]=I[1]-q[1],w[2]=I[2]-q[2],w[3]=I[3]-q[3],w[4]=I[4]-q[4],w[5]=I[5]-q[5],w[6]=I[6]-q[6],w[7]=I[7]-q[7],w[8]=I[8]-q[8],w[9]=I[9]-q[9],w[10]=I[10]-q[10],w[11]=I[11]-q[11],w[12]=I[12]-q[12],w[13]=I[13]-q[13],w[14]=I[14]-q[14],w[15]=I[15]-q[15],w}function ye(w,I,q){return w[0]=I[0]*q,w[1]=I[1]*q,w[2]=I[2]*q,w[3]=I[3]*q,w[4]=I[4]*q,w[5]=I[5]*q,w[6]=I[6]*q,w[7]=I[7]*q,w[8]=I[8]*q,w[9]=I[9]*q,w[10]=I[10]*q,w[11]=I[11]*q,w[12]=I[12]*q,w[13]=I[13]*q,w[14]=I[14]*q,w[15]=I[15]*q,w}function be(w,I,q,ce){return w[0]=I[0]+q[0]*ce,w[1]=I[1]+q[1]*ce,w[2]=I[2]+q[2]*ce,w[3]=I[3]+q[3]*ce,w[4]=I[4]+q[4]*ce,w[5]=I[5]+q[5]*ce,w[6]=I[6]+q[6]*ce,w[7]=I[7]+q[7]*ce,w[8]=I[8]+q[8]*ce,w[9]=I[9]+q[9]*ce,w[10]=I[10]+q[10]*ce,w[11]=I[11]+q[11]*ce,w[12]=I[12]+q[12]*ce,w[13]=I[13]+q[13]*ce,w[14]=I[14]+q[14]*ce,w[15]=I[15]+q[15]*ce,w}function Be(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]&&w[8]===I[8]&&w[9]===I[9]&&w[10]===I[10]&&w[11]===I[11]&&w[12]===I[12]&&w[13]===I[13]&&w[14]===I[14]&&w[15]===I[15]}function lt(w,I){var q=w[0],ce=w[1],Ve=w[2],$e=w[3],gt=w[4],nt=w[5],kt=w[6],$=w[7],Ke=w[8],ae=w[9],et=w[10],zt=w[11],sr=w[12],ft=w[13],pt=w[14],At=w[15],mt=I[0],Me=I[1],ct=I[2],qe=I[3],Vt=I[4],pr=I[5],Gr=I[6],ur=I[7],zn=I[8],xn=I[9],na=I[10],fa=I[11],Hn=I[12],Gn=I[13],F=I[14],W=I[15];return Math.abs(q-mt)<=T.b*Math.max(1,Math.abs(q),Math.abs(mt))&&Math.abs(ce-Me)<=T.b*Math.max(1,Math.abs(ce),Math.abs(Me))&&Math.abs(Ve-ct)<=T.b*Math.max(1,Math.abs(Ve),Math.abs(ct))&&Math.abs($e-qe)<=T.b*Math.max(1,Math.abs($e),Math.abs(qe))&&Math.abs(gt-Vt)<=T.b*Math.max(1,Math.abs(gt),Math.abs(Vt))&&Math.abs(nt-pr)<=T.b*Math.max(1,Math.abs(nt),Math.abs(pr))&&Math.abs(kt-Gr)<=T.b*Math.max(1,Math.abs(kt),Math.abs(Gr))&&Math.abs($-ur)<=T.b*Math.max(1,Math.abs($),Math.abs(ur))&&Math.abs(Ke-zn)<=T.b*Math.max(1,Math.abs(Ke),Math.abs(zn))&&Math.abs(ae-xn)<=T.b*Math.max(1,Math.abs(ae),Math.abs(xn))&&Math.abs(et-na)<=T.b*Math.max(1,Math.abs(et),Math.abs(na))&&Math.abs(zt-fa)<=T.b*Math.max(1,Math.abs(zt),Math.abs(fa))&&Math.abs(sr-Hn)<=T.b*Math.max(1,Math.abs(sr),Math.abs(Hn))&&Math.abs(ft-Gn)<=T.b*Math.max(1,Math.abs(ft),Math.abs(Gn))&&Math.abs(pt-F)<=T.b*Math.max(1,Math.abs(pt),Math.abs(F))&&Math.abs(At-W)<=T.b*Math.max(1,Math.abs(At),Math.abs(W))}var Pe=Fe,ht=St},Ztfv:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function X(re,fe,Y,Fe){var We=m.TAGGED;o(We,re,fe,Fe,Y)}E.tagParameter=X;function z(re,fe,Y){var Fe=m.TAGGED_PROP;o(Fe,re.constructor,fe,Y)}E.tagProperty=z;function o(re,fe,Y,Fe,We){var ge={},we=typeof We=="number",dt=We!==void 0&&we?We.toString():Y;if(we&&Y!==void 0)throw new Error(T.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(re,fe)&&(ge=Reflect.getMetadata(re,fe));var ke=ge[dt];if(!Array.isArray(ke))ke=[];else for(var Et=0,Ze=ke;Et<Ze.length;Et++){var vt=Ze[Et];if(vt.key===Fe.key)throw new Error(T.DUPLICATED_METADATA+" "+vt.key.toString())}ke.push(Fe),ge[dt]=ke,Reflect.defineMetadata(re,ge,fe)}function Z(re,fe){Reflect.decorate(re,fe)}function D(re,fe){return function(Y,Fe){fe(Y,Fe,re)}}function K(re,fe,Y){typeof Y=="number"?Z([D(Y,re)],fe):typeof Y=="string"?Reflect.decorate([re],fe,Y):Z([re],fe)}E.decorate=K},ZxFD:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return K}),i.d(E,"multiply",function(){return re}),i.d(E,"divide",function(){return fe}),i.d(E,"ceil",function(){return Y}),i.d(E,"floor",function(){return Fe}),i.d(E,"min",function(){return We}),i.d(E,"max",function(){return ge}),i.d(E,"round",function(){return we}),i.d(E,"scale",function(){return dt}),i.d(E,"scaleAndAdd",function(){return ke}),i.d(E,"distance",function(){return Et}),i.d(E,"squaredDistance",function(){return Ze}),i.d(E,"length",function(){return vt}),i.d(E,"squaredLength",function(){return Qe}),i.d(E,"negate",function(){return yt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return De}),i.d(E,"dot",function(){return Ne}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"random",function(){return Le}),i.d(E,"transformMat2",function(){return ut}),i.d(E,"transformMat2d",function(){return Gt}),i.d(E,"transformMat3",function(){return Kt}),i.d(E,"transformMat4",function(){return ar}),i.d(E,"rotate",function(){return oe}),i.d(E,"angle",function(){return Q}),i.d(E,"zero",function(){return H}),i.d(E,"str",function(){return Ce}),i.d(E,"exactEquals",function(){return Ee}),i.d(E,"equals",function(){return _e}),i.d(E,"len",function(){return ve}),i.d(E,"sub",function(){return rt}),i.d(E,"mul",function(){return $t}),i.d(E,"div",function(){return St}),i.d(E,"dist",function(){return ye}),i.d(E,"sqrDist",function(){return be}),i.d(E,"sqrLen",function(){return Be}),i.d(E,"forEach",function(){return lt});var T=i("yU0y");function m(){var Pe=new T.a(2);return T.a!=Float32Array&&(Pe[0]=0,Pe[1]=0),Pe}function X(Pe){var ht=new T.a(2);return ht[0]=Pe[0],ht[1]=Pe[1],ht}function z(Pe,ht){var w=new T.a(2);return w[0]=Pe,w[1]=ht,w}function o(Pe,ht){return Pe[0]=ht[0],Pe[1]=ht[1],Pe}function Z(Pe,ht,w){return Pe[0]=ht,Pe[1]=w,Pe}function D(Pe,ht,w){return Pe[0]=ht[0]+w[0],Pe[1]=ht[1]+w[1],Pe}function K(Pe,ht,w){return Pe[0]=ht[0]-w[0],Pe[1]=ht[1]-w[1],Pe}function re(Pe,ht,w){return Pe[0]=ht[0]*w[0],Pe[1]=ht[1]*w[1],Pe}function fe(Pe,ht,w){return Pe[0]=ht[0]/w[0],Pe[1]=ht[1]/w[1],Pe}function Y(Pe,ht){return Pe[0]=Math.ceil(ht[0]),Pe[1]=Math.ceil(ht[1]),Pe}function Fe(Pe,ht){return Pe[0]=Math.floor(ht[0]),Pe[1]=Math.floor(ht[1]),Pe}function We(Pe,ht,w){return Pe[0]=Math.min(ht[0],w[0]),Pe[1]=Math.min(ht[1],w[1]),Pe}function ge(Pe,ht,w){return Pe[0]=Math.max(ht[0],w[0]),Pe[1]=Math.max(ht[1],w[1]),Pe}function we(Pe,ht){return Pe[0]=Math.round(ht[0]),Pe[1]=Math.round(ht[1]),Pe}function dt(Pe,ht,w){return Pe[0]=ht[0]*w,Pe[1]=ht[1]*w,Pe}function ke(Pe,ht,w,I){return Pe[0]=ht[0]+w[0]*I,Pe[1]=ht[1]+w[1]*I,Pe}function Et(Pe,ht){var w=ht[0]-Pe[0],I=ht[1]-Pe[1];return Math.hypot(w,I)}function Ze(Pe,ht){var w=ht[0]-Pe[0],I=ht[1]-Pe[1];return w*w+I*I}function vt(Pe){var ht=Pe[0],w=Pe[1];return Math.hypot(ht,w)}function Qe(Pe){var ht=Pe[0],w=Pe[1];return ht*ht+w*w}function yt(Pe,ht){return Pe[0]=-ht[0],Pe[1]=-ht[1],Pe}function _t(Pe,ht){return Pe[0]=1/ht[0],Pe[1]=1/ht[1],Pe}function De(Pe,ht){var w=ht[0],I=ht[1],q=w*w+I*I;return q>0&&(q=1/Math.sqrt(q)),Pe[0]=ht[0]*q,Pe[1]=ht[1]*q,Pe}function Ne(Pe,ht){return Pe[0]*ht[0]+Pe[1]*ht[1]}function Ue(Pe,ht,w){var I=ht[0]*w[1]-ht[1]*w[0];return Pe[0]=Pe[1]=0,Pe[2]=I,Pe}function st(Pe,ht,w,I){var q=ht[0],ce=ht[1];return Pe[0]=q+I*(w[0]-q),Pe[1]=ce+I*(w[1]-ce),Pe}function Le(Pe,ht){ht=ht||1;var w=T.c()*2*Math.PI;return Pe[0]=Math.cos(w)*ht,Pe[1]=Math.sin(w)*ht,Pe}function ut(Pe,ht,w){var I=ht[0],q=ht[1];return Pe[0]=w[0]*I+w[2]*q,Pe[1]=w[1]*I+w[3]*q,Pe}function Gt(Pe,ht,w){var I=ht[0],q=ht[1];return Pe[0]=w[0]*I+w[2]*q+w[4],Pe[1]=w[1]*I+w[3]*q+w[5],Pe}function Kt(Pe,ht,w){var I=ht[0],q=ht[1];return Pe[0]=w[0]*I+w[3]*q+w[6],Pe[1]=w[1]*I+w[4]*q+w[7],Pe}function ar(Pe,ht,w){var I=ht[0],q=ht[1];return Pe[0]=w[0]*I+w[4]*q+w[12],Pe[1]=w[1]*I+w[5]*q+w[13],Pe}function oe(Pe,ht,w,I){var q=ht[0]-w[0],ce=ht[1]-w[1],Ve=Math.sin(I),$e=Math.cos(I);return Pe[0]=q*$e-ce*Ve+w[0],Pe[1]=q*Ve+ce*$e+w[1],Pe}function Q(Pe,ht){var w=Pe[0],I=Pe[1],q=ht[0],ce=ht[1],Ve=Math.sqrt(w*w+I*I)*Math.sqrt(q*q+ce*ce),$e=Ve&&(w*q+I*ce)/Ve;return Math.acos(Math.min(Math.max($e,-1),1))}function H(Pe){return Pe[0]=0,Pe[1]=0,Pe}function Ce(Pe){return"vec2("+Pe[0]+", "+Pe[1]+")"}function Ee(Pe,ht){return Pe[0]===ht[0]&&Pe[1]===ht[1]}function _e(Pe,ht){var w=Pe[0],I=Pe[1],q=ht[0],ce=ht[1];return Math.abs(w-q)<=T.b*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(I-ce)<=T.b*Math.max(1,Math.abs(I),Math.abs(ce))}var ve=vt,rt=K,$t=re,St=fe,ye=Et,be=Ze,Be=Qe,lt=function(){var Pe=m();return function(ht,w,I,q,ce,Ve){var $e,gt;for(w||(w=2),I||(I=0),q?gt=Math.min(q*w+I,ht.length):gt=ht.length,$e=I;$e<gt;$e+=w)Pe[0]=ht[$e],Pe[1]=ht[$e+1],ce(Pe,Pe,Ve),ht[$e]=Pe[0],ht[$e+1]=Pe[1];return ht}}()},ZzCi:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.NAMED_TAG,o);typeof K=="number"?X.tagParameter(Z,D,K,re):X.tagProperty(Z,D,re)}}E.named=z},a5Wf:function(Re,E,i){"use strict";i.r(E);var T=i("IzEo"),m=i("bx4M"),X=i("14J3"),z=i("BMrR"),o=i("jCWc"),Z=i("kPKH"),D=i("1OyB"),K=i("vuIU"),re=i("Ji7U"),fe=i("LK+K"),Y=i("aHsQ"),Fe=i("sGsY"),We=i("9kvl"),ge=i("q1tI"),we=i.n(ge),dt=i("HTcj"),ke=i("ZhIB"),Et=i.n(ke),Ze=i("yP6+"),vt=i("wx14");function Qe(v){var h=v.style;h.height="100%";var c=parseInt("".concat(getComputedStyle(v).height),10),p=parseInt("".concat(getComputedStyle(v).paddingTop),10)+parseInt("".concat(getComputedStyle(v).paddingBottom),10);return c-p}function yt(v){if(!v)return 0;var h=v,c=Qe(h),p=h.parentNode;return p&&(c=Qe(p)),c}function _t(){return function(v){var h=function(c){Object(re.a)(y,c);var p=Object(fe.a)(y);function y(){var P;Object(D.a)(this,y);for(var N=arguments.length,ee=new Array(N),B=0;B<N;B++)ee[B]=arguments[B];return P=p.call.apply(p,[this].concat(ee)),P.state={computedHeight:0},P.root=null,P.handleRoot=function(J){P.root=J},P}return Object(K.a)(y,[{key:"componentDidMount",value:function(){var N=this.props.height;if(!N&&this.root){var ee=yt(this.root);this.setState({computedHeight:ee}),ee<1&&(ee=yt(this.root),this.setState({computedHeight:ee}))}}},{key:"render",value:function(){var N=this.props.height,ee=this.state.computedHeight,B=N||ee;return we.a.createElement("div",{ref:this.handleRoot},B>0&&we.a.createElement(v,Object(vt.a)({},this.props,{height:B})))}}]),y}(we.a.Component);return h}}var De=_t,Ne=Ze.Guide.Arc,Ue=Ze.Guide.Html,st=Ze.Guide.Line,Le=function(h){switch(h){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};Ze.Shape.registerShape&&Ze.Shape.registerShape("point","pointer",{drawShape:function(h,c){var p=h.points[0];p=this.parsePoint(p);var y=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:y.x,y1:y.y,x2:p.x,y2:p.y,stroke:h.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:y.x,y:y.y,r:6,stroke:h.color,lineWidth:3,fill:"#fff"}})}});var ut=function(h){var c=h.title,p=h.height,y=p===void 0?1:p,P=h.percent,N=h.forceFit,ee=N===void 0?!0:N,B=h.formatter,J=B===void 0?Le:B,he=h.color,Ye=he===void 0?"#2F9CFF":he,He=h.bgColor,It=He===void 0?"#F0F2F5":He,Ft={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},Yt=[{value:P/10}],lr=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((Yt[0].value*10).toFixed(2),`%
    </div>
  </div>`)},_r={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return we.a.createElement(Ze.Chart,{height:y,data:Yt,scale:Ft,padding:[-16,0,16,0],forceFit:ee},we.a.createElement(Ze.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),we.a.createElement(Ze.Axis,{name:"1",line:void 0}),we.a.createElement(Ze.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:J,textStyle:_r}}),we.a.createElement(Ze.Guide,null,we.a.createElement(st,{start:[3,.905],end:[3,.85],lineStyle:{stroke:Ye,lineDash:void 0,lineWidth:2}}),we.a.createElement(st,{start:[5,.905],end:[5,.85],lineStyle:{stroke:Ye,lineDash:void 0,lineWidth:3}}),we.a.createElement(st,{start:[7,.905],end:[7,.85],lineStyle:{stroke:Ye,lineDash:void 0,lineWidth:3}}),we.a.createElement(Ne,{start:[0,.965],end:[10,.965],style:{stroke:It,lineWidth:10}}),we.a.createElement(Ne,{start:[0,.965],end:[Yt[0].value,.965],style:{stroke:Ye,lineWidth:10}}),we.a.createElement(Ue,{position:["50%","95%"],html:lr()})),we.a.createElement(Ze.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:Ye,active:!1}))},Gt=De()(ut),Kt=i("VTBJ"),ar=i("iz+Y"),oe=i.n(ar),Q=function(h){var c=h.height,p=c===void 0?1:c,y=h.data,P=y===void 0?[]:y,N=h.forceFit,ee=N===void 0?!0:N,B=h.color,J=B===void 0?"rgba(24, 144, 255, 0.2)":B,he=h.borderColor,Ye=he===void 0?"#1089ff":he,He=h.scale,It=He===void 0?{x:{},y:{}}:He,Ft=h.borderWidth,Yt=Ft===void 0?2:Ft,lr=h.line,_r=h.xAxis,un=h.yAxis,Nr=h.animate,rn=Nr===void 0?!0:Nr,yn=[36,5,30,5],Vn={x:Object(Kt.a)({type:"cat",range:[0,1]},It.x),y:Object(Kt.a)({min:0},It.y)},ua=["x*y",function(Pi,Ha){return{name:Pi,value:Ha}}],ma=p+54;return we.a.createElement("div",{className:oe.a.miniChart,style:{height:p}},we.a.createElement("div",{className:oe.a.chartContent},p>0&&we.a.createElement(Ze.Chart,{animate:rn,scale:Vn,height:ma,forceFit:ee,data:P,padding:yn},we.a.createElement(Ze.Axis,Object(vt.a)({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},_r)),we.a.createElement(Ze.Axis,Object(vt.a)({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},un)),we.a.createElement(Ze.Tooltip,{showTitle:!1,crosshairs:!1}),we.a.createElement(Ze.Geom,{type:"area",position:"x*y",color:J,tooltip:ua,shape:"smooth",style:{fillOpacity:1}}),lr?we.a.createElement(Ze.Geom,{type:"line",position:"x*y",shape:"smooth",color:Ye,size:Yt,tooltip:!1}):we.a.createElement("span",{style:{display:"none"}}))))},H=De()(Q),Ce=i("/zsF"),Ee=i("PArb"),_e=i("rePB"),ve=i("cQSq"),rt=i.n(ve),$t=i("9/5/"),St=i.n($t),ye=i("Jssm"),be=i.n(ye),Be=i("TSYQ"),lt=i.n(Be),Pe=i("d9mD"),ht=i.n(Pe),w=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.state={legendData:[],legendBlock:!1},p.chart=void 0,p.root=void 0,p.requestRef=0,p.resize=St()(function(){var ee=p.props.hasLegend,B=p.state.legendBlock;if(!ee||!p.root){window.removeEventListener("resize",p.resize);return}p.root&&p.root.parentNode&&p.root.parentNode.clientWidth<=380?B||p.setState({legendBlock:!0}):B&&p.setState({legendBlock:!1})},300),p.getG2Instance=function(ee){p.chart=ee,requestAnimationFrame(function(){p.getLegendData(),p.resize()})},p.getLegendData=function(){if(!p.chart)return;var ee=p.chart.getAllGeoms()[0];if(!ee)return;var B=ee.get("dataArray")||[],J=B.map(function(he){var Ye=he[0]._origin;return Ye.color=he[0].color,Ye.checked=!0,Ye});p.setState({legendData:J})},p.handleRoot=function(ee){p.root=ee},p.handleLegendClick=function(ee,B){var J=ee;J.checked=!J.checked;var he=p.state.legendData;he[B]=J;var Ye=he.filter(function(He){return He.checked}).map(function(He){return He.x});p.chart&&p.chart.filter("x",function(He){return Ye.indexOf("".concat(He))>-1}),p.setState({legendData:he})},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;window.addEventListener("resize",function(){y.requestRef=requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.data;P!==y.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var y,P=this,N=this.props,ee=N.valueFormat,B=N.subTitle,J=N.total,he=N.hasLegend,Ye=he===void 0?!1:he,He=N.className,It=N.style,Ft=N.height,Yt=Ft===void 0?0:Ft,lr=N.forceFit,_r=lr===void 0?!0:lr,un=N.percent,Nr=N.color,rn=N.inner,yn=rn===void 0?.75:rn,Vn=N.animate,ua=Vn===void 0?!0:Vn,ma=N.colors,Pi=N.lineWidth,Ha=Pi===void 0?1:Pi,Ho=this.state,Qo=Ho.legendData,_u=Ho.legendBlock,us=lt()(ht.a.pie,He,(y={},Object(_e.a)(y,ht.a.hasLegend,!!Ye),Object(_e.a)(y,ht.a.legendBlock,_u),y)),Ml=this.props,Kc=Ml.data,Pc=Ml.selected,ao=Pc===void 0?!0:Pc,ai=Ml.tooltip,Of=ai===void 0?!0:ai,dc=Kc||[],Pl=ao,$c=Of,Jf=ma;dc=dc||[],Pl=Pl||!0,$c=$c||!0;var io,ou={x:{type:"cat",range:[0,1]},y:{min:0}};(un||un===0)&&(Pl=!1,$c=!1,io=function(pc){return pc==="\u5360\u6BD4"?Nr||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},dc=[{x:"\u5360\u6BD4",y:parseFloat("".concat(un))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(un))}]);var mf=["x*percent",function(ml,pc){return{name:ml,value:"".concat((pc*100).toFixed(2),"%")}}],sh=[12,0,12,0],xs=new ve.DataView;return xs.source(dc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),we.a.createElement("div",{ref:this.handleRoot,className:us,style:It},we.a.createElement(be.a,{maxFontSize:25},we.a.createElement("div",{className:ht.a.chart},we.a.createElement(Ze.Chart,{scale:ou,height:Yt,forceFit:_r,data:xs,padding:sh,animate:ua,onGetG2Instance:this.getG2Instance},!!$c&&we.a.createElement(Ze.Tooltip,{showTitle:!1}),we.a.createElement(Ze.Coord,{type:"theta",innerRadius:yn}),we.a.createElement(Ze.Geom,{style:{lineWidth:Ha,stroke:"#fff"},tooltip:$c?mf:void 0,type:"intervalStack",position:"percent",color:["x",un||un===0?io:Jf],selected:Pl})),(B||J)&&we.a.createElement("div",{className:ht.a.total},B&&we.a.createElement("h4",{className:"pie-sub-title"},B),J&&we.a.createElement("div",{className:"pie-stat"},typeof J=="function"?J():J)))),Ye&&we.a.createElement("ul",{className:ht.a.legend},Qo.map(function(ml,pc){return we.a.createElement("li",{key:ml.x,onClick:function(){return P.handleLegendClick(ml,pc)}},we.a.createElement("span",{className:ht.a.dot,style:{backgroundColor:ml.checked?ml.color:"#aaa"}}),we.a.createElement("span",{className:ht.a.legendTitle},ml.x),we.a.createElement(Ee.a,{type:"vertical"}),we.a.createElement("span",{className:ht.a.percent},"".concat((Number.isNaN(ml.percent)?0:ml.percent*100).toFixed(2),"%")),we.a.createElement("span",{className:ht.a.value},ee?ee(ml.y):ml.y))})))}}]),c}(ge.Component),I=De()(w),q=i("ODXe"),ce=i("1XEM"),Ve=i.n(ce),$e="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",gt=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.state={dv:null,height:0,width:0},p.requestRef=0,p.isUnmount=!1,p.root=void 0,p.imageMask=void 0,p.resize=function(){p.requestRef=requestAnimationFrame(function(){p.renderChart(p.props)})},p.saveRootRef=function(ee){p.root=ee},p.initTagCloud=function(){function ee(B){return Object(Kt.a)(Object(Kt.a)({},B.style),{},{fillOpacity:B.opacity,fontSize:B.origin._origin.size,rotate:B.origin._origin.rotate,text:B.origin._origin.text,textAlign:"center",fontFamily:B.origin._origin.font,fill:B.color,textBaseline:"Alphabetic"})}Ze.Shape.registerShape("point","cloud",{drawShape:function(J,he){var Ye=ee(J);return he.addShape("text",{attrs:Object(Kt.a)(Object(Kt.a)({},Ye),{},{x:J.x,y:J.y})})}})},p.renderChart=St()(function(ee){var B=ee||p.props,J=B.data,he=B.height;if(J.length<1||!p.root)return;var Ye=he,He=p.root.offsetWidth,It=function(){var Yt=new rt.a.View().source(J),lr=Yt.range("value"),_r=Object(q.a)(lr,2),un=_r[0],Nr=_r[1];if(Yt.transform({type:"tag-cloud",fields:["name","value"],imageMask:p.imageMask,font:"Verdana",size:[He,Ye],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(yn){var Vn=Math.pow((yn.value-un)/(Nr-un),2);return Vn*(17.5-5)+5}}),p.isUnmount)return;p.setState({dv:Yt,width:He,height:Ye})};p.imageMask?It():(p.imageMask=new Image,p.imageMask.crossOrigin="",p.imageMask.src=$e,p.imageMask.onload=It)},200),p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;requestAnimationFrame(function(){y.initTagCloud(),y.renderChart(y.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.data;y&&JSON.stringify(y.data)!==JSON.stringify(P)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var y=this.props,P=y.className,N=y.height,ee=this.state,B=ee.dv,J=ee.width,he=ee.height;return we.a.createElement("div",{className:lt()(Ve.a.tagCloud,P),style:{width:"100%",height:N},ref:this.saveRootRef},B&&we.a.createElement(Ze.Chart,{width:J,height:he,data:B,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},we.a.createElement(Ze.Tooltip,{showTitle:!1}),we.a.createElement(Ze.Coord,{reflect:"y"}),we.a.createElement(Ze.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(He,It){return{name:He,value:It}}]})))}}]),c}(ge.Component),nt=De()(gt),kt=i("CIdX"),$=i.n(kt),Ke=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.state={radio:1},p.timer=0,p.root=null,p.node=null,p.resize=function(){if(p.root){var ee=p.props.height,B=ee===void 0?1:ee,J=p.root.parentNode,he=J.offsetWidth;p.setState({radio:he<B?he/B:1})}},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.percent;y.percent!==P&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(y){var P=this.props,N=P.percent,ee=P.color,B=ee===void 0?"#1890FF":ee,J=N/100,he=this;if(cancelAnimationFrame(this.timer),!this.node||J!==0&&!J)return;var Ye=this.node,He=Ye.getContext("2d");if(!He)return;var It=Ye.width,Ft=Ye.height,Yt=It/2,lr=2,_r=Yt-lr;He.beginPath(),He.lineWidth=lr*2;for(var un=It-lr,Nr=un/8,rn=.2,yn=rn,Vn=lr,ua=0,ma=0,Pi=.005,Ha=[],Ho=Yt-lr,Qo=-(Math.PI/2),_u=!0,us=Qo;us<Qo+2*Math.PI;us+=1/(8*Math.PI))Ha.push([Yt+Ho*Math.cos(us),Yt+Ho*Math.sin(us)]);var Ml=Ha.shift();He.strokeStyle=B,He.moveTo(Ml[0],Ml[1]);function Kc(){if(!He)return;He.beginPath(),He.save();for(var ao=[],ai=Vn;ai<=Vn+un;ai+=20/un){var Of=ua+(Vn+ai)/Nr,dc=Math.sin(Of)*yn,Pl=ai,$c=2*_r*(1-ma)+(Yt-_r)-Nr*dc;He.lineTo(Pl,$c),ao.push([Pl,$c])}var Jf=ao.shift();He.lineTo(Vn+un,Ft),He.lineTo(Vn,Ft),He.lineTo(Jf[0],Jf[1]);var io=He.createLinearGradient(0,0,0,Ft);io.addColorStop(0,"#ffffff"),io.addColorStop(1,B),He.fillStyle=io,He.fill(),He.restore()}function Pc(){if(!He)return;if(He.clearRect(0,0,It,Ft),_u&&y!=="update")if(Ha.length){var ao=Ha.shift();He.lineTo(ao[0],ao[1]),He.stroke()}else _u=!1,He.lineTo(Ml[0],Ml[1]),He.stroke(),Ha=[],He.globalCompositeOperation="destination-over",He.beginPath(),He.lineWidth=lr,He.arc(Yt,Yt,Ho,0,2*Math.PI,!0),He.beginPath(),He.save(),He.arc(Yt,Yt,Yt-3*lr,0,2*Math.PI,!0),He.restore(),He.clip(),He.fillStyle=B;else{if(J>=.85){if(yn>rn/4){var ai=rn*.01;yn-=ai}}else if(J<=.1){if(yn<rn*1.5){var Of=rn*.01;yn+=Of}}else{if(yn<=rn){var dc=rn*.01;yn+=dc}if(yn>=rn){var Pl=rn*.01;yn-=Pl}}J-ma>0&&(ma+=Pi),J-ma<0&&(ma-=Pi),ua+=.07,Kc()}he.timer=requestAnimationFrame(Pc)}Pc()}},{key:"render",value:function(){var y=this,P=this.state.radio,N=this.props,ee=N.percent,B=N.title,J=N.height,he=J===void 0?1:J;return we.a.createElement("div",{className:$.a.waterWave,ref:function(He){return y.root=He},style:{transform:"scale(".concat(P,")")}},we.a.createElement("div",{style:{width:he,height:he,overflow:"hidden"}},we.a.createElement("canvas",{className:$.a.waterWaveCanvasWrapper,ref:function(He){return y.node=He},width:he*2,height:he*2})),we.a.createElement("div",{className:$.a.text,style:{width:he}},B&&we.a.createElement("span",null,B),we.a.createElement("h4",null,ee,"%")))}}]),c}(ge.Component),ae=De()(Ke),et=i("o0o1"),zt=i.n(et),sr=i("HaE+"),ft=Object(ge.createContext)({});function pt(){return Object(ge.useContext)(ft)}var At=i("8ml+"),mt=i("lwsE"),Me=i.n(mt),ct=i("W8MJ"),qe=i.n(ct),Vt=i("7W2i"),pr=i.n(Vt),Gr=i("a1gu"),ur=i.n(Gr),zn=i("Nsbk"),xn=i.n(zn),na=i("lSNA"),fa=i.n(na),Hn=i("yG8O"),Gn=i.n(Hn),F=i("U+yc"),W=i.n(F),le=i("1ABj"),pe=i("h1nZ"),at,Tt,jt,Ge,wt,ir;function Ur(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Vr(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?Ur(Object(c),!0).forEach(function(p){fa()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Ur(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}var or=(at=Object(pe.lazyInject)(pe.TYPES.ILogService),Tt=Object(pe.lazyInject)(pe.TYPES.IGlobalConfigService),jt=(ir=function(){function v(h){Me()(this,v),Gn()(this,"logger",Ge,this),Gn()(this,"configService",wt,this),this.config=void 0,this.config=h}return qe()(v,[{key:"setContainer",value:function(c,p){c.bind(pe.TYPES.MapConfig).toConstantValue(Vr(Vr({},this.config),{},{id:p})),c.bind(pe.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),v}(),ir),Ge=W()(jt.prototype,"logger",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=W()(jt.prototype,"configService",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt),Fr=i("QILm"),Sn=i.n(Fr),fn=i("yXPU"),Er=i.n(fn),Tn=i("hi0z"),dn=i.n(Tn),vn=i("Hel2"),Sr=i("IOcx"),Kr=i("4cb6"),wn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},Ka=i("J4zp"),da=i.n(Ka),Oa=Math.PI/180,Ia=function(){function v(){Me()(this,v),this.projectionMatrix=Sr.b.create(),this.viewMatrix=Sr.b.create(),this.viewProjectionMatrix=Sr.b.create(),this.ViewProjectionMatrixUncentered=Sr.b.create(),this.viewUncenteredMatrix=Sr.b.create(),this.zoom=void 0,this.center=void 0}return qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.zoom,y=p===void 0?1:p,P=c.pitch,N=P===void 0?0:P,ee=c.bearing,B=ee===void 0?0:ee,J=c.center,he=J===void 0?[0,0]:J,Ye=c.offsetOrigin,He=Ye===void 0?[0,0]:Ye,It=c.cameraHeight,Ft=It===void 0?1:It,Yt=c.aspect,lr=Yt===void 0?1:Yt,_r=c.near,un=_r===void 0?.1:_r,Nr=c.far,rn=Nr===void 0?1e3:Nr,yn=c.fov,Vn=yn===void 0?0:yn;this.zoom=y,this.center=he;var ua=N*Oa,ma=(360-B)*Oa;Sr.b.perspective(this.projectionMatrix,Vn,lr,un,rn);var Pi=Sr.d.fromValues(Ft*Math.sin(ua)*Math.sin(ma),-Ft*Math.sin(ua)*Math.cos(ma),Ft*Math.cos(ua)),Ha=Sr.d.fromValues(-Math.cos(ua)*Math.sin(ma),Math.cos(ua)*Math.cos(ma),Math.sin(ua));Sr.b.lookAt(this.viewMatrix,Pi,Sr.d.fromValues(0,0,0),Ha),this.viewUncenteredMatrix=Sr.b.clone(this.viewMatrix),Sr.b.translate(this.viewMatrix,this.viewMatrix,Sr.d.fromValues(-He[0],He[1],0)),Sr.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Sr.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=da()(this.center,2),p=c[0],y=c[1];return[p,y]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){var y=85.0511287798,P=Math.max(Math.min(y,c[1]),-y),N=256<<20,ee=Math.PI/180,B=c[0]*ee,J=P*ee;J=Math.log(Math.tan(Math.PI/4+J/2));var he=.5/Math.PI,Ye=.5,He=-.5/Math.PI;return ee=.5,B=N*(he*B+Ye)-215440491,J=-(N*(He*J+ee)-106744817),[B,J]}}]),v}(),Xi,ha,gi,Ma,ya,la,Li,po,Yi,Ko,Gu,Ba,Ai,es;function ii(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Ki(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?ii(Object(c),!0).forEach(function(p){fa()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):ii(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}i("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var ts=0;window.forceWebGL=!0;var Ja="15cd8a57710d40c9b7c0e3cc120f1200",oo="1.4.15",so="amap-script",Ys=!1,_o=[],Zl=12,Ks=(Xi=Object(Kr.injectable)(),ha=Object(Kr.inject)(pe.TYPES.IGlobalConfigService),gi=Object(Kr.inject)(pe.TYPES.ILogService),Ma=Object(Kr.inject)(pe.TYPES.MapConfig),ya=Object(Kr.inject)(pe.TYPES.ICoordinateSystemService),la=Object(Kr.inject)(pe.TYPES.IEventEmitter),Xi(Li=(po=(es=function(){function v(){var h=this;Me()(this,v),this.map=void 0,Gn()(this,"configService",Yi,this),Gn()(this,"logger",Ko,this),Gn()(this,"config",Gu,this),Gn()(this,"coordinateSystemService",Ba,this),Gn()(this,"eventEmitter",Ai,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var p=c.camera,y=p.fov,P=p.near,N=p.far,ee=p.height,B=p.pitch,J=p.rotation,he=p.aspect,Ye=p.position,He=h.getCenter(),It=He.lng,Ft=He.lat;h.cameraChangedCallback&&(h.viewport.syncWithMapCamera({aspect:he,bearing:360-J,far:N,fov:y,cameraHeight:ee,near:P,pitch:B,zoom:h.map.getZoom()-1,center:[It,Ft],offsetOrigin:[Ye.x,Ye.y]}),h.viewport.getZoom()>Zl?h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.P20_OFFSET):h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.P20),h.cameraChangedCallback(h.viewport))}}return qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var p=c.getElementsByClassName("amap-maps")[0];this.markerContainer=vn.a.create("div","l7-marker-container",p)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(c,p)}},{key:"off",value:function(c,p){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,p):this.map.off(c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),p=c.getNorthEast(),y=c.getSouthWest(),P=this.getCenter(),N=P.lng>p.getLng()||P.lng<y.getLng()?180-p.getLng():p.getLng(),ee=P.lng<y.getLng()?y.getLng()-180:y.getLng();return[[ee,y.getLat()],[N,p.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,p){this.map.setZoomAndCenter(c,p)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var p=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:p.getLng(),lat:p.getLat()}}},{key:"lngLatToPixel",value:function(c){var p=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:p.getX(),y:p.getY()}}},{key:"containerToLngLat",value:function(c){var p=new AMap.Pixel(c[0],c[1]),y=this.map.containerToLngLat(p);return{lng:y==null?void 0:y.getLng(),lat:y==null?void 0:y.getLat()}}},{key:"lngLatToContainer",value:function(c){var p=new AMap.LngLat(c[0],c[1]),y=this.map.lngLatToContainer(p);return{x:y.getX(),y:y.getY()}}},{key:"lngLatToMercator",value:function(c,p){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ee=this.viewport.projectFlat(c),B=Sr.b.create();return Sr.b.translate(B,B,Sr.d.fromValues(ee[0],ee[1],p)),Sr.b.scale(B,B,Sr.d.fromValues(P[0],P[1],P[2])),Sr.b.rotateX(B,B,y[0]),Sr.b.rotateY(B,B,y[1]),Sr.b.rotateZ(B,B,y[2]),B}},{key:"init",value:function(){var h=Er()(zt.a.mark(function p(){var y=this,P,N,ee,B,J,he,Ye,He,It,Ft,Yt,lr,_r,un;return zt.a.wrap(function(rn){for(;;)switch(rn.prev=rn.next){case 0:return P=this.config,N=P.id,ee=P.style,B=ee===void 0?"light":ee,J=P.minZoom,he=J===void 0?0:J,Ye=P.maxZoom,He=Ye===void 0?18:Ye,It=P.token,Ft=It===void 0?Ja:It,Yt=P.mapInstance,lr=P.plugin,_r=lr===void 0?[]:lr,un=Sn()(P,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),rn.next=3,new Promise(function(yn){var Vn=function(){if(Yt)y.map=Yt,y.$mapContainer=y.map.getContainer(),setTimeout(function(){y.map.on("camerachange",y.handleCameraChanged),yn()},30);else{y.$mapContainer=y.creatAmapContainer(N);var ma=new AMap.Map(y.$mapContainer,Ki({mapStyle:y.getMapStyle(B),zooms:[he,He],viewMode:"3D"},un));ma.on("camerachange",y.handleCameraChanged),y.map=ma,setTimeout(function(){yn()},10)}};!Ys&&!Yt?(Ft===Ja&&y.logger.warn(y.configService.getSceneWarninfo("MapToken")),Ys=!0,_r.push("Map3D"),dn.a.load({key:Ft,version:oo,plugins:_r}).then(function(ua){Vn(),_o.length&&(_o.forEach(function(ma){return ma()}),_o=[])}).catch(function(ua){throw new Error(ua)})):Ys&&window.AMap||Yt?Vn():_o.push(Vn)});case 3:this.viewport=new Ia;case 4:case"end":return rn.stop()}},p,this)}));function c(){return h.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var p,y=(p=this.getContainer())===null||p===void 0?void 0:p.getElementsByClassName("amap-layer")[0],P=c==="jpg"?y==null?void 0:y.toDataURL("image/jpeg"):y==null?void 0:y.toDataURL("image/png");return P}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(so);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return wn[c]?wn[c]:c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_amap_div"+ts++,p.appendChild(y),y}}]),v}(),es),Yi=W()(po.prototype,"configService",[ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=W()(po.prototype,"logger",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gu=W()(po.prototype,"config",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ba=W()(po.prototype,"coordinateSystemService",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=W()(po.prototype,"eventEmitter",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),po))||Li);function So(v){var h=Ut();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function Ut(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Ie=function(v){pr()(c,v);var h=So(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"getServiceConstructor",value:function(){return Ks}}]),c}(or);function Pt(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function cr(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?Pt(Object(c),!0).forEach(function(p){tn(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Pt(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function tn(v,h,c){return h in v?Object.defineProperty(v,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[h]=c,v}function En(v,h){return Do(v)||mo(v,h)||Ri(v,h)||Fn()}function Fn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ri(v,h){if(!v)return;if(typeof v=="string")return to(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return to(v,h)}function to(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function mo(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function Do(v){if(Array.isArray(v))return v}var Hu=we.a.memo(function(v){var h=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ge.createRef)(),ee=Object(ge.useState)(),B=En(ee,2),J=B[0],he=B[1];return Object(ge.useEffect)(function(){var Ye=new At.Scene(cr(cr({id:N.current},y),{},{map:new Ie(p)}));return Ye.on("loaded",function(){he(Ye),P&&P(Ye)}),function(){Ye.destroy()}},[]),Object(ge.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ge.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ge.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ge.useEffect)(function(){J&&p.pitch&&J.setPitch(p.pitch)},[p.pitch]),Object(ge.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ge.createElement)("div",{ref:N,style:h,className:c},J&&v.children))}),Xl=Hu,$s=i("4ZJM"),Ic=i.n($s),Ll=i("md7G"),fs=i("foSv"),ks=i("JX7q"),uo=i("bl9R");function hs(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Js(v,h){var c=uo.transformMat4([],h,v);return uo.scale(c,c,1/c[3]),c}function cu(v,h){var c=v%h;return c<0?h+c:c}function Yl(v,h,c){return c*h+(1-c)*v}var yi=i("ZaHm"),Ni=i("ZxFD"),vl=i("n+fv");function js(v,h){if(!v)throw new Error(h||"viewport-mercator-project: assertion failed.")}var ds=Math.PI,Ot=ds/4,er=ds/180,Or=180/ds,Bn=512,Qa=4003e4,Ii=1.5;function Gi(v){return Math.pow(2,v)}function qa(v){return Math.log2(v)}function bi(v,h){var c=Object(q.a)(v,2),p=c[0],y=c[1];js(Number.isFinite(p)&&Number.isFinite(h)),js(Number.isFinite(y)&&y>=-90&&y<=90,"invalid latitude"),h*=Bn;var P=p*er,N=y*er,ee=h*(P+ds)/(2*ds),B=h*(ds-Math.log(Math.tan(Ot+N*.5)))/(2*ds);return[ee,B]}function Ao(v,h){var c=Object(q.a)(v,2),p=c[0],y=c[1];h*=Bn;var P=p/h*(2*ds)-ds,N=2*(Math.atan(Math.exp(ds-y/h*(2*ds)))-Ot);return[P*Or,N*Or]}function zs(v){var h=v.latitude;js(Number.isFinite(h));var c=Math.cos(h*er);return qa(Qa*c)-9}function di(v){var h=v.latitude,c=v.longitude,p=v.zoom,y=v.scale,P=v.highPrecision,N=P===void 0?!1:P;y=y!==void 0?y:Gi(p),js(Number.isFinite(h)&&Number.isFinite(c)&&Number.isFinite(y));var ee={},B=Bn*y,J=Math.cos(h*er),he=B/360,Ye=he/J,He=B/Qa/J;if(ee.pixelsPerMeter=[He,-He,He],ee.metersPerPixel=[1/He,-1/He,1/He],ee.pixelsPerDegree=[he,-Ye,He],ee.degreesPerPixel=[1/he,-1/Ye,1/He],N){var It=er*Math.tan(h*er)/J,Ft=he*It/2,Yt=B/Qa*It,lr=Yt/Ye*He;ee.pixelsPerDegree2=[0,-Ft,Yt],ee.pixelsPerMeter2=[lr,0,lr]}return ee}function Kl(v,h){var c=Object(q.a)(v,3),p=c[0],y=c[1],P=c[2],N=Object(q.a)(h,3),ee=N[0],B=N[1],J=N[2],he=1,Ye=di({longitude:p,latitude:y,scale:he,highPrecision:!0}),He=Ye.pixelsPerMeter,It=Ye.pixelsPerMeter2,Ft=bi(v,he);Ft[0]+=ee*(He[0]+It[0]*B),Ft[1]+=B*(He[1]+It[1]*B);var Yt=Ao(Ft,he),lr=(P||0)+(J||0);return Number.isFinite(P)||Number.isFinite(J)?[Yt[0],Yt[1],lr]:Yt}function fu(v){var h=v.height,c=v.pitch,p=v.bearing,y=v.altitude,P=v.center,N=P===void 0?null:P,ee=v.flipY,B=ee===void 0?!1:ee,J=hs();return yi.translate(J,J,[0,0,-y]),yi.scale(J,J,[1,1,1/h]),yi.rotateX(J,J,-c*er),yi.rotateZ(J,J,p*er),B&&yi.scale(J,J,[1,-1,1]),N&&yi.translate(J,J,vl.negate([],N)),J}function Os(v){var h=v.width,c=v.height,p=v.altitude,y=p===void 0?Ii:p,P=v.pitch,N=P===void 0?0:P,ee=v.nearZMultiplier,B=ee===void 0?1:ee,J=v.farZMultiplier,he=J===void 0?1:J,Ye=N*er,He=Math.atan(.5/y),It=Math.sin(He)*y/Math.sin(Math.PI/2-Ye-He),Ft=Math.cos(Math.PI/2-Ye)*It+y;return{fov:2*Math.atan(c/2/y),aspect:h/c,focalDistance:y,near:B,far:Ft*he}}function gl(v){var h=v.width,c=v.height,p=v.pitch,y=v.altitude,P=v.nearZMultiplier,N=v.farZMultiplier,ee=Os({width:h,height:c,altitude:y,pitch:p,nearZMultiplier:P,farZMultiplier:N}),B=ee.fov,J=ee.aspect,he=ee.near,Ye=ee.far,He=yi.perspective([],B,J,he,Ye);return He}function hu(v,h){var c=Object(q.a)(v,3),p=c[0],y=c[1],P=c[2],N=P===void 0?0:P;return js(Number.isFinite(p)&&Number.isFinite(y)&&Number.isFinite(N)),Js(h,[p,y,N,1])}function Wu(v,h){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,p=Object(q.a)(v,3),y=p[0],P=p[1],N=p[2];if(js(Number.isFinite(y)&&Number.isFinite(P),"invalid pixel coordinate"),Number.isFinite(N)){var ee=Js(h,[y,P,N,1]);return ee}var B=Js(h,[y,P,0,1]),J=Js(h,[y,P,1,1]),he=B[2],Ye=J[2],He=he===Ye?0:((c||0)-he)/(Ye-he);return Ni.lerp([],B,J,He)}var Qs=hs(),nl=function(){function v(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=h.width,p=h.height,y=h.viewMatrix,P=y===void 0?Qs:y,N=h.projectionMatrix,ee=N===void 0?Qs:N;Object(D.a)(this,v),this.width=c||1,this.height=p||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=P,this.projectionMatrix=ee;var B=hs();yi.multiply(B,B,this.projectionMatrix),yi.multiply(B,B,this.viewMatrix),this.viewProjectionMatrix=B;var J=hs();yi.scale(J,J,[this.width/2,-this.height/2,1]),yi.translate(J,J,[1,-1,0]),yi.multiply(J,J,this.viewProjectionMatrix);var he=yi.invert(hs(),J);if(!he)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=J,this.pixelUnprojectionMatrix=he,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(K.a)(v,[{key:"equals",value:function(c){return c instanceof v?c.width===this.width&&c.height===this.height&&yi.equals(c.projectionMatrix,this.projectionMatrix)&&yi.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.topLeft,P=y===void 0?!0:y,N=this.projectPosition(c),ee=hu(N,this.pixelProjectionMatrix),B=Object(q.a)(ee,2),J=B[0],he=B[1],Ye=P?he:this.height-he;return c.length===2?[J,Ye]:[J,Ye,ee[2]]}},{key:"unproject",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.topLeft,P=y===void 0?!0:y,N=p.targetZ,ee=Object(q.a)(c,3),B=ee[0],J=ee[1],he=ee[2],Ye=P?J:this.height-J,He=N&&N*this.pixelsPerMeter,It=Wu([B,Ye,he],this.pixelUnprojectionMatrix,He),Ft=this.unprojectPosition(It),Yt=Object(q.a)(Ft,3),lr=Yt[0],_r=Yt[1],un=Yt[2];return Number.isFinite(he)?[lr,_r,un]:Number.isFinite(N)?[lr,_r,N]:[lr,_r]}},{key:"projectPosition",value:function(c){var p=this.projectFlat(c),y=Object(q.a)(p,2),P=y[0],N=y[1],ee=(c[2]||0)*this.pixelsPerMeter;return[P,N,ee]}},{key:"unprojectPosition",value:function(c){var p=this.unprojectFlat(c),y=Object(q.a)(p,2),P=y[0],N=y[1],ee=(c[2]||0)/this.pixelsPerMeter;return[P,N,ee]}},{key:"projectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),v}();function du(v){var h=v.width,c=v.height,p=v.bounds,y=v.minExtent,P=y===void 0?0:y,N=v.maxZoom,ee=N===void 0?24:N,B=v.padding,J=B===void 0?0:B,he=v.offset,Ye=he===void 0?[0,0]:he,He=Object(q.a)(p,2),It=Object(q.a)(He[0],2),Ft=It[0],Yt=It[1],lr=Object(q.a)(He[1],2),_r=lr[0],un=lr[1];if(Number.isFinite(J)){var Nr=J;J={top:Nr,bottom:Nr,left:Nr,right:Nr}}else js(Number.isFinite(J.top)&&Number.isFinite(J.bottom)&&Number.isFinite(J.left)&&Number.isFinite(J.right));var rn=new vc({width:h,height:c,longitude:0,latitude:0,zoom:0}),yn=rn.project([Ft,un]),Vn=rn.project([_r,Yt]),ua=[Math.max(Math.abs(Vn[0]-yn[0]),P),Math.max(Math.abs(Vn[1]-yn[1]),P)],ma=[h-J.left-J.right-Math.abs(Ye[0])*2,c-J.top-J.bottom-Math.abs(Ye[1])*2];js(ma[0]>0&&ma[1]>0);var Pi=ma[0]/ua[0],Ha=ma[1]/ua[1],Ho=(J.right-J.left)/2/Pi,Qo=(J.bottom-J.top)/2/Ha,_u=[(Vn[0]+yn[0])/2+Ho,(Vn[1]+yn[1])/2+Qo],us=rn.unproject(_u),Ml=rn.zoom+Math.log2(Math.abs(Math.min(Pi,Ha)));return{longitude:us[0],latitude:us[1],zoom:Math.min(Ml,ee)}}var vc=function(v){Object(re.a)(h,v);function h(){var c,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=p.width,P=p.height,N=p.latitude,ee=N===void 0?0:N,B=p.longitude,J=B===void 0?0:B,he=p.zoom,Ye=he===void 0?0:he,He=p.pitch,It=He===void 0?0:He,Ft=p.bearing,Yt=Ft===void 0?0:Ft,lr=p.altitude,_r=lr===void 0?1.5:lr,un=p.nearZMultiplier,Nr=p.farZMultiplier;Object(D.a)(this,h),y=y||1,P=P||1;var rn=Gi(Ye);_r=Math.max(.75,_r);var yn=bi([J,ee],rn);yn[2]=0;var Vn=gl({width:y,height:P,pitch:It,bearing:Yt,altitude:_r,nearZMultiplier:un||1/P,farZMultiplier:Nr||1.01}),ua=fu({height:P,center:yn,pitch:It,bearing:Yt,altitude:_r,flipY:!0});return c=Object(Ll.a)(this,Object(fs.a)(h).call(this,{width:y,height:P,viewMatrix:ua,projectionMatrix:Vn})),c.latitude=ee,c.longitude=J,c.zoom=Ye,c.pitch=It,c.bearing=Yt,c.altitude=_r,c.scale=rn,c.center=yn,c.pixelsPerMeter=di(Object(ks.a)(Object(ks.a)(c))).pixelsPerMeter[2],Object.freeze(Object(ks.a)(Object(ks.a)(c))),c}return Object(K.a)(h,[{key:"projectFlat",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return bi(p,y)}},{key:"unprojectFlat",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ao(p,y)}},{key:"getMapCenterByLngLatPosition",value:function(p){var y=p.lngLat,P=p.pos,N=Wu(P,this.pixelUnprojectionMatrix),ee=bi(y,this.scale),B=Ni.add([],ee,Ni.negate([],N)),J=Ni.add([],this.center,B);return Ao(J,this.scale)}},{key:"getLocationAtPoint",value:function(p){var y=p.lngLat,P=p.pos;return this.getMapCenterByLngLatPosition({lngLat:y,pos:P})}},{key:"fitBounds",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=this.width,N=this.height,ee=du(Object.assign({width:P,height:N,bounds:p},y)),B=ee.longitude,J=ee.latitude,he=ee.zoom;return new h({width:P,height:N,longitude:B,latitude:J,zoom:he})}}]),h}(nl),Pf=function(){function v(){Me()(this,v),this.viewport=void 0}return qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.center,y=c.zoom,P=c.pitch,N=c.bearing,ee=c.viewportHeight,B=c.viewportWidth;this.viewport=new vc({width:B,height:ee,longitude:p&&p[0],latitude:p&&p[1],zoom:y,pitch:P,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),v}(),pi={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Dc,gc,rf,nf,af,$i,Cu,qs,ps,Nc,yc,yl,al,bc;function eu(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Zu(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?eu(Object(c),!0).forEach(function(p){fa()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):eu(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Ic.a;var kc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},$l=0,Ci=12,jc="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Lf=(Dc=Object(Kr.injectable)(),gc=Object(Kr.inject)(pe.TYPES.MapConfig),rf=Object(Kr.inject)(pe.TYPES.IGlobalConfigService),nf=Object(Kr.inject)(pe.TYPES.ILogService),af=Object(Kr.inject)(pe.TYPES.ICoordinateSystemService),$i=Object(Kr.inject)(pe.TYPES.IEventEmitter),Dc(Cu=(qs=(bc=function(){function v(){var h=this;Me()(this,v),this.map=void 0,Gn()(this,"config",ps,this),Gn()(this,"configService",Nc,this),Gn()(this,"logger",yc,this),Gn()(this,"coordinateSystemService",yl,this),Gn()(this,"eventEmitter",al,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=h.map.getCenter().wrap(),p=c.lat,y=c.lng;h.viewport.syncWithMapCamera({bearing:h.map.getBearing(),center:[y,p],viewportHeight:h.map.transform.height,pitch:h.map.getPitch(),viewportWidth:h.map.transform.width,zoom:h.map.getZoom(),cameraHeight:0}),h.viewport.getZoom()>Ci?h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT_OFFSET):h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT),h.cameraChangedCallback(h.viewport)}}return qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=vn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(kc[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(kc[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){var y=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),P=y.x,N=P===void 0?0:P,ee=y.y,B=ee===void 0?0:ee,J=y.z,he=J===void 0?0:J;return{x:N,y:B,z:he}}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ee=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),B=ee.meterInMercatorCoordinateUnits(),J=Sr.b.create();return Sr.b.translate(J,J,Sr.d.fromValues(ee.x-N.x,ee.y-N.y,ee.z||0-N.z)),Sr.b.scale(J,J,Sr.d.fromValues(B*P[0],-B*P[1],B*P[2])),Sr.b.rotateX(J,J,y[0]),Sr.b.rotateY(J,J,y[1]),Sr.b.rotateZ(J,J,y[2]),J}},{key:"init",value:function(){var h=Er()(zt.a.mark(function p(){var y,P,N,ee,B,J,he,Ye,He,It,Ft,Yt,lr;return zt.a.wrap(function(un){for(;;)switch(un.prev=un.next){case 0:y=this.config,P=y.id,N=P===void 0?"map":P,ee=y.attributionControl,B=ee===void 0?!1:ee,J=y.style,he=J===void 0?"light":J,Ye=y.token,He=Ye===void 0?jc:Ye,It=y.rotation,Ft=It===void 0?0:It,Yt=y.mapInstance,lr=Sn()(y,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new Pf,!Yt&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),He===jc&&he!=="blank"&&!window.mapboxgl.accessToken&&!Yt&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!Yt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=He),Yt?(this.map=Yt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new window.mapboxgl.Map(Zu({container:this.$mapContainer,style:this.getMapStyle(he),attributionControl:B,bearing:Ft},lr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return un.stop()}},p,this)}));function c(){return h.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),y=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_mapbox_div"+$l++,p.appendChild(y),y}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:pi[c]?pi[c]:c}}]),v}(),bc),ps=W()(qs.prototype,"config",[gc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nc=W()(qs.prototype,"configService",[rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yc=W()(qs.prototype,"logger",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=W()(qs.prototype,"coordinateSystemService",[af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),al=W()(qs.prototype,"eventEmitter",[$i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qs))||Cu);function xc(v){var h=zc();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function zc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var Jl=function(v){pr()(c,v);var h=xc(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"getServiceConstructor",value:function(){return Lf}}]),c}(or);function Xu(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function wu(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?Xu(Object(c),!0).forEach(function(p){Rl(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Xu(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function Rl(v,h,c){return h in v?Object.defineProperty(v,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[h]=c,v}function No(v,h){return Dl(v)||Fc(v,h)||Il(v,h)||Ql()}function Ql(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Il(v,h){if(!v)return;if(typeof v=="string")return bl(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return bl(v,h)}function bl(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function Fc(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function Dl(v){if(Array.isArray(v))return v}var tu=we.a.memo(function(v){var h=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ge.createRef)(),ee=Object(ge.useState)(),B=No(ee,2),J=B[0],he=B[1];return Object(ge.useEffect)(function(){var Ye=new At.Scene(wu(wu({id:N.current},y),{},{map:new Jl(p)}));return Ye.on("loaded",function(){he(Ye),P&&P(Ye)}),function(){Ye.destroy()}},[]),Object(ge.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ge.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ge.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ge.useEffect)(function(){J&&p.pitch!==void 0&&J.setPitch(p.pitch||0)},[p.pitch]),Object(ge.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ge.createElement)("div",{ref:N,style:h,className:c},J&&v.children))}),yf=tu,bf=i("PJYZ"),of=i.n(bf),xl=i("QkVN"),ki=i.n(xl),il=i("uhBA"),Nl=i("cDf5"),Ec=i.n(Nl),Uc=i("zvhG"),kl=i.n(Uc);function Rf(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=If(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function If(v,h){if(!v)return;if(typeof v=="string")return sf(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return sf(v,h)}function sf(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var El;function ql(v,h,c){var p=c-h,y=((v-h)%p+p)%p+h;return y===h?c:y}function Ou(v,h,c){return Math.min(c,Math.max(h,v))}function Fs(v,h,c){return v*(1-c)+h*c}function ol(v,h,c,p){var y=new kl.a(v,h,c,p);return function(P){return y.solve(P)}}var Bc=ol(.25,.1,.25,1);function Yu(){return window.matchMedia?(El==null&&(El=window.matchMedia("(prefers-reduced-motion: reduce)")),El.matches):!1}function ji(v,h){var c={},p=Rf(h),y;try{for(p.s();!(y=p.n()).done;){var P=y.value;P in v&&(c[P]=v[P])}}catch(N){p.e(N)}finally{p.f()}return c}var pu=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),sl=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,ul=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function Da(v){var h=sl(v);return{cancel:function(){return ul(h)}}}var mi=function(){qe()(v,null,[{key:"convert",value:function(c){return c instanceof v?c:new v(c)}}]);function v(h,c){Me()(this,v),this.ne=void 0,this.sw=void 0,h&&(c?this.setSouthWest(h).setNorthEast(c):h.length===4?this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]]):this.setSouthWest(h[0]).setNorthEast(h[1]))}return qe()(v,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof Ti?new Ti(c.lng,c.lat):Ti.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof Ti?new Ti(c.lng,c.lat):Ti.convert(c),this}},{key:"extend",value:function(c){var p=this.sw,y=this.ne,P,N;if(c instanceof Ti)P=c,N=c;else if(c instanceof v){if(P=c.sw,N=c.ne,!P||!N)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var ee=c;return this.extend(v.convert(ee))}else{var B=c;return this.extend(Ti.convert(B))}return this}return!p&&!y?(this.sw=new Ti(P.lng,P.lat),this.ne=new Ti(N.lng,N.lat)):(p.lng=Math.min(P.lng,p.lng),p.lat=Math.min(P.lat,p.lat),y.lng=Math.max(N.lng,y.lng),y.lat=Math.max(N.lat,y.lat)),this}},{key:"getCenter",value:function(){return new Ti((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new Ti(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Ti(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var p=Ti.convert(c),y=p.lng,P=p.lat,N=this.sw.lat<=P&&P<=this.ne.lat,ee=this.sw.lng<=y&&y<=this.ne.lng;return this.sw.lng>this.ne.lng&&(ee=this.sw.lng>=y&&y>=this.ne.lng),N&&ee}}]),v}(),Ms=63710088e-1,Ti=function(){qe()(v,null,[{key:"convert",value:function(c){if(c instanceof v)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new v(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&Ec()(c)==="object"&&c!==null){var p="lng"in c?c.lng:c.lon;return new v(Number(p),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function v(h,c){if(Me()(this,v),this.lng=void 0,this.lat=void 0,isNaN(h)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(h,", ").concat(c,")"));if(this.lng=+h,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return qe()(v,[{key:"wrap",value:function(){return new v(ql(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=40075017,y=360*c/p,P=y/Math.cos(Math.PI/180*this.lat);return new mi(new v(this.lng-P,this.lat-y),new v(this.lng+P,this.lat+y))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var p=Math.PI/180,y=this.lat*p,P=c.lat*p,N=Math.sin(y)*Math.sin(P)+Math.cos(y)*Math.cos(P)*Math.cos((c.lng-this.lng)*p),ee=Ms*Math.acos(Math.min(N,1));return ee}}]),v}(),Wa=function(){qe()(v,null,[{key:"convert",value:function(c){return c instanceof v?c:Array.isArray(c)?new v(c[0],c[1]):c}}]);function v(h,c){Me()(this,v),this.x=void 0,this.y=void 0,this.x=h,this.y=c}return qe()(v,[{key:"clone",value:function(){return new v(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var p=Math.cos(c),y=Math.sin(c),P=p*this.x-y*this.y,N=y*this.x+p*this.y;return this.x=P,this.y=N,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,p){var y=Math.cos(c),P=Math.sin(c),N=p.x+y*(this.x-p.x)-P*(this.y-p.y),ee=p.y+P*(this.x-p.x)+y*(this.y-p.y);return this.x=N,this.y=ee,this}},{key:"roateAround",value:function(c,p){return this.clone()._rotateAround(c,p)}},{key:"_matMult",value:function(c){var p=c[0]*this.x+c[1]*this.y,y=c[2]*this.x+c[3]*this.y;return this.x=p,this.y=y,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var p=c.x-this.x,y=c.y-this.y;return p*p+y*y}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,p){return Math.atan2(this.x*p-this.y*c,this.x*c+this.y*p)}}]),v}(),ec=function(){function v(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Me()(this,v),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(h)||h<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=c,this.left=p,this.right=y}return qe()(v,[{key:"interpolate",value:function(c,p,y){return p.top!=null&&c.top!=null&&(this.top=Fs(c.top,p.top,y)),p.bottom!=null&&c.bottom!=null&&(this.bottom=Fs(c.bottom,p.bottom,y)),p.left!=null&&c.left!=null&&(this.left=Fs(c.left,p.left,y)),p.right!=null&&c.right!=null&&(this.right=Fs(c.right,p.right,y)),this}},{key:"getCenter",value:function(c,p){var y=Ou((this.left+c-this.right)/2,0,c),P=Ou((this.top+p-this.bottom)/2,0,p);return new Wa(y,P)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new v(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),v}(),xf=2*Math.PI*Ms;function rs(v){return xf*Math.cos(v*Math.PI/180)}function ll(v){return(180+v)/360}function mu(v){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+v*Math.PI/360)))/360}function Ku(v,h){return v/rs(h)}function ro(v){return v*360-180}function ns(v){var h=180-v*360;return 360/Math.PI*Math.atan(Math.exp(h*Math.PI/180))-90}function jl(v,h){return v*rs(ns(h))}function lo(v){return 1/Math.cos(v*Math.PI/180)}var Mn=function(){qe()(v,null,[{key:"fromLngLat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=Ti.convert(c);return new v(ll(y.lng),mu(y.lat),Ku(p,y.lat))}}]);function v(h,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Me()(this,v),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+h,this.y=+c,this.z=+p}return qe()(v,[{key:"toLngLat",value:function(){return new Ti(ro(this.x),ns(this.y))}},{key:"toAltitude",value:function(){return jl(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/xf*lo(ns(this.y))}}]),v}();function Us(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Tc(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Tc(v,h){if(!v)return;if(typeof v=="string")return Tl(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Tl(v,h)}function Tl(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var Mu=8192,Bs=function(){qe()(v,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Wa(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var p=-ql(c,-180,180)*Math.PI/180;if(this.angle===p)return;this.unmodified=!1,this.angle=p,this.calcMatrices(),this.rotationMatrix=Sr.a.create(),Sr.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var p=Ou(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===p)return;this.unmodified=!1,this._pitch=p,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var p=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===p)return;this.unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function v(h,c,p,y,P){Me()(this,v),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0?!0:P,this._minZoom=h||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Ti(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new ec,this.posMatrixCache={},this.alignedPosMatrixCache={}}return qe()(v,[{key:"clone",value:function(){var c=new v(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,p,y){this.unmodified=!1,this.edgeInsets.interpolate(c,p,y),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var p=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,p)}},{key:"resize",value:function(c,p){this.width=c,this.height=p,this.pixelsToGLUnits=[2/c,-2/p],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var p=Ou(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Wa(ll(c.lng)*this.worldSize,mu(p)*this.worldSize)}},{key:"unproject",value:function(c){return new Mn(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,p){var y=this.pointCoordinate(p),P=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(c),ee=new Mn(N.x-(y.x-P.x),N.y-(y.y-P.y));this.center=this.coordinateLocation(ee),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var p=0,y=new Float32Array([c.x,c.y,0,1]),P=new Float32Array([c.x,c.y,1,1]);Sr.e.transformMat4(y,y,this.pixelMatrixInverse),Sr.e.transformMat4(P,P,this.pixelMatrixInverse);var N=y[3],ee=P[3],B=y[0]/N,J=P[0]/ee,he=y[1]/N,Ye=P[1]/ee,He=y[2]/N,It=P[2]/ee,Ft=He===It?0:(p-He)/(It-He);return new Mn(Fs(B,J,Ft)/this.worldSize,Fs(he,Ye,Ft)/this.worldSize)}},{key:"getBounds",value:function(){return new mi().extend(this.pointLocation(new Wa(0,0))).extend(this.pointLocation(new Wa(this.width,0))).extend(this.pointLocation(new Wa(this.width,this.height))).extend(this.pointLocation(new Wa(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new mi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new Wa(0,0)),p=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),y=Sr.e.transformMat4(p,p,this.pixelMatrix);return y[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,p=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Wa(0,p))}},{key:"getCameraQueryGeometry",value:function(c){var p=this.getCameraPoint();if(c.length===1)return[c[0],p];var y=p.x,P=p.y,N=p.x,ee=p.y,B=Us(c),J;try{for(B.s();!(J=B.n()).done;){var he=J.value;y=Math.min(y,he.x),P=Math.min(P,he.y),N=Math.max(N,he.x),ee=Math.max(ee,he.y)}}catch(Ye){B.e(Ye)}finally{B.f()}return[new Wa(y,P),new Wa(N,P),new Wa(N,ee),new Wa(y,ee),new Wa(y,P)]}},{key:"coordinatePoint",value:function(c){var p=Sr.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return Sr.e.transformMat4(p,p,this.pixelMatrix),new Wa(p[0]/p[3],p[1]/p[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return Mn.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,p=90,y=-180,P=180,N,ee,B,J,he=this.size,Ye=this.unmodified;if(this.latRange){var He=this.latRange;c=mu(He[1])*this.worldSize,p=mu(He[0])*this.worldSize,N=p-c<he.y?he.y/(p-c):0}if(this.lngRange){var It=this.lngRange;y=ll(It[0])*this.worldSize,P=ll(It[1])*this.worldSize,ee=P-y<he.x?he.x/(P-y):0}var Ft=this.point,Yt=Math.max(ee||0,N||0);if(Yt){this.center=this.unproject(new Wa(ee?(P+y)/2:Ft.x,N?(p+c)/2:Ft.y)),this.zoom+=this.scaleZoom(Yt),this.unmodified=Ye,this.constraining=!1;return}if(this.latRange){var lr=Ft.y,_r=he.y/2;lr-_r<c&&(J=c+_r),lr+_r>p&&(J=p-_r)}if(this.lngRange){var un=Ft.x,Nr=he.x/2;un-Nr<y&&(B=y+Nr),un+Nr>P&&(B=P-Nr)}(B!==void 0||J!==void 0)&&(this.center=this.unproject(new Wa(B!==void 0?B:Ft.x,J!==void 0?J:Ft.y))),this.unmodified=Ye,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,p=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var y=Math.PI/2+this._pitch,P=this._fov*(.5+p.y/this.height),N=Math.sin(P)*this.cameraToCenterDistance/Math.sin(Ou(Math.PI-y-P,.01,Math.PI-.01)),ee=this.point,B=ee.x,J=ee.y,he=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToCenterDistance,Ye=he*1.01,He=this.height/50,It=Sr.b.create();Sr.b.perspective(It,this._fov,this.width/this.height,He,Ye),It[8]=-p.x*2/this.width,It[9]=p.y*2/this.height,Sr.b.scale(It,It,[1,-1,1]),Sr.b.translate(It,It,[0,0,-this.cameraToCenterDistance]),Sr.b.rotateX(It,It,this._pitch),Sr.b.rotateZ(It,It,this.angle),Sr.b.translate(It,It,[-B,-J,0]),this.mercatorMatrix=Sr.b.scale(Sr.b.create(),It,[this.worldSize,this.worldSize,this.worldSize]),Sr.b.scale(It,It,Sr.d.fromValues(1,1,Ku(1,this.center.lat)*this.worldSize)),this.projMatrix=It,this.invProjMatrix=Sr.b.invert(Sr.b.create(),this.projMatrix);var Ft=this.width%2/2,Yt=this.height%2/2,lr=Math.cos(this.angle),_r=Math.sin(this.angle),un=B-Math.round(B)+lr*Ft+_r*Yt,Nr=J-Math.round(J)+lr*Yt+_r*Ft,rn=Sr.b.clone(It);if(Sr.b.translate(rn,rn,[un>.5?un-1:un,Nr>.5?Nr-1:Nr,0]),this.alignedProjMatrix=rn,It=Sr.b.create(),Sr.b.scale(It,It,[this.width/2,-this.height/2,1]),Sr.b.translate(It,It,[1,-1,0]),this.labelPlaneMatrix=It,It=Sr.b.create(),Sr.b.scale(It,It,[1,-1,1]),Sr.b.translate(It,It,[-1,-1,0]),Sr.b.scale(It,It,[2/this.width,2/this.height,1]),this.glCoordMatrix=It,this.pixelMatrix=Sr.b.multiply(Sr.b.create(),this.labelPlaneMatrix,this.projMatrix),It=Sr.b.invert(Sr.b.create(),this.pixelMatrix),!It)throw new Error("failed to invert matrix");this.pixelMatrixInverse=It,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),v}(),ei=function v(h){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Me()(this,v),this.type=void 0,ki()(this,c),this.type=h};function qr(v){var h=Vc();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function Vc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var _c=function(v){pr()(c,v);var h=qr(c);function c(p){var y;Me()(this,c),y=h.call(this),y.transform=void 0,y.options=void 0,y.moving=void 0,y.zooming=void 0,y.rotating=void 0,y.pitching=void 0,y.padding=void 0,y.bearingSnap=void 0,y.easeEndTimeoutID=void 0,y.easeStart=void 0,y.easeOptions=void 0,y.easeId=void 0,y.onEaseFrame=void 0,y.onEaseEnd=void 0,y.easeFrameId=void 0,y.renderFrameCallback=function(){var he=Math.min((pu()-y.easeStart)/y.easeOptions.duration,1);y.onEaseFrame(y.easeOptions.easing(he)),he<1?y.easeFrameId=y.requestRenderFrame(y.renderFrameCallback):y.stop()},y.options=p;var P=p.minZoom,N=p.maxZoom,ee=p.minPitch,B=p.maxPitch,J=p.renderWorldCopies;return y.moving=!1,y.zooming=!1,y.bearingSnap=p.bearingSnap,y.transform=new Bs(P,N,ee,B,J),y}return qe()(c,[{key:"requestRenderFrame",value:function(y){return 0}},{key:"cancelRenderFrame",value:function(y){return}},{key:"getCenter",value:function(){var y=this.transform.center,P=y.lng,N=y.lat;return new Ti(P,N)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(y,P){return this.jumpTo({center:y},P)}},{key:"setPitch",value:function(y,P){return this.jumpTo({pitch:y},P),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(y,P,N){return this.easeTo(ki()({center:y},P),N)}},{key:"zoomOut",value:function(y,P){return this.zoomTo(this.getZoom()-1,y,P),this}},{key:"setBearing",value:function(y,P){return this.jumpTo({bearing:y},P),this}},{key:"setZoom",value:function(y,P){return this.jumpTo({zoom:y},P),this}},{key:"zoomIn",value:function(y,P){return this.zoomTo(this.getZoom()+1,y,P),this}},{key:"zoomTo",value:function(y,P,N){return this.easeTo(ki()({zoom:y},P),N)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(y,P){return this.jumpTo({padding:y},P),this}},{key:"rotateTo",value:function(y,P,N){return this.easeTo(ki()({bearing:y},P),N)}},{key:"resetNorth",value:function(y,P){return this.rotateTo(0,ki()({duration:1e3},y),P),this}},{key:"resetNorthPitch",value:function(y,P){return this.easeTo(ki()({bearing:0,pitch:0,duration:1e3},y),P),this}},{key:"fitBounds",value:function(y,P,N){return this.fitInternal(this.cameraForBounds(y,P),P,N)}},{key:"cameraForBounds",value:function(y,P){return y=mi.convert(y),this.cameraForBoxAndBearing(y.getNorthWest(),y.getSouthEast(),0,P)}},{key:"snapToNorth",value:function(y,P){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(y,P):this}},{key:"jumpTo",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1?arguments[1]:void 0;this.stop();var N=this.transform,ee=!1,B=!1,J=!1;return y.zoom&&N.zoom!==+y.zoom&&(ee=!0,N.zoom=+y.zoom),y.center!==void 0&&(N.center=Ti.convert(y.center)),y.bearing&&N.bearing!==+y.bearing&&(B=!0,N.bearing=+y.bearing),y.pitch&&N.pitch!==+y.pitch&&(J=!0,N.pitch=+y.pitch),y.padding!=null&&!N.isPaddingEqual(y.padding)&&(N.padding=y.padding),this.emit("movestart",new ei("movestart",P)),this.emit("move",new ei("move",P)),ee&&(this.emit("zoomstart",new ei("zoomstart",P)),this.emit("zoom",new ei("zoom",P)),this.emit("zoomend",new ei("zoomend",P))),B&&(this.emit("rotatestart",new ei("rotatestart",P)),this.emit("rotate",new ei("rotate",P)),this.emit("rotateend",new ei("rotateend",P))),J&&(this.emit("pitchstart",new ei("pitchstart",P)),this.emit("pitch",new ei("pitch",P)),this.emit("pitchend",new ei("pitchend",P))),this.emit("moveend",new ei("moveend",P))}},{key:"easeTo",value:function(){var y=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;P=ki()({offset:[0,0],duration:500,easing:Bc},P),(P.animate===!1||!P.essential&&Yu())&&(P.duration=0);var ee=this.transform,B=this.getZoom(),J=this.getBearing(),he=this.getPitch(),Ye=this.getPadding(),He=P.zoom?+P.zoom:B,It=P.bearing?this.normalizeBearing(P.bearing,J):J,Ft=P.pitch?+P.pitch:he,Yt=P.padding?P.padding:ee.padding,lr=Wa.convert(P.offset),_r=ee.centerPoint.add(lr),un=ee.pointLocation(_r),Nr=Ti.convert(P.center||un);this.normalizeCenter(Nr);var rn=ee.project(un),yn=ee.project(Nr).sub(rn),Vn=ee.zoomScale(He-B),ua,ma;P.around&&(ua=Ti.convert(P.around),ma=ee.locationPoint(ua));var Pi={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||He!==B,this.rotating=this.rotating||J!==It,this.pitching=this.pitching||Ft!==he,this.padding=!ee.isPaddingEqual(Yt),this.easeId=P.easeId,this.prepareEase(N,P.noMoveStart,Pi),clearTimeout(this.easeEndTimeoutID),this.ease(function(Ha){if(y.zooming&&(ee.zoom=Fs(B,He,Ha)),y.rotating&&(ee.bearing=Fs(J,It,Ha)),y.pitching&&(ee.pitch=Fs(he,Ft,Ha)),y.padding&&(ee.interpolatePadding(Ye,Yt,Ha),_r=ee.centerPoint.add(lr)),ua)ee.setLocationAtPoint(ua,ma);else{var Ho=ee.zoomScale(ee.zoom-B),Qo=He>B?Math.min(2,Vn):Math.max(.5,Vn),_u=Math.pow(Qo,1-Ha),us=ee.unproject(rn.add(yn.mult(Ha*_u)).mult(Ho));ee.setLocationAtPoint(ee.renderWorldCopies?us.wrap():us,_r)}y.fireMoveEvents(N)},function(Ha){y.afterEase(N,Ha)},P),this}},{key:"flyTo",value:function(){var y=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;if(!P.essential&&Yu()){var ee=ji(P,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ee,N)}this.stop(),P=ki()({offset:[0,0],speed:1.2,curve:1.42,easing:Bc},P);var B=this.transform,J=this.getZoom(),he=this.getBearing(),Ye=this.getPitch(),He=this.getPadding(),It=P.zoom?Ou(+P.zoom,B.minZoom,B.maxZoom):J,Ft=P.bearing?this.normalizeBearing(P.bearing,he):he,Yt=P.pitch?+P.pitch:Ye,lr="padding"in P?P.padding:B.padding,_r=B.zoomScale(It-J),un=Wa.convert(P.offset),Nr=B.centerPoint.add(un),rn=B.pointLocation(Nr),yn=Ti.convert(P.center||rn);this.normalizeCenter(yn);var Vn=B.project(rn),ua=B.project(yn).sub(Vn),ma=P.curve,Pi=Math.max(B.width,B.height),Ha=Pi/_r,Ho=ua.mag();if("minZoom"in P){var Qo=Ou(Math.min(P.minZoom,J,It),B.minZoom,B.maxZoom),_u=Pi/B.zoomScale(Qo-J);ma=Math.sqrt(_u/Ho*2)}var us=ma*ma;function Ml(io){var ou=(Ha*Ha-Pi*Pi+(io?-1:1)*us*us*Ho*Ho)/(2*(io?Ha:Pi)*us*Ho);return Math.log(Math.sqrt(ou*ou+1)-ou)}function Kc(io){return(Math.exp(io)-Math.exp(-io))/2}function Pc(io){return(Math.exp(io)+Math.exp(-io))/2}function ao(io){return Kc(io)/Pc(io)}var ai=Ml(0),Of=function(ou){return Pc(ai)/Pc(ai+ma*ou)},dc=function(ou){return Pi*((Pc(ai)*ao(ai+ma*ou)-Kc(ai))/us)/Ho},Pl=(Ml(1)-ai)/ma;if(Math.abs(Ho)<1e-6||!isFinite(Pl)){if(Math.abs(Pi-Ha)<1e-6)return this.easeTo(P,N);var $c=Ha<Pi?-1:1;Pl=Math.abs(Math.log(Ha/Pi))/ma,dc=function(){return 0},Of=function(ou){return Math.exp($c*ma*ou)}}if("duration"in P)P.duration=+P.duration;else{var Jf="screenSpeed"in P?+P.screenSpeed/ma:+P.speed;P.duration=1e3*Pl/Jf}return P.maxDuration&&P.duration>P.maxDuration&&(P.duration=0),this.zooming=!0,this.rotating=he!==Ft,this.pitching=Yt!==Ye,this.padding=!B.isPaddingEqual(lr),this.prepareEase(N,!1),this.ease(function(io){var ou=io*Pl,mf=1/Of(ou);B.zoom=io===1?It:J+B.scaleZoom(mf),y.rotating&&(B.bearing=Fs(he,Ft,io)),y.pitching&&(B.pitch=Fs(Ye,Yt,io)),y.padding&&(B.interpolatePadding(He,lr,io),Nr=B.centerPoint.add(un));var sh=io===1?yn:B.unproject(Vn.add(ua.mult(dc(ou))).mult(mf));B.setLocationAtPoint(B.renderWorldCopies?sh.wrap():sh,Nr),y.fireMoveEvents(N)},function(){return y.afterEase(N)},P),this}},{key:"fitScreenCoordinates",value:function(y,P,N,ee,B){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Wa.convert(y)),this.transform.pointLocation(Wa.convert(P)),N,ee),ee,B)}},{key:"stop",value:function(y,P){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var N=this.onEaseEnd;delete this.onEaseEnd,N.call(this,P)}return this}},{key:"normalizeBearing",value:function(y,P){y=ql(y,-180,180);var N=Math.abs(y-P);return Math.abs(y-360-P)<N&&(y-=360),Math.abs(y+360-P)<N&&(y+=360),y}},{key:"normalizeCenter",value:function(y){var P=this.transform;if(!P.renderWorldCopies||P.lngRange)return;var N=y.lng-P.center.lng;y.lng+=N>180?-360:N<-180?360:0}},{key:"fireMoveEvents",value:function(y){this.emit("move",new ei("move",y)),this.zooming&&this.emit("zoom",new ei("zoom",y)),this.rotating&&this.emit("rotate",new ei("rotate",y)),this.pitching&&this.emit("rotate",new ei("pitch",y))}},{key:"prepareEase",value:function(y){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!P&&!N.moving&&this.emit("movestart",new ei("movestart",y)),this.zooming&&!N.zooming&&this.emit("zoomstart",new ei("zoomstart",y)),this.rotating&&!N.rotating&&this.emit("rotatestart",new ei("rotatestart",y)),this.pitching&&!N.pitching&&this.emit("pitchstart",new ei("pitchstart",y))}},{key:"afterEase",value:function(y,P){if(this.easeId&&P&&this.easeId===P)return;delete this.easeId;var N=this.zooming,ee=this.rotating,B=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,N&&this.emit("zoomend",new ei("zoomend",y)),ee&&this.emit("rotateend",new ei("rotateend",y)),B&&this.emit("pitchend",new ei("pitchend",y)),this.emit("moveend",new ei("moveend",y))}},{key:"ease",value:function(y,P,N){N.animate===!1||N.duration===0?(y(1),P()):(this.easeStart=pu(),this.easeOptions=N,this.onEaseFrame=y,this.onEaseEnd=P,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(y,P,N,ee){var B={top:0,bottom:0,right:0,left:0};if(ee=ki()({padding:B,offset:[0,0],maxZoom:this.transform.maxZoom},ee),typeof ee.padding=="number"){var J=ee.padding;ee.padding={top:J,bottom:J,right:J,left:J}}ee.padding=ki()(B,ee.padding);var he=this.transform,Ye=he.padding,He=he.project(Ti.convert(y)),It=he.project(Ti.convert(P)),Ft=He.rotate(-N*Math.PI/180),Yt=It.rotate(-N*Math.PI/180),lr=new Wa(Math.max(Ft.x,Yt.x),Math.max(Ft.y,Yt.y)),_r=new Wa(Math.min(Ft.x,Yt.x),Math.min(Ft.y,Yt.y)),un=lr.sub(_r),Nr=(he.width-(Ye.left+Ye.right+ee.padding.left+ee.padding.right))/un.x,rn=(he.height-(Ye.top+Ye.bottom+ee.padding.top+ee.padding.bottom))/un.y;if(rn<0||Nr<0)return;var yn=Math.min(he.scaleZoom(he.scale*Math.min(Nr,rn)),ee.maxZoom),Vn=Wa.convert(ee.offset),ua=(ee.padding.left-ee.padding.right)/2,ma=(ee.padding.top-ee.padding.bottom)/2,Pi=new Wa(Vn.x+ua,Vn.y+ma),Ha=Pi.mult(he.scale/he.zoomScale(yn)),Ho=he.unproject(He.add(It).div(2).sub(Ha));return{center:Ho,zoom:yn,bearing:N}}},{key:"fitInternal",value:function(y,P,N){return y?(P=ki()(y,P),delete P.padding,P.linear?this.easeTo(P,N):this.flyTo(P,N)):this}}]),c}(il.EventEmitter);function cl(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=vu(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function vu(v,h){if(!v)return;if(typeof v=="string")return Ps(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ps(v,h)}function Ps(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var Ls={},$o=Ls;Ls.create=function(v,h,c){var p=window.document.createElement(v);return h!==void 0&&(p.className=h),c&&c.appendChild(p),p},Ls.createNS=function(v,h){var c=window.document.createElementNS(v,h);return c};var ko=window.document&&window.document.documentElement.style;function fl(v){if(!ko)return v[0];var h=cl(v),c;try{for(h.s();!(c=h.n()).done;){var p=c.value;if(p in ko)return p}}catch(y){h.e(y)}finally{h.f()}return v[0]}var _l=fl(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),zl;Ls.disableDrag=function(){ko&&_l&&(zl=ko[_l],ko[_l]="none")},Ls.enableDrag=function(){ko&&_l&&(ko[_l]=zl)};var uf=fl(["transform","WebkitTransform"]);Ls.setTransform=function(v,h){v.style[uf]=h};var Fl=!1;try{var Rs=Object.defineProperty({},"passive",{get:function(){Fl=!0}});window.addEventListener("test",Rs,Rs),window.removeEventListener("test",Rs,Rs)}catch(v){Fl=!1}Ls.addEventListener=function(v,h,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Fl?v.addEventListener(h,c,p):v.addEventListener(h,c,p.capture)},Ls.removeEventListener=function(v,h,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Fl?v.removeEventListener(h,c,p):v.removeEventListener(h,c,p.capture)};var as=function v(h){h.preventDefault(),h.stopPropagation(),window.removeEventListener("click",v,!0)};Ls.suppressClick=function(){window.addEventListener("click",as,!0),window.setTimeout(function(){window.removeEventListener("click",as,!0)},0)},Ls.mousePos=function(v,h){var c=v.getBoundingClientRect();return new Wa(h.clientX-c.left-v.clientLeft,h.clientY-c.top-v.clientTop)},Ls.touchPos=function(v,h){var c=v.getBoundingClientRect(),p=[],y=cl(h),P;try{for(y.s();!(P=y.n()).done;){var N=P.value;p.push(new Wa(N.clientX-c.left-v.clientLeft,N.clientY-c.top-v.clientTop))}}catch(ee){y.e(ee)}finally{y.f()}return p},Ls.mouseButton=function(v){return typeof window.InstallTrigger!="undefined"&&v.button===2&&v.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button},Ls.remove=function(v){v.parentNode&&v.parentNode.removeChild(v)};function Pa(v){var h=$u();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function $u(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var zi=function(v){pr()(c,v);var h=Pa(c);function c(p,y,P){var N,ee=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Me()(this,c);var B=$o.mousePos(y.getCanvasContainer(),P),J=y.unproject(B);return N=h.call(this,p,ki()({point:B,lngLat:J,originalEvent:P},ee)),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.point=void 0,N.lngLat=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N.target=y,N}return qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ei);function Co(v){var h=Sl();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function Sl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var gu=function(v){pr()(c,v);var h=Co(c);function c(p,y,P){var N;Me()(this,c);var ee=p==="touchend"?P.changedTouches:P.touches,B=$o.touchPos(y.getCanvasContainer(),ee),J=B.map(function(He){return y.unproject(He)}),he=B.reduce(function(He,It,Ft,Yt){return He.add(It.div(Yt.length))},new Wa(0,0)),Ye=y.unproject(he);return N=h.call(this,p,{points:B,point:he,lngLats:J,lngLat:Ye,originalEvent:P}),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.lngLat=void 0,N.point=void 0,N.points=void 0,N.lngLats=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N}return qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ei);function yu(v){var h=Ss();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function Ss(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Sc=function(v){pr()(c,v);var h=yu(c);function c(p,y,P){var N;return Me()(this,c),N=h.call(this,p,{originalEvent:P}),N.type=void 0,N.originalEvent=void 0,N.defaultPrevented=void 0,N.target=void 0,N.defaultPrevented=!1,N}return qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ei),Yn=function(){function v(h){Me()(this,v),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=h}return qe()(v,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new zi(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new zi("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new zi(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),v}(),Nn=function(){function v(h,c){Me()(this,v),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=h,this.el=h.getCanvasContainer(),this.container=h.getContainer(),this.clickTolerance=c.clickTolerance||1}return qe()(v,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,p){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;$o.disableDrag(),this.startPos=this.lastPos=p,this.active=!0}},{key:"mousemoveWindow",value:function(c,p){if(!this.active)return;var y=p;if(this.lastPos.equals(y)||!this.box&&y.dist(this.startPos)<this.clickTolerance)return;var P=this.startPos;this.lastPos=y,this.box||(this.box=$o.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var N=Math.min(P.x,y.x),ee=Math.max(P.x,y.x),B=Math.min(P.y,y.y),J=Math.max(P.y,y.y);$o.setTransform(this.box,"translate(".concat(N,"px,").concat(B,"px)")),this.box&&(this.box.style.width="".concat(ee-N,"px"),this.box.style.height="".concat(J-B,"px"))}},{key:"mouseupWindow",value:function(c,p){var y=this;if(!this.active)return;if(c.button!==0)return;var P=this.startPos,N=p;if(this.reset(),$o.suppressClick(),P.x===N.x&&P.y===N.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new ei("boxzoomend",{originalEvent:c})),{cameraAnimation:function(B){return B.fitScreenCoordinates(P,N,y.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&($o.remove(this.box),this.box=null),$o.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,p){return this.map.emit(c,new ei(c,{originalEvent:p}))}}]),v}(),Ac=Nn,ms=function(){function v(){Me()(this,v),this.enabled=void 0,this.active=void 0,this.reset()}return qe()(v,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,p){return c.preventDefault(),{cameraAnimation:function(P){P.easeTo({duration:300,zoom:P.getZoom()+(c.shiftKey?-1:1),around:P.unproject(p)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function jo(v){var h=wo();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function wo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var ru=function(v){pr()(c,v);var h=jo(c);function c(){var p;Me()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.type="renderFrame",p.timeStamp=void 0,p}return c}(ei);function Pu(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=tc(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function tc(v,h){if(!v)return;if(typeof v=="string")return Za(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Za(v,h)}function Za(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var Hi={linearity:.3,easing:ol(0,0,.3,1)},hl=ki()({deceleration:2500,maxSpeed:1400},Hi),dl=ki()({deceleration:20,maxSpeed:1400},Hi),rc=ki()({deceleration:1e3,maxSpeed:360},Hi),Lu=ki()({deceleration:1e3,maxSpeed:90},Hi),Is=function(){function v(h){Me()(this,v),this.map=void 0,this.inertiaBuffer=void 0,this.map=h,this.clear()}return qe()(v,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:pu(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,p=pu(),y=160;c.length>0&&p-c[0].time>y;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var p={zoom:0,bearing:0,pitch:0,pan:new Wa(0,0),pinchAround:void 0,around:void 0},y=Pu(this.inertiaBuffer),P;try{for(y.s();!(P=y.n()).done;){var N=P.value.settings;p.zoom+=N.zoomDelta||0,p.bearing+=N.bearingDelta||0,p.pitch+=N.pitchDelta||0,N.panDelta&&p.pan._add(N.panDelta),N.around&&(p.around=N.around),N.pinchAround&&(p.pinchAround=N.pinchAround)}}catch(Yt){y.e(Yt)}finally{y.f()}var ee=this.inertiaBuffer[this.inertiaBuffer.length-1],B=ee.time-this.inertiaBuffer[0].time,J={};if(p.pan.mag()){var he=vs(p.pan.mag(),B,ki()({},hl,c||{}));J.offset=p.pan.mult(he.amount/p.pan.mag()),J.center=this.map.transform.center,Ul(J,he)}if(p.zoom){var Ye=vs(p.zoom,B,dl);J.zoom=this.map.transform.zoom+Ye.amount,Ul(J,Ye)}if(p.bearing){var He=vs(p.bearing,B,rc);J.bearing=this.map.transform.bearing+Ou(He.amount,-179,179),Ul(J,He)}if(p.pitch){var It=vs(p.pitch,B,Lu);J.pitch=this.map.transform.pitch+It.amount,Ul(J,It)}if(J.zoom||J.bearing){var Ft=p.pinchAround===void 0?p.around:p.pinchAround;J.around=Ft?this.map.unproject(Ft):this.map.getCenter()}return this.clear(),ki()(J,{noMoveStart:!0})}}]),v}();function Ul(v,h){(!v.duration||v.duration<h.duration)&&(v.duration=h.duration,v.easing=h.easing)}function vs(v,h,c){var p=c.maxSpeed,y=c.linearity,P=c.deceleration,N=Ou(v*y/(h/1e3),-p,p),ee=Math.abs(N)/(P*y);return{easing:c.easing,duration:ee*1e3,amount:N*(ee/2)}}var Ef={panStep:100,bearingStep:15,pitchStep:10},Bl=function(){function v(){Me()(this,v),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var h=Ef;this.panStep=h.panStep,this.bearingStep=h.bearingStep,this.pitchStep=h.pitchStep}return qe()(v,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var p=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var y=0,P=0,N=0,ee=0,B=0;switch(c.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:c.shiftKey?P=-1:(c.preventDefault(),ee=-1);break;case 39:c.shiftKey?P=1:(c.preventDefault(),ee=1);break;case 38:c.shiftKey?N=1:(c.preventDefault(),B=-1);break;case 40:c.shiftKey?N=-1:(c.preventDefault(),B=1);break;default:return}return{cameraAnimation:function(he){var Ye=he.getZoom();he.easeTo({duration:300,easeId:"keyboardHandler",easing:Gc,zoom:y?Math.round(Ye)+y*(c.shiftKey?2:1):Ye,bearing:he.getBearing()+P*p.bearingStep,pitch:he.getPitch()+N*p.pitchStep,offset:[-ee*p.panStep,-B*p.panStep],center:he.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function Gc(v){return v*(2-v)}var Tf=Bl,Vs=function(){function v(h,c){Me()(this,v),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=h,this.clickTolerance=c.clickTolerance}return qe()(v,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Sc(c.type,this.map,c))}},{key:"mousedown",value:function(c,p){return this.mousedownPos=p,this.firePreventable(new zi(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new zi(c.type,this.map,c))}},{key:"click",value:function(c,p){if(this.mousedownPos&&this.mousedownPos.dist(p)>=this.clickTolerance)return;this.map.emit(c.type,new zi(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new zi(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new zi(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new zi(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new gu(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new gu(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new gu(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new gu(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),v}(),Al=i("iWIM"),Vl=i.n(Al),Ru,Iu=0,Cl=2,Ju=(Ru={},fa()(Ru,Iu,1),fa()(Ru,Cl,2),Ru);function Ds(v,h){var c=Ju[h];return v.buttons===void 0||(v.buttons&c)!==c}var Cc=function(){function v(h){Me()(this,v),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=h.clickTolerance||1}return qe()(v,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,p){if(this.lastPoint)return;var y=$o.mouseButton(c);if(!this.correctButton(c,y))return;this.lastPoint=p,this.eventButton=y}},{key:"mousemoveWindow",value:function(c,p){var y=this.lastPoint;if(!y)return;if(c.preventDefault(),Ds(c,this.eventButton)){this.reset();return}return!this.moved&&p.dist(y)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=p,this.move(y,p))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var p=$o.mouseButton(c);if(p!==this.eventButton)return;this.moved&&$o.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,p){return!1}},{key:"move",value:function(c,p){return}}]),v}();function nc(v){var h=ac();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function ac(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var ic=function(v){pr()(c,v);var h=nc(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"mousedown",value:function(y,P){Vl()(xn()(c.prototype),"mousedown",this).call(this,y,P),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(y,P){return{around:P,panDelta:P.sub(y)}}},{key:"correctButton",value:function(y,P){return P===Iu&&!y.ctrlKey}}]),c}(Cc);function s(v){var h=a();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function a(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var n=function(v){pr()(c,v);var h=s(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"correctButton",value:function(y,P){return P===Iu&&y.ctrlKey||P===Cl}},{key:"move",value:function(y,P){var N=-.5,ee=(P.y-y.y)*N;if(ee)return this.active=!0,{pitchDelta:ee}}},{key:"contextmenu",value:function(y){y.preventDefault()}}]),c}(Cc);function l(v){var h=b();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function b(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var O=function(v){pr()(c,v);var h=l(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"contextmenu",value:function(y){y.preventDefault()}},{key:"correctButton",value:function(y,P){return P===Iu&&y.ctrlKey||P===Cl}},{key:"move",value:function(y,P){var N=.8,ee=(P.x-y.x)*N;if(ee)return this.active=!0,{bearingDelta:ee}}}]),c}(Cc),R=4.000244140625,j=1/100,ue=1/450,Te=2,Xe=function(){function v(h,c){var p=this;Me()(this,v),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!p.frameId)return;if(p.frameId=null,!p.isActive())return;var y=p.map.transform;if(p.delta!==0){var P=p.type==="wheel"&&Math.abs(p.delta)>R?p.wheelZoomRate:p.defaultZoomRate,N=Te/(1+Math.exp(-Math.abs(p.delta*P)));p.delta<0&&N!==0&&(N=1/N);var ee=typeof p.targetZoom=="number"?y.zoomScale(p.targetZoom):y.scale;p.targetZoom=Math.min(y.maxZoom,Math.max(y.minZoom,y.scaleZoom(ee*N))),p.type==="wheel"&&(p.startZoom=y.zoom,p.easing=p.smoothOutEasing(200)),p.delta=0}var B=typeof p.targetZoom=="number"?p.targetZoom:y.zoom,J=p.startZoom,he=p.easing,Ye=!1,He;if(p.type==="wheel"&&J&&he){var It=Math.min((pu()-p.lastWheelEventTime)/200,1),Ft=he(It);He=Fs(J,B,Ft),It<1?p.frameId||(p.frameId=!0):Ye=!0}else He=B,Ye=!0;return p.active=!0,Ye&&(p.active=!1,p.finishTimeout=setTimeout(function(){p.zooming=!1,p.handler.triggerRenderFrame(),delete p.targetZoom,delete p.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ye,zoomDelta:He-y.zoom,around:p.aroundPoint,originalEvent:p.lastWheelEvent}},this.map=h,this.el=h.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=j,this.wheelZoomRate=ue}return qe()(v,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var p=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,y=pu(),P=y-(this.lastWheelEventTime||0);this.lastWheelEventTime=y,p!==0&&p%R===0?this.type="wheel":p!==0&&Math.abs(p)<4?this.type="trackpad":P>400?(this.type=null,this.lastValue=p,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(P*p)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,p+=this.lastValue)),c.shiftKey&&p&&(p=p/4),this.type&&(this.lastWheelEvent=c,this.delta-=p,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var p=$o.mousePos(this.el,c);this.around=Ti.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(p)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var p=Bc;if(this.prevEase){var y=this.prevEase,P=(pu()-y.start)/y.duration,N=y.easing(P+.01)-y.easing(P),ee=.27/Math.sqrt(N*N+1e-4)*.01,B=Math.sqrt(.27*.27-ee*ee);p=ol(ee,B,.25,1)}return this.prevEase={start:pu(),duration:c,easing:p},p}}]),v}(),Je=Xe,tt=function(){function v(h,c){Me()(this,v),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=h,this.tapZoom=c}return qe()(v,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),v}(),Dt=function(){function v(h,c,p){Me()(this,v),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=h,this.mousePan=c,this.touchPan=p}return qe()(v,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),v}(),Lt=function(){function v(h,c,p){Me()(this,v),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=h.pitchWithRotate,this.mouseRotate=c,this.mousePitch=p}return qe()(v,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),v}(),Zt=function(){function v(h,c,p,y){Me()(this,v),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=h,this.touchZoom=c,this.touchRotate=p,this.tapDragZoom=y,this.rotationDisabled=!1,this.enabled=!0}return qe()(v,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),v}();function Rt(v,h){for(var c={},p=0;p<v.length;p++)c[v[p].identifier]=h[p];return c}function Bt(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=qt(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function qt(v,h){if(!v)return;if(typeof v=="string")return Qt(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Qt(v,h)}function Qt(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function Pr(v){var h=new Wa(0,0),c=Bt(v),p;try{for(c.s();!(p=c.n()).done;){var y=p.value;h._add(y)}}catch(P){c.e(P)}finally{c.f()}return h.div(v.length)}var fr=500,Tr=500,Ar=30,nn=function(){function v(h){Me()(this,v),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=h.numTouches}return qe()(v,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,p,y){if((this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=Pr(p),this.touches=Rt(y,p))}},{key:"touchmove",value:function(c,p,y){if(this.aborted||!this.centroid)return;var P=Rt(y,p);for(var N in this.touches)if(this.touches[N]){var ee=this.touches[N],B=P[N];(!B||B.dist(ee)>Ar)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,p,y){if((!this.centroid||c.timeStamp-this.startTime>Tr)&&(this.aborted=!0),y.length===0){var P=!this.aborted&&this.centroid;if(this.reset(),P)return P}}}]),v}(),Xr=function(){function v(h){Me()(this,v),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new nn(h),this.numTaps=h.numTaps,this.reset()}return qe()(v,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,p,y){this.singleTap.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){this.singleTap.touchmove(c,p,y)}},{key:"touchend",value:function(c,p,y){var P=this.singleTap.touchend(c,p,y);if(P){var N=c.timeStamp-this.lastTime<fr,ee=!this.lastTap||this.lastTap.dist(P)<Ar;if((!N||!ee)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=P,this.count===this.numTaps)return this.reset(),P}}}]),v}(),gn=function(){function v(){Me()(this,v),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new Xr({numTouches:1,numTaps:1}),this.reset()}return qe()(v,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,p,y){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>fr&&this.reset(),this.tapTime?y.length>0&&(this.swipePoint=p[0],this.swipeTouch=y[0].identifier):this.tap.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){if(!this.tapTime)this.tap.touchmove(c,p,y);else if(this.swipePoint){if(y[0].identifier!==this.swipeTouch)return;var P=p[0],N=P.y-this.swipePoint.y;return this.swipePoint=P,c.preventDefault(),this.active=!0,{zoomDelta:N/128}}}},{key:"touchend",value:function(c,p,y){if(this.tapTime)this.swipePoint&&(y.length===0&&this.reset());else{var P=this.tap.touchend(c,p,y);P&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}(),Pn=function(){function v(){Me()(this,v),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new Xr({numTouches:1,numTaps:2}),this.zoomOut=new Xr({numTouches:2,numTaps:1}),this.reset()}return qe()(v,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,p,y){this.zoomIn.touchstart(c,p,y),this.zoomOut.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){this.zoomIn.touchmove(c,p,y),this.zoomOut.touchmove(c,p,y)}},{key:"touchend",value:function(c,p,y){var P=this,N=this.zoomIn.touchend(c,p,y),ee=this.zoomOut.touchend(c,p,y);if(N)return this.active=!0,c.preventDefault(),setTimeout(function(){return P.reset()},0),{cameraAnimation:function(J){return J.easeTo({duration:300,zoom:J.getZoom()+1,around:J.unproject(N)},{originalEvent:c})}};if(ee)return this.active=!0,c.preventDefault(),setTimeout(function(){return P.reset()},0),{cameraAnimation:function(J){return J.easeTo({duration:300,zoom:J.getZoom()-1,around:J.unproject(ee)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}(),Jn=function(){function v(h){Me()(this,v),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=h.clickTolerance||1,this.reset()}return qe()(v,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Wa(0,0)}},{key:"touchstart",value:function(c,p,y){return this.calculateTransform(c,p,y)}},{key:"touchmove",value:function(c,p,y){return this.active?(c.preventDefault(),this.calculateTransform(c,p,y)):void 0}},{key:"touchend",value:function(c,p,y){this.calculateTransform(c,p,y),this.active&&y.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,p,y){y.length>0&&(this.active=!0);var P=Rt(y,p),N=new Wa(0,0),ee=new Wa(0,0),B=0;for(var J in P)if(P[J]){var he=P[J],Ye=this.touches[J];Ye&&(N._add(he),ee._add(he.sub(Ye)),B++,P[J]=he)}if(this.touches=P,B<this.minTouches||!ee.mag())return;var He=ee.div(B);if(this.sum._add(He),this.sum.mag()<this.clickTolerance)return;var It=N.div(B);return{around:It,panDelta:He}}}]),v}(),aa=function(){function v(){Me()(this,v),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return qe()(v,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,p,y){return}},{key:"touchstart",value:function(c,p,y){if(this.firstTwoTouches||y.length<2)return;this.firstTwoTouches=[y[0].identifier,y[1].identifier],this.start([p[0],p[1]])}},{key:"touchmove",value:function(c,p,y){if(!this.firstTwoTouches)return;c.preventDefault();var P=da()(this.firstTwoTouches,2),N=P[0],ee=P[1],B=ba(y,p,N),J=ba(y,p,ee);if(!B||!J)return;var he=this.aroundCenter?null:B.add(J).div(2);return this.move([B,J],he,c)}},{key:"touchend",value:function(c,p,y){if(!this.firstTwoTouches)return;var P=da()(this.firstTwoTouches,2),N=P[0],ee=P[1],B=ba(y,p,N),J=ba(y,p,ee);if(B&&J)return;this.active&&$o.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function ba(v,h,c){for(var p=0;p<v.length;p++)if(v[p].identifier===c)return h[p]}function Xa(v){var h=_n();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function _n(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function ia(v){return Math.abs(v.y)>Math.abs(v.x)}var xa=100,Wn=function(v){pr()(c,v);var h=Xa(c);function c(){var p;Me()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.valid=void 0,p.firstMove=void 0,p.lastPoints=void 0,p}return qe()(c,[{key:"reset",value:function(){Vl()(xn()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(y){this.lastPoints=y,ia(y[0].sub(y[1]))&&(this.valid=!1)}},{key:"move",value:function(y,P,N){var ee=y[0].sub(this.lastPoints[0]),B=y[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(ee,B,N.timeStamp),!this.valid)return;this.lastPoints=y,this.active=!0;var J=(ee.y+B.y)/2,he=-.5;return{pitchDelta:J*he}}},{key:"gestureBeginsVertically",value:function(y,P,N){if(this.valid!==void 0)return this.valid;var ee=2,B=y.mag()>=ee,J=P.mag()>=ee;if(!B&&!J)return;if(!B||!J)return this.firstMove===void 0&&(this.firstMove=N),N-this.firstMove<xa?void 0:!1;var he=y.y>0===P.y>0;return ia(y)&&ia(P)&&he}}]),c}(aa);function Aa(v){var h=ta();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function ta(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var La=25;function ja(v,h){return v.angleWith(h)*180/Math.PI}var Ji=function(v){pr()(c,v);var h=Aa(c);function c(){var p;Me()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.minDiameter=void 0,p}return qe()(c,[{key:"reset",value:function(){Vl()(xn()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(y){this.startVector=this.vector=y[0].sub(y[1]),this.minDiameter=y[0].dist(y[1])}},{key:"move",value:function(y,P){var N=this.vector;return this.vector=y[0].sub(y[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:ja(this.vector,N),pinchAround:P})}},{key:"isBelowThreshold",value:function(y){this.minDiameter=Math.min(this.minDiameter,y.mag());var P=Math.PI*this.minDiameter,N=La/P*360,ee=ja(y,this.startVector);return Math.abs(ee)<N}}]),c}(aa);function wi(v){var h=vo();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function vo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var _i=.1;function Wi(v,h){return Math.log(v/h)/Math.LN2}var Ns=function(v){pr()(c,v);var h=wi(c);function c(){var p;Me()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.distance=void 0,p.startDistance=void 0,p}return qe()(c,[{key:"reset",value:function(){Vl()(xn()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(y){this.startDistance=this.distance=y[0].dist(y[1])}},{key:"move",value:function(y,P){var N=this.distance;return this.distance=y[0].dist(y[1]),!this.active&&Math.abs(Wi(this.distance,this.startDistance))<_i?void 0:(this.active=!0,{zoomDelta:Wi(this.distance,N),pinchAround:P})}}]),c}(aa);function go(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=bu(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function bu(v,h){if(!v)return;if(typeof v=="string")return xu(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xu(v,h)}function xu(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var zo=function(h){return h.zoom||h.drag||h.pitch||h.rotate};function As(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}var Du=function(){function v(h,c){var p=this;Me()(this,v),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(Ye){p.handleEvent(Ye,"".concat(Ye.type,"Window"))},this.handleEvent=function(Ye,He){if(Ye.type==="blur"){p.stop();return}p.updatingCamera=!0;var It=Ye.type==="renderFrame"?void 0:Ye,Ft={needsRenderFrame:!1},Yt={},lr={},_r=Ye.touches?p.getMapTouches(Ye.touches):void 0,un=_r?$o.touchPos(p.el,_r):$o.mousePos(p.el,Ye),Nr=go(p.handlers),rn;try{for(Nr.s();!(rn=Nr.n()).done;){var yn=rn.value,Vn=yn.handlerName,ua=yn.handler,ma=yn.allowed;if(!ua.isEnabled())continue;var Pi=void 0;if(p.blockedByActive(lr,ma,Vn))ua.reset();else{var Ha=He||Ye.type;ua&&ua[Ha]&&(Pi=ua[Ha](Ye,un,_r),p.mergeIHandlerResult(Ft,Yt,Pi,Vn,It),Pi&&Pi.needsRenderFrame&&p.triggerRenderFrame())}(Pi||ua.isActive())&&(lr[Vn]=ua)}}catch(us){Nr.e(us)}finally{Nr.f()}var Ho={};for(var Qo in p.previousActiveHandlers)lr[Qo]||(Ho[Qo]=It);p.previousActiveHandlers=lr,(Object.keys(Ho).length||As(Ft))&&(p.changes.push([Ft,Yt,Ho]),p.triggerRenderFrame()),(Object.keys(lr).length||As(Ft))&&p.map.stop(!0),p.updatingCamera=!1;var _u=Ft.cameraAnimation;_u&&(p.inertia.clear(),p.fireEvents({},{}),p.changes=[],_u(p.map))},this.map=h,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new Is(h),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var y=this.el;this.listeners=[[y,"touchstart",{passive:!1}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];var P=go(this.listeners),N;try{for(P.s();!(N=P.n()).done;){var ee=da()(N.value,3),B=ee[0],J=ee[1],he=ee[2];$o.addEventListener(B,J,B===window.document?this.handleWindowEvent:this.handleEvent,he)}}catch(Ye){P.e(Ye)}finally{P.f()}}return qe()(v,[{key:"destroy",value:function(){var c=go(this.listeners),p;try{for(c.s();!(p=c.n()).done;){var y=da()(p.value,3),P=y[0],N=y[1],ee=y[2];$o.removeEventListener(P,N,P===window.document?this.handleWindowEvent:this.handleEvent,ee)}}catch(B){c.e(B)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=go(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var y=p.value.handler;y.reset()}}catch(P){c.e(P)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=go(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var y=p.value.handler;if(y.isActive())return!0}}catch(P){c.e(P)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(zo(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,p,y,P,N){if(!y)return;ki()(c,y);var ee={handlerName:P,originalEvent:y.originalEvent||N};y.zoomDelta!==void 0&&(p.zoom=ee),y.panDelta!==void 0&&(p.drag=ee),y.pitchDelta!==void 0&&(p.pitch=ee),y.bearingDelta!==void 0&&(p.rotate=ee)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(p){delete c.frameId,c.handleEvent(new ru("renderFrame",{timeStamp:p})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var p=this.map,y=p.getCanvasContainer();this.add("mapEvent",new Vs(p,c));var P=p.boxZoom=new Ac(p,c);this.add("boxZoom",P);var N=new Pn,ee=new ms;p.doubleClickZoom=new tt(ee,N),this.add("tapZoom",N),this.add("clickZoom",ee);var B=new gn;this.add("tapDragZoom",B);var J=p.touchPitch=new Wn;this.add("touchPitch",J);var he=new n(c),Ye=new O(c);p.dragRotate=new Lt(c,he,Ye),this.add("mouseRotate",he,["mousePitch"]),this.add("mousePitch",Ye,["mouseRotate"]);var He=new ic(c),It=new Jn(c);p.dragPan=new Dt(y,He,It),this.add("mousePan",He),this.add("touchPan",It,["touchZoom","touchRotate"]);var Ft=new Ji,Yt=new Ns;p.touchZoomRotate=new Zt(y,Yt,Ft,B),this.add("touchRotate",Ft,["touchPan","touchZoom"]),this.add("touchZoom",Yt,["touchPan","touchRotate"]);var lr=p.scrollZoom=new Je(p,this);this.add("scrollZoom",lr,["mousePan"]);var _r=p.keyboard=new Tf;this.add("keyboard",_r),this.add("blockableMapEvent",new Yn(p));for(var un=0,Nr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];un<Nr.length;un++){var rn=Nr[un];c.interactive&&c[rn]&&p[rn].enable(c[rn])}}},{key:"add",value:function(c,p,y){this.handlers.push({handlerName:c,handler:p,allowed:y}),this.handlersById[c]=p}},{key:"blockedByActive",value:function(c,p,y){for(var P in c){if(P===y)continue;if(!p||p.indexOf(P)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var p=[],y=go(c),P;try{for(y.s();!(P=y.n()).done;){var N=P.value,ee=N.target;this.el.contains(ee)&&p.push(N)}}catch(B){y.e(B)}finally{y.f()}return p}},{key:"applyChanges",value:function(){var c={},p={},y={},P=go(this.changes),N;try{for(P.s();!(N=P.n()).done;){var ee=da()(N.value,3),B=ee[0],J=ee[1],he=ee[2];B.panDelta&&(c.panDelta=(c.panDelta||new Wa(0,0))._add(B.panDelta)),B.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+B.zoomDelta),B.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+B.bearingDelta),B.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+B.pitchDelta),B.around!==void 0&&(c.around=B.around),B.pinchAround!==void 0&&(c.pinchAround=B.pinchAround),B.noInertia&&(c.noInertia=B.noInertia),ki()(p,J),ki()(y,he)}}catch(Ye){P.e(Ye)}finally{P.f()}this.updateMapTransform(c,p,y),this.changes=[]}},{key:"updateMapTransform",value:function(c,p,y){var P=this.map,N=P.transform;if(!As(c))return this.fireEvents(p,y);var ee=c.panDelta,B=c.zoomDelta,J=c.bearingDelta,he=c.pitchDelta,Ye=c.pinchAround,He=c.around;Ye!==void 0&&(He=Ye),P.stop(!0),He=He||P.transform.centerPoint;var It=N.pointLocation(ee?He.sub(ee):He);J&&(N.bearing+=J),he&&(N.pitch+=he),B&&(N.zoom+=B),N.setLocationAtPoint(It,He),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(p,y)}},{key:"fireEvents",value:function(c,p){var y=this,P=zo(this.eventsInProgress),N=zo(c),ee={};for(var B in c)if(c[B]){var J=c[B].originalEvent;this.eventsInProgress[B]||(ee["".concat(B,"start")]=J),this.eventsInProgress[B]=c[B]}!P&&N&&this.fireEvent("movestart",N.originalEvent);for(var he in ee)ee[he]&&this.fireEvent(he,ee[he]);c.rotate&&(this.bearingChanged=!0),N&&this.fireEvent("move",N.originalEvent);for(var Ye in c)if(c[Ye]){var He=c[Ye].originalEvent;this.fireEvent(Ye,He)}var It={},Ft;for(var Yt in this.eventsInProgress)if(this.eventsInProgress[Yt]){var lr=this.eventsInProgress[Yt],_r=lr.handlerName,un=lr.originalEvent;this.handlersById[_r].isActive()||(delete this.eventsInProgress[Yt],Ft=p[_r]||un,It["".concat(Yt,"end")]=Ft)}for(var Nr in It)It[Nr]&&this.fireEvent(Nr,It[Nr]);var rn=zo(this.eventsInProgress);if((P||N)&&!rn){this.updatingCamera=!0;var yn=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),Vn=function(ma){return ma!==0&&-y.bearingSnap<ma&&ma<y.bearingSnap};yn?(Vn(yn.bearing||this.map.getBearing())&&(yn.bearing=0),this.map.easeTo(yn,{originalEvent:Ft})):(this.map.emit("moveend",new ei("moveend",{originalEvent:Ft})),Vn(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,p){this.map.emit(c,new ei(c,p?{originalEvent:p}:{}))}}]),v}(),oc=Du,Qu=i("DzJC"),sc=i.n(Qu),uc=function(){function v(h){var c=this;Me()(this,v),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var p=c.getCurrentHash();if(p.length>=3&&!p.some(function(P){return isNaN(+P)})){var y=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(p[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:y,pitch:+(p[4]||0)}),!0}return!1},this.getCurrentHash=function(){var p=window.location.hash.replace("#","");if(c.hashName){var y;return p.split("&").map(function(P){return P.split("=")}).forEach(function(P){P[0]===c.hashName&&(y=P)}),(y&&y[1]||"").split("/")}return p.split("/")},this.updateHashUnthrottled=function(){var p=c.getHashString();try{window.history.replaceState(window.history.state,"",p)}catch(y){}},this.hashName=h&&encodeURIComponent(h),this.updateHash=sc()(this.updateHashUnthrottled,30*1e3/100)}return qe()(v,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var p=this.map.getCenter(),y=Math.round(this.map.getZoom()*100)/100,P=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,P),ee=Math.round(p.lng*N)/N,B=Math.round(p.lat*N)/N,J=this.map.getBearing(),he=this.map.getPitch(),Ye="";if(c?Ye+="/".concat(ee,"/").concat(B,"/").concat(y):Ye+="".concat(y,"/").concat(B,"/").concat(ee),(J||he)&&(Ye+="/".concat(Math.round(J*10)/10)),he&&(Ye+="/".concat(Math.round(he))),this.hashName){var He=this.hashName,It=!1,Ft=window.location.hash.slice(1).split("&").map(function(Yt){var lr=Yt.split("=")[0];return lr===He?(It=!0,"".concat(lr,"=").concat(Ye)):Yt}).filter(function(Yt){return Yt});return It||Ft.push("".concat(He,"=").concat(Ye)),"#".concat(Ft.join("&"))}return"#".concat(Ye)}}]),v}(),Nu=uc,pl=null,Cs=[],co=30,ku=1e3/co,Eu=window.performance,Oo={create:"create",load:"load",fullLoad:"fullLoad"},Mo={mark:function(h){Eu.mark(h)},frame:function(h){var c=h;if(pl!=null){var p=c-pl;Cs.push(p)}pl=c},clearMetrics:function(){pl=null,Cs=[],Eu.clearMeasures("loadTime"),Eu.clearMeasures("fullLoadTime");for(var h in Oo)Eu.clearMarks(Oo[h])},getPerformanceMetrics:function(){var h=Eu.measure("loadTime",Oo.create,Oo.load).duration,c=Eu.measure("fullLoadTime",Oo.create,Oo.fullLoad).duration,p=Cs.length,y=Cs.reduce(function(B,J){return B+J},0)/p/1e3,P=1/y,N=Cs.filter(function(B){return B>ku}).reduce(function(B,J){return B+(J-ku)/ku},0),ee=N/(p+N)*100;return{loadTime:h,fullLoadTime:c,fps:P,percentDroppedFrames:ee}}};function Po(v,h){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Jo(v))||h&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Jo(v,h){if(!v)return;if(typeof v=="string")return yo(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return yo(v,h)}function yo(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}var Fo=function(){function v(){Me()(this,v),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return qe()(v,[{key:"add",value:function(c){var p=++this.id,y=this.queue;return y.push({callback:c,id:p,cancelled:!1}),p}},{key:"remove",value:function(c){var p=this.currentlyRunning,y=p?this.queue.concat(p):this.queue,P=Po(y),N;try{for(P.s();!(N=P.n()).done;){var ee=N.value;if(ee.id===c){ee.cancelled=!0;return}}}catch(B){P.e(B)}finally{P.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=this.currentlyRunning=this.queue;this.queue=[];var y=Po(p),P;try{for(y.s();!(P=y.n()).done;){var N=P.value;if(N.cancelled)continue;if(N.callback(c),this.cleared)break}}catch(ee){y.e(ee)}finally{y.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),v}(),Gs=Fo;function wl(v){var h=Hc();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function Hc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}i("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Gl=-2,qu=22,ju=0,zu=60,Hs={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Gl,maxZoom:qu,minPitch:ju,maxPitch:zu,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},Lo=function(v){pr()(c,v);var h=wl(c);function c(p){var y;Me()(this,c),y=h.call(this,ki()({},Hs,p)),y.doubleClickZoom=void 0,y.dragRotate=void 0,y.dragPan=void 0,y.touchZoomRotate=void 0,y.scrollZoom=void 0,y.keyboard=void 0,y.touchPitch=void 0,y.boxZoom=void 0,y.handlers=void 0,y.container=void 0,y.canvas=void 0,y.canvasContainer=void 0,y.renderTaskQueue=new Gs,y.frame=void 0,y.trackResize=!0,y.hash=void 0,y.onWindowOnline=function(){y.update()},y.onWindowResize=function(N){y.trackResize&&y.resize({originalEvent:N}).update()},y.initContainer(),y.resize(),y.handlers=new oc(of()(y),y.options),typeof window!="undefined"&&(window.addEventListener("online",y.onWindowOnline,!1),window.addEventListener("resize",y.onWindowResize,!1),window.addEventListener("orientationchange",y.onWindowResize,!1));var P=typeof p.hash=="string"&&p.hash||void 0;return p.hash&&(y.hash=new Nu(P).addTo(of()(y))),(!y.hash||!y.hash.onHashChange())&&(y.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(y.resize(),y.fitBounds(p.bounds,ki()({},p.fitBoundsOptions,{duration:0})))),y}return qe()(c,[{key:"resize",value:function(y){var P=this.containerDimensions(),N=P[0],ee=P[1];this.transform.resize(N,ee);var B=!this.moving;return B&&(this.stop(),this.emit("movestart",new Event("movestart",y)),this.emit("move",new Event("move",y))),this.emit("resize",new Event("resize",y)),B&&this.emit("moveend",new Event("moveend",y)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(y){return this.transform.locationPoint(Ti.convert(y))}},{key:"unproject",value:function(y){return this.transform.pointLocation(Wa.convert(y))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(y){this.transform.setMaxBounds(mi.convert(y))}},{key:"setStyle",value:function(y){return}},{key:"setMinZoom",value:function(y){if(y=y==null?Gl:y,y>=Gl&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between ".concat(Gl," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(y){if(y=y==null?qu:y,y>=this.transform.minZoom)return this.transform.maxZoom=y,this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(y){if(y=y==null?ju:y,y<ju)throw new Error("minPitch must be greater than or equal to ".concat(ju));if(y>=ju&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between ".concat(ju," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(y){if(y=y==null?zu:y,y>zu)throw new Error("maxPitch must be less than or equal to ".concat(zu));if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(y){this.transform.renderWorldCopies=!!y}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(y){return this.update(),this.renderTaskQueue.add(y)}},{key:"cancelRenderFrame",value:function(y){return this.renderTaskQueue.remove(y)}},{key:"triggerRepaint",value:function(){var y=this;this.frame||(this.frame=Da(function(P){Mo.frame(P),y.frame=null,y.update(P)}))}},{key:"update",value:function(y){var P=this;this.frame||(this.frame=Da(function(N){Mo.frame(N),P.frame=null,P.renderTaskQueue.run(y)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var y=this.container;y.classList.add("l7-map");var P=this.canvasContainer=vn.a.create("div","l7-canvas-container",y);this.options.interactive&&P.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var y=0,P=0;return this.container&&(y=this.container.clientWidth||400,P=this.container.clientHeight||300),[y,P]}},{key:"resizeCanvas",value:function(y,P){var N=window.devicePixelRatio||1;this.canvas.width=N*y,this.canvas.height=N*P,this.canvas.style.width="".concat(y,"px"),this.canvas.style.height="".concat(P,"px")}}]),c}(_c),Wc=function(){function v(){Me()(this,v),this.viewport=void 0}return qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.center,y=c.zoom,P=c.pitch,N=c.bearing,ee=c.viewportHeight,B=c.viewportWidth;this.viewport=new vc({width:B,height:ee,longitude:p&&p[0],latitude:p&&p[1],zoom:y,pitch:P,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),v}(),gs={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},lf,Df,Nf,Bf,el,_f,cf,lc,Fu,cc,Vf,wc,Oc,Gf;function Hf(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function ih(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?Hf(Object(c),!0).forEach(function(p){fa()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Hf(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}var Wf={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},kf=12,fh=(lf=Object(Kr.injectable)(),Df=Object(Kr.inject)(pe.TYPES.MapConfig),Nf=Object(Kr.inject)(pe.TYPES.IGlobalConfigService),Bf=Object(Kr.inject)(pe.TYPES.ILogService),el=Object(Kr.inject)(pe.TYPES.ICoordinateSystemService),_f=Object(Kr.inject)(pe.TYPES.IEventEmitter),lf(cf=(lc=(Gf=function(){function v(){var h=this;Me()(this,v),this.map=void 0,Gn()(this,"config",Fu,this),Gn()(this,"configService",cc,this),Gn()(this,"logger",Vf,this),Gn()(this,"coordinateSystemService",wc,this),Gn()(this,"eventEmitter",Oc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=h.map.getCenter(),p=c.lat,y=c.lng;h.viewport.syncWithMapCamera({bearing:h.map.getBearing(),center:[y,p],viewportHeight:h.map.transform.height,pitch:h.map.getPitch(),viewportWidth:h.map.transform.width,zoom:h.map.getZoom(),cameraHeight:0}),h.viewport.getZoom()>kf?h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT_OFFSET):h.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT),h.cameraChangedCallback(h.viewport)}}return qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=vn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(Wf[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(Wf[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var h=Er()(zt.a.mark(function p(){var y,P,N,ee,B,J,he,Ye,He,It,Ft;return zt.a.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:y=this.config,P=y.id,N=P===void 0?"map":P,ee=y.attributionControl,B=ee===void 0?!1:ee,J=y.style,he=J===void 0?"light":J,Ye=y.rotation,He=Ye===void 0?0:Ye,It=y.mapInstance,Ft=Sn()(y,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new Wc,It?(this.map=It,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new Lo(ih({container:this.$mapContainer,style:this.getMapStyle(he),bearing:He},Ft))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return lr.stop()}},p,this)}));function c(){return h.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),y=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;return typeof c=="string"&&(p=document.getElementById(c)),p}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:gs[c]?gs[c]:c}}]),v}(),Gf),Fu=W()(lc.prototype,"config",[Df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cc=W()(lc.prototype,"configService",[Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vf=W()(lc.prototype,"logger",[Bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc=W()(lc.prototype,"coordinateSystemService",[el],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oc=W()(lc.prototype,"eventEmitter",[_f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lc))||cf);function fc(v){var h=ff();return function(){var p=xn()(v),y;if(h){var P=xn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return ur()(this,y)}}function ff(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var no=function(v){pr()(c,v);var h=fc(c);function c(){return Me()(this,c),h.apply(this,arguments)}return qe()(c,[{key:"getServiceConstructor",value:function(){return fh}}]),c}(or);function Hl(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function hf(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?Hl(Object(c),!0).forEach(function(p){Zc(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Hl(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function Zc(v,h,c){return h in v?Object.defineProperty(v,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[h]=c,v}function nu(v,h){return df(v)||Xc(v,h)||Sf(v,h)||Ol()}function Ol(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sf(v,h){if(!v)return;if(typeof v=="string")return Af(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Af(v,h)}function Af(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function Xc(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function df(v){if(Array.isArray(v))return v}var Yc=we.a.memo(function(v){var h=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ge.createRef)(),ee=Object(ge.useState)(),B=nu(ee,2),J=B[0],he=B[1];return Object(ge.useEffect)(function(){var Ye=new At.Scene(hf(hf({id:N.current},y),{},{map:new no(p)}));return Ye.on("loaded",function(){he(Ye),P&&P(Ye)}),function(){Ye.destroy()}},[]),Object(ge.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ge.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ge.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ge.useEffect)(function(){J&&p.pitch&&J.setPitch(p.pitch)},[p.pitch]),Object(ge.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ge.createElement)("div",{ref:N,style:h,className:c},J&&v.children))}),Wl=Yc;function ne(v,h){return ot(v)||Ae(v,h)||k(v,h)||se()}function se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(v,h){if(!v)return;if(typeof v=="string")return G(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return G(v,h)}function G(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function Ae(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function ot(v){if(Array.isArray(v))return v}var Xt=we.a.memo(function(v){var h=v.style,c=v.className,p=v.map,y=Object(ge.createRef)(),P=Object(ge.useState)(),N=ne(P,2),ee=N[0],B=N[1];return Object(ge.useEffect)(function(){var J=new At.Scene({id:y.current,map:p});return J.on("loaded",function(){B(J)}),function(){J.destroy()}},[]),we.a.createElement(ft.Provider,{value:ee},Object(ge.createElement)("div",{ref:y,style:h,className:c},ee&&v.children))});function nr(v,h){return Kn(v)||Un(v,h)||Rr(v,h)||rr()}function rr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rr(v,h){if(!v)return;if(typeof v=="string")return on(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return on(v,h)}function on(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function Un(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function Kn(v){if(Array.isArray(v))return v}var oa=we.a.memo(function(h){var c=pt(),p=Object(ge.useState)(),y=nr(p,2),P=y[1],N=h.type,ee=h.position;return Object(ge.useEffect)(function(){var B;switch(N){case"scale":B=new At.Scale({position:ee||"bottomright"});break;case"zoom":B=new At.Zoom({position:ee||"topright"});break;case"logo":B=new At.Logo({position:ee||"bottomleft"})}return P(B),c.addControl(B),function(){c.removeControl(B)}},[N,ee]),null}),ti=i("i8i4"),za=ge.useEffect,Oi=ge.useState;function ni(v){var h=v.className,c=v.style,p=v.children,y=v.position,P=pt(),N=document.createElement("div");return za(function(){var ee=new At.Control({position:y});return ee.onAdd=function(){if(h&&(N.className=h),c){var B=Object.keys(c).map(function(J){return"".concat(J,":").concat(c[J])}).join(";");N.style.cssText=B}return N},P.addControl(ee),function(){P.removeControl(ee)}},[]),Object(ti.createPortal)(p,N)}var Fi=Object(ge.createContext)({});function Ro(){return Object(ge.useContext)(Fi)}var bo=ge.useEffect,Zi=ge.memo(function(h){var c=h.layer,p=h.active;return bo(function(){c.active(p.option)},[JSON.stringify(p)]),null}),Uo=ge.useEffect,ri=ge.memo(function(h){var c=h.layer,p=h.animate;return Uo(function(){c.animate(p)},[JSON.stringify(p)]),null}),fo=ge.useEffect,au=ge.memo(function(h){var c=h.layer,p=h.color;return fo(function(){p.field?c.color(p.field,p.values):c.color(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),Si=ge.useEffect,Ui=ge.memo(function(h){var c=h.layer,p=h.filter;return Si(function(){p.field&&c.filter(p.field,p.values)},[p.field,p.values,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),Ea=ge.useEffect,Io=ge.memo(function(h){var c=h.layer,p=h.scale;return Ea(function(){c.scale(p.values)},[p.values]),null}),hc=ge.useEffect,Zf=ge.memo(function(h){var c=h.layer,p=h.select;return hc(function(){c.select(p.option)},[JSON.stringify(p)]),null}),hh=ge.useEffect,Xf=ge.memo(function(h){var c=h.layer,p=h.shape;return hh(function(){p.field?c.shape(p.field,p.values):c.shape(p.values)},[p.field,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),Uu=ge.useEffect,Yf=ge.memo(function(h){var c=h.layer,p=h.size;return Uu(function(){p.field?c.size(p.field,p.values):c.size(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null});function pf(v,h){if(v==null)return{};var c=Kf(v,h),p,y;if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(v);for(y=0;y<P.length;y++){if(p=P[y],h.indexOf(p)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(v,p))continue;c[p]=v[p]}}return c}function Kf(v,h){if(v==null)return{};var c={},p=Object.keys(v),y,P;for(P=0;P<p.length;P++){if(y=p[P],h.indexOf(y)>=0)continue;c[y]=v[y]}return c}var Sh=ge.useEffect,dh=ge.memo(function(h){var c=h.layer,p=h.source,y=p.data,P=pf(p,["data"]);return Sh(function(){c.inited?c.setData(y,P):c.source(y,P),P.autoFit&&c.fitBounds(P&&P.fitBoundsOptions)},[y,JSON.stringify(P)]),null}),Cf=ge.useEffect,oh=ge.memo(function(h){var c=h.layer,p=h.style;return Cf(function(){c.style(p)},Object.keys(p).map(function(y){return p[y]})),null});function $f(v,h){return Ah(v)||jf(v,h)||jh(v,h)||ph()}function ph(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jh(v,h){if(!v)return;if(typeof v=="string")return wf(v,h);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return wf(v,h)}function wf(v,h){(h==null||h>v.length)&&(h=v.length);for(var c=0,p=new Array(h);c<h;c++)p[c]=v[c];return p}function jf(v,h){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),h&&c.length===h);p=!0);}catch(B){y=!0,P=B}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function Ah(v){if(Array.isArray(v))return v}var xe=ge.useEffect,je=ge.useState;function bt(v,h){var c=h.source,p=h.color,y=h.shape,P=h.style,N=h.size,ee=h.scale,B=h.active,J=h.select,he=h.filter,Ye=h.animate,He=h.options,It=h.onLayerLoaded,Ft=pt(),Yt=je(),lr=$f(Yt,2),_r=lr[0],un=lr[1];if(!_r){var Nr;switch(v){case"polygonLayer":Nr=new At.PolygonLayer(He);break;case"lineLayer":Nr=new At.LineLayer(He);break;case"pointLayer":Nr=new At.PointLayer(He);break;case"heatmapLayer":Nr=new At.HeatmapLayer(He);break;case"rasterLayer":Nr=new At.RasterLayer(He);break;case"imageLayer":Nr=new At.ImageLayer(He);break;case"citybuildingLayer":Nr=new At.CityBuildingLayer(He);break;default:Nr=new At.PolygonLayer(He)}Nr.on("inited",function(){It&&It(Nr,Ft)}),un(Nr)}return xe(function(){if(_r!==void 0)return Ft.addLayer(_r),function(){Ft.removeLayer(_r)}},[]),xe(function(){_r&&Ft.render()}),xe(function(){_r&&_r.inited&&He&&_r.updateLayerConfig(He)},[He==null?void 0:He.minZoom,He==null?void 0:He.maxZoom,He==null?void 0:He.visible]),xe(function(){_r&&_r.inited&&He&&He.zIndex&&_r.setIndex(He.zIndex)},[He==null?void 0:He.zIndex]),xe(function(){_r&&_r.inited&&He&&He.blend&&_r.setBlend(He.blend)},[He==null?void 0:He.blend]),_r!=null?ge.createElement(Fi.Provider,{value:_r},ge.createElement(dh,{layer:_r,source:c}),ee&&ge.createElement(Io,{layer:_r,scale:ee}),p&&ge.createElement(au,{layer:_r,color:p}),N&&ge.createElement(Yf,{layer:_r,size:N}),y&&ge.createElement(Xf,{layer:_r,shape:y}),P&&ge.createElement(oh,{layer:_r,style:P}),B&&ge.createElement(Zi,{layer:_r,active:B}),J&&ge.createElement(Zf,{layer:_r,select:J}),he&&ge.createElement(Ui,{layer:_r,filter:he}),Ye&&ge.createElement(ri,{layer:_r,animate:Ye}),h.children):null}var vr=ge.memo(function(h){return bt("polygonLayer",h)}),Mr=ge.memo(function(h){return bt("lineLayer",h)}),Cr=ge.memo(function(h){return bt("pointLayer",h)}),gr=ge.memo(function(h){return bt("heatmapLayer",h)}),Wr=ge.memo(function(h){return bt("rasterLayer",h)}),sn=ge.memo(function(h){return bt("imageLayer",h)}),en=ge.memo(function(h){return bt("citybuildingLayer",h)}),$r=ge.useEffect,ln=ge.memo(function(v){var h=v.type,c=v.handler,p=Ro();return $r(function(){return p.off(h,c),p.on(h,c),function(){p.off(h,c)}},[h,c]),null}),An=i("dgMf"),pn=ge.memo(function(v){var h=v.className,c=v.style,p=v.title,y=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return ge.createElement("div",null,ge.createElement("div",null,y.map(function(P,N){return ge.createElement("div",{key:N.toString(),style:{background:P.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%",padding:5}})})),ge.createElement("div",null,y.map(function(P,N){return ge.createElement("div",{key:N.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%"}},P.title)})))});function Jr(v){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jr=function(c){return typeof c}:Jr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Jr(v)}function yr(v,h){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);h&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function hr(v){for(var h=1;h<arguments.length;h++){var c=arguments[h]!=null?arguments[h]:{};h%2?yr(Object(c),!0).forEach(function(p){Zr(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):yr(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function Zr(v,h,c){return h in v?Object.defineProperty(v,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[h]=c,v}function On(v,h){if(!(v instanceof h))throw new TypeError("Cannot call a class as a function")}function Lr(v,h){for(var c=0;c<h.length;c++){var p=h[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(v,p.key,p)}}function Qn(v,h,c){return h&&Lr(v.prototype,h),c&&Lr(v,c),v}function Qr(v,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(h&&h.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),h&&zr(v,h)}function zr(v,h){return zr=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p},zr(v,h)}function Br(v){var h=ra();return function(){var p=an(v),y;if(h){var P=an(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return Yr(this,y)}}function Yr(v,h){return h&&(Jr(h)==="object"||typeof h=="function")?h:Zn(v)}function Zn(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function ra(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function an(v){return an=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},an(v)}var Hr=function(v){Qr(c,v);var h=Br(c);function c(p){var y;return On(this,c),y=h.call(this,p),y.el=document.createElement("div"),y}return Qn(c,[{key:"componentDidMount",value:function(){var y=this.props,P=y.lnglat,N=y.children,ee=y.option,B=new At.Popup(hr(hr({},ee),{},{stopPropagation:!1}));P&&B.setLnglat(P),N&&B.setDOMContent(this.el),this.popup=B,this.scene.addPopup(B)}},{key:"componentDidUpdate",value:function(y){var P,N,ee,B,J,he,Ye=Array.isArray(y.lnglat)?y.lnglat:[y==null||((P=y.lnglat)===null||P===void 0)?void 0:P.lng,y==null||((N=y.lnglat)===null||N===void 0)?void 0:N.lat],He=Array.isArray(this.props.lnglat)?this.props.lnglat:[(ee=this.props)===null||ee===void 0||((B=ee.lnglat)===null||B===void 0)?void 0:B.lng,(J=this.props)===null||J===void 0||((he=J.lnglat)===null||he===void 0)?void 0:he.lat],It=Ye.toString()!==He.toString();It&&(this.popup.remove(),this.popup=new At.Popup(hr(hr({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var y=this;return ge.createElement(ft.Consumer,{},function(P){return P&&(y.scene=P),Object(ti.createPortal)(y.props.children,y.el)})}}]),c}(ge.PureComponent);function kr(v){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kr=function(c){return typeof c}:kr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},kr(v)}function pa(v,h){if(!(v instanceof h))throw new TypeError("Cannot call a class as a function")}function ca(v,h){for(var c=0;c<h.length;c++){var p=h[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(v,p.key,p)}}function jn(v,h,c){return h&&ca(v.prototype,h),c&&ca(v,c),v}function Fa(v,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(h&&h.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),h&&Sa(v,h)}function Sa(v,h){return Sa=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p},Sa(v,h)}function Ua(v){var h=ys();return function(){var p=Va(v),y;if(h){var P=Va(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return fi(this,y)}}function fi(v,h){return h&&(kr(h)==="object"||typeof h=="function")?h:Bo(v)}function Bo(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function ys(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function Va(v){return Va=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Va(v)}var xo=function(v){Fa(c,v);var h=Ua(c);function c(p){var y;return pa(this,c),y=h.call(this,p),y.el=document.createElement("div"),y}return jn(c,[{key:"componentDidMount",value:function(){var y=this.props,P=y.lnglat,N=y.children,ee=y.option,B=y.onMarkerLoaded,J=new At.Marker(ee);P&&J.setLnglat(P),N&&J.setElement(this.el),this.marker=J,B&&B(J),this.scene.addMarker(J)}},{key:"componentDidUpdate",value:function(y){var P,N=(y==null?void 0:y.lnglat.toString())!==((P=this.props)===null||P===void 0?void 0:P.lnglat.toString());N&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var y=this;return ge.createElement(ft.Consumer,{},function(P){return P&&(y.scene=P),Object(ti.createPortal)(y.props.children,y.el)})}}]),c}(ge.PureComponent),Mi=ge.useEffect,bs=ge.memo(function(v){var h=v.type,c=v.handler,p=pt();return Mi(function(){return p.on(h,c),function(){p.off(h,c)}},[h]),null}),is=bs,os=ge.useEffect,ss=ge.memo(function(h){var c=h.name,p=h.url,y=pt();return os(function(){y.addImage(c,p)},[c,p]),null}),Ws=i("tbuW"),Vo=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],ea=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.state={data:null,grid:null,loading:!1},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var p=Object(sr.a)(zt.a.mark(function P(){var N,ee,B,J;return zt.a.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return Ye.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(He){return He.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(He){return He.json()})]);case 2:N=Ye.sent,ee=Object(q.a)(N,2),B=ee[0],J=ee[1],this.setState({data:B,grid:J,loading:!0});case 7:case"end":return Ye.stop()}},P,this)}));function y(){return p.apply(this,arguments)}return y}()},{key:"render",value:function(){var y=this.state,P=y.data,N=y.grid,ee=y.loading;return ee===!1?ge.createElement(Ws.a,null):ge.createElement(yf,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},N&&ge.createElement(gr,{key:"1",source:{data:N,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),P&&[ge.createElement(Cr,{key:"2",options:{autoFit:!0},source:{data:P},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Vo},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),ge.createElement(Cr,{key:"5",source:{data:P},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(J){return J>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),c}(ge.Component),Tu={Pie:I,WaterWave:ae,Gauge:Gt,MiniArea:H,TagCloud:nt,Map:ea},xi=i("KQm4"),Cn=i("H+7v"),ga=i.n(Cn);function Ga(v){return v*1<10?"0".concat(v):v}function Go(){for(var v=[],h=0;h<24;h+=1)v.push({x:"".concat(Ga(h),":00"),y:Math.floor(Math.random()*200)+h*50});return v}var iu=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=h.call.apply(h,[this].concat(P)),p.state={activeData:Go()},p.timer=void 0,p.requestRef=void 0,p.loopData=function(){p.requestRef=requestAnimationFrame(function(){p.timer=window.setTimeout(function(){p.setState({activeData:Go()},function(){p.loopData()})},1e3)})},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var y=this.state.activeData,P=y===void 0?[]:y;return we.a.createElement("div",{className:ga.a.activeChart},we.a.createElement(Fe.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),we.a.createElement("div",{style:{marginTop:32}},we.a.createElement(H,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:P})),P&&we.a.createElement("div",null,we.a.createElement("div",{className:ga.a.activeChartGrid},we.a.createElement("p",null,Object(xi.a)(P).sort()[P.length-1].y+200," \u4EBF\u5143"),we.a.createElement("p",null,Object(xi.a)(P).sort()[Math.floor(P.length/2)].y," \u4EBF\u5143")),we.a.createElement("div",{className:ga.a.dashedLine},we.a.createElement("div",{className:ga.a.line})),we.a.createElement("div",{className:ga.a.dashedLine},we.a.createElement("div",{className:ga.a.line}))),P&&we.a.createElement("div",{className:ga.a.activeChartLegend},we.a.createElement("span",null,"00:00"),we.a.createElement("span",null,P[Math.floor(P.length/2)].x),we.a.createElement("span",null,P[P.length-1].x)))}}]),c}(ge.Component),Mc=i("Wnft"),Mt=i.n(Mc),xr=Fe.a.Countdown,mr=Date.now()+1e3*60*60*24*2+1e3*30,Rn=function(v){Object(re.a)(c,v);var h=Object(fe.a)(c);function c(){return Object(D.a)(this,c),h.apply(this,arguments)}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this.props.dispatch;y({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var y=this.props,P=y.dashboardAndmonitor,N=y.loading,ee=P.tags;return we.a.createElement(dt.a,null,we.a.createElement(we.a.Fragment,null,we.a.createElement(z.a,{gutter:24},we.a.createElement(Z.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},we.a.createElement(z.a,null,we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:Et()(124543233).format("0,0")})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(xr,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:mr,format:"HH:mm:ss:SSS"})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:Et()(234).format("0,0")}))),we.a.createElement("div",{className:Mt.a.mapChart},we.a.createElement(ea,null)))),we.a.createElement(Z.a,{xl:6,lg:24,md:24,sm:24,xs:24},we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},we.a.createElement(iu,null)),we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},we.a.createElement(Gt,{title:Object(We.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),we.a.createElement(z.a,{gutter:24},we.a.createElement(Z.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:Mt.a.pieCard},we.a.createElement(z.a,{style:{padding:"16px 0"}},we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,percent:28,title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,color:"#5DDECF",percent:22,title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,color:"#2FC25B",percent:32,title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),we.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:N,bordered:!1,bodyStyle:{overflow:"hidden"}},we.a.createElement(nt,{data:ee||[],height:161}))),we.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},we.a.createElement(ae,{height:161,title:we.a.createElement(We.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),c}(ge.Component),Na=E.default=Object(We.c)(function(v){var h=v.dashboardAndmonitor,c=v.loading;return{dashboardAndmonitor:h,loading:c.models.dashboardAndmonitor}})(Rn)},aF1E:function(Re,E,i){"use strict";i.d(E,"a",function(){return o});var T=i("lSNA"),m=i.n(T);function X(Z,D){var K=Object.keys(Z);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Z);D&&(re=re.filter(function(fe){return Object.getOwnPropertyDescriptor(Z,fe).enumerable})),K.push.apply(K,re)}return K}function z(Z){for(var D=1;D<arguments.length;D++){var K=arguments[D]!=null?arguments[D]:{};D%2?X(Object(K),!0).forEach(function(re){m()(Z,re,K[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(K)):X(Object(K)).forEach(function(re){Object.defineProperty(Z,re,Object.getOwnPropertyDescriptor(K,re))})}return Z}function o(Z,D){var K=D.sourceField,re=D.targetField,fe=D.data,Y={};return fe.forEach(function(Fe){Y[Fe[K]]=Fe}),Z.dataArray=Z.dataArray.map(function(Fe){var We=Fe[re];return z(z({},Fe),Y[We])}),Z}},aHsQ:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("6D9b"),z=i.n(X),o=i("cWXX")},aPG5:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("qK8v"),z=i("ujMp"),o=i("cSJO"),Z=function(fe,Y,Fe){try{return Fe()}catch(We){throw X.isStackOverflowExeption(We)?new Error(T.CIRCULAR_DEPENDENCY_IN_FACTORY(fe,Y.toString())):We}},D=function re(fe){return function(Y){Y.parentContext.setCurrentRequest(Y);var Fe=Y.bindings,We=Y.childRequests,ge=Y.target&&Y.target.isArray(),we=!Y.parentRequest||!Y.parentRequest.target||!Y.target||!Y.parentRequest.target.matchesArray(Y.target.serviceIdentifier);if(ge&&we)return We.map(function(Qe){var yt=re(fe);return yt(Qe)});var dt=null;if(Y.target.isOptional()&&Fe.length===0)return;var ke=Fe[0],Et=ke.scope===m.BindingScopeEnum.Singleton,Ze=ke.scope===m.BindingScopeEnum.Request;if(Et&&ke.activated)return ke.cache;if(Ze&&fe!==null&&fe.has(ke.id))return fe.get(ke.id);if(ke.type===m.BindingTypeEnum.ConstantValue)dt=ke.cache;else if(ke.type===m.BindingTypeEnum.Function)dt=ke.cache;else if(ke.type===m.BindingTypeEnum.Constructor)dt=ke.implementationType;else if(ke.type===m.BindingTypeEnum.DynamicValue&&ke.dynamicValue!==null)dt=Z("toDynamicValue",ke.serviceIdentifier,function(){return ke.dynamicValue(Y.parentContext)});else if(ke.type===m.BindingTypeEnum.Factory&&ke.factory!==null)dt=Z("toFactory",ke.serviceIdentifier,function(){return ke.factory(Y.parentContext)});else if(ke.type===m.BindingTypeEnum.Provider&&ke.provider!==null)dt=Z("toProvider",ke.serviceIdentifier,function(){return ke.provider(Y.parentContext)});else if(ke.type===m.BindingTypeEnum.Instance&&ke.implementationType!==null)dt=o.resolveInstance(ke.implementationType,We,re(fe));else{var vt=z.getServiceIdentifierAsString(Y.serviceIdentifier);throw new Error(T.INVALID_BINDING_TYPE+" "+vt)}return typeof ke.onActivation=="function"&&(dt=ke.onActivation(Y.parentContext,dt)),Et&&(ke.cache=dt,ke.activated=!0),Ze&&fe!==null&&!fe.has(ke.id)&&fe.set(ke.id,dt),dt}};function K(re){var fe=D(re.plan.rootRequest.requestScope);return fe(re.plan.rootRequest)}E.resolve=K},asDA:function(Re,E){function i(T,m,X,z){var o=-1,Z=T==null?0:T.length;for(z&&Z&&(X=T[++o]);++o<Z;)X=m(X,T[o],o,T);return X}Re.exports=i},b2z7:function(Re,E){var i=/\w*$/;function T(m){var X=new m.constructor(m.source,i.exec(m));return X.lastIndex=m.lastIndex,X}Re.exports=T},bB6j:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Normal="normal",m.PostProcessing="post-processing"})(T||(T={}))},bTtR:function(Re,E){},bYl4:function(Re,E){},bahg:function(Re,E){function i(T){return T.split("")}Re.exports=i},bl9R:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return K}),i.d(E,"multiply",function(){return re}),i.d(E,"divide",function(){return fe}),i.d(E,"ceil",function(){return Y}),i.d(E,"floor",function(){return Fe}),i.d(E,"min",function(){return We}),i.d(E,"max",function(){return ge}),i.d(E,"round",function(){return we}),i.d(E,"scale",function(){return dt}),i.d(E,"scaleAndAdd",function(){return ke}),i.d(E,"distance",function(){return Et}),i.d(E,"squaredDistance",function(){return Ze}),i.d(E,"length",function(){return vt}),i.d(E,"squaredLength",function(){return Qe}),i.d(E,"negate",function(){return yt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return De}),i.d(E,"dot",function(){return Ne}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"random",function(){return Le}),i.d(E,"transformMat4",function(){return ut}),i.d(E,"transformQuat",function(){return Gt}),i.d(E,"zero",function(){return Kt}),i.d(E,"str",function(){return ar}),i.d(E,"exactEquals",function(){return oe}),i.d(E,"equals",function(){return Q}),i.d(E,"sub",function(){return H}),i.d(E,"mul",function(){return Ce}),i.d(E,"div",function(){return Ee}),i.d(E,"dist",function(){return _e}),i.d(E,"sqrDist",function(){return ve}),i.d(E,"len",function(){return rt}),i.d(E,"sqrLen",function(){return $t}),i.d(E,"forEach",function(){return St});var T=i("yU0y");function m(){var ye=new T.a(4);return T.a!=Float32Array&&(ye[0]=0,ye[1]=0,ye[2]=0,ye[3]=0),ye}function X(ye){var be=new T.a(4);return be[0]=ye[0],be[1]=ye[1],be[2]=ye[2],be[3]=ye[3],be}function z(ye,be,Be,lt){var Pe=new T.a(4);return Pe[0]=ye,Pe[1]=be,Pe[2]=Be,Pe[3]=lt,Pe}function o(ye,be){return ye[0]=be[0],ye[1]=be[1],ye[2]=be[2],ye[3]=be[3],ye}function Z(ye,be,Be,lt,Pe){return ye[0]=be,ye[1]=Be,ye[2]=lt,ye[3]=Pe,ye}function D(ye,be,Be){return ye[0]=be[0]+Be[0],ye[1]=be[1]+Be[1],ye[2]=be[2]+Be[2],ye[3]=be[3]+Be[3],ye}function K(ye,be,Be){return ye[0]=be[0]-Be[0],ye[1]=be[1]-Be[1],ye[2]=be[2]-Be[2],ye[3]=be[3]-Be[3],ye}function re(ye,be,Be){return ye[0]=be[0]*Be[0],ye[1]=be[1]*Be[1],ye[2]=be[2]*Be[2],ye[3]=be[3]*Be[3],ye}function fe(ye,be,Be){return ye[0]=be[0]/Be[0],ye[1]=be[1]/Be[1],ye[2]=be[2]/Be[2],ye[3]=be[3]/Be[3],ye}function Y(ye,be){return ye[0]=Math.ceil(be[0]),ye[1]=Math.ceil(be[1]),ye[2]=Math.ceil(be[2]),ye[3]=Math.ceil(be[3]),ye}function Fe(ye,be){return ye[0]=Math.floor(be[0]),ye[1]=Math.floor(be[1]),ye[2]=Math.floor(be[2]),ye[3]=Math.floor(be[3]),ye}function We(ye,be,Be){return ye[0]=Math.min(be[0],Be[0]),ye[1]=Math.min(be[1],Be[1]),ye[2]=Math.min(be[2],Be[2]),ye[3]=Math.min(be[3],Be[3]),ye}function ge(ye,be,Be){return ye[0]=Math.max(be[0],Be[0]),ye[1]=Math.max(be[1],Be[1]),ye[2]=Math.max(be[2],Be[2]),ye[3]=Math.max(be[3],Be[3]),ye}function we(ye,be){return ye[0]=Math.round(be[0]),ye[1]=Math.round(be[1]),ye[2]=Math.round(be[2]),ye[3]=Math.round(be[3]),ye}function dt(ye,be,Be){return ye[0]=be[0]*Be,ye[1]=be[1]*Be,ye[2]=be[2]*Be,ye[3]=be[3]*Be,ye}function ke(ye,be,Be,lt){return ye[0]=be[0]+Be[0]*lt,ye[1]=be[1]+Be[1]*lt,ye[2]=be[2]+Be[2]*lt,ye[3]=be[3]+Be[3]*lt,ye}function Et(ye,be){var Be=be[0]-ye[0],lt=be[1]-ye[1],Pe=be[2]-ye[2],ht=be[3]-ye[3];return Math.hypot(Be,lt,Pe,ht)}function Ze(ye,be){var Be=be[0]-ye[0],lt=be[1]-ye[1],Pe=be[2]-ye[2],ht=be[3]-ye[3];return Be*Be+lt*lt+Pe*Pe+ht*ht}function vt(ye){var be=ye[0],Be=ye[1],lt=ye[2],Pe=ye[3];return Math.hypot(be,Be,lt,Pe)}function Qe(ye){var be=ye[0],Be=ye[1],lt=ye[2],Pe=ye[3];return be*be+Be*Be+lt*lt+Pe*Pe}function yt(ye,be){return ye[0]=-be[0],ye[1]=-be[1],ye[2]=-be[2],ye[3]=-be[3],ye}function _t(ye,be){return ye[0]=1/be[0],ye[1]=1/be[1],ye[2]=1/be[2],ye[3]=1/be[3],ye}function De(ye,be){var Be=be[0],lt=be[1],Pe=be[2],ht=be[3],w=Be*Be+lt*lt+Pe*Pe+ht*ht;return w>0&&(w=1/Math.sqrt(w)),ye[0]=Be*w,ye[1]=lt*w,ye[2]=Pe*w,ye[3]=ht*w,ye}function Ne(ye,be){return ye[0]*be[0]+ye[1]*be[1]+ye[2]*be[2]+ye[3]*be[3]}function Ue(ye,be,Be,lt){var Pe=Be[0]*lt[1]-Be[1]*lt[0],ht=Be[0]*lt[2]-Be[2]*lt[0],w=Be[0]*lt[3]-Be[3]*lt[0],I=Be[1]*lt[2]-Be[2]*lt[1],q=Be[1]*lt[3]-Be[3]*lt[1],ce=Be[2]*lt[3]-Be[3]*lt[2],Ve=be[0],$e=be[1],gt=be[2],nt=be[3];return ye[0]=$e*ce-gt*q+nt*I,ye[1]=-(Ve*ce)+gt*w-nt*ht,ye[2]=Ve*q-$e*w+nt*Pe,ye[3]=-(Ve*I)+$e*ht-gt*Pe,ye}function st(ye,be,Be,lt){var Pe=be[0],ht=be[1],w=be[2],I=be[3];return ye[0]=Pe+lt*(Be[0]-Pe),ye[1]=ht+lt*(Be[1]-ht),ye[2]=w+lt*(Be[2]-w),ye[3]=I+lt*(Be[3]-I),ye}function Le(ye,be){be=be||1;var Be,lt,Pe,ht,w,I;do Be=T.c()*2-1,lt=T.c()*2-1,w=Be*Be+lt*lt;while(w>=1);do Pe=T.c()*2-1,ht=T.c()*2-1,I=Pe*Pe+ht*ht;while(I>=1);var q=Math.sqrt((1-w)/I);return ye[0]=be*Be,ye[1]=be*lt,ye[2]=be*Pe*q,ye[3]=be*ht*q,ye}function ut(ye,be,Be){var lt=be[0],Pe=be[1],ht=be[2],w=be[3];return ye[0]=Be[0]*lt+Be[4]*Pe+Be[8]*ht+Be[12]*w,ye[1]=Be[1]*lt+Be[5]*Pe+Be[9]*ht+Be[13]*w,ye[2]=Be[2]*lt+Be[6]*Pe+Be[10]*ht+Be[14]*w,ye[3]=Be[3]*lt+Be[7]*Pe+Be[11]*ht+Be[15]*w,ye}function Gt(ye,be,Be){var lt=be[0],Pe=be[1],ht=be[2],w=Be[0],I=Be[1],q=Be[2],ce=Be[3],Ve=ce*lt+I*ht-q*Pe,$e=ce*Pe+q*lt-w*ht,gt=ce*ht+w*Pe-I*lt,nt=-w*lt-I*Pe-q*ht;return ye[0]=Ve*ce+nt*-w+$e*-q-gt*-I,ye[1]=$e*ce+nt*-I+gt*-w-Ve*-q,ye[2]=gt*ce+nt*-q+Ve*-I-$e*-w,ye[3]=be[3],ye}function Kt(ye){return ye[0]=0,ye[1]=0,ye[2]=0,ye[3]=0,ye}function ar(ye){return"vec4("+ye[0]+", "+ye[1]+", "+ye[2]+", "+ye[3]+")"}function oe(ye,be){return ye[0]===be[0]&&ye[1]===be[1]&&ye[2]===be[2]&&ye[3]===be[3]}function Q(ye,be){var Be=ye[0],lt=ye[1],Pe=ye[2],ht=ye[3],w=be[0],I=be[1],q=be[2],ce=be[3];return Math.abs(Be-w)<=T.b*Math.max(1,Math.abs(Be),Math.abs(w))&&Math.abs(lt-I)<=T.b*Math.max(1,Math.abs(lt),Math.abs(I))&&Math.abs(Pe-q)<=T.b*Math.max(1,Math.abs(Pe),Math.abs(q))&&Math.abs(ht-ce)<=T.b*Math.max(1,Math.abs(ht),Math.abs(ce))}var H=K,Ce=re,Ee=fe,_e=Et,ve=Ze,rt=vt,$t=Qe,St=function(){var ye=m();return function(be,Be,lt,Pe,ht,w){var I,q;for(Be||(Be=4),lt||(lt=0),Pe?q=Math.min(Pe*Be+lt,be.length):q=be.length,I=lt;I<q;I+=Be)ye[0]=be[I],ye[1]=be[I+1],ye[2]=be[I+2],ye[3]=be[I+3],ht(ye,ye,w),be[I]=ye[0],be[I+1]=ye[1],be[I+2]=ye[2],be[I+3]=ye[3];return be}}()},bzyH:function(Re,E){},cSJO:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("xfSm");function z(K,re,fe){var Y=re.filter(function(We){return We.target!==null&&We.target.type===m.TargetTypeEnum.ClassProperty}),Fe=Y.map(fe);return Y.forEach(function(We,ge){var we="";we=We.target.name.value();var dt=Fe[ge];K[we]=dt}),K}function o(K,re){return new(K.bind.apply(K,[void 0].concat(re)))}function Z(K,re){if(Reflect.hasMetadata(X.POST_CONSTRUCT,K)){var fe=Reflect.getMetadata(X.POST_CONSTRUCT,K);try{re[fe.value]()}catch(Y){throw new Error(T.POST_CONSTRUCT_ERROR(K.name,Y.message))}}}function D(K,re,fe){var Y=null;if(re.length>0){var Fe=re.filter(function(ge){return ge.target!==null&&ge.target.type===m.TargetTypeEnum.ConstructorArgument}),We=Fe.map(fe);Y=o(K,We),Y=z(Y,re,fe)}else Y=new K;return Z(K,Y),Y}E.resolveInstance=D},cWXX:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("oIFs"),z=i.n(X)},cWyK:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(Ze,vt,Qe){if(Ze===null)return;for(var yt,_t,De,Ne,Ue,st,Le,ut=0,Gt=0,Kt,ar=Ze.type,oe=ar==="FeatureCollection",Q=ar==="Feature",H=oe?Ze.features.length:1,Ce=0;Ce<H;Ce++){Le=oe?Ze.features[Ce].geometry:Q?Ze.geometry:Ze,Kt=Le?Le.type==="GeometryCollection":!1,Ue=Kt?Le.geometries.length:1;for(var Ee=0;Ee<Ue;Ee++){var _e=0,ve=0;if(Ne=Kt?Le.geometries[Ee]:Le,Ne===null)continue;st=Ne.coordinates;var rt=Ne.type;ut=Qe&&(rt==="Polygon"||rt==="MultiPolygon")?1:0;switch(rt){case null:break;case"Point":if(vt(st,Gt,Ce,_e,ve)===!1)return!1;Gt++,_e++;break;case"LineString":case"MultiPoint":for(yt=0;yt<st.length;yt++){if(vt(st[yt],Gt,Ce,_e,ve)===!1)return!1;Gt++,rt==="MultiPoint"&&_e++}rt==="LineString"&&_e++;break;case"Polygon":case"MultiLineString":for(yt=0;yt<st.length;yt++){for(_t=0;_t<st[yt].length-ut;_t++){if(vt(st[yt][_t],Gt,Ce,_e,ve)===!1)return!1;Gt++}rt==="MultiLineString"&&_e++,rt==="Polygon"&&ve++}rt==="Polygon"&&_e++;break;case"MultiPolygon":for(yt=0;yt<st.length;yt++){for(ve=0,_t=0;_t<st[yt].length;_t++){for(De=0;De<st[yt][_t].length-ut;De++){if(vt(st[yt][_t][De],Gt,Ce,_e,ve)===!1)return!1;Gt++}ve++}_e++}break;case"GeometryCollection":for(yt=0;yt<Ne.geometries.length;yt++)if(m(Ne.geometries[yt],vt,Qe)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function X(Ze,vt,Qe,yt){var _t=Qe;return m(Ze,function(De,Ne,Ue,st,Le){Ne===0&&Qe===void 0?_t=De:_t=vt(_t,De,Ne,Ue,st,Le)},yt),_t}function z(Ze,vt){var Qe;switch(Ze.type){case"FeatureCollection":for(Qe=0;Qe<Ze.features.length&&!(vt(Ze.features[Qe].properties,Qe)===!1);Qe++);break;case"Feature":vt(Ze.properties,0);break}}function o(Ze,vt,Qe){var yt=Qe;return z(Ze,function(_t,De){De===0&&Qe===void 0?yt=_t:yt=vt(yt,_t,De)}),yt}function Z(Ze,vt){if(Ze.type==="Feature")vt(Ze,0);else if(Ze.type==="FeatureCollection")for(var Qe=0;Qe<Ze.features.length&&!(vt(Ze.features[Qe],Qe)===!1);Qe++);}function D(Ze,vt,Qe){var yt=Qe;return Z(Ze,function(_t,De){De===0&&Qe===void 0?yt=_t:yt=vt(yt,_t,De)}),yt}function K(Ze){var vt=[];return m(Ze,function(Qe){vt.push(Qe)}),vt}function re(Ze,vt){var Qe,yt,_t,De,Ne,Ue,st,Le,ut,Gt,Kt=0,ar=Ze.type==="FeatureCollection",oe=Ze.type==="Feature",Q=ar?Ze.features.length:1;for(Qe=0;Qe<Q;Qe++){for(Ue=ar?Ze.features[Qe].geometry:oe?Ze.geometry:Ze,Le=ar?Ze.features[Qe].properties:oe?Ze.properties:{},ut=ar?Ze.features[Qe].bbox:oe?Ze.bbox:void 0,Gt=ar?Ze.features[Qe].id:oe?Ze.id:void 0,st=Ue?Ue.type==="GeometryCollection":!1,Ne=st?Ue.geometries.length:1,_t=0;_t<Ne;_t++){if(De=st?Ue.geometries[_t]:Ue,De===null){if(vt(null,Kt,Le,ut,Gt)===!1)return!1;continue}switch(De.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(vt(De,Kt,Le,ut,Gt)===!1)return!1;break}case"GeometryCollection":{for(yt=0;yt<De.geometries.length;yt++)if(vt(De.geometries[yt],Kt,Le,ut,Gt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Kt++}}function fe(Ze,vt,Qe){var yt=Qe;return re(Ze,function(_t,De,Ne,Ue,st){De===0&&Qe===void 0?yt=_t:yt=vt(yt,_t,De,Ne,Ue,st)}),yt}function Y(Ze,vt){re(Ze,function(Qe,yt,_t,De,Ne){var Ue=Qe===null?null:Qe.type;switch(Ue){case null:case"Point":case"LineString":case"Polygon":return vt(T.feature(Qe,_t,{bbox:De,id:Ne}),yt,0)===!1?!1:void 0}var st;switch(Ue){case"MultiPoint":st="Point";break;case"MultiLineString":st="LineString";break;case"MultiPolygon":st="Polygon";break}for(var Le=0;Le<Qe.coordinates.length;Le++){var ut=Qe.coordinates[Le],Gt={type:st,coordinates:ut};if(vt(T.feature(Gt,_t),yt,Le)===!1)return!1}})}function Fe(Ze,vt,Qe){var yt=Qe;return Y(Ze,function(_t,De,Ne){De===0&&Ne===0&&Qe===void 0?yt=_t:yt=vt(yt,_t,De,Ne)}),yt}function We(Ze,vt){Y(Ze,function(Qe,yt,_t){var De=0;if(!Qe.geometry)return;var Ne=Qe.geometry.type;if(Ne==="Point"||Ne==="MultiPoint")return;var Ue,st=0,Le=0,ut=0;if(m(Qe,function(Gt,Kt,ar,oe,Q){if(Ue===void 0||yt>st||oe>Le||Q>ut){Ue=Gt,st=yt,Le=oe,ut=Q,De=0;return}var H=T.lineString([Ue,Gt],Qe.properties);if(vt(H,yt,_t,Q,De)===!1)return!1;De++,Ue=Gt})===!1)return!1})}function ge(Ze,vt,Qe){var yt=Qe,_t=!1;return We(Ze,function(De,Ne,Ue,st,Le){_t===!1&&Qe===void 0?yt=De:yt=vt(yt,De,Ne,Ue,st,Le),_t=!0}),yt}function we(Ze,vt){if(!Ze)throw new Error("geojson is required");Y(Ze,function(Qe,yt,_t){if(Qe.geometry===null)return;var De=Qe.geometry.type,Ne=Qe.geometry.coordinates;switch(De){case"LineString":if(vt(Qe,yt,_t,0,0)===!1)return!1;break;case"Polygon":for(var Ue=0;Ue<Ne.length;Ue++)if(vt(T.lineString(Ne[Ue],Qe.properties),yt,_t,Ue)===!1)return!1;break}})}function dt(Ze,vt,Qe){var yt=Qe;return we(Ze,function(_t,De,Ne,Ue){De===0&&Qe===void 0?yt=_t:yt=vt(yt,_t,De,Ne,Ue)}),yt}function ke(Ze,vt){if(vt=vt||{},!T.isObject(vt))throw new Error("options is invalid");var Qe=vt.featureIndex||0,yt=vt.multiFeatureIndex||0,_t=vt.geometryIndex||0,De=vt.segmentIndex||0,Ne=vt.properties,Ue;switch(Ze.type){case"FeatureCollection":Qe<0&&(Qe=Ze.features.length+Qe),Ne=Ne||Ze.features[Qe].properties,Ue=Ze.features[Qe].geometry;break;case"Feature":Ne=Ne||Ze.properties,Ue=Ze.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=Ze;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var st=Ue.coordinates;switch(Ue.type){case"Point":case"MultiPoint":return null;case"LineString":return De<0&&(De=st.length+De-1),T.lineString([st[De],st[De+1]],Ne,vt);case"Polygon":return _t<0&&(_t=st.length+_t),De<0&&(De=st[_t].length+De-1),T.lineString([st[_t][De],st[_t][De+1]],Ne,vt);case"MultiLineString":return yt<0&&(yt=st.length+yt),De<0&&(De=st[yt].length+De-1),T.lineString([st[yt][De],st[yt][De+1]],Ne,vt);case"MultiPolygon":return yt<0&&(yt=st.length+yt),_t<0&&(_t=st[yt].length+_t),De<0&&(De=st[yt][_t].length-De-1),T.lineString([st[yt][_t][De],st[yt][_t][De+1]],Ne,vt)}throw new Error("geojson is invalid")}function Et(Ze,vt){if(vt=vt||{},!T.isObject(vt))throw new Error("options is invalid");var Qe=vt.featureIndex||0,yt=vt.multiFeatureIndex||0,_t=vt.geometryIndex||0,De=vt.coordIndex||0,Ne=vt.properties,Ue;switch(Ze.type){case"FeatureCollection":Qe<0&&(Qe=Ze.features.length+Qe),Ne=Ne||Ze.features[Qe].properties,Ue=Ze.features[Qe].geometry;break;case"Feature":Ne=Ne||Ze.properties,Ue=Ze.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=Ze;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var st=Ue.coordinates;switch(Ue.type){case"Point":return T.point(st,Ne,vt);case"MultiPoint":return yt<0&&(yt=st.length+yt),T.point(st[yt],Ne,vt);case"LineString":return De<0&&(De=st.length+De),T.point(st[De],Ne,vt);case"Polygon":return _t<0&&(_t=st.length+_t),De<0&&(De=st[_t].length+De),T.point(st[_t][De],Ne,vt);case"MultiLineString":return yt<0&&(yt=st.length+yt),De<0&&(De=st[yt].length+De),T.point(st[yt][De],Ne,vt);case"MultiPolygon":return yt<0&&(yt=st.length+yt),_t<0&&(_t=st[yt].length+_t),De<0&&(De=st[yt][_t].length-De),T.point(st[yt][_t][De],Ne,vt)}throw new Error("geojson is invalid")}E.coordEach=m,E.coordReduce=X,E.propEach=z,E.propReduce=o,E.featureEach=Z,E.featureReduce=D,E.coordAll=K,E.geomEach=re,E.geomReduce=fe,E.flattenEach=Y,E.flattenReduce=Fe,E.segmentEach=We,E.segmentReduce=ge,E.lineEach=we,E.lineReduce=dt,E.findSegment=ke,E.findPoint=Et},cZ5Q:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function X(){return function(z){if(Reflect.hasOwnMetadata(m.PARAM_TYPES,z))throw new Error(T.DUPLICATED_INJECTABLE_DECORATOR);var o=Reflect.getMetadata(m.DESIGN_PARAM_TYPES,z)||[];return Reflect.defineMetadata(m.PARAM_TYPES,o,z),z}}E.injectable=X},cZlC:function(Re,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"c",function(){return m}),i.d(E,"a",function(){return X});var T;(function(z){z.LINEAR="linear",z.POWER="power",z.LOG="log",z.IDENTITY="identity",z.TIME="time",z.QUANTILE="quantile",z.QUANTIZE="quantize",z.THRESHOLD="threshold",z.CAT="cat"})(T||(T={}));var m;(function(z){z.CONSTANT="constant",z.VARIABLE="variable"})(m||(m={}));var X;(function(z){z[z.Attribute=0]="Attribute",z[z.InstancedAttribute=1]="InstancedAttribute",z[z.Uniform=2]="Uniform"})(X||(X={}))},"cq/+":function(Re,E,i){var T=i("mc0g"),m=T();Re.exports=m},cvCv:function(Re,E){function i(T){return function(){return T}}Re.exports=i},d9O0:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=0;function m(){return T++}E.id=m},d9mD:function(Re,E,i){Re.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(Re,E,i){var T=i("yGk4"),m=i("vN+2"),X=i("rEGp"),z=1/0,o=T&&1/X(new T([,-0]))[1]==z?function(Z){return new T(Z)}:m;Re.exports=o},dTAl:function(Re,E,i){var T=i("GoyQ"),m=Object.create,X=function(){function z(){}return function(o){if(!T(o))return{};if(m)return m(o);z.prototype=o;var Z=new z;return z.prototype=void 0,Z}}();Re.exports=X},dVn5:function(Re,E){var i=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function T(m){return m.match(i)||[]}Re.exports=T},dX1H:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("d9O0"),X=i("GXnB"),z=i("zxMA"),o=function(){function Z(D,K,re,fe){this.id=m.id(),this.type=D,this.serviceIdentifier=re,this.name=new z.QueryableString(K||""),this.metadata=new Array;var Y=null;typeof fe=="string"?Y=new X.Metadata(T.NAMED_TAG,fe):fe instanceof X.Metadata&&(Y=fe),Y!==null&&this.metadata.push(Y)}return Z.prototype.hasTag=function(D){for(var K=0,re=this.metadata;K<re.length;K++){var fe=re[K];if(fe.key===D)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(T.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(D){return this.matchesTag(T.MULTI_INJECT_TAG)(D)},Z.prototype.isNamed=function(){return this.hasTag(T.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG})},Z.prototype.isOptional=function(){return this.matchesTag(T.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===T.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG}):null},Z.prototype.matchesNamedTag=function(D){return this.matchesTag(T.NAMED_TAG)(D)},Z.prototype.matchesTag=function(D){var K=this;return function(re){for(var fe=0,Y=K.metadata;fe<Y.length;fe++){var Fe=Y[fe];if(Fe.key===D&&Fe.value===re)return!0}return!1}},Z}();E.Target=o},dgMf:function(Re,E,i){Re.exports={color:"color"}},doU7:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};E.BindingCount=T},dt0z:function(Re,E,i){var T=i("zoYe");function m(X){return X==null?"":T(X)}Re.exports=m},dxzI:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.ContainerModule=m;var X=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.AsyncContainerModule=X},eUgh:function(Re,E){function i(T,m){for(var X=-1,z=T==null?0:T.length,o=Array(z);++X<z;)o[X]=m(T[X],X,T);return o}Re.exports=i},"eg+a":function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Re,E,i){"use strict";i.d(E,"d",function(){return Sf}),i.d(E,"b",function(){return Yc}),i.d(E,"a",function(){return Wl});var T=i("mNvP"),m=i("uhBA"),X=i.n(m),z=i("4cb6"),o=i("APxj"),Z=i.n(o),D=i("bB6j"),K=i("lSNA"),re=i.n(K),fe=i("lwsE"),Y=i.n(fe),Fe=i("W8MJ"),We=i.n(Fe),ge=i("Hel2"),we=i("rxlC"),dt=i.n(we);function ke(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Et(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?ke(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):ke(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Ze(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=vt(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Rr){throw Rr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,nr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Rr=k.next();return ot=Rr.done,Rr},e:function(Rr){Xt=!0,nr=Rr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw nr}}}}function vt(ne,se){if(!ne)return;if(typeof ne=="string")return Qe(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return Qe(ne,se)}function Qe(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var yt=30;function _t(ne){var se=ne.characterSet,k=ne.getFontWidth,G=ne.fontHeight,Ae=ne.buffer,ot=ne.maxCanvasWidth,Xt=ne.mapping,nr=Xt===void 0?{}:Xt,rr=ne.xOffset,Rr=rr===void 0?0:rr,on=ne.yOffset,Un=on===void 0?0:on,Kn=0,oa=Rr;Array.from(se).forEach(function(za,Oi){if(!nr[za]){var ni=k(za,Oi);oa+yt>ot&&(oa=0,Kn++),nr[za]={x:oa,y:Un+Kn*yt,width:yt,height:yt,advance:ni},oa+=yt}});var ti=G+Ae*2;return{mapping:nr,xOffset:oa,yOffset:Un+Kn*ti,canvasHeight:Ue(Un+(Kn+1)*ti)}}function De(ne,se,k){var G=0,Ae=0,ot=0,Xt=[],nr={},rr=Ze(ne),Rr;try{for(rr.s();!(Rr=rr.n()).done;){var on=Rr.value;if(!nr[on.id]){var Un=on.height,Kn=on.width;G+Kn+se>k&&(Ne(nr,Xt,Ae),G=0,Ae=ot+Ae+se,ot=0,Xt=[]),Xt.push({icon:on,xOffset:G}),G=G+Kn+se,ot=Math.max(ot,Un)}}}catch(ti){rr.e(ti)}finally{rr.f()}Xt.length>0&&Ne(nr,Xt,Ae);var oa=Ue(ot+Ae+se);return{mapping:nr,canvasHeight:oa}}function Ne(ne,se,k){var G=Ze(se),Ae;try{for(G.s();!(Ae=G.n()).done;){var ot=Ae.value,Xt=ot.icon,nr=ot.xOffset;ne[Xt.id]=Et(Et({},Xt),{},{x:nr,y:k,image:Xt.image})}}catch(rr){G.e(rr)}finally{G.f()}}function Ue(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var st,Le,ut;function Gt(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=Kt(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Rr){throw Rr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,nr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Rr=k.next();return ot=Rr.done,Rr},e:function(Rr){Xt=!0,nr=Rr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw nr}}}}function Kt(ne,se){if(!ne)return;if(typeof ne=="string")return ar(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return ar(ne,se)}function ar(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}function oe(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Q(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):oe(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var H=Pe(),Ce="sans-serif",Ee="normal",_e=24,ve=3,rt=.25,$t=8,St=1024,ye=1,be=1,Be=3,lt=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Pe(){for(var ne=[],se=32;se<128;se++)ne.push(String.fromCharCode(se));return ne}function ht(ne,se,k,G){ne.font="".concat(G," ").concat(k,"px ").concat(se),ne.fillStyle="black",ne.textBaseline="middle"}function w(ne,se){for(var k=0;k<ne.length;k++)se.data[4*k+3]=ne[k]}var I=(st=Object(z.injectable)(),st(Le=(ut=function(){function ne(){Y()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new ge.b(Be)}return We()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ce,fontWeight:Ee,characterSet:H,fontSize:_e,buffer:ve,sdf:!0,cutoff:rt,radius:$t},this.key=""}},{key:"addIconGlyphs",value:function(k){var G=this;k.forEach(function(Ae){G.iconFontGlyphs[Ae.name]=Ae.unicode})}},{key:"getGlyph",value:function(k){return this.iconFontGlyphs[k]?String.fromCharCode(parseInt(this.iconFontGlyphs[k],16)):""}},{key:"setFontOptions",value:function(k){this.fontOptions=Q(Q({},this.fontOptions),k),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),Ae=this.cache.get(this.key);if(Ae&&G.length===0)return;var ot=this.generateFontAtlas(this.key,G,Ae);this.fontAtlas=ot,this.cache.set(this.key,ot)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(k,G,Ae){var ot=this.fontOptions,Xt=ot.fontFamily,nr=ot.fontWeight,rr=ot.fontSize,Rr=ot.buffer,on=ot.sdf,Un=ot.radius,Kn=ot.cutoff,oa=Ae&&Ae.data;oa||(oa=document.createElement("canvas"),oa.width=St);var ti=oa.getContext("2d");ht(ti,Xt,rr,nr);var za=_t(Q({getFontWidth:function(hc){return ti.measureText(hc).width},fontHeight:rr*be,buffer:Rr,characterSet:G,maxCanvasWidth:St},Ae&&{mapping:Ae.mapping,xOffset:Ae.xOffset,yOffset:Ae.yOffset})),Oi=za.mapping,ni=za.canvasHeight,Fi=za.xOffset,Ro=za.yOffset;if(oa.height!==ni){var bo=ti.getImageData(0,0,oa.width,oa.height);oa.height=ni,ti.putImageData(bo,0,0)}if(ht(ti,Xt,rr,nr),on){var Zi=new dt.a(rr,Rr,Un,Kn,Xt,nr),Uo=ti.getImageData(0,0,Zi.size,Zi.size),ri=Gt(G),fo;try{for(ri.s();!(fo=ri.n()).done;){var au=fo.value;w(Zi.draw(au),Uo),ti.putImageData(Uo,Oi[au].x,Oi[au].y)}}catch(Io){ri.e(Io)}finally{ri.f()}}else{var Si=Gt(G),Ui;try{for(Si.s();!(Ui=Si.n()).done;){var Ea=Ui.value;ti.fillText(Ea,Oi[Ea].x,Oi[Ea].y+rr*ye)}}catch(Io){Si.e(Io)}finally{Si.f()}}return{xOffset:Fi,yOffset:Ro,mapping:Oi,data:oa,width:oa.width,height:oa.height}}},{key:"getKey",value:function(){var k=this.fontOptions,G=k.fontFamily,Ae=k.fontWeight,ot=k.fontSize,Xt=k.buffer,nr=k.sdf,rr=k.radius,Rr=k.cutoff;return nr?"".concat(G," ").concat(Ae," ").concat(ot," ").concat(Xt," ").concat(rr," ").concat(Rr):"".concat(G," ").concat(Ae," ").concat(ot," ").concat(Xt)}},{key:"getNewChars",value:function(k,G){var Ae=this.cache.get(k);if(!Ae)return G;var ot=[],Xt=Ae.mapping,nr=new Set(Object.keys(Xt)),rr=new Set(G);return rr.forEach(function(Rr){nr.has(Rr)||ot.push(Rr)}),ot}},{key:"scale",get:function(){return be}},{key:"canvas",get:function(){var k=this.cache.get(this.key);return k&&k.data}},{key:"mapping",get:function(){var k=this.cache.get(this.key);return k&&k.mapping}}]),ne}(),ut))||Le),q=i("7W2i"),ce=i.n(q),Ve=i("a1gu"),$e=i.n(Ve),gt=i("Nsbk"),nt=i.n(gt),kt,$,Ke;function ae(ne){var se=et();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var zt=3,sr=1024,ft=64,pt=(kt=Object(z.injectable)(),kt($=(Ke=function(ne){ce()(k,ne);var se=ae(k);function k(){var G;Y()(this,k);for(var Ae=arguments.length,ot=new Array(Ae),Xt=0;Xt<Ae;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return We()(k,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ae,ot){var Xt=this,nr=new Image;if(this.hasImage(Ae))throw new Error("Image Id already exists");this.iconData.push({id:Ae,width:ft,height:ft}),this.updateIconMap(),this.loadImage(ot).then(function(rr){nr=rr;var Rr=Xt.iconData.find(function(on){return on.id===Ae});Rr&&(Rr.image=nr),Xt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ae){return this.iconMap.hasOwnProperty(Ae)}},{key:"removeImage",value:function(Ae){this.hasImage(Ae)&&(this.iconData=this.iconData.filter(function(ot){return ot.id!==Ae}),delete this.iconMap[Ae],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ae=this;this.canvas.width=sr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ot){var Xt=Ae.iconMap[ot],nr=Xt.x,rr=Xt.y,Rr=Xt.image;Rr&&Ae.ctx.drawImage(Rr,nr,rr,ft,ft)})}},{key:"updateIconMap",value:function(){var Ae=De(this.iconData,zt,sr),ot=Ae.mapping,Xt=Ae.canvasHeight;this.iconMap=ot,this.canvasHeight=Xt}},{key:"loadImage",value:function(Ae){return new Promise(function(ot,Xt){if(Ae instanceof HTMLImageElement){ot(Ae);return}var nr=new Image;nr.crossOrigin="anonymous",nr.onload=function(){ot(nr)},nr.onerror=function(){Xt(new Error("Could not load image at "+Ae))},nr.src=Ae instanceof File?URL.createObjectURL(Ae):Ae})}}]),k}(m.EventEmitter),Ke))||$),At=i("J4zp"),mt=i.n(At),Me=i("IOcx"),ct,qe,Vt,pr=(ct=Object(z.injectable)(),ct(qe=(Vt=function(){function ne(){Y()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return We()(ne,[{key:"init",value:function(){}},{key:"update",value:function(k){this.viewport=k,this.viewMatrixInverse=Me.b.invert(Me.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var k=this.viewport.getCenter(),G=mt()(k,2),Ae=G[0],ot=G[1];return[Ae,ot]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(k,G){return this.viewport.projectFlat(k,G)}},{key:"setViewProjectionMatrix",value:function(k){this.overridedViewProjectionMatrix=k}},{key:"jitterProjectionMatrix",value:function(k,G){var Ae=Me.b.fromTranslation(Me.b.create(),[k,G,0]);this.jitteredProjectionMatrix=Me.b.multiply(Me.b.create(),Ae,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Me.b.multiply(Me.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Vt))||qe),Gr,ur,zn;function xn(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=na(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Rr){throw Rr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,nr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Rr=k.next();return ot=Rr.done,Rr},e:function(Rr){Xt=!0,nr=Rr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw nr}}}}function na(ne,se){if(!ne)return;if(typeof ne=="string")return fa(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return fa(ne,se)}function fa(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var Hn=(Gr=Object(z.injectable)(),Gr(ur=(zn=function(){function ne(){Y()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return We()(ne,[{key:"init",value:function(k,G){this.container=k.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(k,G){var Ae=G.get(D.a.IMapService);Ae.map?(k.addTo(this.scene),this.controls.push(k)):this.unAddControls.push(k)}},{key:"getControlByName",value:function(k){return this.controls.find(function(G){return G.controlOption.name===k})}},{key:"removeControl",value:function(k){var G=this.controls.indexOf(k);return G>-1&&this.controls.splice(G,1),k.remove(),this}},{key:"addControls",value:function(){var k=this;this.unAddControls.forEach(function(G){G.addTo(k.scene),k.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var k=xn(this.controls),G;try{for(k.s();!(G=k.n()).done;){var Ae=G.value;Ae.remove()}}catch(ot){k.e(ot)}finally{k.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var k=this.controlCorners={},G="l7-",Ae=this.controlContainer=ge.a.create("div",G+"control-container",this.container);function ot(Xt,nr){var rr=G+Xt+" "+G+nr;k[Xt+nr]=ge.a.create("div",rr,Ae)}ot("top","left"),ot("top","right"),ot("bottom","left"),ot("bottom","right")}},{key:"clearControlPos",value:function(){for(var k in this.controlCorners)this.controlCorners[k]&&ge.a.remove(this.controlCorners[k]);this.controlContainer&&ge.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),zn))||ur),Gn,F,W,le=(Gn=Object(z.injectable)(),Gn(F=(W=function(){function ne(){Y()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return We()(ne,[{key:"addMarkerLayer",value:function(k){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(k),k.addTo(this.scene)):this.unAddMarkerLayers.push(k)}},{key:"removeMarkerLayer",value:function(k){k.destroy(),this.markerLayers.indexOf(k);var G=this.markerLayers.indexOf(k);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(k){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(k),k.addTo(this.scene)):this.unAddMarkers.push(k)}},{key:"addMarkers",value:function(){var k=this;this.unAddMarkers.forEach(function(G){G.addTo(k.scene),k.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var k=this;this.unAddMarkerLayers.forEach(function(G){k.markerLayers.push(G),G.addTo(k.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(k){k.remove(),this.markers.indexOf(k);var G=this.markers.indexOf(k);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(k){this.scene=k,this.mapsService=k.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(k){k.remove()}),this.markers=[],this.markerLayers.forEach(function(k){k.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(k){k.destroy()}}]),ne}(),W))||F),pe,at,Tt,jt=(pe=Object(z.injectable)(),pe(at=(Tt=function(){function ne(){Y()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return We()(ne,[{key:"removePopup",value:function(k){k.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(k){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(k.addTo(this.scene),this.popup=k):this.unAddPopup=k}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(k){this.scene=k,this.mapsService=k.get(D.a.IMapService)}}]),ne}(),Tt))||at),Ge=i("QkVN"),wt=i.n(Ge),ir={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Ur=ir,Vr,or,Fr;function Sn(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function fn(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Sn(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Sn(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var Er={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},dn=(Vr=Object(z.injectable)(),Vr(or=(Fr=function(){function ne(){Y()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return We()(ne,[{key:"getSceneConfig",value:function(k){return this.sceneConfigCache[k]}},{key:"getSceneWarninfo",value:function(k){return Ur[k]}},{key:"setSceneConfig",value:function(k,G){this.sceneConfigCache[k]=fn(fn({},Er),G)}},{key:"getLayerConfig",value:function(k){return this.layerConfigCache[k]}},{key:"setLayerConfig",value:function(k,G,Ae){this.layerConfigCache[G]=fn({},wt()({},this.sceneConfigCache[k],Tn,Ae))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),Fr))||or),vn=i("yG8O"),Sr=i.n(vn),Kr=i("U+yc"),wn=i.n(Kr),Ka=i("1ABj"),da=Math.PI/180,Oa=512,Ia=4003e4;function Xi(ne){var se=ne.latitude,k=se===void 0?0:se,G=ne.zoom,Ae=G===void 0?0:G,ot=ne.scale,Xt=ne.highPrecision,nr=Xt===void 0?!1:Xt,rr=ne.flipY,Rr=rr===void 0?!1:rr;ot=ot!==void 0?ot:Math.pow(2,Ae);var on={},Un=Oa*ot,Kn=Math.cos(k*da),oa=Un/360,ti=oa/Kn,za=Un/Ia/Kn;if(on.pixelsPerMeter=[za,-za,za],on.metersPerPixel=[1/za,-1/za,1/za],on.pixelsPerDegree=[oa,-ti,za],on.degreesPerPixel=[1/oa,-1/ti,1/za],nr){var Oi=da*Math.tan(k*da)/Kn,ni=oa*Oi/2,Fi=Un/Ia*Oi,Ro=Fi/ti*za;on.pixelsPerDegree2=[0,-ni,Fi],on.pixelsPerMeter2=[Ro,0,Ro],Rr&&(on.pixelsPerDegree2[1]=-on.pixelsPerDegree2[1],on.pixelsPerMeter2[1]=-on.pixelsPerMeter2[1])}return Rr&&(on.pixelsPerMeter[1]=-on.pixelsPerMeter[1],on.metersPerPixel[1]=-on.metersPerPixel[1],on.pixelsPerDegree[1]=-on.pixelsPerDegree[1],on.degreesPerPixel[1]=-on.degreesPerPixel[1]),on}var ha=i("HthE"),gi,Ma,ya,la,Li,po,Yi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ko=(gi=Object(z.injectable)(),Ma=Object(z.inject)(D.a.ICameraService),gi(ya=(la=(po=function(){function ne(){Y()(this,ne),this.needRefresh=!0,Sr()(this,"cameraService",Li,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return We()(ne,[{key:"refresh",value:function(){var k=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),Ae=this.cameraService.getCenter(),ot=Xi({latitude:Ae[1],zoom:k}),Xt=ot.pixelsPerMeter,nr=ot.pixelsPerDegree;this.viewportCenter=Ae,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Xt,this.pixelsPerDegree=nr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===ha.a.LNGLAT||this.coordinateSystem===ha.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===ha.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ae,k):this.coordinateSystem===ha.a.P20_OFFSET&&this.calculateLnglatOffset(Ae,k,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(k){this.coordinateSystem=k}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(k,G,Ae,ot){var Xt=Xi({latitude:k[1],zoom:G,scale:Ae,flipY:ot,highPrecision:!0}),nr=Xt.pixelsPerMeter,rr=Xt.pixelsPerDegree,Rr=Xt.pixelsPerDegree2,on=this.cameraService.getViewMatrix(),Un=this.cameraService.getProjectionMatrix(),Kn=Me.b.multiply([],Un,on),oa=this.cameraService.projectFlat([Math.fround(k[0]),Math.fround(k[1])],Math.pow(2,G));this.viewportCenterProjection=Me.e.transformMat4([],[oa[0],oa[1],0,1],Kn),on=this.cameraService.getViewMatrixUncentered()||on,Kn=Me.b.multiply([],Un,on),Kn=Me.b.multiply([],Kn,Yi),this.cameraService.setViewProjectionMatrix(Kn),this.pixelsPerMeter=nr,this.pixelsPerDegree=rr,this.pixelsPerDegree2=Rr}}]),ne}(),po),Li=wn()(la.prototype,"cameraService",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),la))||ya),Gu=i("PJYZ"),Ba=i.n(Gu),Ai=i("yLV6"),es=i.n(Ai),ii=i("V1cb"),Ki,ts,Ja,oo,so,Ys,_o,Zl;function Ks(ne){var se=So();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function So(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ut={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Ie=(Ki=Object(z.injectable)(),ts=Object(z.inject)(D.a.IMapService),Ja=Object(z.inject)(D.a.ILogService),Ki(oo=(so=(Zl=function(ne){ce()(k,ne);var se=Ks(k);function k(){var G;Y()(this,k);for(var Ae=arguments.length,ot=new Array(Ae),Xt=0;Xt<Ae;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),Sr()(G,"mapService",Ys,Ba()(G)),Sr()(G,"logger",_o,Ba()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(nr){var rr=G.interactionEvent(nr);rr.type=Ut[rr.type],G.emit(ii.a.Drag,rr)},G.onHammer=function(nr){nr.srcEvent.stopPropagation();var rr=G.interactionEvent(nr);G.emit(ii.a.Hover,rr)},G.onTouch=function(nr){var rr=nr.touches[0];G.onHover({x:rr.pageX,y:rr.pageY,type:"touch"})},G.onHover=function(nr){var rr=nr.clientX,Rr=nr.clientY,on=rr,Un=Rr,Kn=nr.type,oa=G.mapService.getMapContainer();if(oa){var ti=oa.getBoundingClientRect(),za=ti.top,Oi=ti.left;on=on-Oi-oa.clientLeft,Un=Un-za-oa.clientTop}var ni=G.mapService.containerToLngLat([on,Un]);if(Kn==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(on,Un,ni);return}if(Kn==="touch"){G.isDoubleTap(on,Un,ni);return}Kn!=="click"&&Kn!=="dblclick"&&G.emit(ii.a.Hover,{x:on,y:Un,lngLat:ni,type:Kn,target:nr})},G}return We()(k,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ii.a.Hover)}},{key:"triggerHover",value:function(Ae){var ot=Ae.x,Xt=Ae.y;this.emit(ii.a.Hover,{x:ot,y:Xt})}},{key:"triggerSelect",value:function(Ae){this.emit(ii.a.Select,{featureId:Ae})}},{key:"triggerActive",value:function(Ae){this.emit(ii.a.Active,{featureId:Ae})}},{key:"addEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();if(Ae){var ot=new es.a.Manager(Ae);ot.add(new es.a.Tap({event:"dblclick",taps:2})),ot.add(new es.a.Tap({event:"click"})),ot.add(new es.a.Pan({threshold:0,pointers:0})),ot.add(new es.a.Press({})),ot.on("dblclick click",this.onHammer),ot.on("panstart panmove panend pancancel",this.onDrag),Ae.addEventListener("mousemove",this.onHover),Ae.addEventListener("mousedown",this.onHover),Ae.addEventListener("mouseup",this.onHover),Ae.addEventListener("contextmenu",this.onHover),this.hammertime=ot,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();Ae&&(Ae.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ae.removeEventListener("mousedown",this.onHover),Ae.removeEventListener("mouseup",this.onHover),Ae.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ae){var ot=Ae.type,Xt=Ae.pointerType,nr,rr;Xt==="touch"?(rr=Math.floor(Ae.pointers[0].clientY),nr=Math.floor(Ae.pointers[0].clientX)):(rr=Math.floor(Ae.srcEvent.y),nr=Math.floor(Ae.srcEvent.x));var Rr=this.mapService.getMapContainer();if(Rr){var on=Rr.getBoundingClientRect(),Un=on.top,Kn=on.left;nr-=Kn,rr-=Un}var oa=this.mapService.containerToLngLat([nr,rr]);return{x:nr,y:rr,lngLat:oa,type:ot,target:Ae.srcEvent}}},{key:"isDoubleTap",value:function(Ae,ot,Xt){var nr=this,rr=new Date().getTime(),Rr="click";rr-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ae)<10&&Math.abs(this.lastClickXY[1]-ot)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Rr="dblclick",this.emit(ii.a.Hover,{x:Ae,y:ot,lngLat:Xt,type:Rr})):(this.lastClickTime=rr,this.lastClickXY=[Ae,ot],this.clickTimer=setTimeout(function(){Rr="click",nr.emit(ii.a.Hover,{x:Ae,y:ot,lngLat:Xt,type:Rr})},400))}}]),k}(X.a),Zl),Ys=wn()(so.prototype,"mapService",[ts],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_o=wn()(so.prototype,"logger",[Ja],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),Pt=i("o0o1"),cr=i.n(Pt),tn=i("yXPU"),En=i.n(tn),Fn=i("o+pz"),Ri,to,mo,Do,Hu,Xl,$s,Ic,Ll,fs,ks,uo;function hs(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Js(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?hs(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):hs(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var cu=(Ri=Object(z.injectable)(),to=Object(z.inject)(D.a.IRendererService),mo=Object(z.inject)(D.a.IGlobalConfigService),Do=Object(z.inject)(D.a.IInteractionService),Hu=Object(z.inject)(D.a.ILayerService),Ri(Xl=($s=(uo=function(){function ne(){var se=this;Y()(this,ne),Sr()(this,"rendererService",Ic,this),Sr()(this,"configService",Ll,this),Sr()(this,"interactionService",fs,this),Sr()(this,"layerService",ks,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(k,G){var Ae,ot=G.x,Xt=G.y,nr=G.lngLat,rr=G.type,Rr=G.target,on=!1,Un=se.rendererService,Kn=Un.getViewportSize,oa=Un.readPixels,ti=Un.getContainer,za=ti().getBoundingClientRect(),Oi=za.width,ni=za.height;Oi*=window.devicePixelRatio,ni*=window.devicePixelRatio;var Fi=k.getLayerConfig(),Ro=Fi.enableHighlight,bo=Fi.enableSelect,Zi=ot*window.devicePixelRatio,Uo=Xt*window.devicePixelRatio;if(Zi>Oi-1*window.devicePixelRatio||Zi<0||Uo>ni-1*window.devicePixelRatio||Uo<0)return!1;var ri;if(ri=oa({x:Math.floor(Zi/se.pickBufferScale),y:Math.floor((ni-(Xt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),ri[0]!==0||ri[1]!==0||ri[2]!==0){var fo=Object(ge.k)(ri),au=k.getSource().getFeatureById(fo);fo!==k.getCurrentPickId()&&rr==="mousemove"&&(rr="mouseenter");var Si={x:ot,y:Xt,type:rr,lngLat:nr,featureId:fo,feature:au,target:Rr};au&&(on=!0,k.setCurrentPickId(fo),se.triggerHoverOnLayer(k,Si))}else{var Ui={x:ot,y:Xt,lngLat:nr,type:k.getCurrentPickId()!==null&&rr==="mousemove"?"mouseout":"un"+rr,featureId:null,target:Rr,feature:null};se.triggerHoverOnLayer(k,Js(Js({},Ui),{},{type:"unpick"})),se.triggerHoverOnLayer(k,Ui),k.setCurrentPickId(null)}if(Ro&&se.highlightPickedFeature(k,ri),bo&&rr==="click"&&((Ae=ri)===null||Ae===void 0?void 0:Ae.toString())!==[0,0,0,0].toString()){var Ea=Object(ge.k)(ri);k.getCurrentSelectedId()===null||Ea!==k.getCurrentSelectedId()?(se.selectFeature(k,ri),k.setCurrentSelectedId(Ea)):(se.selectFeature(k,new Uint8Array([0,0,0,0])),k.setCurrentSelectedId(null))}return on}}return We()(ne,[{key:"init",value:function(k){var G=this.rendererService,Ae=G.createTexture2D,ot=G.createFramebuffer,Xt=G.getViewportSize,nr=G.getContainer,rr=nr().getBoundingClientRect(),Rr=rr.width,on=rr.height;Rr*=window.devicePixelRatio,on*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(k).pickBufferScale||1,this.pickingFBO=ot({color:Ae({width:Math.round(Rr/this.pickBufferScale),height:Math.round(on/this.pickBufferScale),wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ii.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=En()(cr.a.mark(function G(Ae){return cr.a.wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Xt.next=2;break}return Xt.abrupt("return");case 2:return this.alreadyInPicking=!0,Xt.next=5,this.pickingLayers(Ae);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Xt.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"pickingLayers",value:function(){var se=En()(cr.a.mark(function G(Ae){var ot=this,Xt,nr,rr,Rr,on,Un,Kn,oa;return cr.a.wrap(function(za){for(;;)switch(za.prev=za.next){case 0:Xt=this.rendererService,nr=Xt.getViewportSize,rr=Xt.useFramebuffer,Rr=Xt.clear,on=Xt.getContainer,Un=on().getBoundingClientRect(),Kn=Un.width,oa=Un.height,Kn*=window.devicePixelRatio,oa*=window.devicePixelRatio,(this.width!==Kn||this.height!==oa)&&(this.pickingFBO.resize({width:Math.round(Kn/this.pickBufferScale),height:Math.round(oa/this.pickBufferScale)}),this.width=Kn,this.height=oa),rr(this.pickingFBO,function(){var Oi=ot.layerService.getLayers();Oi.filter(function(ni){return ni.needPick(Ae.type)}).reverse().some(function(ni){Rr({framebuffer:ot.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),ni.hooks.beforePickingEncode.call(),ni.renderModels(),ni.hooks.afterPickingEncode.call();var Fi=ot.pickFromPickingFBO(ni,Ae);return Fi&&!ni.getLayerConfig().enablePropagation})});case 6:case"end":return za.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"triggerHoverOnLayer",value:function(k,G){k.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(k,G){var Ae=mt()(G,3),ot=Ae[0],Xt=Ae[1],nr=Ae[2];k.hooks.beforeHighlight.call([ot,Xt,nr])}},{key:"selectFeature",value:function(k,G){var Ae=mt()(G,3),ot=Ae[0],Xt=Ae[1],nr=Ae[2];k.hooks.beforeSelect.call([ot,Xt,nr])}}]),ne}(),uo),Ic=wn()($s.prototype,"rendererService",[to],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ll=wn()($s.prototype,"configService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs=wn()($s.prototype,"interactionService",[Do],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=wn()($s.prototype,"layerService",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$s))||Xl),Yl=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Y()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return We()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var k=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();k=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=k}return k}}]),ne}(),yi,Ni,vl,js,ds,Ot,er,Or,Bn=(yi=Object(z.injectable)(),Ni=Object(z.inject)(D.a.IRendererService),vl=Object(z.inject)(D.a.IGlobalConfigService),yi(js=(ds=(Or=function(){function ne(){Y()(this,ne),this.clock=new Yl,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Sr()(this,"renderService",Ot,this),Sr()(this,"configService",er,this)}return We()(ne,[{key:"add",value:function(k){this.sceneInited&&k.init(),this.layers.push(k)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(k){k.inited||k.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(k){return this.layers.find(function(G){return G.id===k})}},{key:"getLayerByName",value:function(k){return this.layers.find(function(G){return G.name===k})}},{key:"remove",value:function(k){var G=this.layers.indexOf(k);G>-1&&this.layers.splice(G,1),k.emit("remove",null),k.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(k){return k.inited}).filter(function(k){return k.isVisible()}).forEach(function(k){k.hooks.beforeRenderData.call(),k.hooks.beforeRender.call(),k.render(),k.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(k,G){return k.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(k){return k.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Or),Ot=wn()(ds.prototype,"renderService",[Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),er=wn()(ds.prototype,"configService",[vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds))||js),Qa=i("QILm"),Ii=i.n(Qa),Gi=i("RIqP"),qa=i.n(Gi),bi=i("J2iB"),Ao=i.n(bi),zs=function(){function ne(se){var k=this;Y()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var Ae;return((Ae=k.scale)===null||Ae===void 0?void 0:Ae.defaultValues)||[]}return G.map(function(ot,Xt){var nr,rr=(nr=k.scale)===null||nr===void 0?void 0:nr.scalers[Xt].func,Rr=rr(ot);return Rr})},this.setProps(se)}return We()(ne,[{key:"setProps",value:function(k){Object.assign(this,k)}},{key:"mapping",value:function(k){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var Ae,ot=(Ae=this.scale)===null||Ae===void 0?void 0:Ae.callback.apply(Ae,qa()(k));if(!Ao()(ot))return[ot]}return this.defaultCallback(k)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),di,Kl,fu,Os,gl,hu,Wu;function Qs(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function nl(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Qs(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Qs(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function du(ne){return new Promise(function(se){return setTimeout(se,ne)})}var vc=(di={},re()(di,Fn.a.FLOAT,4),re()(di,Fn.a.UNSIGNED_BYTE,1),re()(di,Fn.a.UNSIGNED_SHORT,2),di),Pf=(Kl=Object(z.injectable)(),fu=Object(z.inject)(D.a.IRendererService),Kl(Os=(gl=(Wu=function(){function ne(){Y()(this,ne),this.attributesAndIndices=void 0,Sr()(this,"rendererService",hu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return We()(ne,[{key:"registerStyleAttribute",value:function(k){var G=this.getLayerStyleAttribute(k.name||"");return G?G.setProps(k):(G=new zs(k),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(k,G,Ae){var ot=this.getLayerStyleAttribute(k);ot||(ot=this.registerStyleAttribute(nl(nl({},G),{},{name:k})));var Xt=G.scale;Xt&&ot&&(ot.scale=Xt,ot.needRescale=!0,ot.needRemapping=!0,ot.needRegenerateVertices=!0,Ae&&Ae.featureRange&&(ot.featureRange=Ae.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(k){return this.attributes.find(function(G){return G.name===k})}},{key:"getLayerAttributeScale",value:function(k){var G,Ae=this.getLayerStyleAttribute(k),ot=Ae==null||((G=Ae.scale)===null||G===void 0)?void 0:G.scalers;return ot&&ot[0]?ot[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(k,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ot=arguments.length>3?arguments[3]:void 0,Xt=this.attributes.find(function(bo){return bo.name===k});if(Xt&&Xt.descriptor){var nr=Xt.descriptor,rr=nr.update,Rr=nr.buffer,on=nr.size,Un=on===void 0?0:on,Kn=vc[Rr.type||Fn.a.FLOAT];if(rr){var oa=this.featureLayout,ti=oa.elements,za=oa.sizePerElement,Oi=ti.slice(Ae,ot);if(!Oi.length)return;var ni=Oi[0].offset,Fi=ni*Un*Kn,Ro=Oi.map(function(bo,Zi){for(var Uo=bo.featureIdx,ri=bo.vertices,fo=bo.normals,au=ri.length/za,Si=[],Ui=0;Ui<au;Ui++){var Ea=fo?fo.slice(Ui*3,Ui*3+3):[];Si.push.apply(Si,qa()(rr(G[Uo],Uo,ri.slice(Ui*za,Ui*za+za),Zi,Ea)))}return Si}).reduce(function(bo,Zi){return bo.push.apply(bo,qa()(Zi)),bo},[]);Xt.vertexAttribute.updateBuffer({data:Ro,offset:Fi})}}}},{key:"createAttributesAndIndices",value:function(k,G){var Ae=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ot=this.attributes.map(function(ni){return ni.resetDescriptor(),ni.descriptor}),Xt=0,nr=[],rr=[],Rr=[],on=3;k.forEach(function(ni,Fi){var Ro=Ae.triangulation(ni),bo=Ro.indices,Zi=Ro.vertices,Uo=Ro.normals,ri=Ro.size;bo.forEach(function(Ui){rr.push(Ui+Xt)}),on=ri;var fo=Zi.length/ri;Ae.featureLayout.sizePerElement=on,Ae.featureLayout.elements.push({featureIdx:Fi,vertices:Zi,normals:Uo,offset:Xt}),Xt+=fo;for(var au=function(Ea){var Io=(Uo==null?void 0:Uo.slice(Ea*3,Ea*3+3))||[],hc=Zi.slice(Ea*ri,Ea*ri+ri);ot.forEach(function(Zf,hh){if(Zf&&Zf.update){var Xf;(Xf=Zf.buffer.data).push.apply(Xf,qa()(Zf.update(ni,Fi,hc,Ea,Io)))}})},Si=0;Si<fo;Si++)au(Si)});var Un=this.rendererService,Kn=Un.createAttribute,oa=Un.createBuffer,ti=Un.createElements,za={};ot.forEach(function(ni,Fi){if(ni){var Ro=ni.buffer,bo=ni.update,Zi=ni.name,Uo=Ii()(ni,["buffer","update","name"]),ri=Kn(nl({buffer:oa(Ro)},Uo));za[ni.name||""]=ri,Ae.attributes[Fi].vertexAttribute=ri}});var Oi=ti({data:rr,type:Fn.a.UNSIGNED_INT,count:rr.length});return this.attributesAndIndices={attributes:za,elements:Oi},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var k;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(k=this.attributesAndIndices)===null||k===void 0||k.elements.destroy(),this.attributes=[]}}]),ne}(),Wu),hu=wn()(gl.prototype,"rendererService",[fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||Os),pi=i("U8pU"),Dc=i("KQm4"),gc=i("rePB"),rf=i("1OyB"),nf=i("vuIU"),af=i("5ku3"),$i=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Cu=Object(af.a)();function qs(ne){try{var se=window[ne],k="__storage_test__";return se.setItem(k,k),se.removeItem(k),se}catch(G){return null}}var ps=function(){function ne(se,k){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(rf.a)(this,ne),this.storage=qs(G),this.id=se,this.config={},Object.assign(this.config,k),this._loadConfiguration()}return Object(nf.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(k){return this.config={},this.updateConfiguration(k)}},{key:"updateConfiguration",value:function(k){if(Object.assign(this.config,k),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var k={};if(this.storage){var G=this.storage.getItem(this.id);k=G?JSON.parse(G):{}}return Object.assign(this.config,k),this}}]),ne}();function Nc(ne){var se;return ne<10?se="".concat(ne.toFixed(2),"ms"):ne<100?se="".concat(ne.toFixed(1),"ms"):ne<1e3?se="".concat(ne.toFixed(0),"ms"):se="".concat((ne/1e3).toFixed(2),"s"),se}function yc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,k=Math.max(se-ne.length,0);return"".concat(" ".repeat(k)).concat(ne)}function yl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,k=Math.max(se-ne.length,0);return"".concat(ne).concat(" ".repeat(k))}function al(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=1e-16,G=se.isInteger,Ae=G===void 0?!1:G;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return bc(ne,se);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<k)return Ae?"0":"0.";if(Ae)return ne.toFixed(0);if(Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var ot=ne.toPrecision(2),Xt=ot.indexOf(".0");return Xt===ot.length-2?ot.slice(0,-1):ot}function bc(ne,se){for(var k=se.maxElts,G=k===void 0?16:k,Ae=se.size,ot=Ae===void 0?1:Ae,Xt="[",nr=0;nr<ne.length&&nr<G;++nr)nr>0&&(Xt+=",".concat(nr%ot===0?" ":"")),Xt+=al(ne[nr],se);var rr=ne.length>G?"...":"]";return"".concat(Xt).concat(rr)}function eu(ne,se,k){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ae=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>G&&(k=Math.min(k,G/ne.width));var ot=ne.width*k,Xt=ne.height*k,nr=["font-size:1px;","padding:".concat(Math.floor(Xt/2),"px ").concat(Math.floor(ot/2),"px;"),"line-height:".concat(Xt,"px;"),"background:url(".concat(Ae,");"),"background-size:".concat(ot,"px ").concat(Xt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),nr]}var Zu={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function kc(ne){return typeof ne=="string"?Zu[ne.toUpperCase()]||Zu.WHITE:ne}function $l(ne,se,k){return!Cu&&typeof ne=="string"&&(se&&(se=kc(se),ne="[".concat(se,"m").concat(ne,"[39m")),k&&(se=kc(k),ne="[".concat(k+10,"m").concat(ne,"[49m"))),ne}function Ci(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=jc(ne))){var se=0,k=function(){};return{s:k,n:function(){return se>=ne.length?{done:!0}:{done:!1,value:ne[se++]}},e:function(rr){throw rr},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,Ae=!0,ot=!1,Xt;return{s:function(){G=ne[Symbol.iterator]()},n:function(){var rr=G.next();return Ae=rr.done,rr},e:function(rr){ot=!0,Xt=rr},f:function(){try{!Ae&&G.return!=null&&G.return()}finally{if(ot)throw Xt}}}}function jc(ne,se){if(!ne)return;if(typeof ne=="string")return Lf(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(k);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return Lf(ne,se)}function Lf(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}function xc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],k=Object.getPrototypeOf(ne),G=Object.getOwnPropertyNames(k),Ae=Ci(G),ot;try{var Xt=function(){var rr=ot.value;typeof ne[rr]=="function"&&(se.find(function(Rr){return rr===Rr})||(ne[rr]=ne[rr].bind(ne)))};for(Ae.s();!(ot=Ae.n()).done;)Xt()}catch(nr){Ae.e(nr)}finally{Ae.f()}}function zc(ne,se){if(!ne)throw new Error(se||"Assertion failed")}var Jl=i("K9nA");function Xu(){var ne;if(Cu&&Jl.b.performance)ne=Jl.b.performance.now();else if(Jl.a.hrtime){var se=Jl.a.hrtime();ne=se[0]*1e3+se[1]/1e6}else ne=Date.now();return ne}var wu={debug:Cu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Rl={enabled:!0,level:0};function No(){}var Ql={},Il={once:!0};function bl(ne){for(var se in ne)for(var k in ne[se])return k||"untitled";return"empty"}var Fc=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=se.id;Object(rf.a)(this,ne),this.id=k,this.VERSION=$i,this._startTs=Xu(),this._deltaTs=Xu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new ps("__probe-".concat(this.id,"__"),Rl),this.userData={},this.timeStamp("".concat(this.id," started")),xc(this),Object.seal(this)}return Object(nf.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Xu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Xu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:k}),this}},{key:"setLevel",value:function(k){return this._storage.updateConfiguration({level:k}),this}},{key:"assert",value:function(k,G){zc(k,G)}},{key:"warn",value:function(k){return this._getLogFunction(0,k,wu.warn,arguments,Il)}},{key:"error",value:function(k){return this._getLogFunction(0,k,wu.error,arguments)}},{key:"deprecated",value:function(k,G){return this.warn("`".concat(k,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(k,G){return this.error("`".concat(k,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(k,G){return this._getLogFunction(k,G,wu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(k,G){return this._getLogFunction(k,G,wu.debug,arguments)}},{key:"info",value:function(k,G){return this._getLogFunction(k,G,console.info,arguments)}},{key:"once",value:function(k,G){return this._getLogFunction(k,G,wu.debug||wu.info,arguments,Il)}},{key:"table",value:function(k,G,Ae){return G?this._getLogFunction(k,G,console.table||No,Ae&&[Ae],{tag:bl(G)}):No}},{key:"image",value:function(k){var G=k.logLevel,Ae=k.priority,ot=k.image,Xt=k.message,nr=Xt===void 0?"":Xt,rr=k.scale,Rr=rr===void 0?1:rr;return this._shouldLog(G||Ae)?Cu?of({image:ot,message:nr,scale:Rr}):bf({image:ot,message:nr,scale:Rr}):No}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(k){return this._storage.config[k]}},{key:"set",value:function(k,G){this._storage.updateConfiguration(Object(gc.a)({},k,G))}},{key:"time",value:function(k,G){return this._getLogFunction(k,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(k,G){return this._getLogFunction(k,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(k,G){return this._getLogFunction(k,G,console.timeStamp||No)}},{key:"group",value:function(k,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ae=tu({logLevel:k,message:G,opts:Ae});var ot=Ae,Xt=ot.collapsed;return Ae.method=(Xt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ae)}},{key:"groupCollapsed",value:function(k,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(k,G,Object.assign({},Ae,{collapsed:!0}))}},{key:"groupEnd",value:function(k){return this._getLogFunction(k,"",console.groupEnd||No)}},{key:"withGroup",value:function(k,G,Ae){this.group(k,G)();try{Ae()}finally{this.groupEnd(k)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(k){return this.isEnabled()&&this.getLevel()>=Dl(k)}},{key:"_getLogFunction",value:function(k,G,Ae){var ot=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Xt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(k)){var nr;Xt=tu({logLevel:k,message:G,args:ot,opts:Xt}),Ae=Ae||Xt.method,zc(Ae),Xt.total=this.getTotal(),Xt.delta=this.getDelta(),this._deltaTs=Xu();var rr=Xt.tag||Xt.message;if(Xt.once)if(!Ql[rr])Ql[rr]=Xu();else return No;return G=yf(this.id,Xt.message,Xt),(nr=Ae).bind.apply(nr,[console,G].concat(Object(Dc.a)(Xt.args)))}return No}},{key:"level",set:function(k){this.setLevel(k)},get:function(){return this.getLevel()}},{key:"priority",set:function(k){this.level=k},get:function(){return this.level}}]),ne}();Fc.VERSION=$i;function Dl(ne){if(!ne)return 0;var se;switch(Object(pi.a)(ne)){case"number":se=ne;break;case"object":se=ne.logLevel||ne.priority||0;break;default:return 0}return zc(Number.isFinite(se)&&se>=0),se}function tu(ne){var se=ne.logLevel,k=ne.message;ne.logLevel=Dl(se);for(var G=ne.args?Array.from(ne.args):[];G.length&&G.shift()!==k;);ne.args=G;switch(Object(pi.a)(se)){case"string":case"function":k!==void 0&&G.unshift(k),ne.message=se;break;case"object":Object.assign(ne,se);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var Ae=Object(pi.a)(ne.message);return zc(Ae==="string"||Ae==="object"),Object.assign(ne,ne.opts)}function yf(ne,se,k){if(typeof se=="string"){var G=k.time?yc(Nc(k.total)):"";se=k.time?"".concat(ne,": ").concat(G,"  ").concat(se):"".concat(ne,": ").concat(se),se=$l(se,k.color,k.background)}return se}function bf(ne){var se=ne.image,k=ne.message,G=k===void 0?"":k,Ae=ne.scale,ot=Ae===void 0?1:Ae,Xt=null;try{Xt=i(2)}catch(nr){}return Xt?function(){return Xt(se,{fit:"box",width:"".concat(Math.round(80*ot),"%")}).then(function(nr){return console.log(nr)})}:No}function of(ne){var se=ne.image,k=ne.message,G=k===void 0?"":k,Ae=ne.scale,ot=Ae===void 0?1:Ae;if(typeof se=="string"){var Xt=new Image;return Xt.onload=function(){var on,Un=eu(Xt,G,ot);(on=console).log.apply(on,Object(Dc.a)(Un))},Xt.src=se,No}var nr=se.nodeName||"";if(nr.toLowerCase()==="img"){var rr;return(rr=console).log.apply(rr,Object(Dc.a)(eu(se,G,ot))),No}if(nr.toLowerCase()==="canvas"){var Rr=new Image;return Rr.onload=function(){var on;return(on=console).log.apply(on,Object(Dc.a)(eu(Rr,G,ot)))},Rr.src=se.toDataURL(),No}return No}var xl,ki,il=new Fc({id:"L7"}).enable(!1);il.priority=5;var Nl=(xl=Object(z.injectable)(),xl(ki=function(){function ne(){Y()(this,ne)}return We()(ne,[{key:"error",value:function(k){il.error(k)()}},{key:"warn",value:function(k){il.probe(1,k)()}},{key:"info",value:function(k){il.info(3,k)()}},{key:"debug",value:function(k){il.probe(4,k)()}}]),ne}())||ki),Ec=i("xp6e"),Uc=i("iegG"),kl=i.n(Uc),Rf=window.document.documentElement.style,If=0;function sf(ne){var se=ne;if(typeof ne=="string"&&(se=document.getElementById(ne)),se){var k=document.createElement("div");return k.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,k.id="l7-scene-".concat(If++),k.classList.add("l7-scene"),se.appendChild(k),k}return null}var El,ql,Ou,Fs,ol,Bc,Yu,ji,pu,sl,ul,Da,mi,Ms,Ti,Wa,ec,xf,rs,ll,mu,Ku,ro,ns,jl,lo,Mn,Us,Tc,Tl,Mu,Bs,ei,qr,Vc,_c;function cl(ne){var se=vu();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function vu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ps=(El=Object(z.injectable)(),ql=Object(z.inject)(D.a.SceneID),Ou=Object(z.inject)(D.a.IIconService),Fs=Object(z.inject)(D.a.IFontService),ol=Object(z.inject)(D.a.IControlService),Bc=Object(z.inject)(D.a.ILogService),Yu=Object(z.inject)(D.a.IGlobalConfigService),ji=Object(z.inject)(D.a.IMapService),pu=Object(z.inject)(D.a.ICoordinateSystemService),sl=Object(z.inject)(D.a.IRendererService),ul=Object(z.inject)(D.a.ILayerService),Da=Object(z.inject)(D.a.ICameraService),mi=Object(z.inject)(D.a.IInteractionService),Ms=Object(z.inject)(D.a.IPickingService),Ti=Object(z.inject)(D.a.IShaderModuleService),Wa=Object(z.inject)(D.a.IMarkerService),ec=Object(z.inject)(D.a.IPopupService),El(xf=(rs=(_c=function(ne){ce()(k,ne);var se=cl(k);function k(){var G;return Y()(this,k),G=se.call(this),G.destroyed=!1,G.loaded=!1,Sr()(G,"id",ll,Ba()(G)),Sr()(G,"iconService",mu,Ba()(G)),Sr()(G,"fontService",Ku,Ba()(G)),Sr()(G,"controlService",ro,Ba()(G)),Sr()(G,"logger",ns,Ba()(G)),Sr()(G,"configService",jl,Ba()(G)),Sr()(G,"map",lo,Ba()(G)),Sr()(G,"coordinateSystemService",Mn,Ba()(G)),Sr()(G,"rendererService",Us,Ba()(G)),Sr()(G,"layerService",Tc,Ba()(G)),Sr()(G,"cameraService",Tl,Ba()(G)),Sr()(G,"interactionService",Mu,Ba()(G)),Sr()(G,"pickingService",Bs,Ba()(G)),Sr()(G,"shaderModuleService",ei,Ba()(G)),Sr()(G,"markerService",qr,Ba()(G)),Sr()(G,"popupService",Vc,Ba()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),ge.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(Ae){G.cameraService.update(Ae),G.render()},G.hooks={init:new Ec.a},G}return We()(k,[{key:"init",value:function(Ae){var ot=this;this.configService.setSceneConfig(this.id,Ae),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",En()(cr.a.mark(function Xt(){return cr.a.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return rr.next=2,new Promise(function(Rr){ot.map.onCameraChanged(function(on){ot.cameraService.init(),ot.cameraService.update(on),Rr()}),ot.map.init()});case 2:ot.map.onCameraChanged(ot.handleMapCameraChanged),ot.map.addMarkerContainer(),ot.markerService.addMarkers(),ot.markerService.addMarkerLayers(),ot.popupService.initPopup(),ot.interactionService.init(),ot.interactionService.on(ii.a.Drag,ot.addSceneEvent.bind(ot)),ot.logger.debug("map ".concat(ot.id," loaded"));case 10:case"end":return rr.stop()}},Xt)}))),this.hooks.init.tapPromise("initRenderer",En()(cr.a.mark(function Xt(){var nr;return cr.a.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(nr=sf(ot.configService.getSceneConfig(ot.id).id||""),ot.$container=nr,!nr){Rr.next=11;break}return ot.canvas=ge.a.create("canvas","",nr),ot.setCanvas(),Rr.next=7,ot.rendererService.init(ot.canvas,ot.configService.getSceneConfig(ot.id));case 7:kl()(ot.$container,ot.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ot.handleWindowResized),Rr.next=12;break;case 11:ot.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ot.pickingService.init(ot.id),ot.logger.debug("scene ".concat(ot.id," renderer loaded"));case 14:case"end":return Rr.stop()}},Xt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ae){this.logger.debug("add layer ".concat(Ae.name," to scene ").concat(this.id)),this.layerService.add(Ae),this.render()}},{key:"render",value:function(){var G=En()(cr.a.mark(function ot(){return cr.a.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:if(!(this.rendering||this.destroyed)){nr.next=2;break}return nr.abrupt("return");case 2:if(this.rendering=!0,this.inited){nr.next=13;break}return nr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return nr.stop()}},ot,this)}));function Ae(){return G.apply(this,arguments)}return Ae}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ae){var ot,Xt=(ot=this.$container)===null||ot===void 0?void 0:ot.getElementsByTagName("canvas")[0];this.render();var nr=Ae==="jpg"?Xt==null?void 0:Xt.toDataURL("image/jpeg"):Xt==null?void 0:Xt.toDataURL("image/png");return nr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ae=this.$container.parentElement;Ae!==null&&(this.markerContainer=ge.a.create("div","l7-marker-container",Ae))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Uc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ae,ot,Xt=window.devicePixelRatio,nr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,rr=((ot=this.$container)===null||ot===void 0?void 0:ot.clientHeight)||300,Rr=this.canvas;Rr&&(Rr.width=nr*Xt,Rr.height=rr*Xt,Rr.style.width="".concat(nr,"px"),Rr.style.height="".concat(rr,"px")),this.rendererService.viewport({x:0,y:0,width:Xt*nr,height:Xt*rr})}},{key:"setCanvas",value:function(){var Ae,ot,Xt=window.devicePixelRatio,nr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,rr=((ot=this.$container)===null||ot===void 0?void 0:ot.clientHeight)||300,Rr=this.canvas;Rr.width=nr*Xt,Rr.height=rr*Xt,Rr.style.width="".concat(nr,"px"),Rr.style.height="".concat(rr,"px")}},{key:"addSceneEvent",value:function(Ae){this.emit(Ae.type,Ae)}}]),k}(m.EventEmitter),_c),ll=wn()(rs.prototype,"id",[ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=wn()(rs.prototype,"iconService",[Ou],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ku=wn()(rs.prototype,"fontService",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ro=wn()(rs.prototype,"controlService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns=wn()(rs.prototype,"logger",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=wn()(rs.prototype,"configService",[Yu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=wn()(rs.prototype,"map",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=wn()(rs.prototype,"coordinateSystemService",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=wn()(rs.prototype,"rendererService",[sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=wn()(rs.prototype,"layerService",[ul],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tl=wn()(rs.prototype,"cameraService",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mu=wn()(rs.prototype,"interactionService",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=wn()(rs.prototype,"pickingService",[Ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei=wn()(rs.prototype,"shaderModuleService",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=wn()(rs.prototype,"markerService",[Wa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vc=wn()(rs.prototype,"popupService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs))||xf),Ls=i("7tbW"),$o=i.n(Ls);function ko(ne){var se=0;switch(ne){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var fl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function _l(ne){var se={};return ne=ne.replace(fl,function(k,G,Ae){var ot=Ae.split(":"),Xt=ot[0].trim(),nr="";ot.length>1&&(nr=ot[1].trim());switch(G){case"bool":nr=nr==="true";break;case"float":case"int":nr=Number(nr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":nr?nr=nr.replace("[","").replace("]","").split(",").reduce(function(rr,Rr){return rr.push(Number(Rr.trim())),rr},[]):nr=new Array(ko(G)).fill(0);break;default:}return se[Xt]=nr,"uniform ".concat(G," ").concat(Xt,`;
`)}),{content:ne,uniforms:se}}var zl,uf,Fl;function Rs(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function as(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Rs(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Rs(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var Pa="#define PI 3.14159265359",$u=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,zi=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Co=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Sl=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,gu=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,yu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Ss=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Sc=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Yn=/precision\s+(high|low|medium)p\s+float/,Nn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Ac=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,ms=(zl=Object(z.injectable)(),zl(uf=(Fl=function(){function ne(){Y()(this,ne),this.moduleCache={},this.rawContentCache={}}return We()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Pa,fs:Pa}),this.registerModule("decode",{vs:$u,fs:""}),this.registerModule("projection",{vs:Ss,fs:""}),this.registerModule("project",{vs:yu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Sc}),this.registerModule("lighting",{vs:Co,fs:""}),this.registerModule("light",{vs:zi,fs:""}),this.registerModule("picking",{vs:gu,fs:Sl})}},{key:"registerModule",value:function(k,G){if(this.rawContentCache[k])return;var Ae=G.vs,ot=G.fs,Xt=G.uniforms,nr=_l(Ae),rr=nr.content,Rr=nr.uniforms,on=_l(ot),Un=on.content,Kn=on.uniforms;this.rawContentCache[k]={fs:Un,uniforms:as(as(as({},Rr),Kn),Xt),vs:rr}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(k){var G=this;if(this.moduleCache[k])return this.moduleCache[k];var Ae=this.rawContentCache[k].vs,ot=this.rawContentCache[k].fs,Xt=this.processModule(Ae,[],"vs"),nr=Xt.content,rr=Xt.includeList,Rr=this.processModule(ot,[],"fs"),on=Rr.content,Un=Rr.includeList,Kn=on,oa=$o()(rr.concat(Un).concat(k)).reduce(function(ti,za){return as(as({},ti),G.rawContentCache[za].uniforms)},{});return Yn.test(on)||(Kn=Nn+on),this.moduleCache[k]={fs:Kn.trim(),uniforms:oa,vs:nr.trim()},this.moduleCache[k]}},{key:"processModule",value:function(k,G,Ae){var ot=this,Xt=k.replace(Ac,function(nr,rr){var Rr=rr.split(" "),on=Rr[0].replace(/"/g,"");if(G.indexOf(on)>-1)return"";var Un=ot.rawContentCache[on][Ae];G.push(on);var Kn=ot.processModule(Un,G,Ae),oa=Kn.content;return oa});return{content:Xt,includeList:G}}}]),ne}(),Fl))||uf),jo=i("iWIM"),wo=i.n(jo),ru=i("bPkA"),Pu,tc,Za,Hi,hl,dl,rc=(Pu=Object(z.injectable)(),tc=Object(z.inject)(D.a.IShaderModuleService),Pu(Za=(Hi=(dl=function(){function ne(){Y()(this,ne),Sr()(this,"shaderModuleService",hl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return We()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ru.a.Normal}},{key:"init",value:function(k,G){this.config=G,this.rendererService=k.getContainer().get(D.a.IRendererService),this.cameraService=k.getContainer().get(D.a.ICameraService),this.mapService=k.getContainer().get(D.a.IMapService),this.interactionService=k.getContainer().get(D.a.IInteractionService),this.layerService=k.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(k){}}]),ne}(),dl),hl=wn()(Hi.prototype,"shaderModuleService",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi))||Za),Lu,Is;function Ul(ne){var se=vs();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function vs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ef=(Lu=Object(z.injectable)(),Lu(Is=function(ne){ce()(k,ne);var se=Ul(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ae,ot){wo()(nt()(k.prototype),"init",this).call(this,Ae,ot)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),k}(rc))||Is),Bl,Gc,Tf,Vs,Al,Vl;function Ru(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=Iu(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Rr){throw Rr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,nr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Rr=k.next();return ot=Rr.done,Rr},e:function(Rr){Xt=!0,nr=Rr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw nr}}}}function Iu(ne,se){if(!ne)return;if(typeof ne=="string")return Cl(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return Cl(ne,se)}function Cl(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var Ju=(Bl=Object(z.injectable)(),Gc=Object(z.inject)(D.a.IPostProcessor),Bl(Tf=(Vs=(Vl=function(){function ne(){Y()(this,ne),this.passes=[],Sr()(this,"postProcessor",Al,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return We()(ne,[{key:"setLayer",value:function(k){this.layer=k}},{key:"setRenderFlag",value:function(k){this.renderFlag=k}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=En()(cr.a.mark(function G(){var Ae,ot,Xt;return cr.a.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:Ae=Ru(this.passes),rr.prev=1,Ae.s();case 3:if((ot=Ae.n()).done){rr.next=9;break}return Xt=ot.value,rr.next=7,Xt.render(this.layer);case 7:rr.next=3;break;case 9:rr.next=14;break;case 11:rr.prev=11,rr.t0=rr.catch(1),Ae.e(rr.t0);case 14:return rr.prev=14,Ae.f(),rr.finish(14);case 17:this.layer.renderModels();case 18:case"end":return rr.stop()}},G,this,[[1,11,14,17]])}));function k(){return se.apply(this,arguments)}return k}()},{key:"resize",value:function(k,G){(this.width!==k||this.height!==G)&&(this.width=k,this.height=G)}},{key:"add",value:function(k,G){k.getType()===ru.a.PostProcessing?this.postProcessor.add(k,this.layer,G):(k.init(this.layer,G),this.passes.push(k))}},{key:"insert",value:function(k,G,Ae){k.init(this.layer,G),this.passes.splice(Ae,0,k)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),Vl),Al=wn()(Vs.prototype,"postProcessor",[Gc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vs))||Tf),Ds,Cc,nc,ac,ic,s;function a(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function n(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?a(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):a(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function l(ne){var se=b();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function b(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var O=(Ds=Object(z.injectable)(),Cc=Object(z.inject)(D.a.ILogService),Ds(nc=(ac=(s=function(ne){ce()(k,ne);var se=l(k);function k(){var G;Y()(this,k);for(var Ae=arguments.length,ot=new Array(Ae),Xt=0;Xt<Ae;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),Sr()(G,"logger",ic,Ba()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(nr){var rr=nr.x,Rr=nr.y,on=nr.lngLat,Un=nr.type;if(!G.layer.isVisible()||!G.layer.needPick(Un))return;var Kn=G.rendererService,oa=Kn.getViewportSize,ti=Kn.readPixels,za=Kn.useFramebuffer,Oi=oa(),ni=Oi.width,Fi=Oi.height,Ro=G.layer.getLayerConfig(),bo=Ro.enableHighlight,Zi=Ro.enableSelect,Uo=rr*window.devicePixelRatio,ri=Rr*window.devicePixelRatio;if(Uo>ni||Uo<0||ri>Fi||ri<0)return;var fo;za(G.pickingFBO,function(){var au;if(fo=ti({x:Math.round(Uo),y:Math.round(Fi-(Rr+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),fo[0]!==0||fo[1]!==0||fo[2]!==0){G.logger.debug("picked");var Si=Object(ge.k)(fo),Ui=G.layer.getSource().getFeatureById(Si),Ea={x:rr,y:Rr,type:Un,lngLat:on,featureId:Si,feature:Ui};Ui&&(G.layer.setCurrentPickId(Si),G.triggerHoverOnLayer(Ea))}else{var Io={x:rr,y:Rr,lngLat:on,type:G.layer.getCurrentPickId()===null?"un"+Un:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(n(n({},Io),{},{type:"unpick"})),G.triggerHoverOnLayer(Io),G.layer.setCurrentPickId(null)}bo&&G.highlightPickedFeature(fo),Zi&&Un==="click"&&((au=fo)===null||au===void 0?void 0:au.toString())!==[0,0,0,0].toString()&&G.selectFeature(fo)})},G}return We()(k,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ae,ot){wo()(nt()(k.prototype),"init",this).call(this,Ae,ot),this.layer=Ae;var Xt=this.rendererService,nr=Xt.createTexture2D,rr=Xt.createFramebuffer,Rr=Xt.getViewportSize,on=Rr(),Un=on.width,Kn=on.height;this.pickingFBO=rr({color:nr({width:Un,height:Kn,wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ii.a.Hover,this.pickFromPickingFBO),this.interactionService.on(ii.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ii.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ae){var ot=this;if(this.alreadyInRendering)return;var Xt=this.rendererService,nr=Xt.getViewportSize,rr=Xt.useFramebuffer,Rr=Xt.clear,on=nr(),Un=on.width,Kn=on.height;this.alreadyInRendering=!0,(this.width!==Un||this.height!==Kn)&&(this.pickingFBO.resize({width:Un,height:Kn}),this.width=Un,this.height=Kn),rr(this.pickingFBO,function(){Rr({framebuffer:ot.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var oa=ot.layer.multiPassRenderer.getRenderFlag();ot.layer.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforePickingEncode.call(),Ae.render(),Ae.hooks.afterPickingEncode.call(),ot.layer.multiPassRenderer.setRenderFlag(oa),ot.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Ae){this.layer.emit(Ae.type,Ae)}},{key:"highlightPickedFeature",value:function(Ae){var ot=mt()(Ae,3),Xt=ot[0],nr=ot[1],rr=ot[2];this.layer.hooks.beforeHighlight.call([Xt,nr,rr]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ae){var ot=mt()(Ae,3),Xt=ot[0],nr=ot[1],rr=ot[2];this.layer.hooks.beforeSelect.call([Xt,nr,rr]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ae){var ot=Ae.featureId,Xt=Object(ge.l)(ot);this.selectFeature(new Uint8Array(Xt))}},{key:"highlightFeatureHandle",value:function(Ae){var ot=Ae.featureId,Xt=Object(ge.l)(ot);this.highlightPickedFeature(new Uint8Array(Xt))}}]),k}(rc),s),ic=wn()(ac.prototype,"logger",[Cc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac))||nc),R=i("+em5"),j,ue;function Te(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Xe(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Te(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Te(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Je(ne){var se=tt();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function tt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Dt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Lt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Zt=(j=Object(z.injectable)(),j(ue=function(ne){ce()(k,ne);var se=Je(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Lt,fs:Dt});var Ae=this.shaderModuleService.getModule("blur-pass"),ot=Ae.vs,Xt=Ae.fs,nr=Ae.uniforms,rr=this.rendererService.getViewportSize(),Rr=rr.width,on=rr.height;return{vs:ot,fs:Xt,uniforms:Xe(Xe({},nr),{},{u_ViewportSize:[Rr,on]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ot={};return Ao()(Ae.blurRadius)||(ot.u_BlurDir=[Ae.blurRadius,0]),ot}}]),k}(R.a))||ue),Rt,Bt;function qt(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Qt(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?qt(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):qt(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Pr(ne){var se=fr();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function fr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Tr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Ar=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,nn=(Rt=Object(z.injectable)(),Rt(Bt=function(ne){ce()(k,ne);var se=Pr(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Ar,fs:Tr});var Ae=this.shaderModuleService.getModule("blur-pass"),ot=Ae.vs,Xt=Ae.fs,nr=Ae.uniforms,rr=this.rendererService.getViewportSize(),Rr=rr.width,on=rr.height;return{vs:ot,fs:Xt,uniforms:Qt(Qt({},nr),{},{u_ViewportSize:[Rr,on]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ot={};return Ao()(Ae.blurRadius)||(ot.u_BlurDir=[0,Ae.blurRadius]),ot}}]),k}(R.a))||Bt),Xr,gn;function Pn(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Jn(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Pn(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Pn(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function aa(ne){var se=ba();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function ba(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Xa=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,_n=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ia=(Xr=Object(z.injectable)(),Xr(gn=function(ne){ce()(k,ne);var se=aa(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:_n,fs:Xa});var Ae=this.shaderModuleService.getModule("colorhalftone-pass"),ot=Ae.vs,Xt=Ae.fs,nr=Ae.uniforms,rr=this.rendererService.getViewportSize(),Rr=rr.width,on=rr.height;return{vs:ot,fs:Xt,uniforms:Jn(Jn({},nr),{},{u_ViewportSize:[Rr,on]})}}}]),k}(R.a))||gn),xa,Wn;function Aa(ne){var se=ta();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function ta(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var La=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,ja=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ji=(xa=Object(z.injectable)(),xa(Wn=function(ne){ce()(k,ne);var se=Aa(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:ja,fs:La}),this.shaderModuleService.getModule("copy-pass")}}]),k}(R.a))||Wn),wi,vo;function _i(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Wi(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?_i(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):_i(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Ns(ne){var se=go();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function go(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var bu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,xu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,zo=(wi=Object(z.injectable)(),wi(vo=function(ne){ce()(k,ne);var se=Ns(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:xu,fs:bu});var Ae=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ot=Ae.vs,Xt=Ae.fs,nr=Ae.uniforms,rr=this.rendererService.getViewportSize(),Rr=rr.width,on=rr.height;return{vs:ot,fs:Xt,uniforms:Wi(Wi({},nr),{},{u_ViewportSize:[Rr,on]})}}}]),k}(R.a))||vo),As,Du;function oc(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Qu(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?oc(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):oc(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function sc(ne){var se=uc();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Nu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,pl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Cs=(As=Object(z.injectable)(),As(Du=function(ne){ce()(k,ne);var se=sc(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:pl,fs:Nu});var Ae=this.shaderModuleService.getModule("ink-pass"),ot=Ae.vs,Xt=Ae.fs,nr=Ae.uniforms,rr=this.rendererService.getViewportSize(),Rr=rr.width,on=rr.height;return{vs:ot,fs:Xt,uniforms:Qu(Qu({},nr),{},{u_ViewportSize:[Rr,on]})}}}]),k}(R.a))||Du),co,ku;function Eu(ne){var se=Oo();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function Oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Mo=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Po=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jo=(co=Object(z.injectable)(),co(ku=function(ne){ce()(k,ne);var se=Eu(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Po,fs:Mo}),this.shaderModuleService.getModule("noise-pass")}}]),k}(R.a))||ku),yo,Fo;function Gs(ne){var se=wl();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function wl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Hc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Gl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,qu=(yo=Object(z.injectable)(),yo(Fo=function(ne){ce()(k,ne);var se=Gs(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Hc,fs:Gl}),this.shaderModuleService.getModule("sepia-pass")}}]),k}(R.a))||Fo),ju,zu,Hs,Lo,Wc,gs,lf,Df=(ju=Object(z.injectable)(),zu=Object(z.inject)(D.a.IRendererService),Hs=Object(z.postConstruct)(),ju(Lo=(Wc=(lf=function(){function ne(){Y()(this,ne),Sr()(this,"rendererService",gs,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return We()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=En()(cr.a.mark(function G(Ae){var ot,Xt;return cr.a.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:ot=0;case 1:if(!(ot<this.passes.length)){rr.next=10;break}return Xt=this.passes[ot],Xt.setRenderToScreen(this.isLastEnabledPass(ot)),rr.next=6,Xt.render(Ae);case 6:ot!==this.passes.length-1&&this.swap();case 7:ot++,rr.next=1;break;case 10:case"end":return rr.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"resize",value:function(k,G){this.readFBO.resize({width:k,height:G}),this.writeFBO.resize({width:k,height:G})}},{key:"add",value:function(k,G,Ae){k.init(G,Ae),this.passes.push(k)}},{key:"insert",value:function(k,G,Ae,ot){k.init(Ae,ot),this.passes.splice(G,0,k)}},{key:"getPostProcessingPassByName",value:function(k){return this.passes.find(function(G){return G.getName()===k})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(k){for(var G=k+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var k=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=k}}]),ne}(),lf),gs=wn()(Wc.prototype,"rendererService",[zu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wn()(Wc.prototype,"init",[Hs],Object.getOwnPropertyDescriptor(Wc.prototype,"init"),Wc.prototype),Wc))||Lo),Nf,Bf;function el(ne){var se=_f();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function _f(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var cf=(Nf=Object(z.injectable)(),Nf(Bf=function(ne){ce()(k,ne);var se=el(k);function k(){return Y()(this,k),se.apply(this,arguments)}return We()(k,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ae,ot){wo()(nt()(k.prototype),"init",this).call(this,Ae,ot)}},{key:"render",value:function(Ae){var ot=this.rendererService,Xt=ot.useFramebuffer,nr=ot.clear;Xt(null,function(){nr({color:[0,0,0,0],depth:1,stencil:0}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)})}}]),k}(rc))||Bf),lc,Fu,cc,Vf,wc,Oc,Gf,Hf;function ih(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),k.push.apply(k,G)}return k}function Wf(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?ih(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):ih(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function kf(ne){var se=fh();return function(){var G=nt()(ne),Ae;if(se){var ot=nt()(this).constructor;Ae=Reflect.construct(G,arguments,ot)}else Ae=G.apply(this,arguments);return $e()(this,Ae)}}function fh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var fc=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,ff=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,no=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Hl(ne,se){for(var k=0,G=1/se,Ae=ne;Ae>0;)k=k+G*(Ae%se),Ae=Math.floor(Ae/se),G=G/se;return k}var hf=1,Zc=(lc=Object(z.injectable)(),Fu=Object(z.inject)(D.a.IShaderModuleService),cc=Object(z.inject)(D.a.ILogService),lc(Vf=(wc=(Hf=function(ne){ce()(k,ne);var se=kf(k);function k(){var G;Y()(this,k);for(var Ae=arguments.length,ot=new Array(Ae),Xt=0;Xt<Ae;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),Sr()(G,"shaderModuleService",Oc,Ba()(G)),Sr()(G,"logger",Gf,Ba()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return We()(k,[{key:"getType",value:function(){return ru.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ae,ot){wo()(nt()(k.prototype),"init",this).call(this,Ae,ot);var Xt=this.rendererService,nr=Xt.createFramebuffer,rr=Xt.createTexture2D;this.sampleRenderTarget=nr({color:rr({width:1,height:1,wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=nr({color:rr({width:1,height:1,wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=nr({color:rr({width:1,height:1,wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=nr({color:rr({width:1,height:1,wrapS:Fn.a.CLAMP_TO_EDGE,wrapT:Fn.a.CLAMP_TO_EDGE})});for(var Rr=0;Rr<30;Rr++)this.haltonSequence.push([Hl(Rr,2),Hl(Rr,3)]);this.blendModel=this.createTriangleModel("blend-pass",fc),this.outputModel=this.createTriangleModel("copy-pass",ff,{blend:{enable:!0,func:{srcRGB:Fn.a.ONE,dstRGB:Fn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Fn.a.ONE,dstAlpha:Fn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Fn.a.FUNC_ADD,alpha:Fn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",ff)}},{key:"render",value:function(Ae){var ot=this,Xt=this.rendererService,nr=Xt.clear,rr=Xt.getViewportSize,Rr=Xt.useFramebuffer,on=rr(),Un=on.width,Kn=on.height;this.sampleRenderTarget.resize({width:Un,height:Kn}),this.prevRenderTarget.resize({width:Un,height:Kn}),this.outputRenderTarget.resize({width:Un,height:Kn}),this.copyRenderTarget.resize({width:Un,height:Kn}),this.resetFrame(),this.stopAccumulating();var oa=Ae.multiPassRenderer.getPostProcessor().getReadFBO();Rr(oa,function(){nr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:oa}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)});var ti=function za(Oi){if(!ot.accumulatingId||Oi!==ot.accumulatingId)return;ot.isFinished()||(ot.doRender(Ae),requestAnimationFrame(function(){za(Oi)}))};this.accumulatingId=hf++,this.timer=window.setTimeout(function(){ti(ot.accumulatingId)},50)}},{key:"doRender",value:function(Ae){var ot=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Xt=this.rendererService,nr=Xt.clear,rr=Xt.getViewportSize,Rr=Xt.useFramebuffer,on=rr(),Un=on.width,Kn=on.height,oa=Ae.getLayerConfig(),ti=oa.jitterScale,za=ti===void 0?1:ti,Oi=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Oi[0]*2-1)/Un*za,(Oi[1]*2-1)/Kn*za),Ae.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforeRender.call(),Rr(this.sampleRenderTarget,function(){nr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ot.sampleRenderTarget}),Ae.render()}),Ae.hooks.afterRender.call(),Ae.multiPassRenderer.setRenderFlag(!0);var ni=Ae.getLayerConfig();Rr(this.outputRenderTarget,function(){ot.blendModel.draw({uniforms:{u_opacity:ni.opacity||1,u_MixRatio:ot.frame===0?1:.9,u_Diffuse1:ot.sampleRenderTarget,u_Diffuse2:ot.frame===0?Ae.multiPassRenderer.getPostProcessor().getReadFBO():ot.prevRenderTarget}})}),this.frame===0&&nr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Rr(this.copyRenderTarget,function(){ot.outputModel.draw({uniforms:{u_Texture:ot.outputRenderTarget}})}),Rr(Ae.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ot.copyModel.draw({uniforms:{u_Texture:ot.copyRenderTarget}})}),Ae.multiPassRenderer.getPostProcessor().render(Ae));var Fi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Fi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ae,ot,Xt){this.shaderModuleService.registerModule(Ae,{vs:no,fs:ot});var nr=this.shaderModuleService.getModule(Ae),rr=nr.vs,Rr=nr.fs,on=nr.uniforms,Un=this.rendererService,Kn=Un.createAttribute,oa=Un.createBuffer,ti=Un.createModel;return ti(Wf({vs:rr,fs:Rr,attributes:{a_Position:Kn({buffer:oa({data:[-4,-4,4,-4,0,4],type:Fn.a.FLOAT}),size:2})},uniforms:Wf({},on),depth:{enable:!1},count:3},Xt))}}]),k}(rc),Hf),Oc=wn()(wc.prototype,"shaderModuleService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=wn()(wc.prototype,"logger",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc))||Vf),nu=new z.Container;nu.bind(D.a.IGlobalConfigService).to(dn).inSingletonScope(),nu.bind(D.a.IShaderModuleService).to(ms).inSingletonScope(),nu.bind(D.a.ILogService).to(Nl).inSingletonScope(),Object(z.decorate)(Object(z.injectable)(),m.EventEmitter),nu.bind(D.a.IEventEmitter).to(m.EventEmitter);var Ol=Z()(nu,!1),Sf=function(se){var k=Ol.lazyInject(se);return function(G,Ae,ot){k.call(this,G,Ae),ot&&(ot.initializer=function(){return G[Ae]})}},Af=function(se){var k=Ol.lazyMultiInject(se);return function(G,Ae,ot){k.call(this,G,Ae),ot&&(ot.initializer=function(){return G[Ae]})}},Xc=E.c=nu,df=0;function Yc(){var ne=new z.Container;return ne.parent=nu,ne.bind(D.a.SceneID).toConstantValue("".concat(df++)),ne.bind(D.a.ILayerService).to(Bn).inSingletonScope(),ne.bind(D.a.ISceneService).to(Ps).inSingletonScope(),ne.bind(D.a.ICameraService).to(pr).inSingletonScope(),ne.bind(D.a.ICoordinateSystemService).to(Ko).inSingletonScope(),ne.bind(D.a.IInteractionService).to(Ie).inSingletonScope(),ne.bind(D.a.IPickingService).to(cu).inSingletonScope(),ne.bind(D.a.IControlService).to(Hn).inSingletonScope(),ne.bind(D.a.IMarkerService).to(le).inSingletonScope(),ne.bind(D.a.IIconService).to(pt).inSingletonScope(),ne.bind(D.a.IFontService).to(I).inSingletonScope(),ne.bind(D.a.IPopupService).to(jt).inSingletonScope(),ne.bind(D.a.INormalPass).to(Ef).whenTargetNamed("clear"),ne.bind(D.a.INormalPass).to(O).whenTargetNamed("pixelPicking"),ne.bind(D.a.INormalPass).to(cf).whenTargetNamed("render"),ne.bind(D.a.INormalPass).to(Zc).whenTargetNamed("taa"),ne.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(k){return se.container.getNamed(D.a.INormalPass,k)}}),ne.bind(D.a.IPostProcessingPass).to(Ji).whenTargetNamed("copy"),ne.bind(D.a.IPostProcessingPass).to(Zt).whenTargetNamed("blurH"),ne.bind(D.a.IPostProcessingPass).to(nn).whenTargetNamed("blurV"),ne.bind(D.a.IPostProcessingPass).to(Jo).whenTargetNamed("noise"),ne.bind(D.a.IPostProcessingPass).to(qu).whenTargetNamed("sepia"),ne.bind(D.a.IPostProcessingPass).to(ia).whenTargetNamed("colorHalftone"),ne.bind(D.a.IPostProcessingPass).to(zo).whenTargetNamed("hexagonalPixelate"),ne.bind(D.a.IPostProcessingPass).to(Cs).whenTargetNamed("ink"),ne.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(k){var G=se.container.getNamed(D.a.IPostProcessingPass,k);return G.setName(k),G}}),ne}function Wl(ne){var se=new z.Container;return se.parent=ne,se.bind(D.a.IStyleAttributeService).to(Pf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Ju).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Df).inSingletonScope(),se}},fbrv:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Yk9n"),m=i("MON2"),X=i("FV85"),z=i("xfSm"),o=i("ujMp");E.getFunctionName=o.getFunctionName;var Z=i("dX1H");function D(ge,we){var dt=o.getFunctionName(we),ke=K(ge,dt,we,!1);return ke}E.getDependencies=D;function K(ge,we,dt,ke){var Et=ge.getConstructorMetadata(dt),Ze=Et.compilerGeneratedMetadata;if(Ze===void 0){var vt=m.MISSING_INJECTABLE_ANNOTATION+" "+we+".";throw new Error(vt)}var Qe=Et.userGeneratedMetadata,yt=Object.keys(Qe),_t=dt.length===0&&yt.length>0,De=_t?yt.length:dt.length,Ne=fe(ke,we,Ze,Qe,De),Ue=Y(ge,dt),st=Ne.concat(Ue);return st}function re(ge,we,dt,ke,Et){var Ze=Et[ge.toString()]||[],vt=We(Ze),Qe=vt.unmanaged!==!0,yt=ke[ge],_t=vt.inject||vt.multiInject;if(yt=_t||yt,yt instanceof T.LazyServiceIdentifer&&(yt=yt.unwrap()),Qe){var De=yt===Object,Ne=yt===Function,Ue=yt===void 0,st=De||Ne||Ue;if(!we&&st){var Le=m.MISSING_INJECT_ANNOTATION+" argument "+ge+" in class "+dt+".";throw new Error(Le)}var ut=new Z.Target(X.TargetTypeEnum.ConstructorArgument,vt.targetName,yt);return ut.metadata=Ze,ut}return null}function fe(ge,we,dt,ke,Et){for(var Ze=[],vt=0;vt<Et;vt++){var Qe=vt,yt=re(Qe,ge,we,dt,ke);yt!==null&&Ze.push(yt)}return Ze}function Y(ge,we){for(var dt=ge.getPropertiesMetadata(we),ke=[],Et=Object.keys(dt),Ze=0,vt=Et;Ze<vt.length;Ze++){var Qe=vt[Ze],yt=dt[Qe],_t=We(dt[Qe]),De=_t.targetName||Qe,Ne=_t.inject||_t.multiInject,Ue=new Z.Target(X.TargetTypeEnum.ClassProperty,De,Ne);Ue.metadata=yt,ke.push(Ue)}var st=Object.getPrototypeOf(we.prototype).constructor;if(st!==Object){var Le=Y(ge,st);ke=ke.concat(Le)}return ke}function Fe(ge,we){var dt=Object.getPrototypeOf(we.prototype).constructor;if(dt!==Object){var ke=o.getFunctionName(dt),Et=K(ge,ke,dt,!0),Ze=Et.map(function(yt){return yt.metadata.filter(function(_t){return _t.key===z.UNMANAGED_TAG})}),vt=[].concat.apply([],Ze).length,Qe=Et.length-vt;return Qe>0?Qe:Fe(ge,dt)}else return 0}E.getBaseClassDependencyCount=Fe;function We(ge){var we={};return ge.forEach(function(dt){we[dt.key.toString()]=dt.value}),{inject:we[z.INJECT_TAG],multiInject:we[z.MULTI_INJECT_TAG],targetName:we[z.NAME_TAG],unmanaged:we[z.UNMANAGED_TAG]}}},fbvF:function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";var T=function(je){return je instanceof Uint8Array||je instanceof Uint16Array||je instanceof Uint32Array||je instanceof Int8Array||je instanceof Int16Array||je instanceof Int32Array||je instanceof Float32Array||je instanceof Float64Array||je instanceof Uint8ClampedArray},m=function(je,bt){for(var vr=Object.keys(bt),Mr=0;Mr<vr.length;++Mr)je[vr[Mr]]=bt[vr[Mr]];return je},X=`
`;function z(xe){return typeof atob!="undefined"?atob(xe):"base64:"+xe}function o(xe){var je=new Error("(regl) "+xe);throw console.error(je),je}function Z(xe,je){xe||o(je)}function D(xe){return xe?": "+xe:""}function K(xe,je,bt){xe in je||o("unknown parameter ("+xe+")"+D(bt)+". possible values: "+Object.keys(je).join())}function re(xe,je){T(xe)||o("invalid parameter type"+D(je)+". must be a typed array")}function fe(xe,je){switch(je){case"number":return typeof xe=="number";case"object":return typeof xe=="object";case"string":return typeof xe=="string";case"boolean":return typeof xe=="boolean";case"function":return typeof xe=="function";case"undefined":return typeof xe=="undefined";case"symbol":return typeof xe=="symbol"}}function Y(xe,je,bt){fe(xe,je)||o("invalid parameter type"+D(bt)+". expected "+je+", got "+typeof xe)}function Fe(xe,je){xe>=0&&(xe|0)===xe||o("invalid parameter type, ("+xe+")"+D(je)+". must be a nonnegative integer")}function We(xe,je,bt){je.indexOf(xe)<0&&o("invalid value"+D(bt)+". must be one of: "+je)}var ge=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function we(xe){Object.keys(xe).forEach(function(je){ge.indexOf(je)<0&&o('invalid regl constructor argument "'+je+'". must be one of '+ge)})}function dt(xe,je){for(xe=xe+"";xe.length<je;)xe=" "+xe;return xe}function ke(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Et(xe,je){this.number=xe,this.line=je,this.errors=[]}function Ze(xe,je,bt){this.file=xe,this.line=je,this.message=bt}function vt(){var xe=new Error,je=(xe.stack||xe).toString(),bt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(je);if(bt)return bt[1];var vr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(je);return vr?vr[1]:"unknown"}function Qe(){var xe=new Error,je=(xe.stack||xe).toString(),bt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(je);if(bt)return bt[1];var vr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(je);return vr?vr[1]:"unknown"}function yt(xe,je){var bt=xe.split(`
`),vr=1,Mr=0,Cr={unknown:new ke,0:new ke};Cr.unknown.name=Cr[0].name=je||vt(),Cr.unknown.lines.push(new Et(0,""));for(var gr=0;gr<bt.length;++gr){var Wr=bt[gr],sn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(sn)switch(sn[1]){case"line":var en=/(\d+)(\s+\d+)?/.exec(sn[2]);en&&(vr=en[1]|0,en[2]&&(Mr=en[2]|0,Mr in Cr||(Cr[Mr]=new ke)));break;case"define":var $r=/SHADER_NAME(_B64)?\s+(.*)$/.exec(sn[2]);$r&&(Cr[Mr].name=$r[1]?z($r[2]):$r[2]);break}Cr[Mr].lines.push(new Et(vr++,Wr))}return Object.keys(Cr).forEach(function(ln){var An=Cr[ln];An.lines.forEach(function(pn){An.index[pn.number]=pn})}),Cr}function _t(xe){var je=[];return xe.split(`
`).forEach(function(bt){if(bt.length<5)return;var vr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(bt);vr?je.push(new Ze(vr[1]|0,vr[2]|0,vr[3].trim())):bt.length>0&&je.push(new Ze("unknown",0,bt))}),je}function De(xe,je){je.forEach(function(bt){var vr=xe[bt.file];if(vr){var Mr=vr.index[bt.line];if(Mr){Mr.errors.push(bt),vr.hasErrors=!0;return}}xe.unknown.hasErrors=!0,xe.unknown.lines[0].errors.push(bt)})}function Ne(xe,je,bt,vr,Mr){if(!xe.getShaderParameter(je,xe.COMPILE_STATUS)){var Cr=xe.getShaderInfoLog(je),gr=vr===xe.FRAGMENT_SHADER?"fragment":"vertex";ar(bt,"string",gr+" shader source must be a string",Mr);var Wr=yt(bt,Mr),sn=_t(Cr);De(Wr,sn),Object.keys(Wr).forEach(function(en){var $r=Wr[en];if(!$r.hasErrors)return;var ln=[""],An=[""];function pn(Jr,yr){ln.push(Jr),An.push(yr||"")}pn("file number "+en+": "+$r.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),$r.lines.forEach(function(Jr){if(Jr.errors.length>0){pn(dt(Jr.number,4)+"|  ","background-color:yellow; font-weight:bold"),pn(Jr.line+X,"color:red; background-color:yellow; font-weight:bold");var yr=0;Jr.errors.forEach(function(hr){var Zr=hr.message,On=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Zr);if(On){var Lr=On[1];Zr=On[2];switch(Lr){case"assign":Lr="=";break}yr=Math.max(Jr.line.indexOf(Lr,yr),0)}else yr=0;pn(dt("| ",6)),pn(dt("^^^",yr+3)+X,"font-weight:bold"),pn(dt("| ",6)),pn(Zr+X,"font-weight:bold")}),pn(dt("| ",6)+X)}else pn(dt(Jr.number,4)+"|  "),pn(Jr.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(An[0]=ln.join("%c"),console.log.apply(console,An)):console.log(ln.join(""))}),Z.raise("Error compiling "+gr+" shader, "+Wr[0].name)}}function Ue(xe,je,bt,vr,Mr){if(!xe.getProgramParameter(je,xe.LINK_STATUS)){var Cr=xe.getProgramInfoLog(je),gr=yt(bt,Mr),Wr=yt(vr,Mr),sn='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+gr[0].name+'"';typeof document!="undefined"?console.log("%c"+sn+X+"%c"+Cr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(sn+X+Cr),Z.raise(sn)}}function st(xe){xe._commandRef=vt()}function Le(xe,je,bt,vr){st(xe);function Mr(sn){return sn?vr.id(sn):0}xe._fragId=Mr(xe.static.frag),xe._vertId=Mr(xe.static.vert);function Cr(sn,en){Object.keys(en).forEach(function($r){sn[vr.id($r)]=!0})}var gr=xe._uniformSet={};Cr(gr,je.static),Cr(gr,je.dynamic);var Wr=xe._attributeSet={};Cr(Wr,bt.static),Cr(Wr,bt.dynamic),xe._hasCount="count"in xe.static||"count"in xe.dynamic||"elements"in xe.static||"elements"in xe.dynamic}function ut(xe,je){var bt=Qe();o(xe+" in command "+(je||vt())+(bt==="unknown"?"":" called from "+bt))}function Gt(xe,je,bt){xe||ut(je,bt||vt())}function Kt(xe,je,bt,vr){xe in je||ut("unknown parameter ("+xe+")"+D(bt)+". possible values: "+Object.keys(je).join(),vr||vt())}function ar(xe,je,bt,vr){fe(xe,je)||ut("invalid parameter type"+D(bt)+". expected "+je+", got "+typeof xe,vr||vt())}function oe(xe){xe()}function Q(xe,je,bt){xe.texture?We(xe.texture._texture.internalformat,je,"unsupported texture format for attachment"):We(xe.renderbuffer._renderbuffer.format,bt,"unsupported renderbuffer format for attachment")}var H=33071,Ce=9728,Ee=9984,_e=9985,ve=9986,rt=9987,$t=5120,St=5121,ye=5122,be=5123,Be=5124,lt=5125,Pe=5126,ht=32819,w=32820,I=33635,q=34042,ce=36193,Ve={};Ve[$t]=Ve[St]=1,Ve[ye]=Ve[be]=Ve[ce]=Ve[I]=Ve[ht]=Ve[w]=2,Ve[Be]=Ve[lt]=Ve[Pe]=Ve[q]=4;function $e(xe,je){return xe===w||xe===ht||xe===I?2:xe===q?4:Ve[xe]*je}function gt(xe){return!(xe&xe-1)&&!!xe}function nt(xe,je,bt){var vr,Mr=je.width,Cr=je.height,gr=je.channels;Z(Mr>0&&Mr<=bt.maxTextureSize&&Cr>0&&Cr<=bt.maxTextureSize,"invalid texture shape"),(xe.wrapS!==H||xe.wrapT!==H)&&Z(gt(Mr)&&gt(Cr),"incompatible wrap mode for texture, both width and height must be power of 2"),je.mipmask===1?Mr!==1&&Cr!==1&&Z(xe.minFilter!==Ee&&xe.minFilter!==ve&&xe.minFilter!==_e&&xe.minFilter!==rt,"min filter requires mipmap"):(Z(gt(Mr)&&gt(Cr),"texture must be a square power of 2 to support mipmapping"),Z(je.mipmask===(Mr<<1)-1,"missing or incomplete mipmap data")),je.type===Pe&&(bt.extensions.indexOf("oes_texture_float_linear")<0&&Z(xe.minFilter===Ce&&xe.magFilter===Ce,"filter not supported, must enable oes_texture_float_linear"),Z(!xe.genMipmaps,"mipmap generation not supported with float textures"));var Wr=je.images;for(vr=0;vr<16;++vr)if(Wr[vr]){var sn=Mr>>vr,en=Cr>>vr;Z(je.mipmask&1<<vr,"missing mipmap data");var $r=Wr[vr];if(Z($r.width===sn&&$r.height===en,"invalid shape for mip images"),Z($r.format===je.format&&$r.internalformat===je.internalformat&&$r.type===je.type,"incompatible type for mip image"),!$r.compressed)if($r.data){var ln=Math.ceil($e($r.type,gr)*sn/$r.unpackAlignment)*$r.unpackAlignment;Z($r.data.byteLength===ln*en,"invalid data for image, buffer size is inconsistent with image format")}else $r.element||$r.copy}else xe.genMipmaps||Z((je.mipmask&1<<vr)===0,"extra mipmap data");je.compressed&&Z(!xe.genMipmaps,"mipmap generation for compressed images not supported")}function kt(xe,je,bt,vr){var Mr=xe.width,Cr=xe.height,gr=xe.channels;Z(Mr>0&&Mr<=vr.maxTextureSize&&Cr>0&&Cr<=vr.maxTextureSize,"invalid texture shape"),Z(Mr===Cr,"cube map must be square"),Z(je.wrapS===H&&je.wrapT===H,"wrap mode not supported by cube map");for(var Wr=0;Wr<bt.length;++Wr){var sn=bt[Wr];Z(sn.width===Mr&&sn.height===Cr,"inconsistent cube map face shape"),je.genMipmaps&&(Z(!sn.compressed,"can not generate mipmap for compressed textures"),Z(sn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var en=sn.images,$r=0;$r<16;++$r){var ln=en[$r];if(ln){var An=Mr>>$r,pn=Cr>>$r;Z(sn.mipmask&1<<$r,"missing mipmap data"),Z(ln.width===An&&ln.height===pn,"invalid shape for mip images"),Z(ln.format===xe.format&&ln.internalformat===xe.internalformat&&ln.type===xe.type,"incompatible type for mip image"),ln.compressed||(ln.data?Z(ln.data.byteLength===An*pn*Math.max($e(ln.type,gr),ln.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ln.element||ln.copy)}}}}var $=m(Z,{optional:oe,raise:o,commandRaise:ut,command:Gt,parameter:K,commandParameter:Kt,constructor:we,type:Y,commandType:ar,isTypedArray:re,nni:Fe,oneOf:We,shaderError:Ne,linkError:Ue,callSite:Qe,saveCommandRef:st,saveDrawInfo:Le,framebufferFormat:Q,guessCommand:vt,texture2D:nt,textureCube:kt}),Ke=0,ae=0,et=5,zt=6;function sr(xe,je){this.id=Ke++,this.type=xe,this.data=je}function ft(xe){return xe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function pt(xe){if(xe.length===0)return[];var je=xe.charAt(0),bt=xe.charAt(xe.length-1);if(xe.length>1&&je===bt&&(je==='"'||je==="'"))return['"'+ft(xe.substr(1,xe.length-2))+'"'];var vr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xe);if(vr)return pt(xe.substr(0,vr.index)).concat(pt(vr[1])).concat(pt(xe.substr(vr.index+vr[0].length)));var Mr=xe.split(".");if(Mr.length===1)return['"'+ft(xe)+'"'];for(var Cr=[],gr=0;gr<Mr.length;++gr)Cr=Cr.concat(pt(Mr[gr]));return Cr}function At(xe){return"["+pt(xe).join("][")+"]"}function mt(xe,je){return new sr(xe,At(je+""))}function Me(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof sr}function ct(xe,je){if(typeof xe=="function")return new sr(ae,xe);if(typeof xe=="number"||typeof xe=="boolean")return new sr(et,xe);if(Array.isArray(xe))return new sr(zt,xe.map(function(bt,vr){return ct(bt,je+"["+vr+"]")}));if(xe instanceof sr)return xe;$(!1,"invalid option type in uniform "+je)}var qe={DynamicVariable:sr,define:mt,isDynamic:Me,unbox:ct,accessor:At},Vt={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},pr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Gr(){var xe={"":0},je=[""];return{id:function(vr){var Mr=xe[vr];return Mr||(Mr=xe[vr]=je.length,je.push(vr),Mr)},str:function(vr){return je[vr]}}}function ur(xe,je,bt){var vr=document.createElement("canvas");m(vr.style,{border:0,margin:0,padding:0,top:0,left:0}),xe.appendChild(vr),xe===document.body&&(vr.style.position="absolute",m(xe.style,{margin:0,padding:0}));function Mr(){var Wr=window.innerWidth,sn=window.innerHeight;if(xe!==document.body){var en=xe.getBoundingClientRect();Wr=en.right-en.left,sn=en.bottom-en.top}vr.width=bt*Wr,vr.height=bt*sn,m(vr.style,{width:Wr+"px",height:sn+"px"})}var Cr;xe!==document.body&&typeof ResizeObserver=="function"?(Cr=new ResizeObserver(function(){setTimeout(Mr)}),Cr.observe(xe)):window.addEventListener("resize",Mr,!1);function gr(){Cr?Cr.disconnect():window.removeEventListener("resize",Mr),xe.removeChild(vr)}return Mr(),{canvas:vr,onDestroy:gr}}function zn(xe,je){function bt(vr){try{return xe.getContext(vr,je)}catch(Mr){return null}}return bt("webgl")||bt("experimental-webgl")||bt("webgl-experimental")}function xn(xe){return typeof xe.nodeName=="string"&&typeof xe.appendChild=="function"&&typeof xe.getBoundingClientRect=="function"}function na(xe){return typeof xe.drawArrays=="function"||typeof xe.drawElements=="function"}function fa(xe){return typeof xe=="string"?xe.split():($(Array.isArray(xe),"invalid extension array"),xe)}function Hn(xe){return typeof xe=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xe)):xe}function Gn(xe){var je=xe||{},bt,vr,Mr,Cr,gr={},Wr=[],sn=[],en=typeof window=="undefined"?1:window.devicePixelRatio,$r=!1,ln=function(yr){yr&&$.raise(yr)},An=function(){};if(typeof je=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),bt=document.querySelector(je),$(bt,"invalid query string for element")):typeof je=="object"?xn(je)?bt=je:na(je)?(Cr=je,Mr=Cr.canvas):($.constructor(je),"gl"in je?Cr=je.gl:"canvas"in je?Mr=Hn(je.canvas):"container"in je&&(vr=Hn(je.container)),"attributes"in je&&(gr=je.attributes,$.type(gr,"object","invalid context attributes")),"extensions"in je&&(Wr=fa(je.extensions)),"optionalExtensions"in je&&(sn=fa(je.optionalExtensions)),"onDone"in je&&($.type(je.onDone,"function","invalid or missing onDone callback"),ln=je.onDone),"profile"in je&&($r=!!je.profile),"pixelRatio"in je&&(en=+je.pixelRatio,$(en>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),bt&&(bt.nodeName.toLowerCase()==="canvas"?Mr=bt:vr=bt),!Cr){if(!Mr){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pn=ur(vr||document.body,ln,en);if(!pn)return null;Mr=pn.canvas,An=pn.onDestroy}gr.premultipliedAlpha===void 0&&(gr.premultipliedAlpha=!0),Cr=zn(Mr,gr)}return Cr?{gl:Cr,canvas:Mr,container:vr,extensions:Wr,optionalExtensions:sn,pixelRatio:en,profile:$r,onDone:ln,onDestroy:An}:(An(),ln("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function F(xe,je){var bt={};function vr(gr){$.type(gr,"string","extension name must be string");var Wr=gr.toLowerCase(),sn;try{sn=bt[Wr]=xe.getExtension(Wr)}catch(en){}return!!sn}for(var Mr=0;Mr<je.extensions.length;++Mr){var Cr=je.extensions[Mr];if(!vr(Cr))return je.onDestroy(),je.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return je.optionalExtensions.forEach(vr),{extensions:bt,restore:function(){Object.keys(bt).forEach(function(Wr){if(bt[Wr]&&!vr(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function W(xe,je){for(var bt=Array(xe),vr=0;vr<xe;++vr)bt[vr]=je(vr);return bt}var le=5120,pe=5121,at=5122,Tt=5123,jt=5124,Ge=5125,wt=5126;function ir(xe){for(var je=16;je<=1<<28;je*=16)if(xe<=je)return je;return 0}function Ur(xe){var je,bt;return je=(xe>65535)<<4,xe>>>=je,bt=(xe>255)<<3,xe>>>=bt,je|=bt,bt=(xe>15)<<2,xe>>>=bt,je|=bt,bt=(xe>3)<<1,xe>>>=bt,je|=bt,je|xe>>1}function Vr(){var xe=W(8,function(){return[]});function je(Cr){var gr=ir(Cr),Wr=xe[Ur(gr)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(gr)}function bt(Cr){xe[Ur(Cr.byteLength)>>2].push(Cr)}function vr(Cr,gr){var Wr=null;switch(Cr){case le:Wr=new Int8Array(je(gr),0,gr);break;case pe:Wr=new Uint8Array(je(gr),0,gr);break;case at:Wr=new Int16Array(je(2*gr),0,gr);break;case Tt:Wr=new Uint16Array(je(2*gr),0,gr);break;case jt:Wr=new Int32Array(je(4*gr),0,gr);break;case Ge:Wr=new Uint32Array(je(4*gr),0,gr);break;case wt:Wr=new Float32Array(je(4*gr),0,gr);break;default:return null}return Wr.length!==gr?Wr.subarray(0,gr):Wr}function Mr(Cr){bt(Cr.buffer)}return{alloc:je,free:bt,allocType:vr,freeType:Mr}}var or=Vr();or.zero=Vr();var Fr=3408,Sn=3410,fn=3411,Er=3412,Tn=3413,dn=3414,vn=3415,Sr=33901,Kr=33902,wn=3379,Ka=3386,da=34921,Oa=36347,Ia=36348,Xi=35661,ha=35660,gi=34930,Ma=36349,ya=34076,la=34024,Li=7936,po=7937,Yi=7938,Ko=35724,Gu=34047,Ba=36063,Ai=34852,es=3553,ii=34067,Ki=34069,ts=33984,Ja=6408,oo=5126,so=5121,Ys=36160,_o=36053,Zl=36064,Ks=16384,So=function(je,bt){var vr=1;bt.ext_texture_filter_anisotropic&&(vr=je.getParameter(Gu));var Mr=1,Cr=1;bt.webgl_draw_buffers&&(Mr=je.getParameter(Ai),Cr=je.getParameter(Ba));var gr=!!bt.oes_texture_float;if(gr){var Wr=je.createTexture();je.bindTexture(es,Wr),je.texImage2D(es,0,Ja,1,1,0,Ja,oo,null);var sn=je.createFramebuffer();if(je.bindFramebuffer(Ys,sn),je.framebufferTexture2D(Ys,Zl,es,Wr,0),je.bindTexture(es,null),je.checkFramebufferStatus(Ys)!==_o)gr=!1;else{je.viewport(0,0,1,1),je.clearColor(1,0,0,1),je.clear(Ks);var en=or.allocType(oo,4);je.readPixels(0,0,1,1,Ja,oo,en),je.getError()?gr=!1:(je.deleteFramebuffer(sn),je.deleteTexture(Wr),gr=en[0]===1),or.freeType(en)}}var $r=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ln=!0;if(!$r){var An=je.createTexture(),pn=or.allocType(so,36);je.activeTexture(ts),je.bindTexture(ii,An),je.texImage2D(Ki,0,Ja,3,3,0,Ja,so,pn),or.freeType(pn),je.bindTexture(ii,null),je.deleteTexture(An),ln=!je.getError()}return{colorBits:[je.getParameter(Sn),je.getParameter(fn),je.getParameter(Er),je.getParameter(Tn)],depthBits:je.getParameter(dn),stencilBits:je.getParameter(vn),subpixelBits:je.getParameter(Fr),extensions:Object.keys(bt).filter(function(Jr){return!!bt[Jr]}),maxAnisotropic:vr,maxDrawbuffers:Mr,maxColorAttachments:Cr,pointSizeDims:je.getParameter(Sr),lineWidthDims:je.getParameter(Kr),maxViewportDims:je.getParameter(Ka),maxCombinedTextureUnits:je.getParameter(Xi),maxCubeMapSize:je.getParameter(ya),maxRenderbufferSize:je.getParameter(la),maxTextureUnits:je.getParameter(gi),maxTextureSize:je.getParameter(wn),maxAttributes:je.getParameter(da),maxVertexUniforms:je.getParameter(Oa),maxVertexTextureUnits:je.getParameter(ha),maxVaryingVectors:je.getParameter(Ia),maxFragmentUniforms:je.getParameter(Ma),glsl:je.getParameter(Ko),renderer:je.getParameter(po),vendor:je.getParameter(Li),version:je.getParameter(Yi),readFloat:gr,npotTextureCube:ln}};function Ut(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||T(xe.data))}var Ie=function(je){return Object.keys(je).map(function(bt){return je[bt]})},Pt={shape:to,flatten:Ri};function cr(xe,je,bt){for(var vr=0;vr<je;++vr)bt[vr]=xe[vr]}function tn(xe,je,bt,vr){for(var Mr=0,Cr=0;Cr<je;++Cr)for(var gr=xe[Cr],Wr=0;Wr<bt;++Wr)vr[Mr++]=gr[Wr]}function En(xe,je,bt,vr,Mr,Cr){for(var gr=Cr,Wr=0;Wr<je;++Wr)for(var sn=xe[Wr],en=0;en<bt;++en)for(var $r=sn[en],ln=0;ln<vr;++ln)Mr[gr++]=$r[ln]}function Fn(xe,je,bt,vr,Mr){for(var Cr=1,gr=bt+1;gr<je.length;++gr)Cr*=je[gr];var Wr=je[bt];if(je.length-bt===4){var sn=je[bt+1],en=je[bt+2],$r=je[bt+3];for(gr=0;gr<Wr;++gr)En(xe[gr],sn,en,$r,vr,Mr),Mr+=Cr}else for(gr=0;gr<Wr;++gr)Fn(xe[gr],je,bt+1,vr,Mr),Mr+=Cr}function Ri(xe,je,bt,vr){var Mr=1;if(je.length)for(var Cr=0;Cr<je.length;++Cr)Mr*=je[Cr];else Mr=0;var gr=vr||or.allocType(bt,Mr);switch(je.length){case 0:break;case 1:cr(xe,je[0],gr);break;case 2:tn(xe,je[0],je[1],gr);break;case 3:En(xe,je[0],je[1],je[2],gr,0);break;default:Fn(xe,je,0,gr,0)}return gr}function to(xe){for(var je=[],bt=xe;bt.length;bt=bt[0])je.push(bt.length);return je}var mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Do=5120,Hu=5122,Xl=5124,$s=5121,Ic=5123,Ll=5125,fs=5126,ks=5126,uo={int8:Do,int16:Hu,int32:Xl,uint8:$s,uint16:Ic,uint32:Ll,float:fs,float32:ks},hs=35048,Js=35040,cu={dynamic:hs,stream:Js,static:35044},Yl=Pt.flatten,yi=Pt.shape,Ni=35044,vl=35040,js=5121,ds=5126,Ot=[];Ot[5120]=1,Ot[5122]=2,Ot[5124]=4,Ot[5121]=1,Ot[5123]=2,Ot[5125]=4,Ot[5126]=4;function er(xe){return mo[Object.prototype.toString.call(xe)]|0}function Or(xe,je){for(var bt=0;bt<je.length;++bt)xe[bt]=je[bt]}function Bn(xe,je,bt,vr,Mr,Cr,gr){for(var Wr=0,sn=0;sn<bt;++sn)for(var en=0;en<vr;++en)xe[Wr++]=je[Mr*sn+Cr*en+gr]}function Qa(xe,je,bt,vr){var Mr=0,Cr={};function gr(yr){this.id=Mr++,this.buffer=xe.createBuffer(),this.type=yr,this.usage=Ni,this.byteLength=0,this.dimension=1,this.dtype=js,this.persistentData=null,bt.profile&&(this.stats={size:0})}gr.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},gr.prototype.destroy=function(){An(this)};var Wr=[];function sn(yr,hr){var Zr=Wr.pop();return Zr||(Zr=new gr(yr)),Zr.bind(),ln(Zr,hr,vl,0,1,!1),Zr}function en(yr){Wr.push(yr)}function $r(yr,hr,Zr){yr.byteLength=hr.byteLength,xe.bufferData(yr.type,hr,Zr)}function ln(yr,hr,Zr,On,Lr,Qn){var Qr;if(yr.usage=Zr,Array.isArray(hr)){if(yr.dtype=On||ds,hr.length>0){var zr;if(Array.isArray(hr[0])){Qr=yi(hr);for(var Br=1,Yr=1;Yr<Qr.length;++Yr)Br*=Qr[Yr];yr.dimension=Br,zr=Yl(hr,Qr,yr.dtype),$r(yr,zr,Zr),Qn?yr.persistentData=zr:or.freeType(zr)}else if(typeof hr[0]=="number"){yr.dimension=Lr;var Zn=or.allocType(yr.dtype,hr.length);Or(Zn,hr),$r(yr,Zn,Zr),Qn?yr.persistentData=Zn:or.freeType(Zn)}else T(hr[0])?(yr.dimension=hr[0].length,yr.dtype=On||er(hr[0])||ds,zr=Yl(hr,[hr.length,hr[0].length],yr.dtype),$r(yr,zr,Zr),Qn?yr.persistentData=zr:or.freeType(zr)):$.raise("invalid buffer data")}}else if(T(hr))yr.dtype=On||er(hr),yr.dimension=Lr,$r(yr,hr,Zr),Qn&&(yr.persistentData=new Uint8Array(new Uint8Array(hr.buffer)));else if(Ut(hr)){Qr=hr.shape;var ra=hr.stride,an=hr.offset,Hr=0,kr=0,pa=0,ca=0;Qr.length===1?(Hr=Qr[0],kr=1,pa=ra[0],ca=0):Qr.length===2?(Hr=Qr[0],kr=Qr[1],pa=ra[0],ca=ra[1]):$.raise("invalid shape"),yr.dtype=On||er(hr.data)||ds,yr.dimension=kr;var jn=or.allocType(yr.dtype,Hr*kr);Bn(jn,hr.data,Hr,kr,pa,ca,an),$r(yr,jn,Zr),Qn?yr.persistentData=jn:or.freeType(jn)}else hr instanceof ArrayBuffer?(yr.dtype=js,yr.dimension=Lr,$r(yr,hr,Zr),Qn&&(yr.persistentData=new Uint8Array(new Uint8Array(hr)))):$.raise("invalid buffer data")}function An(yr){je.bufferCount--,vr(yr);var hr=yr.buffer;$(hr,"buffer must not be deleted already"),xe.deleteBuffer(hr),yr.buffer=null,delete Cr[yr.id]}function pn(yr,hr,Zr,On){je.bufferCount++;var Lr=new gr(hr);Cr[Lr.id]=Lr;function Qn(Br){var Yr=Ni,Zn=null,ra=0,an=0,Hr=1;return Array.isArray(Br)||T(Br)||Ut(Br)||Br instanceof ArrayBuffer?Zn=Br:typeof Br=="number"?ra=Br|0:Br&&($.type(Br,"object","buffer arguments must be an object, a number or an array"),"data"in Br&&($(Zn===null||Array.isArray(Zn)||T(Zn)||Ut(Zn),"invalid data for buffer"),Zn=Br.data),"usage"in Br&&($.parameter(Br.usage,cu,"invalid buffer usage"),Yr=cu[Br.usage]),"type"in Br&&($.parameter(Br.type,uo,"invalid buffer type"),an=uo[Br.type]),"dimension"in Br&&($.type(Br.dimension,"number","invalid dimension"),Hr=Br.dimension|0),"length"in Br&&($.nni(ra,"buffer length must be a nonnegative integer"),ra=Br.length|0)),Lr.bind(),Zn?ln(Lr,Zn,Yr,an,Hr,On):(ra&&xe.bufferData(Lr.type,ra,Yr),Lr.dtype=an||js,Lr.usage=Yr,Lr.dimension=Hr,Lr.byteLength=ra),bt.profile&&(Lr.stats.size=Lr.byteLength*Ot[Lr.dtype]),Qn}function Qr(Br,Yr){$(Yr+Br.byteLength<=Lr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Br.byteLength+" starting from offset "+Yr+" to a buffer of size "+Lr.byteLength),xe.bufferSubData(Lr.type,Yr,Br)}function zr(Br,Yr){var Zn=(Yr||0)|0,ra;if(Lr.bind(),T(Br)||Br instanceof ArrayBuffer)Qr(Br,Zn);else if(Array.isArray(Br)){if(Br.length>0)if(typeof Br[0]=="number"){var an=or.allocType(Lr.dtype,Br.length);Or(an,Br),Qr(an,Zn),or.freeType(an)}else if(Array.isArray(Br[0])||T(Br[0])){ra=yi(Br);var Hr=Yl(Br,ra,Lr.dtype);Qr(Hr,Zn),or.freeType(Hr)}else $.raise("invalid buffer data")}else if(Ut(Br)){ra=Br.shape;var kr=Br.stride,pa=0,ca=0,jn=0,Fa=0;ra.length===1?(pa=ra[0],ca=1,jn=kr[0],Fa=0):ra.length===2?(pa=ra[0],ca=ra[1],jn=kr[0],Fa=kr[1]):$.raise("invalid shape");var Sa=Array.isArray(Br.data)?Lr.dtype:er(Br.data),Ua=or.allocType(Sa,pa*ca);Bn(Ua,Br.data,pa,ca,jn,Fa,Br.offset),Qr(Ua,Zn),or.freeType(Ua)}else $.raise("invalid data for buffer subdata");return Qn}return Zr||Qn(yr),Qn._reglType="buffer",Qn._buffer=Lr,Qn.subdata=zr,bt.profile&&(Qn.stats=Lr.stats),Qn.destroy=function(){An(Lr)},Qn}function Jr(){Ie(Cr).forEach(function(yr){yr.buffer=xe.createBuffer(),xe.bindBuffer(yr.type,yr.buffer),xe.bufferData(yr.type,yr.persistentData||yr.byteLength,yr.usage)})}return bt.profile&&(je.getTotalBufferSize=function(){var yr=0;return Object.keys(Cr).forEach(function(hr){yr+=Cr[hr].stats.size}),yr}),{create:pn,createStream:sn,destroyStream:en,clear:function(){Ie(Cr).forEach(An),Wr.forEach(An)},getBuffer:function(hr){return hr&&hr._buffer instanceof gr?hr._buffer:null},restore:Jr,_initBuffer:ln}}var Ii=0,Gi=0,qa=1,bi=1,Ao=4,zs=4,di={points:Ii,point:Gi,lines:qa,line:bi,triangles:Ao,triangle:zs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Kl=0,fu=1,Os=4,gl=5120,hu=5121,Wu=5122,Qs=5123,nl=5124,du=5125,vc=34963,Pf=35040,pi=35044;function Dc(xe,je,bt,vr){var Mr={},Cr=0,gr={uint8:hu,uint16:Qs};je.oes_element_index_uint&&(gr.uint32=du);function Wr(Jr){this.id=Cr++,Mr[this.id]=this,this.buffer=Jr,this.primType=Os,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var sn=[];function en(Jr){var yr=sn.pop();return yr||(yr=new Wr(bt.create(null,vc,!0,!1)._buffer)),ln(yr,Jr,Pf,-1,-1,0,0),yr}function $r(Jr){sn.push(Jr)}function ln(Jr,yr,hr,Zr,On,Lr,Qn){Jr.buffer.bind();var Qr;if(yr){var zr=Qn;!Qn&&(!T(yr)||Ut(yr)&&!T(yr.data))&&(zr=je.oes_element_index_uint?du:Qs),bt._initBuffer(Jr.buffer,yr,hr,zr,3)}else xe.bufferData(vc,Lr,hr),Jr.buffer.dtype=Qr||hu,Jr.buffer.usage=hr,Jr.buffer.dimension=3,Jr.buffer.byteLength=Lr;if(Qr=Qn,!Qn){switch(Jr.buffer.dtype){case hu:case gl:Qr=hu;break;case Qs:case Wu:Qr=Qs;break;case du:case nl:Qr=du;break;default:$.raise("unsupported type for element array")}Jr.buffer.dtype=Qr}Jr.type=Qr,$(Qr!==du||!!je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Br=On;Br<0&&(Br=Jr.buffer.byteLength,Qr===Qs?Br>>=1:Qr===du&&(Br>>=2)),Jr.vertCount=Br;var Yr=Zr;if(Zr<0){Yr=Os;var Zn=Jr.buffer.dimension;Zn===1&&(Yr=Kl),Zn===2&&(Yr=fu),Zn===3&&(Yr=Os)}Jr.primType=Yr}function An(Jr){vr.elementsCount--,$(Jr.buffer!==null,"must not double destroy elements"),delete Mr[Jr.id],Jr.buffer.destroy(),Jr.buffer=null}function pn(Jr,yr){var hr=bt.create(null,vc,!0),Zr=new Wr(hr._buffer);vr.elementsCount++;function On(Lr){if(!Lr)hr(),Zr.primType=Os,Zr.vertCount=0,Zr.type=hu;else if(typeof Lr=="number")hr(Lr),Zr.primType=Os,Zr.vertCount=Lr|0,Zr.type=hu;else{var Qn=null,Qr=pi,zr=-1,Br=-1,Yr=0,Zn=0;Array.isArray(Lr)||T(Lr)||Ut(Lr)?Qn=Lr:($.type(Lr,"object","invalid arguments for elements"),"data"in Lr&&(Qn=Lr.data,$(Array.isArray(Qn)||T(Qn)||Ut(Qn),"invalid data for element buffer")),"usage"in Lr&&($.parameter(Lr.usage,cu,"invalid element buffer usage"),Qr=cu[Lr.usage]),"primitive"in Lr&&($.parameter(Lr.primitive,di,"invalid element buffer primitive"),zr=di[Lr.primitive]),"count"in Lr&&($(typeof Lr.count=="number"&&Lr.count>=0,"invalid vertex count for elements"),Br=Lr.count|0),"type"in Lr&&($.parameter(Lr.type,gr,"invalid buffer type"),Zn=gr[Lr.type]),"length"in Lr?Yr=Lr.length|0:(Yr=Br,Zn===Qs||Zn===Wu?Yr*=2:(Zn===du||Zn===nl)&&(Yr*=4))),ln(Zr,Qn,Qr,zr,Br,Yr,Zn)}return On}return On(Jr),On._reglType="elements",On._elements=Zr,On.subdata=function(Lr,Qn){return hr.subdata(Lr,Qn),On},On.destroy=function(){An(Zr)},On}return{create:pn,createStream:en,destroyStream:$r,getElements:function(yr){return typeof yr=="function"&&yr._elements instanceof Wr?yr._elements:null},clear:function(){Ie(Mr).forEach(An)}}}var gc=new Float32Array(1),rf=new Uint32Array(gc.buffer),nf=5123;function af(xe){for(var je=or.allocType(nf,xe.length),bt=0;bt<xe.length;++bt)if(isNaN(xe[bt]))je[bt]=65535;else if(xe[bt]===Infinity)je[bt]=31744;else if(xe[bt]===-Infinity)je[bt]=64512;else{gc[0]=xe[bt];var vr=rf[0],Mr=vr>>>31<<15,Cr=(vr<<1>>>24)-127,gr=vr>>13&(1<<10)-1;if(Cr<-24)je[bt]=Mr;else if(Cr<-14){var Wr=-14-Cr;je[bt]=Mr+(gr+(1<<10)>>Wr)}else Cr>15?je[bt]=Mr+31744:je[bt]=Mr+(Cr+15<<10)+gr}return je}function $i(xe){return Array.isArray(xe)||T(xe)}var Cu=function(je){return!(je&je-1)&&!!je},qs=34467,ps=3553,Nc=34067,yc=34069,yl=6408,al=6406,bc=6407,eu=6409,Zu=6410,kc=32854,$l=32855,Ci=36194,jc=32819,Lf=32820,xc=33635,zc=34042,Jl=6402,Xu=34041,wu=35904,Rl=35906,No=36193,Ql=33776,Il=33777,bl=33778,Fc=33779,Dl=35986,tu=35987,yf=34798,bf=35840,of=35841,xl=35842,ki=35843,il=36196,Nl=5121,Ec=5123,Uc=5125,kl=5126,Rf=10242,If=10243,sf=10497,El=33071,ql=33648,Ou=10240,Fs=10241,ol=9728,Bc=9729,Yu=9984,ji=9985,pu=9986,sl=9987,ul=33170,Da=4352,mi=4353,Ms=4354,Ti=34046,Wa=3317,ec=37440,xf=37441,rs=37443,ll=37444,mu=33984,Ku=[Yu,pu,ji,sl],ro=[0,eu,Zu,bc,yl],ns={};ns[eu]=ns[al]=ns[Jl]=1,ns[Xu]=ns[Zu]=2,ns[bc]=ns[wu]=3,ns[yl]=ns[Rl]=4;function jl(xe){return"[object "+xe+"]"}var lo=jl("HTMLCanvasElement"),Mn=jl("OffscreenCanvas"),Us=jl("CanvasRenderingContext2D"),Tc=jl("ImageBitmap"),Tl=jl("HTMLImageElement"),Mu=jl("HTMLVideoElement"),Bs=Object.keys(mo).concat([lo,Mn,Us,Tc,Tl,Mu]),ei=[];ei[Nl]=1,ei[kl]=4,ei[No]=2,ei[Ec]=2,ei[Uc]=4;var qr=[];qr[kc]=2,qr[$l]=2,qr[Ci]=2,qr[Xu]=4,qr[Ql]=.5,qr[Il]=.5,qr[bl]=1,qr[Fc]=1,qr[Dl]=.5,qr[tu]=1,qr[yf]=1,qr[bf]=.5,qr[of]=.25,qr[xl]=.5,qr[ki]=.25,qr[il]=.5;function Vc(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function _c(xe){if(!Array.isArray(xe))return!1;var je=xe.length;return!(je===0||!$i(xe[0]))}function cl(xe){return Object.prototype.toString.call(xe)}function vu(xe){return cl(xe)===lo}function Ps(xe){return cl(xe)===Mn}function Ls(xe){return cl(xe)===Us}function $o(xe){return cl(xe)===Tc}function ko(xe){return cl(xe)===Tl}function fl(xe){return cl(xe)===Mu}function _l(xe){if(!xe)return!1;var je=cl(xe);return Bs.indexOf(je)>=0?!0:Vc(xe)||_c(xe)||Ut(xe)}function zl(xe){return mo[Object.prototype.toString.call(xe)]|0}function uf(xe,je){var bt=je.length;switch(xe.type){case Nl:case Ec:case Uc:case kl:var vr=or.allocType(xe.type,bt);vr.set(je),xe.data=vr;break;case No:xe.data=af(je);break;default:$.raise("unsupported texture type, must specify a typed array")}}function Fl(xe,je){return or.allocType(xe.type===No?kl:xe.type,je)}function Rs(xe,je){xe.type===No?(xe.data=af(je),or.freeType(je)):xe.data=je}function as(xe,je,bt,vr,Mr,Cr){for(var gr=xe.width,Wr=xe.height,sn=xe.channels,en=gr*Wr*sn,$r=Fl(xe,en),ln=0,An=0;An<Wr;++An)for(var pn=0;pn<gr;++pn)for(var Jr=0;Jr<sn;++Jr)$r[ln++]=je[bt*pn+vr*An+Mr*Jr+Cr];Rs(xe,$r)}function Pa(xe,je,bt,vr,Mr,Cr){var gr;if(typeof qr[xe]!="undefined"?gr=qr[xe]:gr=ns[xe]*ei[je],Cr&&(gr*=6),Mr){for(var Wr=0,sn=bt;sn>=1;)Wr+=gr*sn*sn,sn/=2;return Wr}else return gr*bt*vr}function $u(xe,je,bt,vr,Mr,Cr,gr){var Wr={"don't care":Da,"dont care":Da,nice:Ms,fast:mi},sn={repeat:sf,clamp:El,mirror:ql},en={nearest:ol,linear:Bc},$r=m({mipmap:sl,"nearest mipmap nearest":Yu,"linear mipmap nearest":ji,"nearest mipmap linear":pu,"linear mipmap linear":sl},en),ln={none:0,browser:ll},An={uint8:Nl,rgba4:jc,rgb565:xc,"rgb5 a1":Lf},pn={alpha:al,luminance:eu,"luminance alpha":Zu,rgb:bc,rgba:yl,rgba4:kc,"rgb5 a1":$l,rgb565:Ci},Jr={};je.ext_srgb&&(pn.srgb=wu,pn.srgba=Rl),je.oes_texture_float&&(An.float32=An.float=kl),je.oes_texture_half_float&&(An.float16=An["half float"]=No),je.webgl_depth_texture&&(m(pn,{depth:Jl,"depth stencil":Xu}),m(An,{uint16:Ec,uint32:Uc,"depth stencil":zc})),je.webgl_compressed_texture_s3tc&&m(Jr,{"rgb s3tc dxt1":Ql,"rgba s3tc dxt1":Il,"rgba s3tc dxt3":bl,"rgba s3tc dxt5":Fc}),je.webgl_compressed_texture_atc&&m(Jr,{"rgb atc":Dl,"rgba atc explicit alpha":tu,"rgba atc interpolated alpha":yf}),je.webgl_compressed_texture_pvrtc&&m(Jr,{"rgb pvrtc 4bppv1":bf,"rgb pvrtc 2bppv1":of,"rgba pvrtc 4bppv1":xl,"rgba pvrtc 2bppv1":ki}),je.webgl_compressed_texture_etc1&&(Jr["rgb etc1"]=il);var yr=Array.prototype.slice.call(xe.getParameter(qs));Object.keys(Jr).forEach(function(Mt){var xr=Jr[Mt];yr.indexOf(xr)>=0&&(pn[Mt]=xr)});var hr=Object.keys(pn);bt.textureFormats=hr;var Zr=[];Object.keys(pn).forEach(function(Mt){var xr=pn[Mt];Zr[xr]=Mt});var On=[];Object.keys(An).forEach(function(Mt){var xr=An[Mt];On[xr]=Mt});var Lr=[];Object.keys(en).forEach(function(Mt){var xr=en[Mt];Lr[xr]=Mt});var Qn=[];Object.keys($r).forEach(function(Mt){var xr=$r[Mt];Qn[xr]=Mt});var Qr=[];Object.keys(sn).forEach(function(Mt){var xr=sn[Mt];Qr[xr]=Mt});var zr=hr.reduce(function(Mt,xr){var mr=pn[xr];return mr===eu||mr===al||mr===eu||mr===Zu||mr===Jl||mr===Xu||je.ext_srgb&&(mr===wu||mr===Rl)?Mt[mr]=mr:mr===$l||xr.indexOf("rgba")>=0?Mt[mr]=yl:Mt[mr]=bc,Mt},{});function Br(){this.internalformat=yl,this.format=yl,this.type=Nl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ll,this.width=0,this.height=0,this.channels=0}function Yr(Mt,xr){Mt.internalformat=xr.internalformat,Mt.format=xr.format,Mt.type=xr.type,Mt.compressed=xr.compressed,Mt.premultiplyAlpha=xr.premultiplyAlpha,Mt.flipY=xr.flipY,Mt.unpackAlignment=xr.unpackAlignment,Mt.colorSpace=xr.colorSpace,Mt.width=xr.width,Mt.height=xr.height,Mt.channels=xr.channels}function Zn(Mt,xr){if(typeof xr!="object"||!xr)return;if("premultiplyAlpha"in xr&&($.type(xr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Mt.premultiplyAlpha=xr.premultiplyAlpha),"flipY"in xr&&($.type(xr.flipY,"boolean","invalid texture flip"),Mt.flipY=xr.flipY),"alignment"in xr&&($.oneOf(xr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Mt.unpackAlignment=xr.alignment),"colorSpace"in xr&&($.parameter(xr.colorSpace,ln,"invalid colorSpace"),Mt.colorSpace=ln[xr.colorSpace]),"type"in xr){var mr=xr.type;$(je.oes_texture_float||!(mr==="float"||mr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(je.oes_texture_half_float||!(mr==="half float"||mr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(je.webgl_depth_texture||!(mr==="uint16"||mr==="uint32"||mr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(mr,An,"invalid texture type"),Mt.type=An[mr]}var Rn=Mt.width,Na=Mt.height,v=Mt.channels,h=!1;"shape"in xr?($(Array.isArray(xr.shape)&&xr.shape.length>=2,"shape must be an array"),Rn=xr.shape[0],Na=xr.shape[1],xr.shape.length===3&&(v=xr.shape[2],$(v>0&&v<=4,"invalid number of channels"),h=!0),$(Rn>=0&&Rn<=bt.maxTextureSize,"invalid width"),$(Na>=0&&Na<=bt.maxTextureSize,"invalid height")):("radius"in xr&&(Rn=Na=xr.radius,$(Rn>=0&&Rn<=bt.maxTextureSize,"invalid radius")),"width"in xr&&(Rn=xr.width,$(Rn>=0&&Rn<=bt.maxTextureSize,"invalid width")),"height"in xr&&(Na=xr.height,$(Na>=0&&Na<=bt.maxTextureSize,"invalid height")),"channels"in xr&&(v=xr.channels,$(v>0&&v<=4,"invalid number of channels"),h=!0)),Mt.width=Rn|0,Mt.height=Na|0,Mt.channels=v|0;var c=!1;if("format"in xr){var p=xr.format;$(je.webgl_depth_texture||!(p==="depth"||p==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(p,pn,"invalid texture format");var y=Mt.internalformat=pn[p];Mt.format=zr[y],p in An&&("type"in xr||(Mt.type=An[p])),p in Jr&&(Mt.compressed=!0),c=!0}!h&&c?Mt.channels=ns[Mt.format]:h&&!c?Mt.channels!==ro[Mt.format]&&(Mt.format=Mt.internalformat=ro[Mt.channels]):c&&h&&$(Mt.channels===ns[Mt.format],"number of channels inconsistent with specified format")}function ra(Mt){xe.pixelStorei(ec,Mt.flipY),xe.pixelStorei(xf,Mt.premultiplyAlpha),xe.pixelStorei(rs,Mt.colorSpace),xe.pixelStorei(Wa,Mt.unpackAlignment)}function an(){Br.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Hr(Mt,xr){var mr=null;if(_l(xr)?mr=xr:xr&&($.type(xr,"object","invalid pixel data type"),Zn(Mt,xr),"x"in xr&&(Mt.xOffset=xr.x|0),"y"in xr&&(Mt.yOffset=xr.y|0),_l(xr.data)&&(mr=xr.data)),$(!Mt.compressed||mr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),xr.copy){$(!mr,"can not specify copy and data field for the same texture");var Rn=Mr.viewportWidth,Na=Mr.viewportHeight;Mt.width=Mt.width||Rn-Mt.xOffset,Mt.height=Mt.height||Na-Mt.yOffset,Mt.needsCopy=!0,$(Mt.xOffset>=0&&Mt.xOffset<Rn&&Mt.yOffset>=0&&Mt.yOffset<Na&&Mt.width>0&&Mt.width<=Rn&&Mt.height>0&&Mt.height<=Na,"copy texture read out of bounds")}else if(!mr)Mt.width=Mt.width||1,Mt.height=Mt.height||1,Mt.channels=Mt.channels||4;else if(T(mr))Mt.channels=Mt.channels||4,Mt.data=mr,!("type"in xr)&&Mt.type===Nl&&(Mt.type=zl(mr));else if(Vc(mr))Mt.channels=Mt.channels||4,uf(Mt,mr),Mt.alignment=1,Mt.needsFree=!0;else if(Ut(mr)){var v=mr.data;!Array.isArray(v)&&Mt.type===Nl&&(Mt.type=zl(v));var h=mr.shape,c=mr.stride,p,y,P,N,ee,B;h.length===3?(P=h[2],B=c[2]):($(h.length===2,"invalid ndarray pixel data, must be 2 or 3D"),P=1,B=1),p=h[0],y=h[1],N=c[0],ee=c[1],Mt.alignment=1,Mt.width=p,Mt.height=y,Mt.channels=P,Mt.format=Mt.internalformat=ro[P],Mt.needsFree=!0,as(Mt,v,N,ee,B,mr.offset)}else if(vu(mr)||Ps(mr)||Ls(mr))vu(mr)||Ps(mr)?Mt.element=mr:Mt.element=mr.canvas,Mt.width=Mt.element.width,Mt.height=Mt.element.height,Mt.channels=4;else if($o(mr))Mt.element=mr,Mt.width=mr.width,Mt.height=mr.height,Mt.channels=4;else if(ko(mr))Mt.element=mr,Mt.width=mr.naturalWidth,Mt.height=mr.naturalHeight,Mt.channels=4;else if(fl(mr))Mt.element=mr,Mt.width=mr.videoWidth,Mt.height=mr.videoHeight,Mt.channels=4;else if(_c(mr)){var J=Mt.width||mr[0].length,he=Mt.height||mr.length,Ye=Mt.channels;$i(mr[0][0])?Ye=Ye||mr[0][0].length:Ye=Ye||1;for(var He=Pt.shape(mr),It=1,Ft=0;Ft<He.length;++Ft)It*=He[Ft];var Yt=Fl(Mt,It);Pt.flatten(mr,He,"",Yt),Rs(Mt,Yt),Mt.alignment=1,Mt.width=J,Mt.height=he,Mt.channels=Ye,Mt.format=Mt.internalformat=ro[Ye],Mt.needsFree=!0}Mt.type===kl?$(bt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Mt.type===No&&$(bt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function kr(Mt,xr,mr){var Rn=Mt.element,Na=Mt.data,v=Mt.internalformat,h=Mt.format,c=Mt.type,p=Mt.width,y=Mt.height;ra(Mt),Rn?xe.texImage2D(xr,mr,h,h,c,Rn):Mt.compressed?xe.compressedTexImage2D(xr,mr,v,p,y,0,Na):Mt.needsCopy?(vr(),xe.copyTexImage2D(xr,mr,h,Mt.xOffset,Mt.yOffset,p,y,0)):xe.texImage2D(xr,mr,h,p,y,0,h,c,Na||null)}function pa(Mt,xr,mr,Rn,Na){var v=Mt.element,h=Mt.data,c=Mt.internalformat,p=Mt.format,y=Mt.type,P=Mt.width,N=Mt.height;ra(Mt),v?xe.texSubImage2D(xr,Na,mr,Rn,p,y,v):Mt.compressed?xe.compressedTexSubImage2D(xr,Na,mr,Rn,c,P,N,h):Mt.needsCopy?(vr(),xe.copyTexSubImage2D(xr,Na,mr,Rn,Mt.xOffset,Mt.yOffset,P,N)):xe.texSubImage2D(xr,Na,mr,Rn,P,N,p,y,h)}var ca=[];function jn(){return ca.pop()||new an}function Fa(Mt){Mt.needsFree&&or.freeType(Mt.data),an.call(Mt),ca.push(Mt)}function Sa(){Br.call(this),this.genMipmaps=!1,this.mipmapHint=Da,this.mipmask=0,this.images=Array(16)}function Ua(Mt,xr,mr){var Rn=Mt.images[0]=jn();Mt.mipmask=1,Rn.width=Mt.width=xr,Rn.height=Mt.height=mr,Rn.channels=Mt.channels=4}function fi(Mt,xr){var mr=null;if(_l(xr))mr=Mt.images[0]=jn(),Yr(mr,Mt),Hr(mr,xr),Mt.mipmask=1;else if(Zn(Mt,xr),Array.isArray(xr.mipmap))for(var Rn=xr.mipmap,Na=0;Na<Rn.length;++Na)mr=Mt.images[Na]=jn(),Yr(mr,Mt),mr.width>>=Na,mr.height>>=Na,Hr(mr,Rn[Na]),Mt.mipmask|=1<<Na;else mr=Mt.images[0]=jn(),Yr(mr,Mt),Hr(mr,xr),Mt.mipmask=1;Yr(Mt,Mt.images[0]),Mt.compressed&&(Mt.internalformat===Ql||Mt.internalformat===Il||Mt.internalformat===bl||Mt.internalformat===Fc)&&$(Mt.width%4===0&&Mt.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Bo(Mt,xr){for(var mr=Mt.images,Rn=0;Rn<mr.length;++Rn){if(!mr[Rn])return;kr(mr[Rn],xr,Rn)}}var ys=[];function Va(){var Mt=ys.pop()||new Sa;Br.call(Mt),Mt.mipmask=0;for(var xr=0;xr<16;++xr)Mt.images[xr]=null;return Mt}function xo(Mt){for(var xr=Mt.images,mr=0;mr<xr.length;++mr)xr[mr]&&Fa(xr[mr]),xr[mr]=null;ys.push(Mt)}function Mi(){this.minFilter=ol,this.magFilter=ol,this.wrapS=El,this.wrapT=El,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Da}function bs(Mt,xr){if("min"in xr){var mr=xr.min;$.parameter(mr,$r),Mt.minFilter=$r[mr],Ku.indexOf(Mt.minFilter)>=0&&!("faces"in xr)&&(Mt.genMipmaps=!0)}if("mag"in xr){var Rn=xr.mag;$.parameter(Rn,en),Mt.magFilter=en[Rn]}var Na=Mt.wrapS,v=Mt.wrapT;if("wrap"in xr){var h=xr.wrap;typeof h=="string"?($.parameter(h,sn),Na=v=sn[h]):Array.isArray(h)&&($.parameter(h[0],sn),$.parameter(h[1],sn),Na=sn[h[0]],v=sn[h[1]])}else{if("wrapS"in xr){var c=xr.wrapS;$.parameter(c,sn),Na=sn[c]}if("wrapT"in xr){var p=xr.wrapT;$.parameter(p,sn),v=sn[p]}}if(Mt.wrapS=Na,Mt.wrapT=v,"anisotropic"in xr){var y=xr.anisotropic;$(typeof y=="number"&&y>=1&&y<=bt.maxAnisotropic,"aniso samples must be between 1 and "),Mt.anisotropic=xr.anisotropic}if("mipmap"in xr){var P=!1;switch(typeof xr.mipmap){case"string":$.parameter(xr.mipmap,Wr,"invalid mipmap hint"),Mt.mipmapHint=Wr[xr.mipmap],Mt.genMipmaps=!0,P=!0;break;case"boolean":P=Mt.genMipmaps=xr.mipmap;break;case"object":$(Array.isArray(xr.mipmap),"invalid mipmap type"),Mt.genMipmaps=!1,P=!0;break;default:$.raise("invalid mipmap type")}P&&!("min"in xr)&&(Mt.minFilter=Yu)}}function is(Mt,xr){xe.texParameteri(xr,Fs,Mt.minFilter),xe.texParameteri(xr,Ou,Mt.magFilter),xe.texParameteri(xr,Rf,Mt.wrapS),xe.texParameteri(xr,If,Mt.wrapT),je.ext_texture_filter_anisotropic&&xe.texParameteri(xr,Ti,Mt.anisotropic),Mt.genMipmaps&&(xe.hint(ul,Mt.mipmapHint),xe.generateMipmap(xr))}var os=0,ss={},Ws=bt.maxTextureUnits,Vo=Array(Ws).map(function(){return null});function ea(Mt){Br.call(this),this.mipmask=0,this.internalformat=yl,this.id=os++,this.refCount=1,this.target=Mt,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Mi,gr.profile&&(this.stats={size:0})}function Tu(Mt){xe.activeTexture(mu),xe.bindTexture(Mt.target,Mt.texture)}function xi(){var Mt=Vo[0];Mt?xe.bindTexture(Mt.target,Mt.texture):xe.bindTexture(ps,null)}function Cn(Mt){var xr=Mt.texture;$(xr,"must not double destroy texture");var mr=Mt.unit,Rn=Mt.target;mr>=0&&(xe.activeTexture(mu+mr),xe.bindTexture(Rn,null),Vo[mr]=null),xe.deleteTexture(xr),Mt.texture=null,Mt.params=null,Mt.pixels=null,Mt.refCount=0,delete ss[Mt.id],Cr.textureCount--}m(ea.prototype,{bind:function(){var xr=this;xr.bindCount+=1;var mr=xr.unit;if(mr<0){for(var Rn=0;Rn<Ws;++Rn){var Na=Vo[Rn];if(Na){if(Na.bindCount>0)continue;Na.unit=-1}Vo[Rn]=xr,mr=Rn;break}mr>=Ws&&$.raise("insufficient number of texture units"),gr.profile&&Cr.maxTextureUnits<mr+1&&(Cr.maxTextureUnits=mr+1),xr.unit=mr,xe.activeTexture(mu+mr),xe.bindTexture(xr.target,xr.texture)}return mr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Cn(this)}});function ga(Mt,xr){var mr=new ea(ps);ss[mr.id]=mr,Cr.textureCount++;function Rn(h,c){var p=mr.texInfo;Mi.call(p);var y=Va();return typeof h=="number"?typeof c=="number"?Ua(y,h|0,c|0):Ua(y,h|0,h|0):h?($.type(h,"object","invalid arguments to regl.texture"),bs(p,h),fi(y,h)):Ua(y,1,1),p.genMipmaps&&(y.mipmask=(y.width<<1)-1),mr.mipmask=y.mipmask,Yr(mr,y),$.texture2D(p,y,bt),mr.internalformat=y.internalformat,Rn.width=y.width,Rn.height=y.height,Tu(mr),Bo(y,ps),is(p,ps),xi(),xo(y),gr.profile&&(mr.stats.size=Pa(mr.internalformat,mr.type,y.width,y.height,p.genMipmaps,!1)),Rn.format=Zr[mr.internalformat],Rn.type=On[mr.type],Rn.mag=Lr[p.magFilter],Rn.min=Qn[p.minFilter],Rn.wrapS=Qr[p.wrapS],Rn.wrapT=Qr[p.wrapT],Rn}function Na(h,c,p,y){$(!!h,"must specify image data");var P=c|0,N=p|0,ee=y|0,B=jn();return Yr(B,mr),B.width=0,B.height=0,Hr(B,h),B.width=B.width||(mr.width>>ee)-P,B.height=B.height||(mr.height>>ee)-N,$(mr.type===B.type&&mr.format===B.format&&mr.internalformat===B.internalformat,"incompatible format for texture.subimage"),$(P>=0&&N>=0&&P+B.width<=mr.width&&N+B.height<=mr.height,"texture.subimage write out of bounds"),$(mr.mipmask&1<<ee,"missing mipmap data"),$(B.data||B.element||B.needsCopy,"missing image data"),Tu(mr),pa(B,ps,P,N,ee),xi(),Fa(B),Rn}function v(h,c){var p=h|0,y=c|0||p;if(p===mr.width&&y===mr.height)return Rn;Rn.width=mr.width=p,Rn.height=mr.height=y,Tu(mr);for(var P=0;mr.mipmask>>P;++P){var N=p>>P,ee=y>>P;if(!N||!ee)break;xe.texImage2D(ps,P,mr.format,N,ee,0,mr.format,mr.type,null)}return xi(),gr.profile&&(mr.stats.size=Pa(mr.internalformat,mr.type,p,y,!1,!1)),Rn}return Rn(Mt,xr),Rn.subimage=Na,Rn.resize=v,Rn._reglType="texture2d",Rn._texture=mr,gr.profile&&(Rn.stats=mr.stats),Rn.destroy=function(){mr.decRef()},Rn}function Ga(Mt,xr,mr,Rn,Na,v){var h=new ea(Nc);ss[h.id]=h,Cr.cubeCount++;var c=new Array(6);function p(N,ee,B,J,he,Ye){var He,It=h.texInfo;for(Mi.call(It),He=0;He<6;++He)c[He]=Va();if(typeof N=="number"||!N){var Ft=N|0||1;for(He=0;He<6;++He)Ua(c[He],Ft,Ft)}else if(typeof N=="object")if(ee)fi(c[0],N),fi(c[1],ee),fi(c[2],B),fi(c[3],J),fi(c[4],he),fi(c[5],Ye);else if(bs(It,N),Zn(h,N),"faces"in N){var Yt=N.faces;for($(Array.isArray(Yt)&&Yt.length===6,"cube faces must be a length 6 array"),He=0;He<6;++He)$(typeof Yt[He]=="object"&&!!Yt[He],"invalid input for cube map face"),Yr(c[He],h),fi(c[He],Yt[He])}else for(He=0;He<6;++He)fi(c[He],N);else $.raise("invalid arguments to cube map");for(Yr(h,c[0]),bt.npotTextureCube||$(Cu(h.width)&&Cu(h.height),"your browser does not support non power or two texture dimensions"),It.genMipmaps?h.mipmask=(c[0].width<<1)-1:h.mipmask=c[0].mipmask,$.textureCube(h,It,c,bt),h.internalformat=c[0].internalformat,p.width=c[0].width,p.height=c[0].height,Tu(h),He=0;He<6;++He)Bo(c[He],yc+He);for(is(It,Nc),xi(),gr.profile&&(h.stats.size=Pa(h.internalformat,h.type,p.width,p.height,It.genMipmaps,!0)),p.format=Zr[h.internalformat],p.type=On[h.type],p.mag=Lr[It.magFilter],p.min=Qn[It.minFilter],p.wrapS=Qr[It.wrapS],p.wrapT=Qr[It.wrapT],He=0;He<6;++He)xo(c[He]);return p}function y(N,ee,B,J,he){$(!!ee,"must specify image data"),$(typeof N=="number"&&N===(N|0)&&N>=0&&N<6,"invalid face");var Ye=B|0,He=J|0,It=he|0,Ft=jn();return Yr(Ft,h),Ft.width=0,Ft.height=0,Hr(Ft,ee),Ft.width=Ft.width||(h.width>>It)-Ye,Ft.height=Ft.height||(h.height>>It)-He,$(h.type===Ft.type&&h.format===Ft.format&&h.internalformat===Ft.internalformat,"incompatible format for texture.subimage"),$(Ye>=0&&He>=0&&Ye+Ft.width<=h.width&&He+Ft.height<=h.height,"texture.subimage write out of bounds"),$(h.mipmask&1<<It,"missing mipmap data"),$(Ft.data||Ft.element||Ft.needsCopy,"missing image data"),Tu(h),pa(Ft,yc+N,Ye,He,It),xi(),Fa(Ft),p}function P(N){var ee=N|0;if(ee===h.width)return;p.width=h.width=ee,p.height=h.height=ee,Tu(h);for(var B=0;B<6;++B)for(var J=0;h.mipmask>>J;++J)xe.texImage2D(yc+B,J,h.format,ee>>J,ee>>J,0,h.format,h.type,null);return xi(),gr.profile&&(h.stats.size=Pa(h.internalformat,h.type,p.width,p.height,!1,!0)),p}return p(Mt,xr,mr,Rn,Na,v),p.subimage=y,p.resize=P,p._reglType="textureCube",p._texture=h,gr.profile&&(p.stats=h.stats),p.destroy=function(){h.decRef()},p}function Go(){for(var Mt=0;Mt<Ws;++Mt)xe.activeTexture(mu+Mt),xe.bindTexture(ps,null),Vo[Mt]=null;Ie(ss).forEach(Cn),Cr.cubeCount=0,Cr.textureCount=0}gr.profile&&(Cr.getTotalTextureSize=function(){var Mt=0;return Object.keys(ss).forEach(function(xr){Mt+=ss[xr].stats.size}),Mt});function iu(){for(var Mt=0;Mt<Ws;++Mt){var xr=Vo[Mt];xr&&(xr.bindCount=0,xr.unit=-1,Vo[Mt]=null)}Ie(ss).forEach(function(mr){mr.texture=xe.createTexture(),xe.bindTexture(mr.target,mr.texture);for(var Rn=0;Rn<32;++Rn){if((mr.mipmask&1<<Rn)===0)continue;if(mr.target===ps)xe.texImage2D(ps,Rn,mr.internalformat,mr.width>>Rn,mr.height>>Rn,0,mr.internalformat,mr.type,null);else for(var Na=0;Na<6;++Na)xe.texImage2D(yc+Na,Rn,mr.internalformat,mr.width>>Rn,mr.height>>Rn,0,mr.internalformat,mr.type,null)}is(mr.texInfo,mr.target)})}function Mc(){for(var Mt=0;Mt<Ws;++Mt){var xr=Vo[Mt];xr&&(xr.bindCount=0,xr.unit=-1,Vo[Mt]=null),xe.activeTexture(mu+Mt),xe.bindTexture(ps,null),xe.bindTexture(Nc,null)}}return{create2D:ga,createCube:Ga,clear:Go,getTexture:function(xr){return null},restore:iu,refresh:Mc}}var zi=36161,Co=32854,Sl=32855,gu=36194,yu=33189,Ss=36168,Sc=34041,Yn=35907,Nn=34836,Ac=34842,ms=34843,jo=[];jo[Co]=2,jo[Sl]=2,jo[gu]=2,jo[yu]=2,jo[Ss]=1,jo[Sc]=4,jo[Yn]=4,jo[Nn]=16,jo[Ac]=8,jo[ms]=6;function wo(xe,je,bt){return jo[xe]*je*bt}var ru=function(je,bt,vr,Mr,Cr){var gr={rgba4:Co,rgb565:gu,"rgb5 a1":Sl,depth:yu,stencil:Ss,"depth stencil":Sc};bt.ext_srgb&&(gr.srgba=Yn),bt.ext_color_buffer_half_float&&(gr.rgba16f=Ac,gr.rgb16f=ms),bt.webgl_color_buffer_float&&(gr.rgba32f=Nn);var Wr=[];Object.keys(gr).forEach(function(Jr){var yr=gr[Jr];Wr[yr]=Jr});var sn=0,en={};function $r(Jr){this.id=sn++,this.refCount=1,this.renderbuffer=Jr,this.format=Co,this.width=0,this.height=0,Cr.profile&&(this.stats={size:0})}$r.prototype.decRef=function(){--this.refCount<=0&&ln(this)};function ln(Jr){var yr=Jr.renderbuffer;$(yr,"must not double destroy renderbuffer"),je.bindRenderbuffer(zi,null),je.deleteRenderbuffer(yr),Jr.renderbuffer=null,Jr.refCount=0,delete en[Jr.id],Mr.renderbufferCount--}function An(Jr,yr){var hr=new $r(je.createRenderbuffer());en[hr.id]=hr,Mr.renderbufferCount++;function Zr(Lr,Qn){var Qr=0,zr=0,Br=Co;if(typeof Lr=="object"&&Lr){var Yr=Lr;if("shape"in Yr){var Zn=Yr.shape;$(Array.isArray(Zn)&&Zn.length>=2,"invalid renderbuffer shape"),Qr=Zn[0]|0,zr=Zn[1]|0}else"radius"in Yr&&(Qr=zr=Yr.radius|0),"width"in Yr&&(Qr=Yr.width|0),"height"in Yr&&(zr=Yr.height|0);"format"in Yr&&($.parameter(Yr.format,gr,"invalid renderbuffer format"),Br=gr[Yr.format])}else typeof Lr=="number"?(Qr=Lr|0,typeof Qn=="number"?zr=Qn|0:zr=Qr):Lr?$.raise("invalid arguments to renderbuffer constructor"):Qr=zr=1;return $(Qr>0&&zr>0&&Qr<=vr.maxRenderbufferSize&&zr<=vr.maxRenderbufferSize,"invalid renderbuffer size"),Qr===hr.width&&zr===hr.height&&Br===hr.format?void 0:(Zr.width=hr.width=Qr,Zr.height=hr.height=zr,hr.format=Br,je.bindRenderbuffer(zi,hr.renderbuffer),je.renderbufferStorage(zi,Br,Qr,zr),$(je.getError()===0,"invalid render buffer format"),Cr.profile&&(hr.stats.size=wo(hr.format,hr.width,hr.height)),Zr.format=Wr[hr.format],Zr)}function On(Lr,Qn){var Qr=Lr|0,zr=Qn|0||Qr;return Qr===hr.width&&zr===hr.height||($(Qr>0&&zr>0&&Qr<=vr.maxRenderbufferSize&&zr<=vr.maxRenderbufferSize,"invalid renderbuffer size"),Zr.width=hr.width=Qr,Zr.height=hr.height=zr,je.bindRenderbuffer(zi,hr.renderbuffer),je.renderbufferStorage(zi,hr.format,Qr,zr),$(je.getError()===0,"invalid render buffer format"),Cr.profile&&(hr.stats.size=wo(hr.format,hr.width,hr.height))),Zr}return Zr(Jr,yr),Zr.resize=On,Zr._reglType="renderbuffer",Zr._renderbuffer=hr,Cr.profile&&(Zr.stats=hr.stats),Zr.destroy=function(){hr.decRef()},Zr}Cr.profile&&(Mr.getTotalRenderbufferSize=function(){var Jr=0;return Object.keys(en).forEach(function(yr){Jr+=en[yr].stats.size}),Jr});function pn(){Ie(en).forEach(function(Jr){Jr.renderbuffer=je.createRenderbuffer(),je.bindRenderbuffer(zi,Jr.renderbuffer),je.renderbufferStorage(zi,Jr.format,Jr.width,Jr.height)}),je.bindRenderbuffer(zi,null)}return{create:An,clear:function(){Ie(en).forEach(ln)},restore:pn}},Pu=36160,tc=36161,Za=3553,Hi=34069,hl=36064,dl=36096,rc=36128,Lu=33306,Is=36053,Ul=36054,vs=36055,Ef=36057,Bl=36061,Gc=36193,Tf=5121,Vs=5126,Al=6407,Vl=6408,Ru=6402,Iu=[Al,Vl],Cl=[];Cl[Vl]=4,Cl[Al]=3;var Ju=[];Ju[Tf]=1,Ju[Vs]=4,Ju[Gc]=2;var Ds=32854,Cc=32855,nc=36194,ac=33189,ic=36168,s=34041,a=35907,n=34836,l=34842,b=34843,O=[Ds,Cc,nc,a,l,b,n],R={};R[Is]="complete",R[Ul]="incomplete attachment",R[Ef]="incomplete dimensions",R[vs]="incomplete, missing attachment",R[Bl]="unsupported";function j(xe,je,bt,vr,Mr,Cr){var gr={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],sn=["rgba4","rgb565","rgb5 a1"];je.ext_srgb&&sn.push("srgba"),je.ext_color_buffer_half_float&&sn.push("rgba16f","rgb16f"),je.webgl_color_buffer_float&&sn.push("rgba32f");var en=["uint8"];je.oes_texture_half_float&&en.push("half float","float16"),je.oes_texture_float&&en.push("float","float32");function $r(an,Hr,kr){this.target=an,this.texture=Hr,this.renderbuffer=kr;var pa=0,ca=0;Hr?(pa=Hr.width,ca=Hr.height):kr&&(pa=kr.width,ca=kr.height),this.width=pa,this.height=ca}function ln(an){an&&(an.texture&&an.texture._texture.decRef(),an.renderbuffer&&an.renderbuffer._renderbuffer.decRef())}function An(an,Hr,kr){if(!an)return;if(an.texture){var pa=an.texture._texture,ca=Math.max(1,pa.width),jn=Math.max(1,pa.height);$(ca===Hr&&jn===kr,"inconsistent width/height for supplied texture"),pa.refCount+=1}else{var Fa=an.renderbuffer._renderbuffer;$(Fa.width===Hr&&Fa.height===kr,"inconsistent width/height for renderbuffer"),Fa.refCount+=1}}function pn(an,Hr){Hr&&(Hr.texture?xe.framebufferTexture2D(Pu,an,Hr.target,Hr.texture._texture.texture,0):xe.framebufferRenderbuffer(Pu,an,tc,Hr.renderbuffer._renderbuffer.renderbuffer))}function Jr(an){var Hr=Za,kr=null,pa=null,ca=an;typeof an=="object"&&(ca=an.data,"target"in an&&(Hr=an.target|0)),$.type(ca,"function","invalid attachment data");var jn=ca._reglType;return jn==="texture2d"?(kr=ca,$(Hr===Za)):jn==="textureCube"?(kr=ca,$(Hr>=Hi&&Hr<Hi+6,"invalid cube map target")):jn==="renderbuffer"?(pa=ca,Hr=tc):$.raise("invalid regl object for attachment"),new $r(Hr,kr,pa)}function yr(an,Hr,kr,pa,ca){if(kr){var jn=vr.create2D({width:an,height:Hr,format:pa,type:ca});return jn._texture.refCount=0,new $r(Za,jn,null)}else{var Fa=Mr.create({width:an,height:Hr,format:pa});return Fa._renderbuffer.refCount=0,new $r(tc,null,Fa)}}function hr(an){return an&&(an.texture||an.renderbuffer)}function Zr(an,Hr,kr){an&&(an.texture?an.texture.resize(Hr,kr):an.renderbuffer&&an.renderbuffer.resize(Hr,kr),an.width=Hr,an.height=kr)}var On=0,Lr={};function Qn(){this.id=On++,Lr[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Qr(an){an.colorAttachments.forEach(ln),ln(an.depthAttachment),ln(an.stencilAttachment),ln(an.depthStencilAttachment)}function zr(an){var Hr=an.framebuffer;$(Hr,"must not double destroy framebuffer"),xe.deleteFramebuffer(Hr),an.framebuffer=null,Cr.framebufferCount--,delete Lr[an.id]}function Br(an){var Hr;xe.bindFramebuffer(Pu,an.framebuffer);var kr=an.colorAttachments;for(Hr=0;Hr<kr.length;++Hr)pn(hl+Hr,kr[Hr]);for(Hr=kr.length;Hr<bt.maxColorAttachments;++Hr)xe.framebufferTexture2D(Pu,hl+Hr,Za,null,0);xe.framebufferTexture2D(Pu,Lu,Za,null,0),xe.framebufferTexture2D(Pu,dl,Za,null,0),xe.framebufferTexture2D(Pu,rc,Za,null,0),pn(dl,an.depthAttachment),pn(rc,an.stencilAttachment),pn(Lu,an.depthStencilAttachment);var pa=xe.checkFramebufferStatus(Pu);!xe.isContextLost()&&pa!==Is&&$.raise("framebuffer configuration not supported, status = "+R[pa]),xe.bindFramebuffer(Pu,gr.next?gr.next.framebuffer:null),gr.cur=gr.next,xe.getError()}function Yr(an,Hr){var kr=new Qn;Cr.framebufferCount++;function pa(jn,Fa){var Sa;$(gr.next!==kr,"can not update framebuffer which is currently in use");var Ua=0,fi=0,Bo=!0,ys=!0,Va=null,xo=!0,Mi="rgba",bs="uint8",is=1,os=null,ss=null,Ws=null,Vo=!1;if(typeof jn=="number")Ua=jn|0,fi=Fa|0||Ua;else if(!jn)Ua=fi=1;else{$.type(jn,"object","invalid arguments for framebuffer");var ea=jn;if("shape"in ea){var Tu=ea.shape;$(Array.isArray(Tu)&&Tu.length>=2,"invalid shape for framebuffer"),Ua=Tu[0],fi=Tu[1]}else"radius"in ea&&(Ua=fi=ea.radius),"width"in ea&&(Ua=ea.width),"height"in ea&&(fi=ea.height);("color"in ea||"colors"in ea)&&(Va=ea.color||ea.colors,Array.isArray(Va)&&$(Va.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Va||("colorCount"in ea&&(is=ea.colorCount|0,$(is>0,"invalid color buffer count")),"colorTexture"in ea&&(xo=!!ea.colorTexture,Mi="rgba4"),"colorType"in ea&&(bs=ea.colorType,xo?($(je.oes_texture_float||!(bs==="float"||bs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(je.oes_texture_half_float||!(bs==="half float"||bs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):bs==="half float"||bs==="float16"?($(je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Mi="rgba16f"):(bs==="float"||bs==="float32")&&($(je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Mi="rgba32f"),$.oneOf(bs,en,"invalid color type")),"colorFormat"in ea&&(Mi=ea.colorFormat,Wr.indexOf(Mi)>=0?xo=!0:sn.indexOf(Mi)>=0?xo=!1:xo?$.oneOf(ea.colorFormat,Wr,"invalid color format for texture"):$.oneOf(ea.colorFormat,sn,"invalid color format for renderbuffer"))),("depthTexture"in ea||"depthStencilTexture"in ea)&&(Vo=!!(ea.depthTexture||ea.depthStencilTexture),$(!Vo||je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ea&&(typeof ea.depth=="boolean"?Bo=ea.depth:(os=ea.depth,ys=!1)),"stencil"in ea&&(typeof ea.stencil=="boolean"?ys=ea.stencil:(ss=ea.stencil,Bo=!1)),"depthStencil"in ea&&(typeof ea.depthStencil=="boolean"?Bo=ys=ea.depthStencil:(Ws=ea.depthStencil,Bo=!1,ys=!1))}var xi=null,Cn=null,ga=null,Ga=null;if(Array.isArray(Va))xi=Va.map(Jr);else if(Va)xi=[Jr(Va)];else for(xi=new Array(is),Sa=0;Sa<is;++Sa)xi[Sa]=yr(Ua,fi,xo,Mi,bs);$(je.webgl_draw_buffers||xi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(xi.length<=bt.maxColorAttachments,"too many color attachments, not supported"),Ua=Ua||xi[0].width,fi=fi||xi[0].height,os?Cn=Jr(os):Bo&&!ys&&(Cn=yr(Ua,fi,Vo,"depth","uint32")),ss?ga=Jr(ss):ys&&!Bo&&(ga=yr(Ua,fi,!1,"stencil","uint8")),Ws?Ga=Jr(Ws):!os&&!ss&&ys&&Bo&&(Ga=yr(Ua,fi,Vo,"depth stencil","depth stencil")),$(!!os+!!ss+!!Ws<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Go=null;for(Sa=0;Sa<xi.length;++Sa)if(An(xi[Sa],Ua,fi),$(!xi[Sa]||xi[Sa].texture&&Iu.indexOf(xi[Sa].texture._texture.format)>=0||xi[Sa].renderbuffer&&O.indexOf(xi[Sa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Sa+" is invalid"),xi[Sa]&&xi[Sa].texture){var iu=Cl[xi[Sa].texture._texture.format]*Ju[xi[Sa].texture._texture.type];Go===null?Go=iu:$(Go===iu,"all color attachments much have the same number of bits per pixel.")}return An(Cn,Ua,fi),$(!Cn||Cn.texture&&Cn.texture._texture.format===Ru||Cn.renderbuffer&&Cn.renderbuffer._renderbuffer.format===ac,"invalid depth attachment for framebuffer object"),An(ga,Ua,fi),$(!ga||ga.renderbuffer&&ga.renderbuffer._renderbuffer.format===ic,"invalid stencil attachment for framebuffer object"),An(Ga,Ua,fi),$(!Ga||Ga.texture&&Ga.texture._texture.format===s||Ga.renderbuffer&&Ga.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),Qr(kr),kr.width=Ua,kr.height=fi,kr.colorAttachments=xi,kr.depthAttachment=Cn,kr.stencilAttachment=ga,kr.depthStencilAttachment=Ga,pa.color=xi.map(hr),pa.depth=hr(Cn),pa.stencil=hr(ga),pa.depthStencil=hr(Ga),pa.width=kr.width,pa.height=kr.height,Br(kr),pa}function ca(jn,Fa){$(gr.next!==kr,"can not resize a framebuffer which is currently in use");var Sa=Math.max(jn|0,1),Ua=Math.max(Fa|0||Sa,1);if(Sa===kr.width&&Ua===kr.height)return pa;for(var fi=kr.colorAttachments,Bo=0;Bo<fi.length;++Bo)Zr(fi[Bo],Sa,Ua);return Zr(kr.depthAttachment,Sa,Ua),Zr(kr.stencilAttachment,Sa,Ua),Zr(kr.depthStencilAttachment,Sa,Ua),kr.width=pa.width=Sa,kr.height=pa.height=Ua,Br(kr),pa}return pa(an,Hr),m(pa,{resize:ca,_reglType:"framebuffer",_framebuffer:kr,destroy:function(){zr(kr),Qr(kr)},use:function(Fa){gr.setFBO({framebuffer:pa},Fa)}})}function Zn(an){var Hr=Array(6);function kr(ca){var jn;$(Hr.indexOf(gr.next)<0,"can not update framebuffer which is currently in use");var Fa={color:null},Sa=0,Ua=null,fi="rgba",Bo="uint8",ys=1;if(typeof ca=="number")Sa=ca|0;else if(!ca)Sa=1;else{$.type(ca,"object","invalid arguments for framebuffer");var Va=ca;if("shape"in Va){var xo=Va.shape;$(Array.isArray(xo)&&xo.length>=2,"invalid shape for framebuffer"),$(xo[0]===xo[1],"cube framebuffer must be square"),Sa=xo[0]}else"radius"in Va&&(Sa=Va.radius|0),"width"in Va?(Sa=Va.width|0,"height"in Va&&$(Va.height===Sa,"must be square")):"height"in Va&&(Sa=Va.height|0);("color"in Va||"colors"in Va)&&(Ua=Va.color||Va.colors,Array.isArray(Ua)&&$(Ua.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Ua||("colorCount"in Va&&(ys=Va.colorCount|0,$(ys>0,"invalid color buffer count")),"colorType"in Va&&($.oneOf(Va.colorType,en,"invalid color type"),Bo=Va.colorType),"colorFormat"in Va&&(fi=Va.colorFormat,$.oneOf(Va.colorFormat,Wr,"invalid color format for texture"))),"depth"in Va&&(Fa.depth=Va.depth),"stencil"in Va&&(Fa.stencil=Va.stencil),"depthStencil"in Va&&(Fa.depthStencil=Va.depthStencil)}var Mi;if(Ua)if(Array.isArray(Ua))for(Mi=[],jn=0;jn<Ua.length;++jn)Mi[jn]=Ua[jn];else Mi=[Ua];else{Mi=Array(ys);var bs={radius:Sa,format:fi,type:Bo};for(jn=0;jn<ys;++jn)Mi[jn]=vr.createCube(bs)}for(Fa.color=Array(Mi.length),jn=0;jn<Mi.length;++jn){var is=Mi[jn];$(typeof is=="function"&&is._reglType==="textureCube","invalid cube map"),Sa=Sa||is.width,$(is.width===Sa&&is.height===Sa,"invalid cube map shape"),Fa.color[jn]={target:Hi,data:Mi[jn]}}for(jn=0;jn<6;++jn){for(var os=0;os<Mi.length;++os)Fa.color[os].target=Hi+jn;jn>0&&(Fa.depth=Hr[0].depth,Fa.stencil=Hr[0].stencil,Fa.depthStencil=Hr[0].depthStencil),Hr[jn]?Hr[jn](Fa):Hr[jn]=Yr(Fa)}return m(kr,{width:Sa,height:Sa,color:Mi})}function pa(ca){var jn,Fa=ca|0;if($(Fa>0&&Fa<=bt.maxCubeMapSize,"invalid radius for cube fbo"),Fa===kr.width)return kr;var Sa=kr.color;for(jn=0;jn<Sa.length;++jn)Sa[jn].resize(Fa);for(jn=0;jn<6;++jn)Hr[jn].resize(Fa);return kr.width=kr.height=Fa,kr}return kr(an),m(kr,{faces:Hr,resize:pa,_reglType:"framebufferCube",destroy:function(){Hr.forEach(function(jn){jn.destroy()})}})}function ra(){gr.cur=null,gr.next=null,gr.dirty=!0,Ie(Lr).forEach(function(an){an.framebuffer=xe.createFramebuffer(),Br(an)})}return m(gr,{getFramebuffer:function(Hr){if(typeof Hr=="function"&&Hr._reglType==="framebuffer"){var kr=Hr._framebuffer;if(kr instanceof Qn)return kr}return null},create:Yr,createCube:Zn,clear:function(){Ie(Lr).forEach(zr)},restore:ra})}var ue=5126,Te=34962;function Xe(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function Je(xe,je,bt,vr,Mr){for(var Cr=bt.maxAttributes,gr=new Array(Cr),Wr=0;Wr<Cr;++Wr)gr[Wr]=new Xe;var sn=0,en={},$r={Record:Xe,scope:{},state:gr,currentVAO:null,targetVAO:null,restore:An()?Lr:function(){},createVAO:Qn,getVAO:Jr,destroyBuffer:ln,setVAO:An()?yr:hr,clear:An()?Zr:function(){}};function ln(Qr){for(var zr=0;zr<gr.length;++zr){var Br=gr[zr];Br.buffer===Qr&&(xe.disableVertexAttribArray(zr),Br.buffer=null)}}function An(){return je.oes_vertex_array_object}function pn(){return je.angle_instanced_arrays}function Jr(Qr){return typeof Qr=="function"&&Qr._vao?Qr._vao:null}function yr(Qr){if(Qr===$r.currentVAO)return;var zr=An();Qr?zr.bindVertexArrayOES(Qr.vao):zr.bindVertexArrayOES(null),$r.currentVAO=Qr}function hr(Qr){if(Qr===$r.currentVAO)return;if(Qr)Qr.bindAttrs();else for(var zr=pn(),Br=0;Br<gr.length;++Br){var Yr=gr[Br];Yr.buffer?(xe.enableVertexAttribArray(Br),xe.vertexAttribPointer(Br,Yr.size,Yr.type,Yr.normalized,Yr.stride,Yr.offfset),zr&&Yr.divisor&&zr.vertexAttribDivisorANGLE(Br,Yr.divisor)):(xe.disableVertexAttribArray(Br),xe.vertexAttrib4f(Br,Yr.x,Yr.y,Yr.z,Yr.w))}$r.currentVAO=Qr}function Zr(){Ie(en).forEach(function(Qr){Qr.destroy()})}function On(){this.id=++sn,this.attributes=[];var Qr=An();Qr?this.vao=Qr.createVertexArrayOES():this.vao=null,en[this.id]=this,this.buffers=[]}On.prototype.bindAttrs=function(){for(var Qr=pn(),zr=this.attributes,Br=0;Br<zr.length;++Br){var Yr=zr[Br];Yr.buffer?(xe.enableVertexAttribArray(Br),xe.bindBuffer(Te,Yr.buffer.buffer),xe.vertexAttribPointer(Br,Yr.size,Yr.type,Yr.normalized,Yr.stride,Yr.offset),Qr&&Yr.divisor&&Qr.vertexAttribDivisorANGLE(Br,Yr.divisor)):(xe.disableVertexAttribArray(Br),xe.vertexAttrib4f(Br,Yr.x,Yr.y,Yr.z,Yr.w))}for(var Zn=zr.length;Zn<Cr;++Zn)xe.disableVertexAttribArray(Zn)},On.prototype.refresh=function(){var Qr=An();Qr&&(Qr.bindVertexArrayOES(this.vao),this.bindAttrs(),$r.currentVAO=this)},On.prototype.destroy=function(){if(this.vao){var Qr=An();this===$r.currentVAO&&($r.currentVAO=null,Qr.bindVertexArrayOES(null)),Qr.deleteVertexArrayOES(this.vao),this.vao=null}en[this.id]&&(delete en[this.id],vr.vaoCount-=1)};function Lr(){var Qr=An();Qr&&Ie(en).forEach(function(zr){zr.refresh()})}function Qn(Qr){var zr=new On;vr.vaoCount+=1;function Br(Yr){$(Array.isArray(Yr),"arguments to vertex array constructor must be an array"),$(Yr.length<Cr,"too many attributes"),$(Yr.length>0,"must specify at least one attribute");var Zn={},ra=zr.attributes;ra.length=Yr.length;for(var an=0;an<Yr.length;++an){var Hr=Yr[an],kr=ra[an]=new Xe,pa=Hr.data||Hr;if(Array.isArray(pa)||T(pa)||Ut(pa)){var ca;zr.buffers[an]&&(ca=zr.buffers[an],T(pa)&&ca._buffer.byteLength>=pa.byteLength?ca.subdata(pa):(ca.destroy(),zr.buffers[an]=null)),zr.buffers[an]||(ca=zr.buffers[an]=Mr.create(Hr,Te,!1,!0)),kr.buffer=Mr.getBuffer(ca),kr.size=kr.buffer.dimension|0,kr.normalized=!1,kr.type=kr.buffer.dtype,kr.offset=0,kr.stride=0,kr.divisor=0,kr.state=1,Zn[an]=1}else Mr.getBuffer(Hr)?(kr.buffer=Mr.getBuffer(Hr),kr.size=kr.buffer.dimension|0,kr.normalized=!1,kr.type=kr.buffer.dtype,kr.offset=0,kr.stride=0,kr.divisor=0,kr.state=1):Mr.getBuffer(Hr.buffer)?(kr.buffer=Mr.getBuffer(Hr.buffer),kr.size=(+Hr.size||kr.buffer.dimension)|0,kr.normalized=!!Hr.normalized||!1,"type"in Hr?($.parameter(Hr.type,uo,"invalid buffer type"),kr.type=uo[Hr.type]):kr.type=kr.buffer.dtype,kr.offset=(Hr.offset||0)|0,kr.stride=(Hr.stride||0)|0,kr.divisor=(Hr.divisor||0)|0,kr.state=1,$(kr.size>=1&&kr.size<=4,"size must be between 1 and 4"),$(kr.offset>=0,"invalid offset"),$(kr.stride>=0&&kr.stride<=255,"stride must be between 0 and 255"),$(kr.divisor>=0,"divisor must be positive"),$(!kr.divisor||!!je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Hr?($(an>0,"first attribute must not be a constant"),kr.x=+Hr.x||0,kr.y=+Hr.y||0,kr.z=+Hr.z||0,kr.w=+Hr.w||0,kr.state=2):$(!1,"invalid attribute spec for location "+an)}for(var jn=0;jn<zr.buffers.length;++jn)!Zn[jn]&&zr.buffers[jn]&&(zr.buffers[jn].destroy(),zr.buffers[jn]=null);return zr.refresh(),Br}return Br.destroy=function(){for(var Yr=0;Yr<zr.buffers.length;++Yr)zr.buffers[Yr]&&zr.buffers[Yr].destroy();zr.buffers.length=0,zr.destroy()},Br._vao=zr,Br._reglType="vao",Br(Qr)}return $r}var tt=35632,Dt=35633,Lt=35718,Zt=35721;function Rt(xe,je,bt,vr){var Mr={},Cr={};function gr(yr,hr,Zr,On){this.name=yr,this.id=hr,this.location=Zr,this.info=On}function Wr(yr,hr){for(var Zr=0;Zr<yr.length;++Zr)if(yr[Zr].id===hr.id){yr[Zr].location=hr.location;return}yr.push(hr)}function sn(yr,hr,Zr){var On=yr===tt?Mr:Cr,Lr=On[hr];if(!Lr){var Qn=je.str(hr);Lr=xe.createShader(yr),xe.shaderSource(Lr,Qn),xe.compileShader(Lr),$.shaderError(xe,Lr,Qn,yr,Zr),On[hr]=Lr}return Lr}var en={},$r=[],ln=0;function An(yr,hr){this.id=ln++,this.fragId=yr,this.vertId=hr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,vr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pn(yr,hr,Zr){var On,Lr,Qn=sn(tt,yr.fragId),Qr=sn(Dt,yr.vertId),zr=yr.program=xe.createProgram();if(xe.attachShader(zr,Qn),xe.attachShader(zr,Qr),Zr)for(On=0;On<Zr.length;++On){var Br=Zr[On];xe.bindAttribLocation(zr,Br[0],Br[1])}xe.linkProgram(zr),$.linkError(xe,zr,je.str(yr.fragId),je.str(yr.vertId),hr);var Yr=xe.getProgramParameter(zr,Lt);vr.profile&&(yr.stats.uniformsCount=Yr);var Zn=yr.uniforms;for(On=0;On<Yr;++On)if(Lr=xe.getActiveUniform(zr,On),Lr)if(Lr.size>1)for(var ra=0;ra<Lr.size;++ra){var an=Lr.name.replace("[0]","["+ra+"]");Wr(Zn,new gr(an,je.id(an),xe.getUniformLocation(zr,an),Lr))}else Wr(Zn,new gr(Lr.name,je.id(Lr.name),xe.getUniformLocation(zr,Lr.name),Lr));var Hr=xe.getProgramParameter(zr,Zt);vr.profile&&(yr.stats.attributesCount=Hr);var kr=yr.attributes;for(On=0;On<Hr;++On)Lr=xe.getActiveAttrib(zr,On),Lr&&Wr(kr,new gr(Lr.name,je.id(Lr.name),xe.getAttribLocation(zr,Lr.name),Lr))}vr.profile&&(bt.getMaxUniformsCount=function(){var yr=0;return $r.forEach(function(hr){hr.stats.uniformsCount>yr&&(yr=hr.stats.uniformsCount)}),yr},bt.getMaxAttributesCount=function(){var yr=0;return $r.forEach(function(hr){hr.stats.attributesCount>yr&&(yr=hr.stats.attributesCount)}),yr});function Jr(){Mr={},Cr={};for(var yr=0;yr<$r.length;++yr)pn($r[yr],null,$r[yr].attributes.map(function(hr){return[hr.location,hr.name]}))}return{clear:function(){var hr=xe.deleteShader.bind(xe);Ie(Mr).forEach(hr),Mr={},Ie(Cr).forEach(hr),Cr={},$r.forEach(function(Zr){xe.deleteProgram(Zr.program)}),$r.length=0,en={},bt.shaderCount=0},program:function(hr,Zr,On,Lr){$.command(hr>=0,"missing vertex shader",On),$.command(Zr>=0,"missing fragment shader",On);var Qn=en[Zr];Qn||(Qn=en[Zr]={});var Qr=Qn[hr];if(Qr&&(Qr.refCount++,!Lr))return Qr;var zr=new An(Zr,hr);return bt.shaderCount++,pn(zr,On,Lr),Qr||(Qn[hr]=zr),$r.push(zr),m(zr,{destroy:function(){if(zr.refCount--,zr.refCount<=0){xe.deleteProgram(zr.program);var Yr=$r.indexOf(zr);$r.splice(Yr,1),bt.shaderCount--}Qn[zr.vertId].refCount<=0&&(xe.deleteShader(Cr[zr.vertId]),delete Cr[zr.vertId],delete en[zr.fragId][zr.vertId]),Object.keys(en[zr.fragId]).length||(xe.deleteShader(Mr[zr.fragId]),delete Mr[zr.fragId],delete en[zr.fragId])}})},restore:Jr,shader:sn,frag:-1,vert:-1}}var Bt=6408,qt=5121,Qt=3333,Pr=5126;function fr(xe,je,bt,vr,Mr,Cr,gr){function Wr($r){var ln;je.next===null?($(Mr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ln=qt):($(je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ln=je.next.colorAttachments[0].texture._texture.type,Cr.oes_texture_float?($(ln===qt||ln===Pr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ln===Pr&&$(gr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(ln===qt,"Reading from a framebuffer is only allowed for the type 'uint8'"));var An=0,pn=0,Jr=vr.framebufferWidth,yr=vr.framebufferHeight,hr=null;T($r)?hr=$r:$r&&($.type($r,"object","invalid arguments to regl.read()"),An=$r.x|0,pn=$r.y|0,$(An>=0&&An<vr.framebufferWidth,"invalid x offset for regl.read"),$(pn>=0&&pn<vr.framebufferHeight,"invalid y offset for regl.read"),Jr=($r.width||vr.framebufferWidth-An)|0,yr=($r.height||vr.framebufferHeight-pn)|0,hr=$r.data||null),hr&&(ln===qt?$(hr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ln===Pr&&$(hr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(Jr>0&&Jr+An<=vr.framebufferWidth,"invalid width for read pixels"),$(yr>0&&yr+pn<=vr.framebufferHeight,"invalid height for read pixels"),bt();var Zr=Jr*yr*4;return hr||(ln===qt?hr=new Uint8Array(Zr):ln===Pr&&(hr=hr||new Float32Array(Zr))),$.isTypedArray(hr,"data buffer for regl.read() must be a typedarray"),$(hr.byteLength>=Zr,"data buffer for regl.read() too small"),xe.pixelStorei(Qt,4),xe.readPixels(An,pn,Jr,yr,Bt,ln,hr),hr}function sn($r){var ln;return je.setFBO({framebuffer:$r.framebuffer},function(){ln=Wr($r)}),ln}function en($r){return!$r||!("framebuffer"in $r)?Wr($r):sn($r)}return en}function Tr(xe){return Array.prototype.slice.call(xe)}function Ar(xe){return Tr(xe).join("")}function nn(){var xe=0,je=[],bt=[];function vr(ln){for(var An=0;An<bt.length;++An)if(bt[An]===ln)return je[An];var pn="g"+xe++;return je.push(pn),bt.push(ln),pn}function Mr(){var ln=[];function An(){ln.push.apply(ln,Tr(arguments))}var pn=[];function Jr(){var yr="v"+xe++;return pn.push(yr),arguments.length>0&&(ln.push(yr,"="),ln.push.apply(ln,Tr(arguments)),ln.push(";")),yr}return m(An,{def:Jr,toString:function(){return Ar([pn.length>0?"var "+pn.join(",")+";":"",Ar(ln)])}})}function Cr(){var ln=Mr(),An=Mr(),pn=ln.toString,Jr=An.toString;function yr(hr,Zr){An(hr,Zr,"=",ln.def(hr,Zr),";")}return m(function(){ln.apply(ln,Tr(arguments))},{def:ln.def,entry:ln,exit:An,save:yr,set:function(Zr,On,Lr){yr(Zr,On),ln(Zr,On,"=",Lr,";")},toString:function(){return pn()+Jr()}})}function gr(){var ln=Ar(arguments),An=Cr(),pn=Cr(),Jr=An.toString,yr=pn.toString;return m(An,{then:function(){return An.apply(An,Tr(arguments)),this},else:function(){return pn.apply(pn,Tr(arguments)),this},toString:function(){var Zr=yr();return Zr&&(Zr="else{"+Zr+"}"),Ar(["if(",ln,"){",Jr(),"}",Zr])}})}var Wr=Mr(),sn={};function en(ln,An){var pn=[];function Jr(){var Lr="a"+pn.length;return pn.push(Lr),Lr}An=An||0;for(var yr=0;yr<An;++yr)Jr();var hr=Cr(),Zr=hr.toString,On=sn[ln]=m(hr,{arg:Jr,toString:function(){return Ar(["function(",pn.join(),"){",Zr(),"}"])}});return On}function $r(){var ln=['"use strict";',Wr,"return {"];Object.keys(sn).forEach(function(Jr){ln.push('"',Jr,'":',sn[Jr].toString(),",")}),ln.push("}");var An=Ar(ln).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pn=Function.apply(null,je.concat(An));return pn.apply(null,bt)}return{global:Wr,link:vr,block:Mr,proc:en,scope:Cr,cond:gr,compile:$r}}var Xr="xyzw".split(""),gn=5121,Pn=1,Jn=2,aa=0,ba=1,Xa=2,_n=3,ia=4,xa=5,Wn=6,Aa="dither",ta="blend.enable",La="blend.color",ja="blend.equation",Ji="blend.func",wi="depth.enable",vo="depth.func",_i="depth.range",Wi="depth.mask",Ns="colorMask",go="cull.enable",bu="cull.face",xu="frontFace",zo="lineWidth",As="polygonOffset.enable",Du="polygonOffset.offset",oc="sample.alpha",Qu="sample.enable",sc="sample.coverage",uc="stencil.enable",Nu="stencil.mask",pl="stencil.func",Cs="stencil.opFront",co="stencil.opBack",ku="scissor.enable",Eu="scissor.box",Oo="viewport",Mo="profile",Po="framebuffer",Jo="vert",yo="frag",Fo="elements",Gs="primitive",wl="count",Hc="offset",Gl="instances",qu="vao",ju="Width",zu="Height",Hs=Po+ju,Lo=Po+zu,Wc=Oo+ju,gs=Oo+zu,lf="drawingBuffer",Df=lf+ju,Nf=lf+zu,Bf=[Ji,ja,pl,Cs,co,sc,Oo,Eu,Du],el=34962,_f=34963,cf=35632,lc=35633,Fu=3553,cc=34067,Vf=2884,wc=3042,Oc=3024,Gf=2960,Hf=2929,ih=3089,Wf=32823,kf=32926,fh=32928,fc=5126,ff=35664,no=35665,Hl=35666,hf=5124,Zc=35667,nu=35668,Ol=35669,Sf=35670,Af=35671,Xc=35672,df=35673,Yc=35674,Wl=35675,ne=35676,se=35678,k=35680,G=4,Ae=1028,ot=1029,Xt=2304,nr=2305,rr=32775,Rr=32776,on=519,Un=7680,Kn=0,oa=1,ti=32774,za=513,Oi=36160,ni=36064,Fi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ro=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],bo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Zi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Uo={frag:cf,vert:lc},ri={cw:Xt,ccw:nr};function fo(xe){return Array.isArray(xe)||T(xe)||Ut(xe)}function au(xe){return xe.sort(function(je,bt){return je===Oo?-1:bt===Oo?1:je<bt?-1:1})}function Si(xe,je,bt,vr){this.thisDep=xe,this.contextDep=je,this.propDep=bt,this.append=vr}function Ui(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function Ea(xe){return new Si(!1,!1,!1,xe)}function Io(xe,je){var bt=xe.type;if(bt===aa){var vr=xe.data.length;return new Si(!0,vr>=1,vr>=2,je)}else if(bt===ia){var Mr=xe.data;return new Si(Mr.thisDep,Mr.contextDep,Mr.propDep,je)}else{if(bt===xa)return new Si(!1,!1,!1,je);if(bt===Wn){for(var Cr=!1,gr=!1,Wr=!1,sn=0;sn<xe.data.length;++sn){var en=xe.data[sn];if(en.type===ba)Wr=!0;else if(en.type===Xa)gr=!0;else if(en.type===_n)Cr=!0;else if(en.type===aa){Cr=!0;var $r=en.data;$r>=1&&(gr=!0),$r>=2&&(Wr=!0)}else en.type===ia&&(Cr=Cr||en.data.thisDep,gr=gr||en.data.contextDep,Wr=Wr||en.data.propDep)}return new Si(Cr,gr,Wr,je)}else return new Si(bt===_n,bt===Xa,bt===ba,je)}}var hc=new Si(!1,!1,!1,function(){});function Zf(xe,je,bt,vr,Mr,Cr,gr,Wr,sn,en,$r,ln,An,pn,Jr){var yr=en.Record,hr={add:32774,subtract:32778,"reverse subtract":32779};bt.ext_blend_minmax&&(hr.min=rr,hr.max=Rr);var Zr=bt.angle_instanced_arrays,On=bt.webgl_draw_buffers,Lr={dirty:!0,profile:Jr.profile},Qn={},Qr=[],zr={},Br={};function Yr(v){return v.replace(".","_")}function Zn(v,h,c){var p=Yr(v);Qr.push(v),Qn[p]=Lr[p]=!!c,zr[p]=h}function ra(v,h,c){var p=Yr(v);Qr.push(v),Array.isArray(c)?(Lr[p]=c.slice(),Qn[p]=c.slice()):Lr[p]=Qn[p]=c,Br[p]=h}Zn(Aa,Oc),Zn(ta,wc),ra(La,"blendColor",[0,0,0,0]),ra(ja,"blendEquationSeparate",[ti,ti]),ra(Ji,"blendFuncSeparate",[oa,Kn,oa,Kn]),Zn(wi,Hf,!0),ra(vo,"depthFunc",za),ra(_i,"depthRange",[0,1]),ra(Wi,"depthMask",!0),ra(Ns,Ns,[!0,!0,!0,!0]),Zn(go,Vf),ra(bu,"cullFace",ot),ra(xu,xu,nr),ra(zo,zo,1),Zn(As,Wf),ra(Du,"polygonOffset",[0,0]),Zn(oc,kf),Zn(Qu,fh),ra(sc,"sampleCoverage",[1,!1]),Zn(uc,Gf),ra(Nu,"stencilMask",-1),ra(pl,"stencilFunc",[on,0,-1]),ra(Cs,"stencilOpSeparate",[Ae,Un,Un,Un]),ra(co,"stencilOpSeparate",[ot,Un,Un,Un]),Zn(ku,ih),ra(Eu,"scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),ra(Oo,Oo,[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var an={gl:xe,context:An,strings:je,next:Qn,current:Lr,draw:ln,elements:Cr,buffer:Mr,shader:$r,attributes:en.state,vao:en,uniforms:sn,framebuffer:Wr,extensions:bt,timer:pn,isBufferArgs:fo},Hr={primTypes:di,compareFuncs:bo,blendFuncs:Fi,blendEquations:hr,stencilOps:Zi,glTypes:uo,orientationType:ri};$.optional(function(){an.isArrayLike=$i}),On&&(Hr.backBuffer=[ot],Hr.drawBuffer=W(vr.maxDrawbuffers,function(v){return v===0?[0]:W(v,function(h){return ni+h})}));var kr=0;function pa(){var v=nn(),h=v.link,c=v.global;v.id=kr++,v.batchId="0";var p=h(an),y=v.shared={props:"a0"};Object.keys(an).forEach(function(J){y[J]=c.def(p,".",J)}),$.optional(function(){v.CHECK=h($),v.commandStr=$.guessCommand(),v.command=h(v.commandStr),v.assert=function(J,he,Ye){J("if(!(",he,"))",this.CHECK,".commandRaise(",h(Ye),",",this.command,");")},Hr.invalidBlendCombinations=Ro});var P=v.next={},N=v.current={};Object.keys(Br).forEach(function(J){Array.isArray(Lr[J])&&(P[J]=c.def(y.next,".",J),N[J]=c.def(y.current,".",J))});var ee=v.constants={};Object.keys(Hr).forEach(function(J){ee[J]=c.def(JSON.stringify(Hr[J]))}),v.invoke=function(J,he){switch(he.type){case aa:var Ye=["this",y.context,y.props,v.batchId];return J.def(h(he.data),".call(",Ye.slice(0,Math.max(he.data.length+1,4)),")");case ba:return J.def(y.props,he.data);case Xa:return J.def(y.context,he.data);case _n:return J.def("this",he.data);case ia:return he.data.append(v,J),he.data.ref;case xa:return he.data.toString();case Wn:return he.data.map(function(He){return v.invoke(J,He)})}},v.attribCache={};var B={};return v.scopeAttrib=function(J){var he=je.id(J);if(he in B)return B[he];var Ye=en.scope[he];Ye||(Ye=en.scope[he]=new yr);var He=B[he]=h(Ye);return He},v}function ca(v){var h=v.static,c=v.dynamic,p;if(Mo in h){var y=!!h[Mo];p=Ea(function(N,ee){return y}),p.enable=y}else if(Mo in c){var P=c[Mo];p=Io(P,function(N,ee){return N.invoke(ee,P)})}return p}function jn(v,h){var c=v.static,p=v.dynamic;if(Po in c){var y=c[Po];return y?(y=Wr.getFramebuffer(y),$.command(y,"invalid framebuffer object"),Ea(function(N,ee){var B=N.link(y),J=N.shared;ee.set(J.framebuffer,".next",B);var he=J.context;return ee.set(he,"."+Hs,B+".width"),ee.set(he,"."+Lo,B+".height"),B})):Ea(function(N,ee){var B=N.shared;ee.set(B.framebuffer,".next","null");var J=B.context;return ee.set(J,"."+Hs,J+"."+Df),ee.set(J,"."+Lo,J+"."+Nf),"null"})}else if(Po in p){var P=p[Po];return Io(P,function(N,ee){var B=N.invoke(ee,P),J=N.shared,he=J.framebuffer,Ye=ee.def(he,".getFramebuffer(",B,")");$.optional(function(){N.assert(ee,"!"+B+"||"+Ye,"invalid framebuffer object")}),ee.set(he,".next",Ye);var He=J.context;return ee.set(He,"."+Hs,Ye+"?"+Ye+".width:"+He+"."+Df),ee.set(He,"."+Lo,Ye+"?"+Ye+".height:"+He+"."+Nf),Ye})}else return null}function Fa(v,h,c){var p=v.static,y=v.dynamic;function P(B){if(B in p){var J=p[B];$.commandType(J,"object","invalid "+B,c.commandStr);var he=!0,Ye=J.x|0,He=J.y|0,It,Ft;return"width"in J?(It=J.width|0,$.command(It>=0,"invalid "+B,c.commandStr)):he=!1,"height"in J?(Ft=J.height|0,$.command(Ft>=0,"invalid "+B,c.commandStr)):he=!1,new Si(!he&&h&&h.thisDep,!he&&h&&h.contextDep,!he&&h&&h.propDep,function(_r,un){var Nr=_r.shared.context,rn=It;"width"in J||(rn=un.def(Nr,".",Hs,"-",Ye));var yn=Ft;return"height"in J||(yn=un.def(Nr,".",Lo,"-",He)),[Ye,He,rn,yn]})}else if(B in y){var Yt=y[B],lr=Io(Yt,function(_r,un){var Nr=_r.invoke(un,Yt);$.optional(function(){_r.assert(un,Nr+"&&typeof "+Nr+'==="object"',"invalid "+B)});var rn=_r.shared.context,yn=un.def(Nr,".x|0"),Vn=un.def(Nr,".y|0"),ua=un.def('"width" in ',Nr,"?",Nr,".width|0:","(",rn,".",Hs,"-",yn,")"),ma=un.def('"height" in ',Nr,"?",Nr,".height|0:","(",rn,".",Lo,"-",Vn,")");return $.optional(function(){_r.assert(un,ua+">=0&&"+ma+">=0","invalid "+B)}),[yn,Vn,ua,ma]});return h&&(lr.thisDep=lr.thisDep||h.thisDep,lr.contextDep=lr.contextDep||h.contextDep,lr.propDep=lr.propDep||h.propDep),lr}else return h?new Si(h.thisDep,h.contextDep,h.propDep,function(_r,un){var Nr=_r.shared.context;return[0,0,un.def(Nr,".",Hs),un.def(Nr,".",Lo)]}):null}var N=P(Oo);if(N){var ee=N;N=new Si(N.thisDep,N.contextDep,N.propDep,function(B,J){var he=ee.append(B,J),Ye=B.shared.context;return J.set(Ye,"."+Wc,he[2]),J.set(Ye,"."+gs,he[3]),he})}return{viewport:N,scissor_box:P(Eu)}}function Sa(v,h){var c=v.static,p=typeof c[yo]=="string"&&typeof c[Jo]=="string";if(p){if(Object.keys(h.dynamic).length>0)return null;var y=h.static,P=Object.keys(y);if(P.length>0&&typeof y[P[0]]=="number"){for(var N=[],ee=0;ee<P.length;++ee)$(typeof y[P[ee]]=="number","must specify all vertex attribute locations when using vaos"),N.push([y[P[ee]]|0,P[ee]]);return N}}return null}function Ua(v,h,c){var p=v.static,y=v.dynamic;function P(he){if(he in p){var Ye=je.id(p[he]);$.optional(function(){$r.shader(Uo[he],Ye,$.guessCommand())});var He=Ea(function(){return Ye});return He.id=Ye,He}else if(he in y){var It=y[he];return Io(It,function(Ft,Yt){var lr=Ft.invoke(Yt,It),_r=Yt.def(Ft.shared.strings,".id(",lr,")");return $.optional(function(){Yt(Ft.shared.shader,".shader(",Uo[he],",",_r,",",Ft.command,");")}),_r})}return null}var N=P(yo),ee=P(Jo),B=null,J;return Ui(N)&&Ui(ee)?(B=$r.program(ee.id,N.id,null,c),J=Ea(function(he,Ye){return he.link(B)})):J=new Si(N&&N.thisDep||ee&&ee.thisDep,N&&N.contextDep||ee&&ee.contextDep,N&&N.propDep||ee&&ee.propDep,function(he,Ye){var He=he.shared.shader,It;N?It=N.append(he,Ye):It=Ye.def(He,".",yo);var Ft;ee?Ft=ee.append(he,Ye):Ft=Ye.def(He,".",Jo);var Yt=He+".program("+Ft+","+It;return $.optional(function(){Yt+=","+he.command}),Ye.def(Yt+")")}),{frag:N,vert:ee,progVar:J,program:B}}function fi(v,h){var c=v.static,p=v.dynamic;function y(){if(Fo in c){var he=c[Fo];fo(he)?he=Cr.getElements(Cr.create(he,!0)):he&&(he=Cr.getElements(he),$.command(he,"invalid elements",h.commandStr));var Ye=Ea(function(It,Ft){if(he){var Yt=It.link(he);return It.ELEMENTS=Yt,Yt}return It.ELEMENTS=null,null});return Ye.value=he,Ye}else if(Fo in p){var He=p[Fo];return Io(He,function(It,Ft){var Yt=It.shared,lr=Yt.isBufferArgs,_r=Yt.elements,un=It.invoke(Ft,He),Nr=Ft.def("null"),rn=Ft.def(lr,"(",un,")"),yn=It.cond(rn).then(Nr,"=",_r,".createStream(",un,");").else(Nr,"=",_r,".getElements(",un,");");return $.optional(function(){It.assert(yn.else,"!"+un+"||"+Nr,"invalid elements")}),Ft.entry(yn),Ft.exit(It.cond(rn).then(_r,".destroyStream(",Nr,");")),It.ELEMENTS=Nr,Nr})}return null}var P=y();function N(){if(Gs in c){var he=c[Gs];return $.commandParameter(he,di,"invalid primitve",h.commandStr),Ea(function(He,It){return di[he]})}else if(Gs in p){var Ye=p[Gs];return Io(Ye,function(He,It){var Ft=He.constants.primTypes,Yt=He.invoke(It,Ye);return $.optional(function(){He.assert(It,Yt+" in "+Ft,"invalid primitive, must be one of "+Object.keys(di))}),It.def(Ft,"[",Yt,"]")})}else if(P)return Ui(P)?P.value?Ea(function(He,It){return It.def(He.ELEMENTS,".primType")}):Ea(function(){return G}):new Si(P.thisDep,P.contextDep,P.propDep,function(He,It){var Ft=He.ELEMENTS;return It.def(Ft,"?",Ft,".primType:",G)});return null}function ee(he,Ye){if(he in c){var He=c[he]|0;return $.command(!Ye||He>=0,"invalid "+he,h.commandStr),Ea(function(Ft,Yt){return Ye&&(Ft.OFFSET=He),He})}else if(he in p){var It=p[he];return Io(It,function(Ft,Yt){var lr=Ft.invoke(Yt,It);return Ye&&(Ft.OFFSET=lr,$.optional(function(){Ft.assert(Yt,lr+">=0","invalid "+he)})),lr})}else if(Ye&&P)return Ea(function(Ft,Yt){return Ft.OFFSET="0",0});return null}var B=ee(Hc,!0);function J(){if(wl in c){var he=c[wl]|0;return $.command(typeof he=="number"&&he>=0,"invalid vertex count",h.commandStr),Ea(function(){return he})}else if(wl in p){var Ye=p[wl];return Io(Ye,function(Ft,Yt){var lr=Ft.invoke(Yt,Ye);return $.optional(function(){Ft.assert(Yt,"typeof "+lr+'==="number"&&'+lr+">=0&&"+lr+"===("+lr+"|0)","invalid vertex count")}),lr})}else if(P)if(Ui(P)){if(P)return B?new Si(B.thisDep,B.contextDep,B.propDep,function(Ft,Yt){var lr=Yt.def(Ft.ELEMENTS,".vertCount-",Ft.OFFSET);return $.optional(function(){Ft.assert(Yt,lr+">=0","invalid vertex offset/element buffer too small")}),lr}):Ea(function(Ft,Yt){return Yt.def(Ft.ELEMENTS,".vertCount")});var He=Ea(function(){return-1});return $.optional(function(){He.MISSING=!0}),He}else{var It=new Si(P.thisDep||B.thisDep,P.contextDep||B.contextDep,P.propDep||B.propDep,function(Ft,Yt){var lr=Ft.ELEMENTS;return Ft.OFFSET?Yt.def(lr,"?",lr,".vertCount-",Ft.OFFSET,":-1"):Yt.def(lr,"?",lr,".vertCount:-1")});return $.optional(function(){It.DYNAMIC=!0}),It}return null}return{elements:P,primitive:N(),count:J(),instances:ee(Gl,!1),offset:B}}function Bo(v,h){var c=v.static,p=v.dynamic,y={};return Qr.forEach(function(P){var N=Yr(P);function ee(B,J){if(P in c){var he=B(c[P]);y[N]=Ea(function(){return he})}else if(P in p){var Ye=p[P];y[N]=Io(Ye,function(He,It){return J(He,It,He.invoke(It,Ye))})}}switch(P){case go:case ta:case Aa:case uc:case wi:case ku:case As:case oc:case Qu:case Wi:return ee(function(B){return $.commandType(B,"boolean",P,h.commandStr),B},function(B,J,he){return $.optional(function(){B.assert(J,"typeof "+he+'==="boolean"',"invalid flag "+P,B.commandStr)}),he});case vo:return ee(function(B){return $.commandParameter(B,bo,"invalid "+P,h.commandStr),bo[B]},function(B,J,he){var Ye=B.constants.compareFuncs;return $.optional(function(){B.assert(J,he+" in "+Ye,"invalid "+P+", must be one of "+Object.keys(bo))}),J.def(Ye,"[",he,"]")});case _i:return ee(function(B){return $.command($i(B)&&B.length===2&&typeof B[0]=="number"&&typeof B[1]=="number"&&B[0]<=B[1],"depth range is 2d array",h.commandStr),B},function(B,J,he){$.optional(function(){B.assert(J,B.shared.isArrayLike+"("+he+")&&"+he+".length===2&&typeof "+he+'[0]==="number"&&typeof '+he+'[1]==="number"&&'+he+"[0]<="+he+"[1]","depth range must be a 2d array")});var Ye=J.def("+",he,"[0]"),He=J.def("+",he,"[1]");return[Ye,He]});case Ji:return ee(function(B){$.commandType(B,"object","blend.func",h.commandStr);var J="srcRGB"in B?B.srcRGB:B.src,he="srcAlpha"in B?B.srcAlpha:B.src,Ye="dstRGB"in B?B.dstRGB:B.dst,He="dstAlpha"in B?B.dstAlpha:B.dst;return $.commandParameter(J,Fi,N+".srcRGB",h.commandStr),$.commandParameter(he,Fi,N+".srcAlpha",h.commandStr),$.commandParameter(Ye,Fi,N+".dstRGB",h.commandStr),$.commandParameter(He,Fi,N+".dstAlpha",h.commandStr),$.command(Ro.indexOf(J+", "+Ye)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+J+", "+Ye+")",h.commandStr),[Fi[J],Fi[Ye],Fi[he],Fi[He]]},function(B,J,he){var Ye=B.constants.blendFuncs;$.optional(function(){B.assert(J,he+"&&typeof "+he+'==="object"',"invalid blend func, must be an object")});function He(Nr,rn){var yn=J.def('"',Nr,rn,'" in ',he,"?",he,".",Nr,rn,":",he,".",Nr);return $.optional(function(){B.assert(J,yn+" in "+Ye,"invalid "+P+"."+Nr+rn+", must be one of "+Object.keys(Fi))}),yn}var It=He("src","RGB"),Ft=He("dst","RGB");$.optional(function(){var Nr=B.constants.invalidBlendCombinations;B.assert(J,Nr+".indexOf("+It+'+", "+'+Ft+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Yt=J.def(Ye,"[",It,"]"),lr=J.def(Ye,"[",He("src","Alpha"),"]"),_r=J.def(Ye,"[",Ft,"]"),un=J.def(Ye,"[",He("dst","Alpha"),"]");return[Yt,_r,lr,un]});case ja:return ee(function(B){if(typeof B=="string")return $.commandParameter(B,hr,"invalid "+P,h.commandStr),[hr[B],hr[B]];if(typeof B=="object")return $.commandParameter(B.rgb,hr,P+".rgb",h.commandStr),$.commandParameter(B.alpha,hr,P+".alpha",h.commandStr),[hr[B.rgb],hr[B.alpha]];$.commandRaise("invalid blend.equation",h.commandStr)},function(B,J,he){var Ye=B.constants.blendEquations,He=J.def(),It=J.def(),Ft=B.cond("typeof ",he,'==="string"');return $.optional(function(){function Yt(lr,_r,un){B.assert(lr,un+" in "+Ye,"invalid "+_r+", must be one of "+Object.keys(hr))}Yt(Ft.then,P,he),B.assert(Ft.else,he+"&&typeof "+he+'==="object"',"invalid "+P),Yt(Ft.else,P+".rgb",he+".rgb"),Yt(Ft.else,P+".alpha",he+".alpha")}),Ft.then(He,"=",It,"=",Ye,"[",he,"];"),Ft.else(He,"=",Ye,"[",he,".rgb];",It,"=",Ye,"[",he,".alpha];"),J(Ft),[He,It]});case La:return ee(function(B){return $.command($i(B)&&B.length===4,"blend.color must be a 4d array",h.commandStr),W(4,function(J){return+B[J]})},function(B,J,he){return $.optional(function(){B.assert(J,B.shared.isArrayLike+"("+he+")&&"+he+".length===4","blend.color must be a 4d array")}),W(4,function(Ye){return J.def("+",he,"[",Ye,"]")})});case Nu:return ee(function(B){return $.commandType(B,"number",N,h.commandStr),B|0},function(B,J,he){return $.optional(function(){B.assert(J,"typeof "+he+'==="number"',"invalid stencil.mask")}),J.def(he,"|0")});case pl:return ee(function(B){$.commandType(B,"object",N,h.commandStr);var J=B.cmp||"keep",he=B.ref||0,Ye="mask"in B?B.mask:-1;return $.commandParameter(J,bo,P+".cmp",h.commandStr),$.commandType(he,"number",P+".ref",h.commandStr),$.commandType(Ye,"number",P+".mask",h.commandStr),[bo[J],he,Ye]},function(B,J,he){var Ye=B.constants.compareFuncs;$.optional(function(){function Yt(){B.assert(J,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Yt(he+"&&typeof ",he,'==="object"'),Yt('!("cmp" in ',he,")||(",he,".cmp in ",Ye,")")});var He=J.def('"cmp" in ',he,"?",Ye,"[",he,".cmp]",":",Un),It=J.def(he,".ref|0"),Ft=J.def('"mask" in ',he,"?",he,".mask|0:-1");return[He,It,Ft]});case Cs:case co:return ee(function(B){$.commandType(B,"object",N,h.commandStr);var J=B.fail||"keep",he=B.zfail||"keep",Ye=B.zpass||"keep";return $.commandParameter(J,Zi,P+".fail",h.commandStr),$.commandParameter(he,Zi,P+".zfail",h.commandStr),$.commandParameter(Ye,Zi,P+".zpass",h.commandStr),[P===co?ot:Ae,Zi[J],Zi[he],Zi[Ye]]},function(B,J,he){var Ye=B.constants.stencilOps;$.optional(function(){B.assert(J,he+"&&typeof "+he+'==="object"',"invalid "+P)});function He(It){return $.optional(function(){B.assert(J,'!("'+It+'" in '+he+")||("+he+"."+It+" in "+Ye+")","invalid "+P+"."+It+", must be one of "+Object.keys(Zi))}),J.def('"',It,'" in ',he,"?",Ye,"[",he,".",It,"]:",Un)}return[P===co?ot:Ae,He("fail"),He("zfail"),He("zpass")]});case Du:return ee(function(B){$.commandType(B,"object",N,h.commandStr);var J=B.factor|0,he=B.units|0;return $.commandType(J,"number",N+".factor",h.commandStr),$.commandType(he,"number",N+".units",h.commandStr),[J,he]},function(B,J,he){$.optional(function(){B.assert(J,he+"&&typeof "+he+'==="object"',"invalid "+P)});var Ye=J.def(he,".factor|0"),He=J.def(he,".units|0");return[Ye,He]});case bu:return ee(function(B){var J=0;return B==="front"?J=Ae:B==="back"&&(J=ot),$.command(!!J,N,h.commandStr),J},function(B,J,he){return $.optional(function(){B.assert(J,he+'==="front"||'+he+'==="back"',"invalid cull.face")}),J.def(he,'==="front"?',Ae,":",ot)});case zo:return ee(function(B){return $.command(typeof B=="number"&&B>=vr.lineWidthDims[0]&&B<=vr.lineWidthDims[1],"invalid line width, must be a positive number between "+vr.lineWidthDims[0]+" and "+vr.lineWidthDims[1],h.commandStr),B},function(B,J,he){return $.optional(function(){B.assert(J,"typeof "+he+'==="number"&&'+he+">="+vr.lineWidthDims[0]+"&&"+he+"<="+vr.lineWidthDims[1],"invalid line width")}),he});case xu:return ee(function(B){return $.commandParameter(B,ri,N,h.commandStr),ri[B]},function(B,J,he){return $.optional(function(){B.assert(J,he+'==="cw"||'+he+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),J.def(he+'==="cw"?'+Xt+":"+nr)});case Ns:return ee(function(B){return $.command($i(B)&&B.length===4,"color.mask must be length 4 array",h.commandStr),B.map(function(J){return!!J})},function(B,J,he){return $.optional(function(){B.assert(J,B.shared.isArrayLike+"("+he+")&&"+he+".length===4","invalid color.mask")}),W(4,function(Ye){return"!!"+he+"["+Ye+"]"})});case sc:return ee(function(B){$.command(typeof B=="object"&&B,N,h.commandStr);var J="value"in B?B.value:1,he=!!B.invert;return $.command(typeof J=="number"&&J>=0&&J<=1,"sample.coverage.value must be a number between 0 and 1",h.commandStr),[J,he]},function(B,J,he){$.optional(function(){B.assert(J,he+"&&typeof "+he+'==="object"',"invalid sample.coverage")});var Ye=J.def('"value" in ',he,"?+",he,".value:1"),He=J.def("!!",he,".invert");return[Ye,He]})}}),y}function ys(v,h){var c=v.static,p=v.dynamic,y={};return Object.keys(c).forEach(function(P){var N=c[P],ee;if(typeof N=="number"||typeof N=="boolean")ee=Ea(function(){return N});else if(typeof N=="function"){var B=N._reglType;B==="texture2d"||B==="textureCube"?ee=Ea(function(J){return J.link(N)}):B==="framebuffer"||B==="framebufferCube"?($.command(N.color.length>0,'missing color attachment for framebuffer sent to uniform "'+P+'"',h.commandStr),ee=Ea(function(J){return J.link(N.color[0])})):$.commandRaise('invalid data for uniform "'+P+'"',h.commandStr)}else $i(N)?ee=Ea(function(J){var he=J.global.def("[",W(N.length,function(Ye){return $.command(typeof N[Ye]=="number"||typeof N[Ye]=="boolean","invalid uniform "+P,J.commandStr),N[Ye]}),"]");return he}):$.commandRaise('invalid or missing data for uniform "'+P+'"',h.commandStr);ee.value=N,y[P]=ee}),Object.keys(p).forEach(function(P){var N=p[P];y[P]=Io(N,function(ee,B){return ee.invoke(B,N)})}),y}function Va(v,h){var c=v.static,p=v.dynamic,y={};return Object.keys(c).forEach(function(P){var N=c[P],ee=je.id(P),B=new yr;if(fo(N))B.state=Pn,B.buffer=Mr.getBuffer(Mr.create(N,el,!1,!0)),B.type=0;else{var J=Mr.getBuffer(N);if(J)B.state=Pn,B.buffer=J,B.type=0;else if($.command(typeof N=="object"&&N,"invalid data for attribute "+P,h.commandStr),"constant"in N){var he=N.constant;B.buffer="null",B.state=Jn,typeof he=="number"?B.x=he:($.command($i(he)&&he.length>0&&he.length<=4,"invalid constant for attribute "+P,h.commandStr),Xr.forEach(function(_r,un){un<he.length&&(B[_r]=he[un])}))}else{fo(N.buffer)?J=Mr.getBuffer(Mr.create(N.buffer,el,!1,!0)):J=Mr.getBuffer(N.buffer),$.command(!!J,'missing buffer for attribute "'+P+'"',h.commandStr);var Ye=N.offset|0;$.command(Ye>=0,'invalid offset for attribute "'+P+'"',h.commandStr);var He=N.stride|0;$.command(He>=0&&He<256,'invalid stride for attribute "'+P+'", must be integer betweeen [0, 255]',h.commandStr);var It=N.size|0;$.command(!("size"in N)||It>0&&It<=4,'invalid size for attribute "'+P+'", must be 1,2,3,4',h.commandStr);var Ft=!!N.normalized,Yt=0;"type"in N&&($.commandParameter(N.type,uo,"invalid type for attribute "+P,h.commandStr),Yt=uo[N.type]);var lr=N.divisor|0;"divisor"in N&&($.command(lr===0||Zr,'cannot specify divisor for attribute "'+P+'", instancing not supported',h.commandStr),$.command(lr>=0,'invalid divisor for attribute "'+P+'"',h.commandStr)),$.optional(function(){var _r=h.commandStr,un=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(N).forEach(function(Nr){$.command(un.indexOf(Nr)>=0,'unknown parameter "'+Nr+'" for attribute pointer "'+P+'" (valid parameters are '+un+")",_r)})}),B.buffer=J,B.state=Pn,B.size=It,B.normalized=Ft,B.type=Yt||J.dtype,B.offset=Ye,B.stride=He,B.divisor=lr}}y[P]=Ea(function(_r,un){var Nr=_r.attribCache;if(ee in Nr)return Nr[ee];var rn={isStream:!1};return Object.keys(B).forEach(function(yn){rn[yn]=B[yn]}),B.buffer&&(rn.buffer=_r.link(B.buffer),rn.type=rn.type||rn.buffer+".dtype"),Nr[ee]=rn,rn})}),Object.keys(p).forEach(function(P){var N=p[P];function ee(B,J){var he=B.invoke(J,N),Ye=B.shared,He=B.constants,It=Ye.isBufferArgs,Ft=Ye.buffer;$.optional(function(){B.assert(J,he+"&&(typeof "+he+'==="object"||typeof '+he+'==="function")&&('+It+"("+he+")||"+Ft+".getBuffer("+he+")||"+Ft+".getBuffer("+he+".buffer)||"+It+"("+he+'.buffer)||("constant" in '+he+"&&(typeof "+he+'.constant==="number"||'+Ye.isArrayLike+"("+he+".constant))))",'invalid dynamic attribute "'+P+'"')});var Yt={isStream:J.def(!1)},lr=new yr;lr.state=Pn,Object.keys(lr).forEach(function(rn){Yt[rn]=J.def(""+lr[rn])});var _r=Yt.buffer,un=Yt.type;J("if(",It,"(",he,")){",Yt.isStream,"=true;",_r,"=",Ft,".createStream(",el,",",he,");",un,"=",_r,".dtype;","}else{",_r,"=",Ft,".getBuffer(",he,");","if(",_r,"){",un,"=",_r,".dtype;",'}else if("constant" in ',he,"){",Yt.state,"=",Jn,";","if(typeof "+he+'.constant === "number"){',Yt[Xr[0]],"=",he,".constant;",Xr.slice(1).map(function(rn){return Yt[rn]}).join("="),"=0;","}else{",Xr.map(function(rn,yn){return Yt[rn]+"="+he+".constant.length>"+yn+"?"+he+".constant["+yn+"]:0;"}).join(""),"}}else{","if(",It,"(",he,".buffer)){",_r,"=",Ft,".createStream(",el,",",he,".buffer);","}else{",_r,"=",Ft,".getBuffer(",he,".buffer);","}",un,'="type" in ',he,"?",He.glTypes,"[",he,".type]:",_r,".dtype;",Yt.normalized,"=!!",he,".normalized;");function Nr(rn){J(Yt[rn],"=",he,".",rn,"|0;")}return Nr("size"),Nr("offset"),Nr("stride"),Nr("divisor"),J("}}"),J.exit("if(",Yt.isStream,"){",Ft,".destroyStream(",_r,");","}"),Yt}y[P]=Io(N,ee)}),y}function xo(v,h){var c=v.static,p=v.dynamic;if(qu in c){var y=c[qu];return y!==null&&en.getVAO(y)===null&&(y=en.createVAO(y)),Ea(function(N){return N.link(en.getVAO(y))})}else if(qu in p){var P=p[qu];return Io(P,function(N,ee){var B=N.invoke(ee,P);return ee.def(N.shared.vao+".getVAO("+B+")")})}return null}function Mi(v){var h=v.static,c=v.dynamic,p={};return Object.keys(h).forEach(function(y){var P=h[y];p[y]=Ea(function(N,ee){return typeof P=="number"||typeof P=="boolean"?""+P:N.link(P)})}),Object.keys(c).forEach(function(y){var P=c[y];p[y]=Io(P,function(N,ee){return N.invoke(ee,P)})}),p}function bs(v,h,c,p,y){var P=v.static,N=v.dynamic;$.optional(function(){var Nr=[Po,Jo,yo,Fo,Gs,Hc,wl,Gl,Mo,qu].concat(Qr);function rn(yn){Object.keys(yn).forEach(function(Vn){$.command(Nr.indexOf(Vn)>=0,'unknown parameter "'+Vn+'"',y.commandStr)})}rn(P),rn(N)});var ee=Sa(v,h),B=jn(v,y),J=Fa(v,B,y),he=fi(v,y),Ye=Bo(v,y),He=Ua(v,y,ee);function It(Nr){var rn=J[Nr];rn&&(Ye[Nr]=rn)}It(Oo),It(Yr(Eu));var Ft=Object.keys(Ye).length>0,Yt={framebuffer:B,draw:he,shader:He,state:Ye,dirty:Ft,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Yt.profile=ca(v,y),Yt.uniforms=ys(c,y),Yt.drawVAO=Yt.scopeVAO=xo(v,y),!Yt.drawVAO&&He.program&&!ee&&bt.angle_instanced_arrays){var lr=!0,_r=He.program.attributes.map(function(Nr){var rn=h.static[Nr];return lr=lr&&!!rn,rn});if(lr&&_r.length>0){var un=en.getVAO(en.createVAO(_r));Yt.drawVAO=new Si(null,null,null,function(Nr,rn){return Nr.link(un)}),Yt.useVAO=!0}}return ee?Yt.useVAO=!0:Yt.attributes=Va(h,y),Yt.context=Mi(p,y),Yt}function is(v,h,c){var p=v.shared,y=p.context,P=v.scope();Object.keys(c).forEach(function(N){h.save(y,"."+N);var ee=c[N],B=ee.append(v,h);Array.isArray(B)?P(y,".",N,"=[",B.join(),"];"):P(y,".",N,"=",B,";")}),h(P)}function os(v,h,c,p){var y=v.shared,P=y.gl,N=y.framebuffer,ee;On&&(ee=h.def(y.extensions,".webgl_draw_buffers"));var B=v.constants,J=B.drawBuffer,he=B.backBuffer,Ye;c?Ye=c.append(v,h):Ye=h.def(N,".next"),p||h("if(",Ye,"!==",N,".cur){"),h("if(",Ye,"){",P,".bindFramebuffer(",Oi,",",Ye,".framebuffer);"),On&&h(ee,".drawBuffersWEBGL(",J,"[",Ye,".colorAttachments.length]);"),h("}else{",P,".bindFramebuffer(",Oi,",null);"),On&&h(ee,".drawBuffersWEBGL(",he,");"),h("}",N,".cur=",Ye,";"),p||h("}")}function ss(v,h,c){var p=v.shared,y=p.gl,P=v.current,N=v.next,ee=p.current,B=p.next,J=v.cond(ee,".dirty");Qr.forEach(function(he){var Ye=Yr(he);if(Ye in c.state)return;var He,It;if(Ye in N){He=N[Ye],It=P[Ye];var Ft=W(Lr[Ye].length,function(lr){return J.def(He,"[",lr,"]")});J(v.cond(Ft.map(function(lr,_r){return lr+"!=="+It+"["+_r+"]"}).join("||")).then(y,".",Br[Ye],"(",Ft,");",Ft.map(function(lr,_r){return It+"["+_r+"]="+lr}).join(";"),";"))}else{He=J.def(B,".",Ye);var Yt=v.cond(He,"!==",ee,".",Ye);J(Yt),Ye in zr?Yt(v.cond(He).then(y,".enable(",zr[Ye],");").else(y,".disable(",zr[Ye],");"),ee,".",Ye,"=",He,";"):Yt(y,".",Br[Ye],"(",He,");",ee,".",Ye,"=",He,";")}}),Object.keys(c.state).length===0&&J(ee,".dirty=false;"),h(J)}function Ws(v,h,c,p){var y=v.shared,P=v.current,N=y.current,ee=y.gl;au(Object.keys(c)).forEach(function(B){var J=c[B];if(p&&!p(J))return;var he=J.append(v,h);if(zr[B]){var Ye=zr[B];Ui(J)?he?h(ee,".enable(",Ye,");"):h(ee,".disable(",Ye,");"):h(v.cond(he).then(ee,".enable(",Ye,");").else(ee,".disable(",Ye,");")),h(N,".",B,"=",he,";")}else if($i(he)){var He=P[B];h(ee,".",Br[B],"(",he,");",he.map(function(It,Ft){return He+"["+Ft+"]="+It}).join(";"),";")}else h(ee,".",Br[B],"(",he,");",N,".",B,"=",he,";")})}function Vo(v,h){Zr&&(v.instancing=h.def(v.shared.extensions,".angle_instanced_arrays"))}function ea(v,h,c,p,y){var P=v.shared,N=v.stats,ee=P.current,B=P.timer,J=c.profile;function he(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Ye,He;function It(Nr){Ye=h.def(),Nr(Ye,"=",he(),";"),typeof y=="string"?Nr(N,".count+=",y,";"):Nr(N,".count++;"),pn&&(p?(He=h.def(),Nr(He,"=",B,".getNumPendingQueries();")):Nr(B,".beginQuery(",N,");"))}function Ft(Nr){Nr(N,".cpuTime+=",he(),"-",Ye,";"),pn&&(p?Nr(B,".pushScopeStats(",He,",",B,".getNumPendingQueries(),",N,");"):Nr(B,".endQuery();"))}function Yt(Nr){var rn=h.def(ee,".profile");h(ee,".profile=",Nr,";"),h.exit(ee,".profile=",rn,";")}var lr;if(J){if(Ui(J)){J.enable?(It(h),Ft(h.exit),Yt("true")):Yt("false");return}lr=J.append(v,h),Yt(lr)}else lr=h.def(ee,".profile");var _r=v.block();It(_r),h("if(",lr,"){",_r,"}");var un=v.block();Ft(un),h.exit("if(",lr,"){",un,"}")}function Tu(v,h,c,p,y){var P=v.shared;function N(B){switch(B){case ff:case Zc:case Af:return 2;case no:case nu:case Xc:return 3;case Hl:case Ol:case df:return 4;default:return 1}}function ee(B,J,he){var Ye=P.gl,He=h.def(B,".location"),It=h.def(P.attributes,"[",He,"]"),Ft=he.state,Yt=he.buffer,lr=[he.x,he.y,he.z,he.w],_r=["buffer","normalized","offset","stride"];function un(){h("if(!",It,".buffer){",Ye,".enableVertexAttribArray(",He,");}");var rn=he.type,yn;if(he.size?yn=h.def(he.size,"||",J):yn=J,h("if(",It,".type!==",rn,"||",It,".size!==",yn,"||",_r.map(function(ua){return It+"."+ua+"!=="+he[ua]}).join("||"),"){",Ye,".bindBuffer(",el,",",Yt,".buffer);",Ye,".vertexAttribPointer(",[He,yn,rn,he.normalized,he.stride,he.offset],");",It,".type=",rn,";",It,".size=",yn,";",_r.map(function(ua){return It+"."+ua+"="+he[ua]+";"}).join(""),"}"),Zr){var Vn=he.divisor;h("if(",It,".divisor!==",Vn,"){",v.instancing,".vertexAttribDivisorANGLE(",[He,Vn],");",It,".divisor=",Vn,";}")}}function Nr(){h("if(",It,".buffer){",Ye,".disableVertexAttribArray(",He,");",It,".buffer=null;","}if(",Xr.map(function(rn,yn){return It+"."+rn+"!=="+lr[yn]}).join("||"),"){",Ye,".vertexAttrib4f(",He,",",lr,");",Xr.map(function(rn,yn){return It+"."+rn+"="+lr[yn]+";"}).join(""),"}")}Ft===Pn?un():Ft===Jn?Nr():(h("if(",Ft,"===",Pn,"){"),un(),h("}else{"),Nr(),h("}"))}p.forEach(function(B){var J=B.name,he=c.attributes[J],Ye;if(he){if(!y(he))return;Ye=he.append(v,h)}else{if(!y(hc))return;var He=v.scopeAttrib(J);$.optional(function(){v.assert(h,He+".state","missing attribute "+J)}),Ye={},Object.keys(new yr).forEach(function(It){Ye[It]=h.def(He,".",It)})}ee(v.link(B),N(B.info.type),Ye)})}function xi(v,h,c,p,y){for(var P=v.shared,N=P.gl,ee,B=0;B<p.length;++B){var J=p[B],he=J.name,Ye=J.info.type,He=c.uniforms[he],It=v.link(J),Ft=It+".location",Yt;if(He){if(!y(He))continue;if(Ui(He)){var lr=He.value;if($.command(lr!==null&&typeof lr!="undefined",'missing uniform "'+he+'"',v.commandStr),Ye===se||Ye===k){$.command(typeof lr=="function"&&(Ye===se&&(lr._reglType==="texture2d"||lr._reglType==="framebuffer")||Ye===k&&(lr._reglType==="textureCube"||lr._reglType==="framebufferCube")),"invalid texture for uniform "+he,v.commandStr);var _r=v.link(lr._texture||lr.color[0]._texture);h(N,".uniform1i(",Ft,",",_r+".bind());"),h.exit(_r,".unbind();")}else if(Ye===Yc||Ye===Wl||Ye===ne){$.optional(function(){$.command($i(lr),"invalid matrix for uniform "+he,v.commandStr),$.command(Ye===Yc&&lr.length===4||Ye===Wl&&lr.length===9||Ye===ne&&lr.length===16,"invalid length for matrix uniform "+he,v.commandStr)});var un=v.global.def("new Float32Array(["+Array.prototype.slice.call(lr)+"])"),Nr=2;Ye===Wl?Nr=3:Ye===ne&&(Nr=4),h(N,".uniformMatrix",Nr,"fv(",Ft,",false,",un,");")}else{switch(Ye){case fc:$.commandType(lr,"number","uniform "+he,v.commandStr),ee="1f";break;case ff:$.command($i(lr)&&lr.length===2,"uniform "+he,v.commandStr),ee="2f";break;case no:$.command($i(lr)&&lr.length===3,"uniform "+he,v.commandStr),ee="3f";break;case Hl:$.command($i(lr)&&lr.length===4,"uniform "+he,v.commandStr),ee="4f";break;case Sf:$.commandType(lr,"boolean","uniform "+he,v.commandStr),ee="1i";break;case hf:$.commandType(lr,"number","uniform "+he,v.commandStr),ee="1i";break;case Af:$.command($i(lr)&&lr.length===2,"uniform "+he,v.commandStr),ee="2i";break;case Zc:$.command($i(lr)&&lr.length===2,"uniform "+he,v.commandStr),ee="2i";break;case Xc:$.command($i(lr)&&lr.length===3,"uniform "+he,v.commandStr),ee="3i";break;case nu:$.command($i(lr)&&lr.length===3,"uniform "+he,v.commandStr),ee="3i";break;case df:$.command($i(lr)&&lr.length===4,"uniform "+he,v.commandStr),ee="4i";break;case Ol:$.command($i(lr)&&lr.length===4,"uniform "+he,v.commandStr),ee="4i";break}h(N,".uniform",ee,"(",Ft,",",$i(lr)?Array.prototype.slice.call(lr):lr,");")}continue}else Yt=He.append(v,h)}else{if(!y(hc))continue;Yt=h.def(P.uniforms,"[",je.id(he),"]")}Ye===se?($(!Array.isArray(Yt),"must specify a scalar prop for textures"),h("if(",Yt,"&&",Yt,'._reglType==="framebuffer"){',Yt,"=",Yt,".color[0];","}")):Ye===k&&($(!Array.isArray(Yt),"must specify a scalar prop for cube maps"),h("if(",Yt,"&&",Yt,'._reglType==="framebufferCube"){',Yt,"=",Yt,".color[0];","}")),$.optional(function(){function ma(Qo,_u){v.assert(h,Qo,'bad data or missing for uniform "'+he+'".  '+_u)}function Pi(Qo){$(!Array.isArray(Yt),"must not specify an array type for uniform"),ma("typeof "+Yt+'==="'+Qo+'"',"invalid type, expected "+Qo)}function Ha(Qo,_u){Array.isArray(Yt)?$(Yt.length===Qo,"must have length "+Qo):ma(P.isArrayLike+"("+Yt+")&&"+Yt+".length==="+Qo,"invalid vector, should have length "+Qo,v.commandStr)}function Ho(Qo){$(!Array.isArray(Yt),"must not specify a value type"),ma("typeof "+Yt+'==="function"&&'+Yt+'._reglType==="texture'+(Qo===Fu?"2d":"Cube")+'"',"invalid texture type",v.commandStr)}switch(Ye){case hf:Pi("number");break;case Zc:Ha(2,"number");break;case nu:Ha(3,"number");break;case Ol:Ha(4,"number");break;case fc:Pi("number");break;case ff:Ha(2,"number");break;case no:Ha(3,"number");break;case Hl:Ha(4,"number");break;case Sf:Pi("boolean");break;case Af:Ha(2,"boolean");break;case Xc:Ha(3,"boolean");break;case df:Ha(4,"boolean");break;case Yc:Ha(4,"number");break;case Wl:Ha(9,"number");break;case ne:Ha(16,"number");break;case se:Ho(Fu);break;case k:Ho(cc);break}});var rn=1;switch(Ye){case se:case k:var yn=h.def(Yt,"._texture");h(N,".uniform1i(",Ft,",",yn,".bind());"),h.exit(yn,".unbind();");continue;case hf:case Sf:ee="1i";break;case Zc:case Af:ee="2i",rn=2;break;case nu:case Xc:ee="3i",rn=3;break;case Ol:case df:ee="4i",rn=4;break;case fc:ee="1f";break;case ff:ee="2f",rn=2;break;case no:ee="3f",rn=3;break;case Hl:ee="4f",rn=4;break;case Yc:ee="Matrix2fv";break;case Wl:ee="Matrix3fv";break;case ne:ee="Matrix4fv";break}if(h(N,".uniform",ee,"(",Ft,","),ee.charAt(0)==="M"){var Vn=Math.pow(Ye-Yc+2,2),ua=v.global.def("new Float32Array(",Vn,")");Array.isArray(Yt)?h("false,(",W(Vn,function(ma){return ua+"["+ma+"]="+Yt[ma]}),",",ua,")"):h("false,(Array.isArray(",Yt,")||",Yt," instanceof Float32Array)?",Yt,":(",W(Vn,function(ma){return ua+"["+ma+"]="+Yt+"["+ma+"]"}),",",ua,")")}else rn>1?h(W(rn,function(ma){return Array.isArray(Yt)?Yt[ma]:Yt+"["+ma+"]"})):($(!Array.isArray(Yt),"uniform value must not be an array"),h(Yt));h(");")}}function Cn(v,h,c,p){var y=v.shared,P=y.gl,N=y.draw,ee=p.draw;function B(){var yn=ee.elements,Vn,ua=h;return yn?((yn.contextDep&&p.contextDynamic||yn.propDep)&&(ua=c),Vn=yn.append(v,ua)):Vn=ua.def(N,".",Fo),Vn&&ua("if("+Vn+")"+P+".bindBuffer("+_f+","+Vn+".buffer.buffer);"),Vn}function J(){var yn=ee.count,Vn,ua=h;return yn?((yn.contextDep&&p.contextDynamic||yn.propDep)&&(ua=c),Vn=yn.append(v,ua),$.optional(function(){yn.MISSING&&v.assert(h,"false","missing vertex count"),yn.DYNAMIC&&v.assert(ua,Vn+">=0","missing vertex count")})):(Vn=ua.def(N,".",wl),$.optional(function(){v.assert(ua,Vn+">=0","missing vertex count")})),Vn}var he=B();function Ye(yn){var Vn=ee[yn];return Vn?Vn.contextDep&&p.contextDynamic||Vn.propDep?Vn.append(v,c):Vn.append(v,h):h.def(N,".",yn)}var He=Ye(Gs),It=Ye(Hc),Ft=J();if(typeof Ft=="number"){if(Ft===0)return}else c("if(",Ft,"){"),c.exit("}");var Yt,lr;Zr&&(Yt=Ye(Gl),lr=v.instancing);var _r=he+".type",un=ee.elements&&Ui(ee.elements);function Nr(){function yn(){c(lr,".drawElementsInstancedANGLE(",[He,Ft,_r,It+"<<(("+_r+"-"+gn+")>>1)",Yt],");")}function Vn(){c(lr,".drawArraysInstancedANGLE(",[He,It,Ft,Yt],");")}he?un?yn():(c("if(",he,"){"),yn(),c("}else{"),Vn(),c("}")):Vn()}function rn(){function yn(){c(P+".drawElements("+[He,Ft,_r,It+"<<(("+_r+"-"+gn+")>>1)"]+");")}function Vn(){c(P+".drawArrays("+[He,It,Ft]+");")}he?un?yn():(c("if(",he,"){"),yn(),c("}else{"),Vn(),c("}")):Vn()}Zr&&(typeof Yt!="number"||Yt>=0)?typeof Yt=="string"?(c("if(",Yt,">0){"),Nr(),c("}else if(",Yt,"<0){"),rn(),c("}")):Nr():rn()}function ga(v,h,c,p,y){var P=pa(),N=P.proc("body",y);return $.optional(function(){P.commandStr=h.commandStr,P.command=P.link(h.commandStr)}),Zr&&(P.instancing=N.def(P.shared.extensions,".angle_instanced_arrays")),v(P,N,c,p),P.compile().body}function Ga(v,h,c,p){Vo(v,h),c.useVAO?c.drawVAO?h(v.shared.vao,".setVAO(",c.drawVAO.append(v,h),");"):h(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(h(v.shared.vao,".setVAO(null);"),Tu(v,h,c,p.attributes,function(){return!0})),xi(v,h,c,p.uniforms,function(){return!0}),Cn(v,h,h,c)}function Go(v,h){var c=v.proc("draw",1);Vo(v,c),is(v,c,h.context),os(v,c,h.framebuffer),ss(v,c,h),Ws(v,c,h.state),ea(v,c,h,!1,!0);var p=h.shader.progVar.append(v,c);if(c(v.shared.gl,".useProgram(",p,".program);"),h.shader.program)Ga(v,c,h,h.shader.program);else{c(v.shared.vao,".setVAO(null);");var y=v.global.def("{}"),P=c.def(p,".id"),N=c.def(y,"[",P,"]");c(v.cond(N).then(N,".call(this,a0);").else(N,"=",y,"[",P,"]=",v.link(function(ee){return ga(Ga,v,h,ee,1)}),"(",p,");",N,".call(this,a0);"))}Object.keys(h.state).length>0&&c(v.shared.current,".dirty=true;")}function iu(v,h,c,p){v.batchId="a1",Vo(v,h);function y(){return!0}Tu(v,h,c,p.attributes,y),xi(v,h,c,p.uniforms,y),Cn(v,h,h,c)}function Mc(v,h,c,p){Vo(v,h);var y=c.contextDep,P=h.def(),N="a0",ee="a1",B=h.def();v.shared.props=B,v.batchId=P;var J=v.scope(),he=v.scope();h(J.entry,"for(",P,"=0;",P,"<",ee,";++",P,"){",B,"=",N,"[",P,"];",he,"}",J.exit);function Ye(_r){return _r.contextDep&&y||_r.propDep}function He(_r){return!Ye(_r)}if(c.needsContext&&is(v,he,c.context),c.needsFramebuffer&&os(v,he,c.framebuffer),Ws(v,he,c.state,Ye),c.profile&&Ye(c.profile)&&ea(v,he,c,!1,!0),p)c.useVAO?c.drawVAO?Ye(c.drawVAO)?he(v.shared.vao,".setVAO(",c.drawVAO.append(v,he),");"):J(v.shared.vao,".setVAO(",c.drawVAO.append(v,J),");"):J(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(J(v.shared.vao,".setVAO(null);"),Tu(v,J,c,p.attributes,He),Tu(v,he,c,p.attributes,Ye)),xi(v,J,c,p.uniforms,He),xi(v,he,c,p.uniforms,Ye),Cn(v,J,he,c);else{var It=v.global.def("{}"),Ft=c.shader.progVar.append(v,he),Yt=he.def(Ft,".id"),lr=he.def(It,"[",Yt,"]");he(v.shared.gl,".useProgram(",Ft,".program);","if(!",lr,"){",lr,"=",It,"[",Yt,"]=",v.link(function(_r){return ga(iu,v,c,_r,2)}),"(",Ft,");}",lr,".call(this,a0[",P,"],",P,");")}}function Mt(v,h){var c=v.proc("batch",2);v.batchId="0",Vo(v,c);var p=!1,y=!0;Object.keys(h.context).forEach(function(It){p=p||h.context[It].propDep}),p||(is(v,c,h.context),y=!1);var P=h.framebuffer,N=!1;P?(P.propDep?p=N=!0:P.contextDep&&p&&(N=!0),N||os(v,c,P)):os(v,c,null),h.state.viewport&&h.state.viewport.propDep&&(p=!0);function ee(It){return It.contextDep&&p||It.propDep}ss(v,c,h),Ws(v,c,h.state,function(It){return!ee(It)}),(!h.profile||!ee(h.profile))&&ea(v,c,h,!1,"a1"),h.contextDep=p,h.needsContext=y,h.needsFramebuffer=N;var B=h.shader.progVar;if(B.contextDep&&p||B.propDep)Mc(v,c,h,null);else{var J=B.append(v,c);if(c(v.shared.gl,".useProgram(",J,".program);"),h.shader.program)Mc(v,c,h,h.shader.program);else{c(v.shared.vao,".setVAO(null);");var he=v.global.def("{}"),Ye=c.def(J,".id"),He=c.def(he,"[",Ye,"]");c(v.cond(He).then(He,".call(this,a0,a1);").else(He,"=",he,"[",Ye,"]=",v.link(function(It){return ga(Mc,v,h,It,2)}),"(",J,");",He,".call(this,a0,a1);"))}}Object.keys(h.state).length>0&&c(v.shared.current,".dirty=true;")}function xr(v,h){var c=v.proc("scope",3);v.batchId="a2";var p=v.shared,y=p.current;is(v,c,h.context),h.framebuffer&&h.framebuffer.append(v,c),au(Object.keys(h.state)).forEach(function(N){var ee=h.state[N],B=ee.append(v,c);$i(B)?B.forEach(function(J,he){c.set(v.next[N],"["+he+"]",J)}):c.set(p.next,"."+N,B)}),ea(v,c,h,!0,!0),[Fo,Hc,wl,Gl,Gs].forEach(function(N){var ee=h.draw[N];if(!ee)return;c.set(p.draw,"."+N,""+ee.append(v,c))}),Object.keys(h.uniforms).forEach(function(N){var ee=h.uniforms[N].append(v,c);Array.isArray(ee)&&(ee="["+ee.join()+"]"),c.set(p.uniforms,"["+je.id(N)+"]",ee)}),Object.keys(h.attributes).forEach(function(N){var ee=h.attributes[N].append(v,c),B=v.scopeAttrib(N);Object.keys(new yr).forEach(function(J){c.set(B,"."+J,ee[J])})}),h.scopeVAO&&c.set(p.vao,".targetVAO",h.scopeVAO.append(v,c));function P(N){var ee=h.shader[N];ee&&c.set(p.shader,"."+N,ee.append(v,c))}P(Jo),P(yo),Object.keys(h.state).length>0&&(c(y,".dirty=true;"),c.exit(y,".dirty=true;")),c("a1(",v.shared.context,",a0,",v.batchId,");")}function mr(v){if(typeof v!="object"||$i(v))return;for(var h=Object.keys(v),c=0;c<h.length;++c)if(qe.isDynamic(v[h[c]]))return!0;return!1}function Rn(v,h,c){var p=h.static[c];if(!p||!mr(p))return;var y=v.global,P=Object.keys(p),N=!1,ee=!1,B=!1,J=v.global.def("{}");P.forEach(function(Ye){var He=p[Ye];if(qe.isDynamic(He)){typeof He=="function"&&(He=p[Ye]=qe.unbox(He));var It=Io(He,null);N=N||It.thisDep,B=B||It.propDep,ee=ee||It.contextDep}else{y(J,".",Ye,"=");switch(typeof He){case"number":y(He);break;case"string":y('"',He,'"');break;case"object":Array.isArray(He)&&y("[",He.join(),"]");break;default:y(v.link(He));break}y(";")}});function he(Ye,He){P.forEach(function(It){var Ft=p[It];if(!qe.isDynamic(Ft))return;var Yt=Ye.invoke(He,Ft);He(J,".",It,"=",Yt,";")})}h.dynamic[c]=new qe.DynamicVariable(ia,{thisDep:N,contextDep:ee,propDep:B,ref:J,append:he}),delete h.static[c]}function Na(v,h,c,p,y){var P=pa();P.stats=P.link(y),Object.keys(h.static).forEach(function(ee){Rn(P,h,ee)}),Bf.forEach(function(ee){Rn(P,v,ee)});var N=bs(v,h,c,p,P);return Go(P,N),xr(P,N),Mt(P,N),m(P.compile(),{destroy:function(){N.shader.program.destroy()}})}return{next:Qn,current:Lr,procs:function(){var v=pa(),h=v.proc("poll"),c=v.proc("refresh"),p=v.block();h(p),c(p);var y=v.shared,P=y.gl,N=y.next,ee=y.current;p(ee,".dirty=false;"),os(v,h),os(v,c,null,!0);var B;Zr&&(B=v.link(Zr)),bt.oes_vertex_array_object&&c(v.link(bt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var J=0;J<vr.maxAttributes;++J){var he=c.def(y.attributes,"[",J,"]"),Ye=v.cond(he,".buffer");Ye.then(P,".enableVertexAttribArray(",J,");",P,".bindBuffer(",el,",",he,".buffer.buffer);",P,".vertexAttribPointer(",J,",",he,".size,",he,".type,",he,".normalized,",he,".stride,",he,".offset);").else(P,".disableVertexAttribArray(",J,");",P,".vertexAttrib4f(",J,",",he,".x,",he,".y,",he,".z,",he,".w);",he,".buffer=null;"),c(Ye),Zr&&c(B,".vertexAttribDivisorANGLE(",J,",",he,".divisor);")}return c(v.shared.vao,".currentVAO=null;",v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"),Object.keys(zr).forEach(function(He){var It=zr[He],Ft=p.def(N,".",He),Yt=v.block();Yt("if(",Ft,"){",P,".enable(",It,")}else{",P,".disable(",It,")}",ee,".",He,"=",Ft,";"),c(Yt),h("if(",Ft,"!==",ee,".",He,"){",Yt,"}")}),Object.keys(Br).forEach(function(He){var It=Br[He],Ft=Lr[He],Yt,lr,_r=v.block();if(_r(P,".",It,"("),$i(Ft)){var un=Ft.length;Yt=v.global.def(N,".",He),lr=v.global.def(ee,".",He),_r(W(un,function(Nr){return Yt+"["+Nr+"]"}),");",W(un,function(Nr){return lr+"["+Nr+"]="+Yt+"["+Nr+"];"}).join("")),h("if(",W(un,function(Nr){return Yt+"["+Nr+"]!=="+lr+"["+Nr+"]"}).join("||"),"){",_r,"}")}else Yt=p.def(N,".",He),lr=p.def(ee,".",He),_r(Yt,");",ee,".",He,"=",Yt,";"),h("if(",Yt,"!==",lr,"){",_r,"}");c(_r)}),v.compile()}(),compile:Na}}function hh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Xf=34918,Uu=34919,Yf=35007,pf=function(je,bt){if(!bt.ext_disjoint_timer_query)return null;var vr=[];function Mr(){return vr.pop()||bt.ext_disjoint_timer_query.createQueryEXT()}function Cr(On){vr.push(On)}var gr=[];function Wr(On){var Lr=Mr();bt.ext_disjoint_timer_query.beginQueryEXT(Yf,Lr),gr.push(Lr),Jr(gr.length-1,gr.length,On)}function sn(){bt.ext_disjoint_timer_query.endQueryEXT(Yf)}function en(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var $r=[];function ln(){return $r.pop()||new en}function An(On){$r.push(On)}var pn=[];function Jr(On,Lr,Qn){var Qr=ln();Qr.startQueryIndex=On,Qr.endQueryIndex=Lr,Qr.sum=0,Qr.stats=Qn,pn.push(Qr)}var yr=[],hr=[];function Zr(){var On,Lr,Qn=gr.length;if(Qn===0)return;hr.length=Math.max(hr.length,Qn+1),yr.length=Math.max(yr.length,Qn+1),yr[0]=0,hr[0]=0;var Qr=0;for(On=0,Lr=0;Lr<gr.length;++Lr){var zr=gr[Lr];bt.ext_disjoint_timer_query.getQueryObjectEXT(zr,Uu)?(Qr+=bt.ext_disjoint_timer_query.getQueryObjectEXT(zr,Xf),Cr(zr)):gr[On++]=zr,yr[Lr+1]=Qr,hr[Lr+1]=On}for(gr.length=On,On=0,Lr=0;Lr<pn.length;++Lr){var Br=pn[Lr],Yr=Br.startQueryIndex,Zn=Br.endQueryIndex;Br.sum+=yr[Zn]-yr[Yr];var ra=hr[Yr],an=hr[Zn];an===ra?(Br.stats.gpuTime+=Br.sum/1e6,An(Br)):(Br.startQueryIndex=ra,Br.endQueryIndex=an,pn[On++]=Br)}pn.length=On}return{beginQuery:Wr,endQuery:sn,pushScopeStats:Jr,update:Zr,getNumPendingQueries:function(){return gr.length},clear:function(){vr.push.apply(vr,gr);for(var Lr=0;Lr<vr.length;Lr++)bt.ext_disjoint_timer_query.deleteQueryEXT(vr[Lr]);gr.length=0,vr.length=0},restore:function(){gr.length=0,vr.length=0}}},Kf=16384,Sh=256,dh=1024,Cf=34962,oh="webglcontextlost",$f="webglcontextrestored",ph=1,jh=2,wf=3;function jf(xe,je){for(var bt=0;bt<xe.length;++bt)if(xe[bt]===je)return bt;return-1}function Ah(xe){var je=Gn(xe);if(!je)return null;var bt=je.gl,vr=bt.getContextAttributes(),Mr=bt.isContextLost(),Cr=F(bt,je);if(!Cr)return null;var gr=Gr(),Wr=hh(),sn=Cr.extensions,en=pf(bt,sn),$r=pr(),ln=bt.drawingBufferWidth,An=bt.drawingBufferHeight,pn={tick:0,time:0,viewportWidth:ln,viewportHeight:An,framebufferWidth:ln,framebufferHeight:An,drawingBufferWidth:ln,drawingBufferHeight:An,pixelRatio:je.pixelRatio},Jr={},yr={elements:null,primitive:4,count:-1,offset:0,instances:-1},hr=So(bt,sn),Zr=Qa(bt,Wr,je,Lr),On=Je(bt,sn,hr,Wr,Zr);function Lr(Cn){return On.destroyBuffer(Cn)}var Qn=Dc(bt,sn,Zr,Wr),Qr=Rt(bt,gr,Wr,je),zr=$u(bt,sn,hr,function(){Zn.procs.poll()},pn,Wr,je),Br=ru(bt,sn,hr,Wr,je),Yr=j(bt,sn,hr,zr,Br,Wr),Zn=Zf(bt,gr,sn,hr,Zr,Qn,zr,Yr,Jr,On,Qr,yr,pn,en,je),ra=fr(bt,Yr,Zn.procs.poll,pn,vr,sn,hr),an=Zn.next,Hr=bt.canvas,kr=[],pa=[],ca=[],jn=[je.onDestroy],Fa=null;function Sa(){if(kr.length===0){en&&en.update(),Fa=null;return}Fa=Vt.next(Sa),Ws();for(var Cn=kr.length-1;Cn>=0;--Cn){var ga=kr[Cn];ga&&ga(pn,null,0)}bt.flush(),en&&en.update()}function Ua(){!Fa&&kr.length>0&&(Fa=Vt.next(Sa))}function fi(){Fa&&(Vt.cancel(Sa),Fa=null)}function Bo(Cn){Cn.preventDefault(),Mr=!0,fi(),pa.forEach(function(ga){ga()})}function ys(Cn){bt.getError(),Mr=!1,Cr.restore(),Qr.restore(),Zr.restore(),zr.restore(),Br.restore(),Yr.restore(),On.restore(),en&&en.restore(),Zn.procs.refresh(),Ua(),ca.forEach(function(ga){ga()})}Hr&&(Hr.addEventListener(oh,Bo,!1),Hr.addEventListener($f,ys,!1));function Va(){kr.length=0,fi(),Hr&&(Hr.removeEventListener(oh,Bo),Hr.removeEventListener($f,ys)),Qr.clear(),Yr.clear(),Br.clear(),zr.clear(),Qn.clear(),Zr.clear(),On.clear(),en&&en.clear(),jn.forEach(function(Cn){Cn()})}function xo(Cn){$(!!Cn,"invalid args to regl({...})"),$.type(Cn,"object","invalid args to regl({...})");function ga(y){var P=m({},y);delete P.uniforms,delete P.attributes,delete P.context,delete P.vao,"stencil"in P&&P.stencil.op&&(P.stencil.opBack=P.stencil.opFront=P.stencil.op,delete P.stencil.op);function N(ee){if(ee in P){var B=P[ee];delete P[ee],Object.keys(B).forEach(function(J){P[ee+"."+J]=B[J]})}}return N("blend"),N("depth"),N("cull"),N("stencil"),N("polygonOffset"),N("scissor"),N("sample"),"vao"in y&&(P.vao=y.vao),P}function Ga(y,P){var N={},ee={};return Object.keys(y).forEach(function(B){var J=y[B];if(qe.isDynamic(J)){ee[B]=qe.unbox(J,B);return}else if(P&&Array.isArray(J)){for(var he=0;he<J.length;++he)if(qe.isDynamic(J[he])){ee[B]=qe.unbox(J,B);return}}N[B]=J}),{dynamic:ee,static:N}}var Go=Ga(Cn.context||{},!0),iu=Ga(Cn.uniforms||{},!0),Mc=Ga(Cn.attributes||{},!1),Mt=Ga(ga(Cn),!1),xr={gpuTime:0,cpuTime:0,count:0},mr=Zn.compile(Mt,Mc,iu,Go,xr),Rn=mr.draw,Na=mr.batch,v=mr.scope,h=[];function c(y){for(;h.length<y;)h.push(null);return h}function p(y,P){var N;if(Mr&&$.raise("context lost"),typeof y=="function")return v.call(this,null,y,0);if(typeof P=="function")if(typeof y=="number")for(N=0;N<y;++N)v.call(this,null,P,N);else if(Array.isArray(y))for(N=0;N<y.length;++N)v.call(this,y[N],P,N);else return v.call(this,y,P,0);else if(typeof y=="number"){if(y>0)return Na.call(this,c(y|0),y|0)}else if(Array.isArray(y)){if(y.length)return Na.call(this,y,y.length)}else return Rn.call(this,y)}return m(p,{stats:xr,destroy:function(){mr.destroy()}})}var Mi=Yr.setFBO=xo({framebuffer:qe.define.call(null,ph,"framebuffer")});function bs(Cn,ga){var Ga=0;Zn.procs.poll();var Go=ga.color;Go&&(bt.clearColor(+Go[0]||0,+Go[1]||0,+Go[2]||0,+Go[3]||0),Ga|=Kf),"depth"in ga&&(bt.clearDepth(+ga.depth),Ga|=Sh),"stencil"in ga&&(bt.clearStencil(ga.stencil|0),Ga|=dh),$(!!Ga,"called regl.clear with no buffer specified"),bt.clear(Ga)}function is(Cn){if($(typeof Cn=="object"&&Cn,"regl.clear() takes an object as input"),"framebuffer"in Cn)if(Cn.framebuffer&&Cn.framebuffer_reglType==="framebufferCube")for(var ga=0;ga<6;++ga)Mi(m({framebuffer:Cn.framebuffer.faces[ga]},Cn),bs);else Mi(Cn,bs);else bs(null,Cn)}function os(Cn){$.type(Cn,"function","regl.frame() callback must be a function"),kr.push(Cn);function ga(){var Ga=jf(kr,Cn);$(Ga>=0,"cannot cancel a frame twice");function Go(){var iu=jf(kr,Go);kr[iu]=kr[kr.length-1],kr.length-=1,kr.length<=0&&fi()}kr[Ga]=Go}return Ua(),{cancel:ga}}function ss(){var Cn=an.viewport,ga=an.scissor_box;Cn[0]=Cn[1]=ga[0]=ga[1]=0,pn.viewportWidth=pn.framebufferWidth=pn.drawingBufferWidth=Cn[2]=ga[2]=bt.drawingBufferWidth,pn.viewportHeight=pn.framebufferHeight=pn.drawingBufferHeight=Cn[3]=ga[3]=bt.drawingBufferHeight}function Ws(){pn.tick+=1,pn.time=ea(),ss(),Zn.procs.poll()}function Vo(){zr.refresh(),ss(),Zn.procs.refresh(),en&&en.update()}function ea(){return(pr()-$r)/1e3}Vo();function Tu(Cn,ga){$.type(ga,"function","listener callback must be a function");var Ga;switch(Cn){case"frame":return os(ga);case"lost":Ga=pa;break;case"restore":Ga=ca;break;case"destroy":Ga=jn;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ga.push(ga),{cancel:function(){for(var iu=0;iu<Ga.length;++iu)if(Ga[iu]===ga){Ga[iu]=Ga[Ga.length-1],Ga.pop();return}}}}var xi=m(xo,{clear:is,prop:qe.define.bind(null,ph),context:qe.define.bind(null,jh),this:qe.define.bind(null,wf),draw:xo({}),buffer:function(ga){return Zr.create(ga,Cf,!1,!1)},elements:function(ga){return Qn.create(ga,!1)},texture:zr.create2D,cube:zr.createCube,renderbuffer:Br.create,framebuffer:Yr.create,framebufferCube:Yr.createCube,vao:On.createVAO,attributes:vr,frame:os,on:Tu,limits:hr,hasExtension:function(ga){return hr.extensions.indexOf(ga.toLowerCase())>=0},read:ra,destroy:Va,_gl:bt,_refresh:Vo,poll:function(){Ws(),en&&en.update()},now:ea,stats:Wr});return je.onDone(null,xi),xi}return Ah})},fdMe:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.callback;return z&&(m.dataArray=m.dataArray.map(z)),m}},fo6e:function(Re,E){var i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function T(m){return i.test(m)}Re.exports=T},g4R6:function(Re,E){function i(T,m,X){return T===T&&(X!==void 0&&(T=T<=X?T:X),m!==void 0&&(T=T>=m?T:m)),T}Re.exports=i},gFfm:function(Re,E){function i(T,m){for(var X=-1,z=T==null?0:T.length;++X<z&&!(m(T[X],X,T)===!1););return T}Re.exports=i},gMG2:function(Re,E,i){"use strict";i.d(E,"a",function(){return yt});var T={},m={},X=34,z=10,o=13;function Z(_t){return new Function("d","return {"+_t.map(function(De,Ne){return JSON.stringify(De)+": d["+Ne+'] || ""'}).join(",")+"}")}function D(_t,De){var Ne=Z(_t);return function(Ue,st){return De(Ne(Ue),st,_t)}}function K(_t){var De=Object.create(null),Ne=[];return _t.forEach(function(Ue){for(var st in Ue)st in De||Ne.push(De[st]=st)}),Ne}function re(_t,De){var Ne=_t+"",Ue=Ne.length;return Ue<De?new Array(De-Ue+1).join(0)+Ne:Ne}function fe(_t){return _t<0?"-"+re(-_t,6):_t>9999?"+"+re(_t,6):re(_t,4)}function Y(_t){var De=_t.getUTCHours(),Ne=_t.getUTCMinutes(),Ue=_t.getUTCSeconds(),st=_t.getUTCMilliseconds();return isNaN(_t)?"Invalid Date":fe(_t.getUTCFullYear(),4)+"-"+re(_t.getUTCMonth()+1,2)+"-"+re(_t.getUTCDate(),2)+(st?"T"+re(De,2)+":"+re(Ne,2)+":"+re(Ue,2)+"."+re(st,3)+"Z":Ue?"T"+re(De,2)+":"+re(Ne,2)+":"+re(Ue,2)+"Z":Ne||De?"T"+re(De,2)+":"+re(Ne,2)+"Z":"")}var Fe=function(_t){var De=new RegExp('["'+_t+`
\r]`),Ne=_t.charCodeAt(0);function Ue(Q,H){var Ce,Ee,_e=st(Q,function(ve,rt){if(Ce)return Ce(ve,rt-1);Ee=ve,Ce=H?D(ve,H):Z(ve)});return _e.columns=Ee||[],_e}function st(Q,H){var Ce=[],Ee=Q.length,_e=0,ve=0,rt,$t=Ee<=0,St=!1;Q.charCodeAt(Ee-1)===z&&--Ee,Q.charCodeAt(Ee-1)===o&&--Ee;function ye(){if($t)return m;if(St)return St=!1,T;var Be,lt=_e,Pe;if(Q.charCodeAt(lt)===X){for(;_e++<Ee&&Q.charCodeAt(_e)!==X||Q.charCodeAt(++_e)===X;);return(Be=_e)>=Ee?$t=!0:(Pe=Q.charCodeAt(_e++))===z?St=!0:Pe===o&&(St=!0,Q.charCodeAt(_e)===z&&++_e),Q.slice(lt+1,Be-1).replace(/""/g,'"')}for(;_e<Ee;){if((Pe=Q.charCodeAt(Be=_e++))===z)St=!0;else if(Pe===o)St=!0,Q.charCodeAt(_e)===z&&++_e;else if(Pe!==Ne)continue;return Q.slice(lt,Be)}return $t=!0,Q.slice(lt,Ee)}for(;(rt=ye())!==m;){for(var be=[];rt!==T&&rt!==m;)be.push(rt),rt=ye();if(H&&(be=H(be,ve++))==null)continue;Ce.push(be)}return Ce}function Le(Q,H){return Q.map(function(Ce){return H.map(function(Ee){return oe(Ce[Ee])}).join(_t)})}function ut(Q,H){return H==null&&(H=K(Q)),[H.map(oe).join(_t)].concat(Le(Q,H)).join(`
`)}function Gt(Q,H){return H==null&&(H=K(Q)),Le(Q,H).join(`
`)}function Kt(Q){return Q.map(ar).join(`
`)}function ar(Q){return Q.map(oe).join(_t)}function oe(Q){return Q==null?"":Q instanceof Date?Y(Q):De.test(Q+="")?'"'+Q.replace(/"/g,'""')+'"':Q}return{parse:Ue,parseRows:st,format:ut,formatBody:Gt,formatRows:Kt,formatRow:ar,formatValue:oe}},We=Fe(","),ge=We.parse,we=We.parseRows,dt=We.format,ke=We.formatBody,Et=We.formatRows,Ze=We.formatRow,vt=We.formatValue,Qe=i("5zYK");function yt(_t,De){var Ne=ge(_t);return Object(Qe.a)(Ne,De)}},gQMU:function(Re,E,i){var T=i("0ZTe"),m=T("toUpperCase");Re.exports=m},gzZq:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("D9lx"),z=i("LKzl"),o=function(){function Z(D){this._binding=D}return Z.prototype.to=function(D){return this._binding.type=m.BindingTypeEnum.Instance,this._binding.implementationType=D,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+T.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},Z.prototype.toConstantValue=function(D){return this._binding.type=m.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(D){return this._binding.type=m.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(D){return this._binding.type=m.BindingTypeEnum.Constructor,this._binding.implementationType=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(T.INVALID_FUNCTION_BINDING);var K=this.toConstantValue(D);return this._binding.type=m.BindingTypeEnum.Function,K},Z.prototype.toAutoFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=function(K){var re=function(){return K.container.get(D)};return re},new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(D){return this._binding.type=m.BindingTypeEnum.Provider,this._binding.provider=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(D){this.toDynamicValue(function(K){return K.container.get(D)})},Z}();E.BindingToSyntax=o},h1nZ:function(Re,E,i){"use strict";var T=i("fX6N");i.d(E,"container",function(){return T.c}),i.d(E,"createSceneContainer",function(){return T.b}),i.d(E,"createLayerContainer",function(){return T.a}),i.d(E,"lazyInject",function(){return T.d});var m=i("+em5"),X=i("bB6j");i.d(E,"TYPES",function(){return X.a});var z=i("8/Fi"),o=i("PUg6");i.d(E,"BlendType",function(){return o.a});var Z=i("cZlC");i.d(E,"AttributeType",function(){return Z.a}),i.d(E,"ScaleTypes",function(){return Z.b}),i.d(E,"StyleScaleType",function(){return Z.c});var D=i("O1je"),K=i.n(D);i.o(D,"CameraUniform")&&i.d(E,"CameraUniform",function(){return D.CameraUniform}),i.o(D,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return D.CityBuildingLayer}),i.o(D,"Control")&&i.d(E,"Control",function(){return D.Control}),i.o(D,"CoordinateSystem")&&i.d(E,"CoordinateSystem",function(){return D.CoordinateSystem}),i.o(D,"CoordinateUniform")&&i.d(E,"CoordinateUniform",function(){return D.CoordinateUniform}),i.o(D,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return D.HeatmapLayer}),i.o(D,"ImageLayer")&&i.d(E,"ImageLayer",function(){return D.ImageLayer}),i.o(D,"LineLayer")&&i.d(E,"LineLayer",function(){return D.LineLayer}),i.o(D,"Logo")&&i.d(E,"Logo",function(){return D.Logo}),i.o(D,"MapServiceEvent")&&i.d(E,"MapServiceEvent",function(){return D.MapServiceEvent}),i.o(D,"Marker")&&i.d(E,"Marker",function(){return D.Marker}),i.o(D,"PointLayer")&&i.d(E,"PointLayer",function(){return D.PointLayer}),i.o(D,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return D.PolygonLayer}),i.o(D,"Popup")&&i.d(E,"Popup",function(){return D.Popup}),i.o(D,"PositionType")&&i.d(E,"PositionType",function(){return D.PositionType}),i.o(D,"RasterLayer")&&i.d(E,"RasterLayer",function(){return D.RasterLayer}),i.o(D,"Scale")&&i.d(E,"Scale",function(){return D.Scale}),i.o(D,"Scene")&&i.d(E,"Scene",function(){return D.Scene}),i.o(D,"SceneEventList")&&i.d(E,"SceneEventList",function(){return D.SceneEventList}),i.o(D,"Zoom")&&i.d(E,"Zoom",function(){return D.Zoom}),i.o(D,"gl")&&i.d(E,"gl",function(){return D.gl});var re=i("L56e");i.d(E,"MapServiceEvent",function(){return re.a});var fe=i("HthE");i.d(E,"CoordinateSystem",function(){return fe.a}),i.d(E,"CoordinateUniform",function(){return fe.b});var Y=i("/33/"),Fe=i.n(Y);i.o(Y,"CameraUniform")&&i.d(E,"CameraUniform",function(){return Y.CameraUniform}),i.o(Y,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Y.CityBuildingLayer}),i.o(Y,"Control")&&i.d(E,"Control",function(){return Y.Control}),i.o(Y,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Y.HeatmapLayer}),i.o(Y,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Y.ImageLayer}),i.o(Y,"LineLayer")&&i.d(E,"LineLayer",function(){return Y.LineLayer}),i.o(Y,"Logo")&&i.d(E,"Logo",function(){return Y.Logo}),i.o(Y,"Marker")&&i.d(E,"Marker",function(){return Y.Marker}),i.o(Y,"PointLayer")&&i.d(E,"PointLayer",function(){return Y.PointLayer}),i.o(Y,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Y.PolygonLayer}),i.o(Y,"Popup")&&i.d(E,"Popup",function(){return Y.Popup}),i.o(Y,"PositionType")&&i.d(E,"PositionType",function(){return Y.PositionType}),i.o(Y,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Y.RasterLayer}),i.o(Y,"Scale")&&i.d(E,"Scale",function(){return Y.Scale}),i.o(Y,"Scene")&&i.d(E,"Scene",function(){return Y.Scene}),i.o(Y,"SceneEventList")&&i.d(E,"SceneEventList",function(){return Y.SceneEventList}),i.o(Y,"Zoom")&&i.d(E,"Zoom",function(){return Y.Zoom}),i.o(Y,"gl")&&i.d(E,"gl",function(){return Y.gl});var We=i("EfZ0");i.d(E,"CameraUniform",function(){return We.a});var ge=i("riiI"),we=i.n(ge);i.o(ge,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),i.o(ge,"Control")&&i.d(E,"Control",function(){return ge.Control}),i.o(ge,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ge.HeatmapLayer}),i.o(ge,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ge.ImageLayer}),i.o(ge,"LineLayer")&&i.d(E,"LineLayer",function(){return ge.LineLayer}),i.o(ge,"Logo")&&i.d(E,"Logo",function(){return ge.Logo}),i.o(ge,"Marker")&&i.d(E,"Marker",function(){return ge.Marker}),i.o(ge,"PointLayer")&&i.d(E,"PointLayer",function(){return ge.PointLayer}),i.o(ge,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ge.PolygonLayer}),i.o(ge,"Popup")&&i.d(E,"Popup",function(){return ge.Popup}),i.o(ge,"PositionType")&&i.d(E,"PositionType",function(){return ge.PositionType}),i.o(ge,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ge.RasterLayer}),i.o(ge,"Scale")&&i.d(E,"Scale",function(){return ge.Scale}),i.o(ge,"Scene")&&i.d(E,"Scene",function(){return ge.Scene}),i.o(ge,"SceneEventList")&&i.d(E,"SceneEventList",function(){return ge.SceneEventList}),i.o(ge,"Zoom")&&i.d(E,"Zoom",function(){return ge.Zoom}),i.o(ge,"gl")&&i.d(E,"gl",function(){return ge.gl});var dt=i("eg+a");i.d(E,"SceneEventList",function(){return dt.a});var ke=i("bYl4"),Et=i.n(ke);i.o(ke,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ke.CityBuildingLayer}),i.o(ke,"Control")&&i.d(E,"Control",function(){return ke.Control}),i.o(ke,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ke.HeatmapLayer}),i.o(ke,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ke.ImageLayer}),i.o(ke,"LineLayer")&&i.d(E,"LineLayer",function(){return ke.LineLayer}),i.o(ke,"Logo")&&i.d(E,"Logo",function(){return ke.Logo}),i.o(ke,"Marker")&&i.d(E,"Marker",function(){return ke.Marker}),i.o(ke,"PointLayer")&&i.d(E,"PointLayer",function(){return ke.PointLayer}),i.o(ke,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ke.PolygonLayer}),i.o(ke,"Popup")&&i.d(E,"Popup",function(){return ke.Popup}),i.o(ke,"PositionType")&&i.d(E,"PositionType",function(){return ke.PositionType}),i.o(ke,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ke.RasterLayer}),i.o(ke,"Scale")&&i.d(E,"Scale",function(){return ke.Scale}),i.o(ke,"Scene")&&i.d(E,"Scene",function(){return ke.Scene}),i.o(ke,"Zoom")&&i.d(E,"Zoom",function(){return ke.Zoom}),i.o(ke,"gl")&&i.d(E,"gl",function(){return ke.gl});var Ze=i("FI6e"),vt=i.n(Ze);i.o(Ze,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),i.o(Ze,"Control")&&i.d(E,"Control",function(){return Ze.Control}),i.o(Ze,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ze.HeatmapLayer}),i.o(Ze,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ze.ImageLayer}),i.o(Ze,"LineLayer")&&i.d(E,"LineLayer",function(){return Ze.LineLayer}),i.o(Ze,"Logo")&&i.d(E,"Logo",function(){return Ze.Logo}),i.o(Ze,"Marker")&&i.d(E,"Marker",function(){return Ze.Marker}),i.o(Ze,"PointLayer")&&i.d(E,"PointLayer",function(){return Ze.PointLayer}),i.o(Ze,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ze.PolygonLayer}),i.o(Ze,"Popup")&&i.d(E,"Popup",function(){return Ze.Popup}),i.o(Ze,"PositionType")&&i.d(E,"PositionType",function(){return Ze.PositionType}),i.o(Ze,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ze.RasterLayer}),i.o(Ze,"Scale")&&i.d(E,"Scale",function(){return Ze.Scale}),i.o(Ze,"Scene")&&i.d(E,"Scene",function(){return Ze.Scene}),i.o(Ze,"Zoom")&&i.d(E,"Zoom",function(){return Ze.Zoom}),i.o(Ze,"gl")&&i.d(E,"gl",function(){return Ze.gl});var Qe=i("D+ow"),yt=i.n(Qe);i.o(Qe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Qe.CityBuildingLayer}),i.o(Qe,"Control")&&i.d(E,"Control",function(){return Qe.Control}),i.o(Qe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Qe.HeatmapLayer}),i.o(Qe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Qe.ImageLayer}),i.o(Qe,"LineLayer")&&i.d(E,"LineLayer",function(){return Qe.LineLayer}),i.o(Qe,"Logo")&&i.d(E,"Logo",function(){return Qe.Logo}),i.o(Qe,"Marker")&&i.d(E,"Marker",function(){return Qe.Marker}),i.o(Qe,"PointLayer")&&i.d(E,"PointLayer",function(){return Qe.PointLayer}),i.o(Qe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Qe.PolygonLayer}),i.o(Qe,"Popup")&&i.d(E,"Popup",function(){return Qe.Popup}),i.o(Qe,"PositionType")&&i.d(E,"PositionType",function(){return Qe.PositionType}),i.o(Qe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Qe.RasterLayer}),i.o(Qe,"Scale")&&i.d(E,"Scale",function(){return Qe.Scale}),i.o(Qe,"Scene")&&i.d(E,"Scene",function(){return Qe.Scene}),i.o(Qe,"Zoom")&&i.d(E,"Zoom",function(){return Qe.Zoom}),i.o(Qe,"gl")&&i.d(E,"gl",function(){return Qe.gl});var _t=i("AFH1");i.d(E,"PositionType",function(){return _t.a});var De=i("8uyu"),Ne=i.n(De);i.o(De,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return De.CityBuildingLayer}),i.o(De,"Control")&&i.d(E,"Control",function(){return De.Control}),i.o(De,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return De.HeatmapLayer}),i.o(De,"ImageLayer")&&i.d(E,"ImageLayer",function(){return De.ImageLayer}),i.o(De,"LineLayer")&&i.d(E,"LineLayer",function(){return De.LineLayer}),i.o(De,"Logo")&&i.d(E,"Logo",function(){return De.Logo}),i.o(De,"Marker")&&i.d(E,"Marker",function(){return De.Marker}),i.o(De,"PointLayer")&&i.d(E,"PointLayer",function(){return De.PointLayer}),i.o(De,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return De.PolygonLayer}),i.o(De,"Popup")&&i.d(E,"Popup",function(){return De.Popup}),i.o(De,"RasterLayer")&&i.d(E,"RasterLayer",function(){return De.RasterLayer}),i.o(De,"Scale")&&i.d(E,"Scale",function(){return De.Scale}),i.o(De,"Scene")&&i.d(E,"Scene",function(){return De.Scene}),i.o(De,"Zoom")&&i.d(E,"Zoom",function(){return De.Zoom}),i.o(De,"gl")&&i.d(E,"gl",function(){return De.gl});var Ue=i("J7lC"),st=i.n(Ue);i.o(Ue,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ue.CityBuildingLayer}),i.o(Ue,"Control")&&i.d(E,"Control",function(){return Ue.Control}),i.o(Ue,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ue.HeatmapLayer}),i.o(Ue,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ue.ImageLayer}),i.o(Ue,"LineLayer")&&i.d(E,"LineLayer",function(){return Ue.LineLayer}),i.o(Ue,"Logo")&&i.d(E,"Logo",function(){return Ue.Logo}),i.o(Ue,"Marker")&&i.d(E,"Marker",function(){return Ue.Marker}),i.o(Ue,"PointLayer")&&i.d(E,"PointLayer",function(){return Ue.PointLayer}),i.o(Ue,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ue.PolygonLayer}),i.o(Ue,"Popup")&&i.d(E,"Popup",function(){return Ue.Popup}),i.o(Ue,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ue.RasterLayer}),i.o(Ue,"Scale")&&i.d(E,"Scale",function(){return Ue.Scale}),i.o(Ue,"Scene")&&i.d(E,"Scene",function(){return Ue.Scene}),i.o(Ue,"Zoom")&&i.d(E,"Zoom",function(){return Ue.Zoom}),i.o(Ue,"gl")&&i.d(E,"gl",function(){return Ue.gl});var Le=i("QGbF"),ut=i.n(Le);i.o(Le,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),i.o(Le,"Control")&&i.d(E,"Control",function(){return Le.Control}),i.o(Le,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Le.HeatmapLayer}),i.o(Le,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Le.ImageLayer}),i.o(Le,"LineLayer")&&i.d(E,"LineLayer",function(){return Le.LineLayer}),i.o(Le,"Logo")&&i.d(E,"Logo",function(){return Le.Logo}),i.o(Le,"Marker")&&i.d(E,"Marker",function(){return Le.Marker}),i.o(Le,"PointLayer")&&i.d(E,"PointLayer",function(){return Le.PointLayer}),i.o(Le,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Le.PolygonLayer}),i.o(Le,"Popup")&&i.d(E,"Popup",function(){return Le.Popup}),i.o(Le,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Le.RasterLayer}),i.o(Le,"Scale")&&i.d(E,"Scale",function(){return Le.Scale}),i.o(Le,"Scene")&&i.d(E,"Scene",function(){return Le.Scene}),i.o(Le,"Zoom")&&i.d(E,"Zoom",function(){return Le.Zoom}),i.o(Le,"gl")&&i.d(E,"gl",function(){return Le.gl});var Gt=i("V1cb"),Kt=i("bzyH"),ar=i.n(Kt);i.o(Kt,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Kt.CityBuildingLayer}),i.o(Kt,"Control")&&i.d(E,"Control",function(){return Kt.Control}),i.o(Kt,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Kt.HeatmapLayer}),i.o(Kt,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Kt.ImageLayer}),i.o(Kt,"LineLayer")&&i.d(E,"LineLayer",function(){return Kt.LineLayer}),i.o(Kt,"Logo")&&i.d(E,"Logo",function(){return Kt.Logo}),i.o(Kt,"Marker")&&i.d(E,"Marker",function(){return Kt.Marker}),i.o(Kt,"PointLayer")&&i.d(E,"PointLayer",function(){return Kt.PointLayer}),i.o(Kt,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Kt.PolygonLayer}),i.o(Kt,"Popup")&&i.d(E,"Popup",function(){return Kt.Popup}),i.o(Kt,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Kt.RasterLayer}),i.o(Kt,"Scale")&&i.d(E,"Scale",function(){return Kt.Scale}),i.o(Kt,"Scene")&&i.d(E,"Scene",function(){return Kt.Scene}),i.o(Kt,"Zoom")&&i.d(E,"Zoom",function(){return Kt.Zoom}),i.o(Kt,"gl")&&i.d(E,"gl",function(){return Kt.gl});var oe=i("0eqD"),Q=i.n(oe);i.o(oe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),i.o(oe,"Control")&&i.d(E,"Control",function(){return oe.Control}),i.o(oe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return oe.HeatmapLayer}),i.o(oe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return oe.ImageLayer}),i.o(oe,"LineLayer")&&i.d(E,"LineLayer",function(){return oe.LineLayer}),i.o(oe,"Logo")&&i.d(E,"Logo",function(){return oe.Logo}),i.o(oe,"Marker")&&i.d(E,"Marker",function(){return oe.Marker}),i.o(oe,"PointLayer")&&i.d(E,"PointLayer",function(){return oe.PointLayer}),i.o(oe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return oe.PolygonLayer}),i.o(oe,"Popup")&&i.d(E,"Popup",function(){return oe.Popup}),i.o(oe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return oe.RasterLayer}),i.o(oe,"Scale")&&i.d(E,"Scale",function(){return oe.Scale}),i.o(oe,"Scene")&&i.d(E,"Scene",function(){return oe.Scene}),i.o(oe,"Zoom")&&i.d(E,"Zoom",function(){return oe.Zoom}),i.o(oe,"gl")&&i.d(E,"gl",function(){return oe.gl});var H=i("/Uc5"),Ce=i.n(H);i.o(H,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return H.CityBuildingLayer}),i.o(H,"Control")&&i.d(E,"Control",function(){return H.Control}),i.o(H,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return H.HeatmapLayer}),i.o(H,"ImageLayer")&&i.d(E,"ImageLayer",function(){return H.ImageLayer}),i.o(H,"LineLayer")&&i.d(E,"LineLayer",function(){return H.LineLayer}),i.o(H,"Logo")&&i.d(E,"Logo",function(){return H.Logo}),i.o(H,"Marker")&&i.d(E,"Marker",function(){return H.Marker}),i.o(H,"PointLayer")&&i.d(E,"PointLayer",function(){return H.PointLayer}),i.o(H,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return H.PolygonLayer}),i.o(H,"Popup")&&i.d(E,"Popup",function(){return H.Popup}),i.o(H,"RasterLayer")&&i.d(E,"RasterLayer",function(){return H.RasterLayer}),i.o(H,"Scale")&&i.d(E,"Scale",function(){return H.Scale}),i.o(H,"Scene")&&i.d(E,"Scene",function(){return H.Scene}),i.o(H,"Zoom")&&i.d(E,"Zoom",function(){return H.Zoom}),i.o(H,"gl")&&i.d(E,"gl",function(){return H.gl});var Ee=i("RMtq"),_e=i.n(Ee);i.o(Ee,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ee.CityBuildingLayer}),i.o(Ee,"Control")&&i.d(E,"Control",function(){return Ee.Control}),i.o(Ee,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ee.HeatmapLayer}),i.o(Ee,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ee.ImageLayer}),i.o(Ee,"LineLayer")&&i.d(E,"LineLayer",function(){return Ee.LineLayer}),i.o(Ee,"Logo")&&i.d(E,"Logo",function(){return Ee.Logo}),i.o(Ee,"Marker")&&i.d(E,"Marker",function(){return Ee.Marker}),i.o(Ee,"PointLayer")&&i.d(E,"PointLayer",function(){return Ee.PointLayer}),i.o(Ee,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ee.PolygonLayer}),i.o(Ee,"Popup")&&i.d(E,"Popup",function(){return Ee.Popup}),i.o(Ee,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ee.RasterLayer}),i.o(Ee,"Scale")&&i.d(E,"Scale",function(){return Ee.Scale}),i.o(Ee,"Scene")&&i.d(E,"Scene",function(){return Ee.Scene}),i.o(Ee,"Zoom")&&i.d(E,"Zoom",function(){return Ee.Zoom}),i.o(Ee,"gl")&&i.d(E,"gl",function(){return Ee.gl});var ve=i("1jvM"),rt=i.n(ve);i.o(ve,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ve.CityBuildingLayer}),i.o(ve,"Control")&&i.d(E,"Control",function(){return ve.Control}),i.o(ve,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ve.HeatmapLayer}),i.o(ve,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ve.ImageLayer}),i.o(ve,"LineLayer")&&i.d(E,"LineLayer",function(){return ve.LineLayer}),i.o(ve,"Logo")&&i.d(E,"Logo",function(){return ve.Logo}),i.o(ve,"Marker")&&i.d(E,"Marker",function(){return ve.Marker}),i.o(ve,"PointLayer")&&i.d(E,"PointLayer",function(){return ve.PointLayer}),i.o(ve,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ve.PolygonLayer}),i.o(ve,"Popup")&&i.d(E,"Popup",function(){return ve.Popup}),i.o(ve,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ve.RasterLayer}),i.o(ve,"Scale")&&i.d(E,"Scale",function(){return ve.Scale}),i.o(ve,"Scene")&&i.d(E,"Scene",function(){return ve.Scene}),i.o(ve,"Zoom")&&i.d(E,"Zoom",function(){return ve.Zoom}),i.o(ve,"gl")&&i.d(E,"gl",function(){return ve.gl});var $t=i("bPkA"),St=i("PSsN"),ye=i.n(St);i.o(St,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return St.CityBuildingLayer}),i.o(St,"Control")&&i.d(E,"Control",function(){return St.Control}),i.o(St,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return St.HeatmapLayer}),i.o(St,"ImageLayer")&&i.d(E,"ImageLayer",function(){return St.ImageLayer}),i.o(St,"LineLayer")&&i.d(E,"LineLayer",function(){return St.LineLayer}),i.o(St,"Logo")&&i.d(E,"Logo",function(){return St.Logo}),i.o(St,"Marker")&&i.d(E,"Marker",function(){return St.Marker}),i.o(St,"PointLayer")&&i.d(E,"PointLayer",function(){return St.PointLayer}),i.o(St,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return St.PolygonLayer}),i.o(St,"Popup")&&i.d(E,"Popup",function(){return St.Popup}),i.o(St,"RasterLayer")&&i.d(E,"RasterLayer",function(){return St.RasterLayer}),i.o(St,"Scale")&&i.d(E,"Scale",function(){return St.Scale}),i.o(St,"Scene")&&i.d(E,"Scene",function(){return St.Scene}),i.o(St,"Zoom")&&i.d(E,"Zoom",function(){return St.Zoom}),i.o(St,"gl")&&i.d(E,"gl",function(){return St.gl});var be=i("6NqC"),Be=i.n(be);i.o(be,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return be.CityBuildingLayer}),i.o(be,"Control")&&i.d(E,"Control",function(){return be.Control}),i.o(be,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return be.HeatmapLayer}),i.o(be,"ImageLayer")&&i.d(E,"ImageLayer",function(){return be.ImageLayer}),i.o(be,"LineLayer")&&i.d(E,"LineLayer",function(){return be.LineLayer}),i.o(be,"Logo")&&i.d(E,"Logo",function(){return be.Logo}),i.o(be,"Marker")&&i.d(E,"Marker",function(){return be.Marker}),i.o(be,"PointLayer")&&i.d(E,"PointLayer",function(){return be.PointLayer}),i.o(be,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return be.PolygonLayer}),i.o(be,"Popup")&&i.d(E,"Popup",function(){return be.Popup}),i.o(be,"RasterLayer")&&i.d(E,"RasterLayer",function(){return be.RasterLayer}),i.o(be,"Scale")&&i.d(E,"Scale",function(){return be.Scale}),i.o(be,"Scene")&&i.d(E,"Scene",function(){return be.Scene}),i.o(be,"Zoom")&&i.d(E,"Zoom",function(){return be.Zoom}),i.o(be,"gl")&&i.d(E,"gl",function(){return be.gl});var lt=i("bTtR"),Pe=i.n(lt);i.o(lt,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return lt.CityBuildingLayer}),i.o(lt,"Control")&&i.d(E,"Control",function(){return lt.Control}),i.o(lt,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return lt.HeatmapLayer}),i.o(lt,"ImageLayer")&&i.d(E,"ImageLayer",function(){return lt.ImageLayer}),i.o(lt,"LineLayer")&&i.d(E,"LineLayer",function(){return lt.LineLayer}),i.o(lt,"Logo")&&i.d(E,"Logo",function(){return lt.Logo}),i.o(lt,"Marker")&&i.d(E,"Marker",function(){return lt.Marker}),i.o(lt,"PointLayer")&&i.d(E,"PointLayer",function(){return lt.PointLayer}),i.o(lt,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return lt.PolygonLayer}),i.o(lt,"Popup")&&i.d(E,"Popup",function(){return lt.Popup}),i.o(lt,"RasterLayer")&&i.d(E,"RasterLayer",function(){return lt.RasterLayer}),i.o(lt,"Scale")&&i.d(E,"Scale",function(){return lt.Scale}),i.o(lt,"Scene")&&i.d(E,"Scene",function(){return lt.Scene}),i.o(lt,"Zoom")&&i.d(E,"Zoom",function(){return lt.Zoom}),i.o(lt,"gl")&&i.d(E,"gl",function(){return lt.gl});var ht=i("o+pz");i.d(E,"gl",function(){return ht.a})},h7MG:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("doU7"),m=i("MON2"),X=i("FV85"),z=i("xfSm"),o=i("qK8v"),Z=i("ujMp"),D=i("oy+k"),K=i("GXnB"),re=i("yMAV"),fe=i("fbrv"),Y=i("xiII"),Fe=i("dX1H");function We(Qe){return Qe._bindingDictionary}E.getBindingDictionary=We;function ge(Qe,yt,_t,De,Ne,Ue){var st=Qe?z.MULTI_INJECT_TAG:z.INJECT_TAG,Le=new K.Metadata(st,_t),ut=new Fe.Target(yt,De,_t,Le);if(Ne!==void 0){var Gt=new K.Metadata(Ne,Ue);ut.metadata.push(Gt)}return ut}function we(Qe,yt,_t,De,Ne){var Ue=Et(_t.container,Ne.serviceIdentifier),st=[];return Ue.length===T.BindingCount.NoBindingsAvailable&&_t.container.options.autoBindInjectable&&typeof Ne.serviceIdentifier=="function"&&Qe.getConstructorMetadata(Ne.serviceIdentifier).compilerGeneratedMetadata&&(_t.container.bind(Ne.serviceIdentifier).toSelf(),Ue=Et(_t.container,Ne.serviceIdentifier)),yt?st=Ue:st=Ue.filter(function(Le){var ut=new Y.Request(Le.serviceIdentifier,_t,De,Le,Ne);return Le.constraint(ut)}),dt(Ne.serviceIdentifier,st,Ne,_t.container),st}function dt(Qe,yt,_t,De){switch(yt.length){case T.BindingCount.NoBindingsAvailable:if(_t.isOptional())return yt;var Ne=Z.getServiceIdentifierAsString(Qe),Ue=m.NOT_REGISTERED;throw Ue+=Z.listMetadataForTarget(Ne,_t),Ue+=Z.listRegisteredBindingsForServiceIdentifier(De,Ne,Et),new Error(Ue);case T.BindingCount.OnlyOneBindingAvailable:if(!_t.isArray())return yt;case T.BindingCount.MultipleBindingsAvailable:default:if(_t.isArray())return yt;var Ne=Z.getServiceIdentifierAsString(Qe),Ue=m.AMBIGUOUS_MATCH+" "+Ne;throw Ue+=Z.listRegisteredBindingsForServiceIdentifier(De,Ne,Et),new Error(Ue)}}function ke(Qe,yt,_t,De,Ne,Ue){var st,Le;if(Ne===null){st=we(Qe,yt,De,null,Ue),Le=new Y.Request(_t,De,null,st,Ue);var ut=new re.Plan(De,Le);De.addPlan(ut)}else st=we(Qe,yt,De,Ne,Ue),Le=Ne.addChildRequest(Ue.serviceIdentifier,st,Ue);st.forEach(function(Gt){var Kt=null;if(Ue.isArray())Kt=Le.addChildRequest(Gt.serviceIdentifier,Gt,Ue);else{if(Gt.cache)return;Kt=Le}if(Gt.type===X.BindingTypeEnum.Instance&&Gt.implementationType!==null){var ar=fe.getDependencies(Qe,Gt.implementationType);if(!De.container.options.skipBaseClassChecks){var oe=fe.getBaseClassDependencyCount(Qe,Gt.implementationType);if(ar.length<oe){var Q=m.ARGUMENTS_LENGTH_MISMATCH(fe.getFunctionName(Gt.implementationType));throw new Error(Q)}}ar.forEach(function(H){ke(Qe,!1,H.serviceIdentifier,De,Kt,H)})}})}function Et(Qe,yt){var _t=[],De=We(Qe);return De.hasKey(yt)?_t=De.get(yt):Qe.parent!==null&&(_t=Et(Qe.parent,yt)),_t}function Ze(Qe,yt,_t,De,Ne,Ue,st,Le){Le===void 0&&(Le=!1);var ut=new D.Context(yt),Gt=ge(_t,De,Ne,"",Ue,st);try{return ke(Qe,Le,Ne,ut,null,Gt),ut}catch(Kt){throw o.isStackOverflowExeption(Kt)&&(ut.plan&&Z.circularDependencyToException(ut.plan.rootRequest)),Kt}}E.plan=Ze;function vt(Qe,yt,_t,De){var Ne=new Fe.Target(X.TargetTypeEnum.Variable,"",yt,new K.Metadata(_t,De)),Ue=new D.Context(Qe),st=new Y.Request(yt,Ue,null,[],Ne);return st}E.createMockRequest=vt},heNW:function(Re,E){function i(T,m,X){switch(X.length){case 0:return T.call(m);case 1:return T.call(m,X[0]);case 2:return T.call(m,X[0],X[1]);case 3:return T.call(m,X[0],X[1],X[2])}return T.apply(m,X)}Re.exports=i},hi0z:function(Re,E,i){"use strict";(function(T,m){Re.exports=m()})(this,function(){function T(fe){var Y=[];return fe.AMapUI&&Y.push(m(fe.AMapUI)),fe.Loca&&Y.push(X(fe.Loca)),Promise.all(Y)}function m(fe){return new Promise(function(Y,Fe){var We=[];if(fe.plugins)for(var ge=0;ge<fe.plugins.length;ge+=1)o.AMapUI.plugins.indexOf(fe.plugins[ge])==-1&&We.push(fe.plugins[ge]);if(Z.AMapUI===z.failed)Fe("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===z.notload){Z.AMapUI=z.loading,o.AMapUI.version=fe.version||o.AMapUI.version,ge=o.AMapUI.version;var we=document.body||document.head,dt=document.createElement("script");dt.type="text/javascript",dt.src="https://webapi.amap.com/ui/"+ge+"/main.js",dt.onerror=function(ke){Z.AMapUI=z.failed,Fe("\u8BF7\u6C42 AMapUI \u5931\u8D25")},dt.onload=function(){if(Z.AMapUI=z.loaded,We.length)window.AMapUI.loadUI(We,function(){for(var ke=0,Et=We.length;ke<Et;ke++){var Ze=We[ke].split("/").slice(-1)[0];window.AMapUI[Ze]=arguments[ke]}for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},we.appendChild(dt)}else Z.AMapUI===z.loaded?fe.version&&fe.version!==o.AMapUI.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):We.length?window.AMapUI.loadUI(We,function(){for(var ke=0,Et=We.length;ke<Et;ke++){var Ze=We[ke].split("/").slice(-1)[0];window.AMapUI[Ze]=arguments[ke]}Y()}):Y():fe.version&&fe.version!==o.AMapUI.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(ke){ke?Fe(ke):We.length?window.AMapUI.loadUI(We,function(){for(var Et=0,Ze=We.length;Et<Ze;Et++){var vt=We[Et].split("/").slice(-1)[0];window.AMapUI[vt]=arguments[Et]}Y()}):Y()})})}function X(fe){return new Promise(function(Y,Fe){if(o.AMap.version.startsWith("2.0"))Fe("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Z.Loca===z.failed)Fe("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===z.notload){Z.Loca=z.loading,o.Loca.version=fe.version||o.Loca.version;var We=o.Loca.version,ge=o.key,we=document.body||document.head,dt=document.createElement("script");dt.type="text/javascript",dt.src="https://webapi.amap.com/loca?v="+We+"&key="+ge,dt.onerror=function(ke){Z.Loca=z.failed,Fe("\u8BF7\u6C42 AMapUI \u5931\u8D25")},dt.onload=function(){for(Z.Loca=z.loaded,Y();D.Loca.length;)D.Loca.splice(0,1)[0]()},we.appendChild(dt)}else Z.Loca===z.loaded?fe.version&&fe.version!==o.Loca.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):Y():fe.version&&fe.version!==o.Loca.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(ke){ke?Fe(ke):Fe()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var z;(function(fe){fe.notload="notload",fe.loading="loading",fe.loaded="loaded",fe.failed="failed"})(z||(z={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]},K=[],re=function(Y){typeof Y=="function"&&(Z.AMap===z.loaded?Y(window.AMap):K.push(Y))};return{load:function(Y){return new Promise(function(Fe,We){if(Z.AMap==z.failed)We("");else if(Z.AMap==z.notload){var ge=Y.key,we=Y.version,dt=Y.plugins;ge?(window.AMap&&location.host!=="lbs.amap.com"&&We("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=ge,o.AMap.version=we||o.AMap.version,o.AMap.plugins=dt||o.AMap.plugins,Z.AMap=z.loading,we=document.body||document.head,window.___onAPILoaded=function(Et){if(delete window.___onAPILoaded,Et)Z.AMap=z.failed,We(Et);else for(Z.AMap=z.loaded,T(Y).then(function(){Fe(window.AMap)}).catch(We);K.length;)K.splice(0,1)[0]()},dt=document.createElement("script"),dt.type="text/javascript",dt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+ge+"&plugin="+o.AMap.plugins.join(","),dt.onerror=function(Et){Z.AMap=z.failed,We(Et)},we.appendChild(dt)):We("\u8BF7\u586B\u5199key")}else if(Z.AMap==z.loaded)if(Y.key&&Y.key!==o.key)We("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==o.AMap.version)We("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ge=[],Y.plugins)for(we=0;we<Y.plugins.length;we+=1)o.AMap.plugins.indexOf(Y.plugins[we])==-1&&ge.push(Y.plugins[we]);ge.length?window.AMap.plugin(ge,function(){T(Y).then(function(){Fe(window.AMap)}).catch(We)}):T(Y).then(function(){Fe(window.AMap)}).catch(We)}else if(Y.key&&Y.key!==o.key)We("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==o.AMap.version)We("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var ke=[];if(Y.plugins)for(we=0;we<Y.plugins.length;we+=1)o.AMap.plugins.indexOf(Y.plugins[we])==-1&&ke.push(Y.plugins[we]);re(function(){ke.length?window.AMap.plugin(ke,function(){T(Y).then(function(){Fe(window.AMap)}).catch(We)}):T(Y).then(function(){Fe(window.AMap)}).catch(We)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Re,E,i){var T=i("O0oS");function m(X,z,o){z=="__proto__"&&T?T(X,z,{configurable:!0,enumerable:!0,value:o,writable:!0}):X[z]=o}Re.exports=m},iWIM:function(Re,E,i){var T=i("n3AX");function m(X,z,o){return typeof Reflect!="undefined"&&Reflect.get?Re.exports=m=Reflect.get:Re.exports=m=function(D,K,re){var fe=T(D,K);if(!fe)return;var Y=Object.getOwnPropertyDescriptor(fe,K);return Y.get?Y.get.call(re):Y.value},m(X,z,o||X)}Re.exports=m},iegG:function(Re,E){function i(T){var m=T.target||T.srcElement;m.__resizeRAF__&&cancelAnimationFrame(m.__resizeRAF__),m.__resizeRAF__=requestAnimationFrame(function(){var X=m.__resizeTrigger__,z=X&&X.__resizeListeners__;z&&z.forEach(function(o){o.call(X,T)})})}var E=function(m,X){var z=this,o=z.document,Z,D=o.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function K(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",i)}if(!m.__resizeListeners__)if(m.__resizeListeners__=[],D)m.__resizeTrigger__=m,m.attachEvent("onresize",i);else{getComputedStyle(m).position==="static"&&(m.style.position="relative");var re=m.__resizeTrigger__=o.createElement("object");re.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),re.setAttribute("class","resize-sensor"),re.setAttribute("tabindex","-1"),re.__resizeElement__=m,re.onload=K,re.type="text/html",Z&&m.appendChild(re),re.data="about:blank",Z||m.appendChild(re)}m.__resizeListeners__.push(X)};Re.exports=typeof window=="undefined"?E:E.bind(window),Re.exports.unbind=function(T,m){var X=document.attachEvent,z=T.__resizeListeners__||[];if(m){var o=z.indexOf(m);o!==-1&&z.splice(o,1)}else z=T.__resizeListeners__=[];if(!z.length){if(X)T.detachEvent("onresize",i);else if(T.__resizeTrigger__){var Z=T.__resizeTrigger__.contentDocument,D=Z&&Z.defaultView;D&&(D.removeEventListener("resize",i),delete D.__resizeTrigger__),T.__resizeTrigger__=!T.removeChild(T.__resizeTrigger__)}delete T.__resizeListeners__}}},itsj:function(Re,E){function i(T,m){return m==="constructor"&&typeof T[m]=="function"||m=="__proto__"?void 0:T[m]}Re.exports=i},"iz+Y":function(Re,E,i){Re.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("1GLa")},"jIg/":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.MULTI_INJECT_TAG,o);typeof K=="number"?X.tagParameter(Z,D,K,re):X.tagProperty(Z,D,re)}}E.multiInject=z},jYQm:function(Re,E,i){"use strict";var T=i("q1tI"),m=i.n(T),X=Object(T.createContext)({});E.a=X},jYx5:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(){return function(o,Z,D){var K=new m.Metadata(T.OPTIONAL_TAG,!0);typeof D=="number"?X.tagParameter(o,Z,D,K):X.tagProperty(o,Z,K)}}E.optional=z},"jbM+":function(Re,E,i){var T=i("R/W3");function m(X,z){var o=X==null?0:X.length;return!!o&&T(X,z,0)>-1}Re.exports=m},jeLo:function(Re,E,i){var T=i("juv8"),m=i("mTTR");function X(z){return T(z,m(z))}Re.exports=X},juv8:function(Re,E,i){var T=i("MrPd"),m=i("hypo");function X(z,o,Z,D){var K=!Z;Z||(Z={});for(var re=-1,fe=o.length;++re<fe;){var Y=o[re],Fe=D?D(Z[Y],z[Y],Y,Z,z):void 0;Fe===void 0&&(Fe=z[Y]),K?m(Z,Y,Fe):T(Z,Y,Fe)}return Z}Re.exports=X},"k5/I":function(Re,E,i){"use strict";i.d(E,"a",function(){return yt}),i.d(E,"b",function(){return Gt}),i.d(E,"e",function(){return oe}),i.d(E,"f",function(){return Ce}),i.d(E,"c",function(){return $t}),i.d(E,"d",function(){return gt});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("7W2i"),K=i.n(D),re=i("a1gu"),fe=i.n(re),Y=i("Nsbk"),Fe=i.n(Y),We=i("h1nZ"),ge=i("Hel2"),we=i("uhBA");function dt(nt,kt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);kt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function ke(nt){for(var kt=1;kt<arguments.length;kt++){var $=arguments[kt]!=null?arguments[kt]:{};kt%2?dt(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):dt(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function Et(nt){var kt=Ze();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function Ze(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var vt;(function(nt){nt.TOPRIGHT="topright",nt.TOPLEFT="topleft",nt.BOTTOMRIGHT="bottomright",nt.BOTTOMLEFT="bottomleft"})(vt||(vt={}));var Qe=0,yt=function(nt){K()($,nt);var kt=Et($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this),ae.controlOption=void 0,ae.container=void 0,ae.sceneContainer=void 0,ae.mapsService=void 0,ae.renderService=void 0,ae.layerService=void 0,ae.controlService=void 0,ae.isShow=void 0,ae.controlOption=ke(ke({},ae.getDefault()),Ke||{}),ae}return Z()($,[{key:"getDefault",value:function(){return{position:vt.TOPRIGHT,name:"".concat(Qe++)}}},{key:"setPosition",value:function(ae){var et=this.controlService;return et&&et.removeControl(this),this.controlOption.position=ae,et&&et.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ae){this.mapsService=ae.get(We.TYPES.IMapService),this.renderService=ae.get(We.TYPES.IRendererService),this.layerService=ae.get(We.TYPES.ILayerService),this.controlService=ae.get(We.TYPES.IControlService),this.sceneContainer=ae,this.isShow=!0,this.container=this.onAdd();var et=this.container,zt=this.controlOption.position,sr=this.controlService.controlCorners[zt];return ge.a.addClass(et,"l7-control"),zt.indexOf("bottom")!==-1?sr.insertBefore(et,sr.firstChild):sr.appendChild(et),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ae=this.container;ge.a.addClass(ae,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ae=this.container;ge.a.removeClass(ae,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;ge.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ae){if(this.mapsService&&ae&&ae.screenX>0&&ae.screenY>0){var et=this.mapsService.getContainer();et!==null&&et.focus()}}}]),$}(we.EventEmitter),_t=i("PJYZ"),De=i.n(_t);function Ne(nt){var kt=Ue();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function Ue(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var st=function(nt){K()($,nt);var kt=Ne($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this,Ke),ae.layerControlInputs=void 0,ae.layers=void 0,ae.lastZIndex=void 0,ae.handlingClick=void 0,ae.layersLink=void 0,ae.baseLayersList=void 0,ae.separator=void 0,ae.overlaysList=void 0,ae.form=void 0,ae.layerControlInputs=[],ae.layers=[],ae.lastZIndex=0,ae.handlingClick=!1,ae.initLayers(),Object(ge.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],De()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:We.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ae=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(et){et.layer.on("remove",ae.onLayerChange),et.layer.on("add",ae.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ae,et){return this.addLayer(ae,et,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ae=this.renderService.getViewportSize(),et=ae.height;ge.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var zt=et-(this.container.offsetTop+50);return zt<this.form.clientHeight?(ge.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=zt+"px"):ge.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return ge.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ae=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(et){et.layer.off("remove",ae.onLayerChange),et.layer.off("add",ae.onLayerChange)})}},{key:"initLayout",value:function(){var ae="l7-control-layers",et=this.container=ge.a.create("div",ae),zt=this.controlOption.collapsed;et.setAttribute("aria-haspopup","true");var sr=this.form=ge.a.create("form",ae+"-list");zt&&(this.mapsService.on("click",this.collapse),et.addEventListener("mouseenter",this.expand),et.addEventListener("mouseleave",this.collapse)),this.layersLink=ge.a.create("a",ae+"-toggle",et);var ft=this.layersLink;ft.title="Layers",zt||this.expand(),this.baseLayersList=ge.a.create("div",ae+"-base",sr),this.separator=ge.a.create("div",ae+"-separator",sr),this.overlaysList=ge.a.create("div",ae+"-overlays",sr),et.appendChild(sr)}},{key:"initLayers",value:function(){var ae=this,et=this.controlOption,zt=et.baseLayers,sr=zt===void 0?{}:zt,ft=et.overlayers,pt=ft===void 0?{}:ft;Object.keys(sr).forEach(function(At,mt){ae.addLayer(sr[At],At,!1)}),Object.keys(pt).forEach(function(At,mt){ae.addLayer(pt[At],At,!0)})}},{key:"update",value:function(){if(!this.container)return this;ge.a.empty(this.baseLayersList),ge.a.empty(this.overlaysList),this.layerControlInputs=[];var ae,et,zt,sr,ft=0;for(zt=0;zt<this.layers.length;zt++)sr=this.layers[zt],this.addItem(sr),et=et||sr.overlay,ae=ae||!sr.overlay,ft+=sr.overlay?0:1;return this.controlOption.hideSingleBase&&(ae=ae&&ft>1,this.baseLayersList.style.display=ae?"":"none"),this.separator.style.display=et&&ae?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ae=this.layerControlInputs,et,zt,sr=this.mapsService.getZoom(),ft=ae.length-1;ft>=0;ft--)if(et=ae[ft],zt=this.layerService.getLayer(et.layerId),zt&&zt.inited){var pt=zt.getMinZoom(),At=zt.getMaxZoom();et.disabled=sr<pt||sr>At}}},{key:"addLayer",value:function(ae,et,zt){this.mapsService&&(ae.on("add",this.onLayerChange),ae.on("remove",this.onLayerChange)),this.layers.push({layer:ae,name:et,overlay:zt});var sr=this.controlOption,ft=sr.sortLayers,pt=sr.sortFunction,At=sr.autoZIndex;ft&&this.layers.sort(function(mt,Me){return pt(mt.layer,Me.layer,mt.name,Me.name)}),At&&ae.setZIndex&&(this.lastZIndex++,ae.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ae){this.handlingClick||this.update();var et=this.layerService.getLayer(ae.target.layerId),zt=(et==null?void 0:et.overlay)?ae.type==="add"?"overlayadd":"overlayremove":ae.type==="add"?"baselayerchange":null;zt&&this.emit(zt,et)}},{key:"createRadioElement",value:function(ae,et){var zt='<input type="radio" class="l7-control-layers-selector" name="'+ae+'"'+(et?' checked="checked"':"")+"/>",sr=document.createElement("div");return sr.innerHTML=zt,sr.firstChild}},{key:"addItem",value:function(ae){var et=document.createElement("label"),zt=this.layerService.getLayer(ae.layer.id),sr=zt&&zt.inited&&ae.layer.isVisible(),ft;ae.overlay?(ft=document.createElement("input"),ft.type="checkbox",ft.className="l7-control-layers-selector",ft.defaultChecked=sr):ft=this.createRadioElement("l7-base-layers",sr),this.layerControlInputs.push(ft),ft.layerId=ae.layer.id,ft.addEventListener("click",this.onInputClick);var pt=document.createElement("span");pt.innerHTML=" "+ae.name;var At=document.createElement("div");et.appendChild(At),At.appendChild(ft),At.appendChild(pt);var mt=ae.overlay?this.overlaysList:this.baseLayersList;return mt.appendChild(et),this.checkDisabledLayers(),et}},{key:"onInputClick",value:function(){var ae=this.layerControlInputs,et,zt,sr=[],ft=[];this.handlingClick=!0;for(var pt=ae.length-1;pt>=0;pt--)et=ae[pt],zt=this.layerService.getLayer(et.layerId),et.checked?sr.push(zt):et.checked||ft.push(zt);ft.forEach(function(At){At.hide()}),sr.forEach(function(At){At.show()}),this.handlingClick=!1}}]),$}(yt);function Le(nt){var kt=ut();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function ut(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Gt=function(nt){K()($,nt);var kt=Le($);function $(){return z()(this,$),kt.apply(this,arguments)}return Z()($,[{key:"getDefault",value:function(){return{position:vt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ae="l7-control-logo",et=ge.a.create("div",ae),zt=ge.a.create("a","l7-ctrl-logo");return zt.target="_blank",zt.rel="noopener nofollow",zt.href="https://antv.alipay.com/l7",zt.setAttribute("aria-label","AntV logo"),zt.setAttribute("rel","noopener nofollow"),et.appendChild(zt),et}},{key:"onRemove",value:function(){return null}}]),$}(yt);function Kt(nt){var kt=ar();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function ar(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var oe=function(nt){K()($,nt);var kt=Kt($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this,Ke),ae.mScale=void 0,ae.iScale=void 0,Object(ge.i)(["update"],De()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:vt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ae="l7-control-scale",et=ge.a.create("div",ae);this.addScales(ae+"-line",et);var zt=this.controlOption.updateWhenIdle;return this.mapsService.on(zt?"moveend":"mapmove",this.update),this.mapsService.on(zt?"zoomend":"zoomchange",this.update),this.update(),et}},{key:"onRemove",value:function(){var ae=this.controlOption.updateWhenIdle;this.mapsService.off(ae?"zoomend":"zoomchange",this.update),this.mapsService.off(ae?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ae=this.mapsService,et=this.controlOption.maxWidth,zt=ae.getSize()[1]/2,sr=ae.containerToLngLat([0,zt]),ft=ae.containerToLngLat([et,zt]),pt=Object(ge.q)([sr.lng,sr.lat],[ft.lng,ft.lat]);this.updateScales(pt)}},{key:"updateScales",value:function(ae){var et=this.controlOption,zt=et.metric,sr=et.imperial;zt&&ae&&this.updateMetric(ae),sr&&ae&&this.updateImperial(ae)}},{key:"updateMetric",value:function(ae){var et=this.getRoundNum(ae),zt=et<1e3?et+" m":et/1e3+" km";this.updateScale(this.mScale,zt,et/ae)}},{key:"updateImperial",value:function(ae){var et=ae*3.2808399,zt,sr,ft;et>5280?(zt=et/5280,sr=this.getRoundNum(zt),this.updateScale(this.iScale,sr+" mi",sr/zt)):(ft=this.getRoundNum(et),this.updateScale(this.iScale,ft+" ft",ft/et))}},{key:"updateScale",value:function(ae,et,zt){var sr=this.controlOption.maxWidth;ae.style.width=Math.round(sr*zt)+"px",ae.innerHTML=et}},{key:"getRoundNum",value:function(ae){var et=Math.pow(10,(Math.floor(ae)+"").length-1),zt=ae/et;return zt=zt>=10?10:zt>=5?5:zt>=3?3:zt>=2?2:1,et*zt}},{key:"addScales",value:function(ae,et){var zt=this.controlOption,sr=zt.metric,ft=zt.imperial;sr&&(this.mScale=ge.a.create("div",ae,et)),ft&&(this.iScale=ge.a.create("div",ae,et))}}]),$}(yt);function Q(nt){var kt=H();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Ce=function(nt){K()($,nt);var kt=Q($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this,Ke),ae.disabled=void 0,ae.zoomInButton=void 0,ae.zoomOutButton=void 0,Object(ge.i)(["updateDisabled","zoomIn","zoomOut"],De()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:vt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ae="l7-control-zoom",et=ge.a.create("div",ae+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ae+"-in",et,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ae+"-out",et,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),et}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ae,et,zt,sr,ft){var pt=ge.a.create("a",zt,sr);return pt.innerHTML=ae,pt.title=et,pt.href="javascript:void(0)",pt.addEventListener("click",ft),pt}},{key:"updateDisabled",value:function(){var ae=this.mapsService,et="l7-disabled";ge.a.removeClass(this.zoomInButton,et),ge.a.removeClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()<=ae.getMinZoom())&&ge.a.addClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()>=ae.getMaxZoom())&&ge.a.addClass(this.zoomInButton,et)}}]),$}(yt);function Ee(nt,kt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);kt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function _e(nt){for(var kt=1;kt<arguments.length;kt++){var $=arguments[kt]!=null?arguments[kt]:{};kt%2?Ee(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):Ee(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function ve(nt){var kt=rt();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var $t=function(nt){K()($,nt);var kt=ve($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this),ae.markerOption=void 0,ae.defaultMarker=void 0,ae.popup=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.scene=void 0,ae.added=!1,ae.eventHandle=function(et){ae.emit(et.type,{target:et,data:ae.markerOption.extData,lngLat:ae.lngLat})},ae.markerOption=_e(_e({},ae.getDefault()),Ke),Object(ge.i)(["update","onMove","onUp","addDragHandler","onMapClick"],De()(ae)),ae.init(),ae}return Z()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:ge.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ae){this.scene=ae,this.mapsService=ae.get(We.TYPES.IMapService),this.sceneSerive=ae.get(We.TYPES.ISceneService);var et=this.markerOption,zt=et.element,sr=et.draggable;return this.mapsService.getMarkerContainer().appendChild(zt),this.registerMarkerEvent(zt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ae=this.markerOption.element;return ae&&ge.a.remove(ae),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ae){var et=this;if(!this.added)return this.once("added",function(){et.setElement(ae)}),this;var zt=this.markerOption.element;return zt&&ge.a.remove(zt),this.markerOption.element=ae,this.init(),this.mapsService.getMarkerContainer().appendChild(ae),this.registerMarkerEvent(ae),this.update(),this}},{key:"openPopup",value:function(){var ae=this;if(!this.added)return this.once("added",function(){ae.openPopup()}),this;var et=this.popup;return et?(et.isOpen()||et.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ae=this;this.added||this.once("added",function(){ae.closePopup()});var et=this.popup;return et&&et.remove(),this}},{key:"setPopup",value:function(ae){return this.popup=ae,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ae=this.popup;if(ae)ae.isOpen()?ae.remove():ae.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ae){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ae){this.markerOption.extData=ae}},{key:"update",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,zt=ae.anchor;this.updatePosition(),ge.a.setTransform(et,"".concat(ge.e[zt]))}},{key:"onMapClick",value:function(ae){var et=this.markerOption.element;this.popup&&et&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,zt=ae.offsets,sr=this.lngLat,ft=sr.lng,pt=sr.lat,At=this.mapsService.getBounds(),mt=this.mapsService.getZoom();if((ft<At[0][0]||ft>At[1][0]||pt<At[0][1]||pt>At[1][1])&&mt>3){et&&(et.style.display="none");return}var Me=this.mapsService.lngLatToContainer([ft,pt]);et&&(et.style.display="block",et.style.left=Me.x+zt[0]+"px",et.style.top=Me.y-zt[1]+"px")}},{key:"init",value:function(){var ae=this,et=this.markerOption.element,zt=this.markerOption,sr=zt.color,ft=zt.anchor;if(!et){this.defaultMarker=!0,et=ge.a.create("div"),this.markerOption.element=et;var pt=document.createElementNS("http://www.w3.org/2000/svg","svg");pt.setAttributeNS(null,"display","block"),pt.setAttributeNS(null,"height","48px"),pt.setAttributeNS(null,"width","48px"),pt.setAttributeNS(null,"viewBox","0 0 1024 1024");var At=document.createElementNS("http://www.w3.org/2000/svg","path");At.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),At.setAttributeNS(null,"fill",sr),pt.appendChild(At),et.appendChild(pt)}ge.a.addClass(et,"l7-marker"),et.addEventListener("click",function(mt){ae.onMapClick(mt)}),et.addEventListener("click",this.eventHandle),Object(ge.g)(et,ft,"marker")}},{key:"registerMarkerEvent",value:function(ae){ae.addEventListener("mousemove",this.eventHandle),ae.addEventListener("click",this.eventHandle),ae.addEventListener("mousedown",this.eventHandle),ae.addEventListener("mouseup",this.eventHandle),ae.addEventListener("dblclick",this.eventHandle),ae.addEventListener("contextmenu",this.eventHandle),ae.addEventListener("mouseover",this.eventHandle),ae.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ae=this.getElement();ae.removeEventListener("mousemove",this.eventHandle),ae.removeEventListener("click",this.eventHandle),ae.removeEventListener("mousedown",this.eventHandle),ae.removeEventListener("mouseup",this.eventHandle),ae.removeEventListener("dblclick",this.eventHandle),ae.removeEventListener("contextmenu",this.eventHandle),ae.removeEventListener("mouseover",this.eventHandle),ae.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ae){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ae){throw new Error("Method not implemented.")}}]),$}(we.EventEmitter),St=i("QkVN"),ye=i.n(St),be=i("mpbz"),Be=i.n(be);function lt(nt,kt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);kt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function Pe(nt){for(var kt=1;kt<arguments.length;kt++){var $=arguments[kt]!=null?arguments[kt]:{};kt%2?lt(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):lt(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function ht(nt){var kt=w();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function w(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var I=function(nt){K()($,nt);var kt=ht($);function $(Ke){var ae,et;return z()(this,$),et=kt.call(this),et.markers=[],et.markerLayerOption=void 0,et.clusterIndex=void 0,et.points=[],et.clusterMarkers=[],et.mapsService=void 0,et.scene=void 0,et.zoom=void 0,et.bbox=void 0,et.markerLayerOption=ye()(et.getDefault(),Ke),Object(ge.i)(["update"],De()(et)),et.zoom=((ae=et.markerLayerOption.clusterOption)===null||ae===void 0?void 0:ae.zoom)||-99,et}return Z()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ae){return this.scene=ae,this.mapsService=ae.get(We.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ae){var et=this.markerLayerOption.cluster;et&&this.addPoint(ae,this.markers.length),this.markers.push(ae)}},{key:"removeMarker",value:function(ae){this.markers.indexOf(ae);var et=this.markers.indexOf(ae);et>-1&&this.markers.splice(et,1)}},{key:"getMarkers",value:function(){var ae=this.markerLayerOption.cluster;return ae?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ae=this;this.getMarkers().forEach(function(et){et.addTo(ae.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ae){ae.remove()}),this.clusterMarkers.forEach(function(ae){ae.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ae,et){var zt=ae.getLnglat(),sr=zt.lng,ft=zt.lat,pt={geometry:{type:"Point",coordinates:[sr,ft]},properties:Pe(Pe({},ae.getExtData()),{},{marker_id:et})};this.points.push(pt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ae=this.markerLayerOption.clusterOption,et=ae.radius,zt=ae.minZoom,sr=zt===void 0?0:zt,ft=ae.maxZoom;this.clusterIndex=new Be.a({radius:et,minZoom:sr,maxZoom:ft}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ae,et){var zt=this,sr=ae[0].concat(ae[1]),ft=this.clusterIndex.getClusters(sr,et);this.clusterMarkers.forEach(function(pt){pt.remove()}),this.clusterMarkers=[],ft.forEach(function(pt){var At,mt=zt.markerLayerOption.clusterOption,Me=mt.field,ct=mt.method;if(pt.properties&&((At=pt.properties)===null||At===void 0?void 0:At.cluster_id)){var qe,Vt=zt.getLeaves((qe=pt.properties)===null||qe===void 0?void 0:qe.cluster_id);if(pt.properties.clusterData=Vt,Me&&ct){var pr=Vt==null?void 0:Vt.map(function(na){var fa=m()({},Me,na.properties[Me]);return fa}),Gr=ge.c.getColumn(pr,Me),ur=ge.c.getSatByColumn(ct,Gr),zn="point_"+ct;pt.properties[zn]=ur.toFixed(2)}}var xn=zt.clusterMarker(pt);zt.clusterMarkers.push(xn),xn.addTo(zt.scene)})}},{key:"getLeaves",value:function(ae){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,zt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ae?this.clusterIndex.getLeaves(ae,et,zt):null}},{key:"clusterMarker",value:function(ae){var et=this.markerLayerOption.clusterOption,zt=et,sr=zt.element,ft=sr===void 0?this.generateElement.bind(this):sr,pt=new $t({element:ft(ae)}).setLnglat({lng:ae.geometry.coordinates[0],lat:ae.geometry.coordinates[1]});return pt}},{key:"normalMarker",value:function(ae){var et=ae.properties.marker_id;return this.markers[et]}},{key:"update",value:function(){var ae=this.mapsService.getZoom(),et=this.mapsService.getBounds();(!this.bbox||Math.abs(ae-this.zoom)>=1||!Object(ge.j)(this.bbox,et))&&(this.bbox=Object(ge.r)(et,.5),this.zoom=Math.floor(ae),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ae){var et=ge.a.create("div","l7-marker-cluster"),zt=ge.a.create("div","",et),sr=ge.a.create("span","",zt),ft=this.markerLayerOption.clusterOption,pt=ft.field,At=ft.method;ae.properties.point_count=ae.properties.point_count||1;var mt=pt&&At?ae.properties["point_"+At]||ae.properties[pt]:ae.properties.point_count;return sr.textContent=mt,et}}]),$}(we.EventEmitter);function q(nt,kt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);kt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function ce(nt){for(var kt=1;kt<arguments.length;kt++){var $=arguments[kt]!=null?arguments[kt]:{};kt%2?q(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function Ve(nt){var kt=$e();return function(){var Ke=Fe()(nt),ae;if(kt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return fe()(this,ae)}}function $e(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var gt=function(nt){K()($,nt);var kt=Ve($);function $(Ke){var ae;return z()(this,$),ae=kt.call(this),ae.popupOption=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.content=void 0,ae.closeButton=void 0,ae.timeoutInstance=void 0,ae.container=void 0,ae.tip=void 0,ae.scene=void 0,ae.popupOption=ce(ce({},ae.getdefault()),Ke),Object(ge.i)(["update","onClickClose","remove"],De()(ae)),ae}return Z()($,[{key:"addTo",value:function(ae){var et=this;return this.mapsService=ae.get(We.TYPES.IMapService),this.sceneSerive=ae.get(We.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ae,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){et.mapsService.on("click",et.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ae){var et=window.document.createDocumentFragment(),zt=window.document.createElement("body"),sr;for(zt.innerHTML=ae;!(sr=zt.firstChild,!sr);)et.appendChild(sr);return this.setDOMContent(et)}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ae){return this.setDOMContent(window.document.createTextNode(ae))}},{key:"setMaxWidth",value:function(ae){return this.popupOption.maxWidth=ae,this.update(),this}},{key:"setDOMContent",value:function(ae){return this.createContent(),this.content.appendChild(ae),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&ge.a.remove(this.content),this.content=ge.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=ge.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ae,et,zt){var sr=window.document.createElement(ae);return et!==void 0&&(sr.className=et),zt&&zt.appendChild(sr),sr}},{key:"removeDom",value:function(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:ge.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ae){ae.stopPropagation&&ae.stopPropagation(),this.remove()}},{key:"update",value:function(){var ae=this,et=this.lngLat,zt=this.popupOption,sr=zt.className,ft=zt.maxWidth,pt=zt.anchor;if(!this.mapsService||!et||!this.content)return;var At=this.mapsService.getMarkerContainer();if(!this.container&&At){this.container=this.creatDom("div","l7-popup",At),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),sr&&sr.split(" ").forEach(function(Me){return ae.container.classList.add(Me)});var mt=this.popupOption.stopPropagation;mt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Me){ae.container.addEventListener(Me,function(ct){ct.stopPropagation()})})}ft&&this.container.style.maxWidth!==ft&&(this.container.style.maxWidth=ft),this.updatePosition(),ge.a.setTransform(this.container,"".concat(ge.e[pt])),Object(ge.g)(this.container,pt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.lngLat,et=ae.lng,zt=ae.lat,sr=this.popupOption.offsets,ft=this.mapsService.lngLatToContainer([et,zt]);this.container.style.left=ft.x+sr[0]+"px",this.container.style.top=ft.y-sr[1]+"px"}}]),$}(we.EventEmitter);i("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Re,E,i){"use strict";var T=i("/kpp");E.a=T.a},"kQ+U":function(Re,E,i){"use strict";i.d(E,"a",function(){return pt});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("k5/I"),K=i("h1nZ"),re=i("o0o1"),fe=i.n(re),Y=i("yXPU"),Fe=i.n(Y),We=i("4cb6"),ge=i("fbvF"),we=i.n(ge),dt=function(){function At(mt,Me){z()(this,At),this.attribute=void 0,this.buffer=void 0;var ct=Me.buffer,qe=Me.offset,Vt=Me.stride,pr=Me.normalized,Gr=Me.size,ur=Me.divisor;this.buffer=ct,this.attribute={buffer:ct.get(),offset:qe||0,stride:Vt||0,normalized:pr||!1,divisor:ur||0},Gr&&(this.attribute.size=Gr)}return Z()(At,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Me){this.buffer.subData(Me)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),At}(),ke,Et,Ze,vt,Qe,yt,_t,De,Ne,Ue,st,Le,ut,Gt,Kt=(ke={},m()(ke,K.gl.POINTS,"points"),m()(ke,K.gl.LINES,"lines"),m()(ke,K.gl.LINE_LOOP,"line loop"),m()(ke,K.gl.LINE_STRIP,"line strip"),m()(ke,K.gl.TRIANGLES,"triangles"),m()(ke,K.gl.TRIANGLE_FAN,"triangle fan"),m()(ke,K.gl.TRIANGLE_STRIP,"triangle strip"),ke),ar=(Et={},m()(Et,K.gl.STATIC_DRAW,"static"),m()(Et,K.gl.DYNAMIC_DRAW,"dynamic"),m()(Et,K.gl.STREAM_DRAW,"stream"),Et),oe=(Ze={},m()(Ze,K.gl.BYTE,"int8"),m()(Ze,K.gl.UNSIGNED_INT,"int16"),m()(Ze,K.gl.INT,"int32"),m()(Ze,K.gl.UNSIGNED_BYTE,"uint8"),m()(Ze,K.gl.UNSIGNED_SHORT,"uint16"),m()(Ze,K.gl.UNSIGNED_INT,"uint32"),m()(Ze,K.gl.FLOAT,"float"),Ze),Q=(vt={},m()(vt,K.gl.ALPHA,"alpha"),m()(vt,K.gl.LUMINANCE,"luminance"),m()(vt,K.gl.LUMINANCE_ALPHA,"luminance alpha"),m()(vt,K.gl.RGB,"rgb"),m()(vt,K.gl.RGBA,"rgba"),m()(vt,K.gl.RGBA4,"rgba4"),m()(vt,K.gl.RGB5_A1,"rgb5 a1"),m()(vt,K.gl.RGB565,"rgb565"),m()(vt,K.gl.DEPTH_COMPONENT,"depth"),m()(vt,K.gl.DEPTH_STENCIL,"depth stencil"),vt),H=(Qe={},m()(Qe,K.gl.DONT_CARE,"dont care"),m()(Qe,K.gl.NICEST,"nice"),m()(Qe,K.gl.FASTEST,"fast"),Qe),Ce=(yt={},m()(yt,K.gl.NEAREST,"nearest"),m()(yt,K.gl.LINEAR,"linear"),m()(yt,K.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),m()(yt,K.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),m()(yt,K.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),m()(yt,K.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),yt),Ee=(_t={},m()(_t,K.gl.REPEAT,"repeat"),m()(_t,K.gl.CLAMP_TO_EDGE,"clamp"),m()(_t,K.gl.MIRRORED_REPEAT,"mirror"),_t),_e=(De={},m()(De,K.gl.NONE,"none"),m()(De,K.gl.BROWSER_DEFAULT_WEBGL,"browser"),De),ve=(Ne={},m()(Ne,K.gl.NEVER,"never"),m()(Ne,K.gl.ALWAYS,"always"),m()(Ne,K.gl.LESS,"less"),m()(Ne,K.gl.LEQUAL,"lequal"),m()(Ne,K.gl.GREATER,"greater"),m()(Ne,K.gl.GEQUAL,"gequal"),m()(Ne,K.gl.EQUAL,"equal"),m()(Ne,K.gl.NOTEQUAL,"notequal"),Ne),rt=(Ue={},m()(Ue,K.gl.FUNC_ADD,"add"),m()(Ue,K.gl.MIN_EXT,"min"),m()(Ue,K.gl.MAX_EXT,"max"),m()(Ue,K.gl.FUNC_SUBTRACT,"subtract"),m()(Ue,K.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ue),$t=(st={},m()(st,K.gl.ZERO,"zero"),m()(st,K.gl.ONE,"one"),m()(st,K.gl.SRC_COLOR,"src color"),m()(st,K.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),m()(st,K.gl.SRC_ALPHA,"src alpha"),m()(st,K.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),m()(st,K.gl.DST_COLOR,"dst color"),m()(st,K.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),m()(st,K.gl.DST_ALPHA,"dst alpha"),m()(st,K.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),m()(st,K.gl.CONSTANT_COLOR,"constant color"),m()(st,K.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),m()(st,K.gl.CONSTANT_ALPHA,"constant alpha"),m()(st,K.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),m()(st,K.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),st),St=(Le={},m()(Le,K.gl.NEVER,"never"),m()(Le,K.gl.ALWAYS,"always"),m()(Le,K.gl.LESS,"less"),m()(Le,K.gl.LEQUAL,"lequal"),m()(Le,K.gl.GREATER,"greater"),m()(Le,K.gl.GEQUAL,"gequal"),m()(Le,K.gl.EQUAL,"equal"),m()(Le,K.gl.NOTEQUAL,"notequal"),Le),ye=(ut={},m()(ut,K.gl.ZERO,"zero"),m()(ut,K.gl.KEEP,"keep"),m()(ut,K.gl.REPLACE,"replace"),m()(ut,K.gl.INVERT,"invert"),m()(ut,K.gl.INCR,"increment"),m()(ut,K.gl.DECR,"decrement"),m()(ut,K.gl.INCR_WRAP,"increment wrap"),m()(ut,K.gl.DECR_WRAP,"decrement wrap"),ut),be=(Gt={},m()(Gt,K.gl.FRONT,"front"),m()(Gt,K.gl.BACK,"back"),Gt),Be=function(){function At(mt,Me){z()(this,At),this.buffer=void 0;var ct=Me.data,qe=Me.usage,Vt=Me.type;this.buffer=mt.buffer({data:ct,usage:ar[qe||K.gl.STATIC_DRAW],type:oe[Vt||K.gl.UNSIGNED_BYTE]})}return Z()(At,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Me){var ct=Me.data,qe=Me.offset;this.buffer.subdata(ct,qe)}}]),At}(),lt=function(){function At(mt,Me){z()(this,At),this.elements=void 0;var ct=Me.data,qe=Me.usage,Vt=Me.type,pr=Me.count;this.elements=mt.elements({data:ct,usage:ar[qe||K.gl.STATIC_DRAW],type:oe[Vt||K.gl.UNSIGNED_BYTE],count:pr})}return Z()(At,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Me){var ct=Me.data;this.elements.subdata(ct)}},{key:"destroy",value:function(){}}]),At}(),Pe=function(){function At(mt,Me){z()(this,At),this.framebuffer=void 0;var ct=Me.width,qe=Me.height,Vt=Me.color,pr=Me.colors,Gr=Me.depth,ur=Me.stencil,zn={width:ct,height:qe};Array.isArray(pr)&&(zn.colors=pr.map(function(xn){return xn.get()})),Vt&&typeof Vt!="boolean"&&(zn.color=Vt.get()),this.framebuffer=mt.framebuffer(zn)}return Z()(At,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Me){var ct=Me.width,qe=Me.height;this.framebuffer.resize(ct,qe)}}]),At}(),ht=i("cDf5"),w=i.n(ht),I=i("c6wG"),q=i.n(I),ce=i("YO3V"),Ve=i.n(ce);function $e(At,mt){var Me=Object.keys(At);if(Object.getOwnPropertySymbols){var ct=Object.getOwnPropertySymbols(At);mt&&(ct=ct.filter(function(qe){return Object.getOwnPropertyDescriptor(At,qe).enumerable})),Me.push.apply(Me,ct)}return Me}function gt(At){for(var mt=1;mt<arguments.length;mt++){var Me=arguments[mt]!=null?arguments[mt]:{};mt%2?$e(Object(Me),!0).forEach(function(ct){m()(At,ct,Me[ct])}):Object.getOwnPropertyDescriptors?Object.defineProperties(At,Object.getOwnPropertyDescriptors(Me)):$e(Object(Me)).forEach(function(ct){Object.defineProperty(At,ct,Object.getOwnPropertyDescriptor(Me,ct))})}return At}var nt=function(){function At(mt,Me){z()(this,At),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=mt;var ct=Me.vs,qe=Me.fs,Vt=Me.attributes,pr=Me.uniforms,Gr=Me.primitive,ur=Me.count,zn=Me.elements,xn=Me.depth,na=Me.blend,fa=Me.stencil,Hn=Me.cull,Gn=Me.instances,F={};this.options=Me,pr&&(this.uniforms=this.extractUniforms(pr),Object.keys(pr).forEach(function(pe){F[pe]=mt.prop(pe)}));var W={};Object.keys(Vt).forEach(function(pe){W[pe]=Vt[pe].get()});var le={attributes:W,frag:qe,uniforms:F,vert:ct,primitive:Kt[Gr===void 0?K.gl.TRIANGLES:Gr]};Gn&&(le.instances=Gn),ur&&(le.count=ur),zn&&(le.elements=zn.get()),this.initDepthDrawParams({depth:xn},le),this.initBlendDrawParams({blend:na},le),this.initStencilDrawParams({stencil:fa},le),this.initCullDrawParams({cull:Hn},le),this.drawCommand=mt(le),this.drawParams=le}return Z()(At,[{key:"addUniforms",value:function(Me){this.uniforms=gt(gt({},this.uniforms),this.extractUniforms(Me))}},{key:"draw",value:function(Me){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var ct=gt(gt({},this.uniforms),this.extractUniforms(Me.uniforms||{})),qe={};Object.keys(ct).forEach(function(Vt){var pr=w()(ct[Vt]);pr==="boolean"||pr==="number"||Array.isArray(ct[Vt])||ct[Vt].BYTES_PER_ELEMENT?qe[Vt]=ct[Vt]:qe[Vt]=ct[Vt].get()}),this.drawCommand(qe)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Me){Me.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Me,ct){var qe=Me.depth;qe&&(ct.depth={enable:qe.enable===void 0?!0:!!qe.enable,mask:qe.mask===void 0?!0:!!qe.mask,func:ve[qe.func||K.gl.LESS],range:qe.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Me,ct){var qe=Me.blend;if(qe){var Vt=qe.enable,pr=qe.func,Gr=qe.equation,ur=qe.color,zn=ur===void 0?[0,0,0,0]:ur;ct.blend={enable:!!Vt,func:{srcRGB:$t[pr&&pr.srcRGB||K.gl.SRC_ALPHA],srcAlpha:$t[pr&&pr.srcAlpha||K.gl.SRC_ALPHA],dstRGB:$t[pr&&pr.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:$t[pr&&pr.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:rt[Gr&&Gr.rgb||K.gl.FUNC_ADD],alpha:rt[Gr&&Gr.alpha||K.gl.FUNC_ADD]},color:zn}}}},{key:"initStencilDrawParams",value:function(Me,ct){var qe=Me.stencil;if(qe){var Vt=qe.enable,pr=qe.mask,Gr=pr===void 0?-1:pr,ur=qe.func,zn=ur===void 0?{cmp:K.gl.ALWAYS,ref:0,mask:-1}:ur,xn=qe.opFront,na=xn===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:xn,fa=qe.opBack,Hn=fa===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:fa;ct.stencil={enable:!!Vt,mask:Gr,func:gt(gt({},zn),{},{cmp:St[zn.cmp]}),opFront:{fail:ye[na.fail],zfail:ye[na.zfail],zpass:ye[na.zpass]},opBack:{fail:ye[Hn.fail],zfail:ye[Hn.zfail],zpass:ye[Hn.zpass]}}}}},{key:"initCullDrawParams",value:function(Me,ct){var qe=Me.cull;if(qe){var Vt=qe.enable,pr=qe.face,Gr=pr===void 0?K.gl.BACK:pr;ct.cull={enable:!!Vt,face:be[Gr]}}}},{key:"extractUniforms",value:function(Me){var ct=this,qe={};return Object.keys(Me).forEach(function(Vt){ct.extractUniformsRecursively(Vt,Me[Vt],qe,"")}),qe}},{key:"extractUniformsRecursively",value:function(Me,ct,qe,Vt){var pr=this;if(ct===null||typeof ct=="number"||typeof ct=="boolean"||Array.isArray(ct)&&typeof ct[0]=="number"||q()(ct)||ct===""||"resize"in ct){qe["".concat(Vt&&Vt+".").concat(Me)]=ct;return}Ve()(ct)&&Object.keys(ct).forEach(function(Gr){pr.extractUniformsRecursively(Gr,ct[Gr],qe,"".concat(Vt&&Vt+".").concat(Me))}),Array.isArray(ct)&&ct.forEach(function(Gr,ur){Object.keys(Gr).forEach(function(zn){pr.extractUniformsRecursively(zn,Gr[zn],qe,"".concat(Vt&&Vt+".").concat(Me,"[").concat(ur,"]"))})})}}]),At}(),kt=function(){function At(mt,Me){z()(this,At),this.texture=void 0,this.width=void 0,this.height=void 0;var ct=Me.data,qe=Me.type,Vt=qe===void 0?K.gl.UNSIGNED_BYTE:qe,pr=Me.width,Gr=Me.height,ur=Me.flipY,zn=ur===void 0?!1:ur,xn=Me.format,na=xn===void 0?K.gl.RGBA:xn,fa=Me.mipmap,Hn=fa===void 0?!1:fa,Gn=Me.wrapS,F=Gn===void 0?K.gl.CLAMP_TO_EDGE:Gn,W=Me.wrapT,le=W===void 0?K.gl.CLAMP_TO_EDGE:W,pe=Me.aniso,at=pe===void 0?0:pe,Tt=Me.alignment,jt=Tt===void 0?1:Tt,Ge=Me.premultiplyAlpha,wt=Ge===void 0?!1:Ge,ir=Me.mag,Ur=ir===void 0?K.gl.NEAREST:ir,Vr=Me.min,or=Vr===void 0?K.gl.NEAREST:Vr,Fr=Me.colorSpace,Sn=Fr===void 0?K.gl.BROWSER_DEFAULT_WEBGL:Fr;this.width=pr,this.height=Gr;var fn={width:pr,height:Gr,type:oe[Vt],format:Q[na],wrapS:Ee[F],wrapT:Ee[le],mag:Ce[Ur],min:Ce[or],alignment:jt,flipY:zn,colorSpace:_e[Sn],premultiplyAlpha:wt,aniso:at};ct&&(fn.data=ct),typeof Hn=="number"?fn.mipmap=H[Hn]:typeof Hn=="boolean"&&(fn.mipmap=Hn),this.texture=mt.texture(fn)}return Z()(At,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Me)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Me){var ct=Me.width,qe=Me.height;this.texture.resize(ct,qe),this.width=ct,this.height=qe}},{key:"destroy",value:function(){this.texture.destroy()}}]),At}(),$,Ke,ae,et=($=Object(We.injectable)(),$(Ke=(ae=function(){function At(){var mt=this;z()(this,At),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Me){return new nt(mt.gl,Me)},this.createAttribute=function(Me){return new dt(mt.gl,Me)},this.createBuffer=function(Me){return new Be(mt.gl,Me)},this.createElements=function(Me){return new lt(mt.gl,Me)},this.createTexture2D=function(Me){return new kt(mt.gl,Me)},this.createFramebuffer=function(Me){return new Pe(mt.gl,Me)},this.useFramebuffer=function(Me,ct){mt.gl({framebuffer:Me?Me.get():null})(ct)},this.clear=function(Me){var ct=Me.color,qe=Me.depth,Vt=Me.stencil,pr=Me.framebuffer,Gr=pr===void 0?null:pr,ur={color:ct,depth:qe,stencil:Vt};ur.framebuffer=Gr===null?Gr:Gr.get(),mt.gl.clear(ur)},this.viewport=function(Me){var ct=Me.x,qe=Me.y,Vt=Me.width,pr=Me.height;mt.gl._gl.viewport(ct,qe,Vt,pr),mt.width=Vt,mt.height=pr,mt.gl._refresh()},this.readPixels=function(Me){var ct=Me.framebuffer,qe=Me.x,Vt=Me.y,pr=Me.width,Gr=Me.height,ur={x:qe,y:Vt,width:pr,height:Gr};return ct&&(ur.framebuffer=ct.get()),mt.gl.read(ur)},this.getViewportSize=function(){return{width:mt.gl._gl.drawingBufferWidth,height:mt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Me;return(Me=mt.canvas)===null||Me===void 0?void 0:Me.parentElement},this.getCanvas=function(){return mt.canvas},this.getGLContext=function(){return mt.gl._gl},this.destroy=function(){mt.gl.destroy()}}return Z()(At,[{key:"init",value:function(){var mt=Fe()(fe.a.mark(function ct(qe,Vt){var pr=this;return fe.a.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return this.canvas=qe,ur.next=3,new Promise(function(zn,xn){we()({canvas:pr.canvas,attributes:{alpha:!0,antialias:Vt.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Vt.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(fa,Hn){(fa||!Hn)&&xn(fa),zn(Hn)}})});case 3:this.gl=ur.sent;case 4:case"end":return ur.stop()}},ct,this)}));function Me(ct,qe){return mt.apply(this,arguments)}return Me}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Me=this.getGLContext();Me.disable(Me.CULL_FACE)}},{key:"setDirty",value:function(Me){this.isDirty=Me}},{key:"getDirty",value:function(){return this.isDirty}}]),At}(),ae))||Ke),zt=i("Hel2");function sr(At,mt){var Me=Object.keys(At);if(Object.getOwnPropertySymbols){var ct=Object.getOwnPropertySymbols(At);mt&&(ct=ct.filter(function(qe){return Object.getOwnPropertyDescriptor(At,qe).enumerable})),Me.push.apply(Me,ct)}return Me}function ft(At){for(var mt=1;mt<arguments.length;mt++){var Me=arguments[mt]!=null?arguments[mt]:{};mt%2?sr(Object(Me),!0).forEach(function(ct){m()(At,ct,Me[ct])}):Object.getOwnPropertyDescriptors?Object.defineProperties(At,Object.getOwnPropertyDescriptors(Me)):sr(Object(Me)).forEach(function(ct){Object.defineProperty(At,ct,Object.getOwnPropertyDescriptor(Me,ct))})}return At}var pt=function(){function At(mt){z()(this,At),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Me=mt.id,ct=mt.map,qe=Object(K.createSceneContainer)();this.container=qe,ct.setContainer(qe,Me),qe.bind(K.TYPES.IRendererService).to(et).inSingletonScope(),this.sceneService=qe.get(K.TYPES.ISceneService),this.mapService=qe.get(K.TYPES.IMapService),this.iconService=qe.get(K.TYPES.IIconService),this.fontService=qe.get(K.TYPES.IFontService),this.controlService=qe.get(K.TYPES.IControlService),this.layerService=qe.get(K.TYPES.ILayerService),this.markerService=qe.get(K.TYPES.IMarkerService),this.interactionService=qe.get(K.TYPES.IInteractionService),this.popupService=qe.get(K.TYPES.IPopupService),this.initComponent(Me),this.sceneService.init(mt),this.initControl()}return Z()(At,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Me){return this.sceneService.exportPng(Me)}},{key:"exportMap",value:function(Me){return this.sceneService.exportPng(Me)}},{key:"registerRenderService",value:function(Me){var ct=this;if(this.sceneService.loaded){var qe=new Me(this);qe.init()}else this.on("loaded",function(){var Vt=new Me(ct);Vt.init()})}},{key:"addLayer",value:function(Me){var ct=Object(K.createLayerContainer)(this.container);Me.setContainer(ct),this.sceneService.addLayer(Me)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Me){return this.layerService.getLayer(Me)}},{key:"getLayerByName",value:function(Me){return this.layerService.getLayerByName(Me)}},{key:"removeLayer",value:function(Me){this.layerService.remove(Me)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Me,ct){this.iconService.addImage(Me,ct)}},{key:"hasImage",value:function(Me){return this.iconService.hasImage(Me)}},{key:"removeImage",value:function(Me){this.iconService.removeImage(Me)}},{key:"addIconFontGlyphs",value:function(Me,ct){this.fontService.addIconGlyphs(ct)}},{key:"addControl",value:function(Me){this.controlService.addControl(Me,this.container)}},{key:"removeControl",value:function(Me){this.controlService.removeControl(Me)}},{key:"getControlByName",value:function(Me){return this.controlService.getControlByName(Me)}},{key:"addMarker",value:function(Me){this.markerService.addMarker(Me)}},{key:"addMarkerLayer",value:function(Me){this.markerService.addMarkerLayer(Me)}},{key:"removeMarkerLayer",value:function(Me){this.markerService.removeMarkerLayer(Me)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Me){this.popupService.addPopup(Me)}},{key:"on",value:function(Me,ct){K.SceneEventList.indexOf(Me)===-1?this.mapService.on(Me,ct):this.sceneService.on(Me,ct)}},{key:"off",value:function(Me,ct){K.SceneEventList.indexOf(Me)===-1?this.mapService.off(Me,ct):this.sceneService.off(Me,ct)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Me){return this.mapService.setCenter(Me)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Me){return this.mapService.setPitch(Me)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Me){this.mapService.setRotation(Me)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Me){this.mapService.panTo(Me)}},{key:"panBy",value:function(Me){this.mapService.panBy(Me)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Me){this.mapService.setZoom(Me)}},{key:"fitBounds",value:function(Me,ct){var qe=this.sceneService.getSceneConfig(),Vt=qe.fitBoundsOptions,pr=qe.animate;this.mapService.fitBounds(Me,ct||ft(ft({},Vt),{},{animate:pr}))}},{key:"setZoomAndCenter",value:function(Me,ct){this.mapService.setZoomAndCenter(Me,ct)}},{key:"setMapStyle",value:function(Me){this.mapService.setMapStyle(Me)}},{key:"setMapStatus",value:function(Me){this.mapService.setMapStatus(Me)}},{key:"pixelToLngLat",value:function(Me){return this.mapService.pixelToLngLat(Me)}},{key:"lngLatToPixel",value:function(Me){return this.mapService.lngLatToPixel(Me)}},{key:"containerToLngLat",value:function(Me){return this.mapService.containerToLngLat(Me)}},{key:"lngLatToContainer",value:function(Me){return this.mapService.lngLatToContainer(Me)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Me,ct){this.container.bind(K.TYPES.IPostProcessingPass).to(Me).whenTargetNamed(ct)}},{key:"initComponent",value:function(Me){this.controlService.init({container:zt.a.getContainer(Me)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Me=this.sceneService.getSceneConfig(),ct=Me.logoVisible,qe=Me.logoPosition;ct&&this.addControl(new D.b({position:qe}))}},{key:"map",get:function(){return this.mapService.map}}]),At}()},kZZr:function(Re,E,i){Re.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},l94r:function(Re,E,i){"use strict";i.d(E,"a",function(){return Q});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("7W2i"),K=i.n(D),re=i("a1gu"),fe=i.n(re),Y=i("Nsbk"),Fe=i.n(Y),We=i("4qC0"),ge=i.n(We),we=i("lSCD"),dt=i.n(we),ke=i("BkRI"),Et=i.n(ke),Ze=i("xp6e"),vt=i("Hel2"),Qe=i("uhBA"),yt=i("rlAn"),_t=i("qxNg");function De(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Ce=H[0],Ee=1;Ee<H.length;Ee++)H[Ee]>Ce&&(Ce=H[Ee]);return Ce}function Ne(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Ce=H[0],Ee=1;Ee<H.length;Ee++)H[Ee]<Ce&&(Ce=H[Ee]);return Ce}function Ue(H){if(H.length===0)return 0;for(var Ce=H[0],Ee=0,_e,ve=1;ve<H.length;ve++)_e=Ce+H[ve]*1,Math.abs(Ce)>=Math.abs(H[ve])?Ee+=Ce-_e+H[ve]:Ee+=H[ve]-_e+Ce,Ce=_e;return Ce+Ee*1}function st(H){if(H.length===0)throw new Error("mean requires at least one data point");return Ue(H)/H.length}var Le={min:Ne,max:De,mean:st,sum:Ue};function ut(H,Ce){return H.map(function(Ee){return Ee[Ce]*1})}function Gt(H,Ce){var Ee=Object.keys(H);if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(H);Ce&&(_e=_e.filter(function(ve){return Object.getOwnPropertyDescriptor(H,ve).enumerable})),Ee.push.apply(Ee,_e)}return Ee}function Kt(H){for(var Ce=1;Ce<arguments.length;Ce++){var Ee=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?Gt(Object(Ee),!0).forEach(function(_e){m()(H,_e,Ee[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(Ee)):Gt(Object(Ee)).forEach(function(_e){Object.defineProperty(H,_e,Object.getOwnPropertyDescriptor(Ee,_e))})}return H}function ar(H){var Ce=oe();return function(){var _e=Fe()(H),ve;if(Ce){var rt=Fe()(this).constructor;ve=Reflect.construct(_e,arguments,rt)}else ve=_e.apply(this,arguments);return fe()(this,ve)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var Q=function(H){K()(Ee,H);var Ce=ar(Ee);function Ee(_e,ve){var rt;return z()(this,Ee),rt=Ce.call(this),rt.data=void 0,rt.extent=void 0,rt.hooks={init:new Ze.c},rt.parser={type:"geojson"},rt.transforms=[],rt.cluster=!1,rt.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},rt.originData=void 0,rt.rawData=void 0,rt.clusterIndex=void 0,rt.originData=_e,rt.initCfg(ve),rt.hooks.init.tap("parser",function(){rt.excuteParser()}),rt.hooks.init.tap("cluster",function(){rt.initCluster()}),rt.hooks.init.tap("transform",function(){rt.executeTrans()}),rt.init(),rt}return Z()(Ee,[{key:"setData",value:function(ve,rt){this.rawData=ve,this.originData=ve,this.initCfg(rt),this.init(),this.emit("update")}},{key:"getClusters",value:function(ve){return this.clusterIndex.getClusters(this.extent,ve)}},{key:"getClustersLeaves",value:function(ve){return this.clusterIndex.getLeaves(ve,Infinity)}},{key:"updateClusterData",value:function(ve){var rt=this,$t=this.clusterOptions,St=$t.method,ye=St===void 0?"sum":St,be=$t.field,Be=Object(vt.r)(Object(vt.h)(this.extent),2),lt=this.clusterIndex.getClusters(Be[0].concat(Be[1]),Math.floor(ve));this.clusterOptions.zoom=ve,lt.forEach(function(Pe){Pe.id||(Pe.properties.point_count=1)}),(be||dt()(ye))&&(lt=lt.map(function(Pe){var ht=Pe.id;if(ht){var w=rt.clusterIndex.getLeaves(ht,Infinity),I=w.map(function(Ve){return Ve.properties}),q;if(ge()(ye)&&be){var ce=ut(I,be);q=Le[ye](ce)}dt()(ye)&&(q=ye(I)),Pe.properties.stat=q}else Pe.properties.point_count=1;return Pe})),this.data=Object(yt.getParser)("geojson")({type:"FeatureCollection",features:lt}),this.executeTrans()}},{key:"getFeatureById",value:function(ve){var rt=this.parser.type,$t=rt===void 0?"geojson":rt;if($t==="geojson"&&!this.cluster){var St=ve<this.originData.features.length?this.originData.features[ve]:"null",ye=Et()(St);if(this.transforms.length!==0){var be=this.data.dataArray.find(function(Be){return Be._id===ve});ye.properties=be}return ye}else return ve<this.data.dataArray.length?this.data.dataArray[ve]:"null"}},{key:"getFeatureId",value:function(ve,rt){var $t=this.data.dataArray.find(function(St){return St[ve]===name});return $t==null?void 0:$t._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(ve){ve&&(ve.parser&&(this.parser=ve.parser),ve.transforms&&(this.transforms=ve.transforms),this.cluster=ve.cluster||!1,ve.clusterOptions&&(this.cluster=!0,this.clusterOptions=Kt(Kt({},this.clusterOptions),ve.clusterOptions)))}},{key:"excuteParser",value:function(){var ve=this.parser,rt=ve.type||"geojson",$t=Object(yt.getParser)(rt);this.data=$t(this.originData,ve),this.extent=Object(vt.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var ve=this,rt=this.transforms;rt.forEach(function($t){var St=$t.type,ye=Object(yt.getTransform)(St)(ve.data,$t);Object.assign(ve.data,ye)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var ve=this.clusterOptions||{};this.clusterIndex=Object(_t.a)(this.data,ve)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),Ee}(Qe.EventEmitter)},lJbI:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.extent,o=X.width,Z=X.height,D=X.min,K=X.max,re={_id:1,dataArray:[{_id:1,data:Array.from(m),width:o,height:Z,min:D,max:K,coordinates:[[z[0],z[1]],[z[2],z[3]]]}]};return re}},mNvP:function(Re,E,i){(function(T,m){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var X;(function(z){(function(o){var Z=typeof m=="object"?m:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=K(z);typeof Z.Reflect=="undefined"?Z.Reflect=z:D=K(Z.Reflect,D),o(D);function K(re,fe){return function(Y,Fe){typeof re[Y]!="function"&&Object.defineProperty(re,Y,{configurable:!0,writable:!0,value:Fe}),fe&&fe(Y,Fe)}}})(function(o){var Z=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",K=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",re=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",fe=typeof Object.create=="function",Y={__proto__:[]}instanceof Array,Fe=!fe&&!Y,We={create:fe?function(){return sr(Object.create(null))}:Y?function(){return sr({__proto__:null})}:function(){return sr({})},has:Fe?function(ft,pt){return Z.call(ft,pt)}:function(ft,pt){return pt in ft},get:Fe?function(ft,pt){return Z.call(ft,pt)?ft[pt]:void 0}:function(ft,pt){return ft[pt]}},ge=Object.getPrototypeOf(Function),we=typeof T=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",dt=!we&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ae(),ke=!we&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),Et=!we&&typeof WeakMap=="function"?WeakMap:zt(),Ze=new Et;function vt(ft,pt,At,mt){if($t(At)){if(!I(ft))throw new TypeError;if(!ce(pt))throw new TypeError;return Gt(ft,pt)}else{if(!I(ft))throw new TypeError;if(!be(pt))throw new TypeError;if(!be(mt)&&!$t(mt)&&!St(mt))throw new TypeError;return St(mt)&&(mt=void 0),At=w(At),Kt(ft,pt,At,mt)}}o("decorate",vt);function Qe(ft,pt){function At(mt,Me){if(!be(mt))throw new TypeError;if(!$t(Me)&&!Ve(Me))throw new TypeError;Ee(ft,pt,mt,Me)}return At}o("metadata",Qe);function yt(ft,pt,At,mt){if(!be(At))throw new TypeError;return $t(mt)||(mt=w(mt)),Ee(ft,pt,At,mt)}o("defineMetadata",yt);function _t(ft,pt,At){if(!be(pt))throw new TypeError;return $t(At)||(At=w(At)),oe(ft,pt,At)}o("hasMetadata",_t);function De(ft,pt,At){if(!be(pt))throw new TypeError;return $t(At)||(At=w(At)),Q(ft,pt,At)}o("hasOwnMetadata",De);function Ne(ft,pt,At){if(!be(pt))throw new TypeError;return $t(At)||(At=w(At)),H(ft,pt,At)}o("getMetadata",Ne);function Ue(ft,pt,At){if(!be(pt))throw new TypeError;return $t(At)||(At=w(At)),Ce(ft,pt,At)}o("getOwnMetadata",Ue);function st(ft,pt){if(!be(ft))throw new TypeError;return $t(pt)||(pt=w(pt)),_e(ft,pt)}o("getMetadataKeys",st);function Le(ft,pt){if(!be(ft))throw new TypeError;return $t(pt)||(pt=w(pt)),ve(ft,pt)}o("getOwnMetadataKeys",Le);function ut(ft,pt,At){if(!be(pt))throw new TypeError;$t(At)||(At=w(At));var mt=ar(pt,At,!1);if($t(mt))return!1;if(!mt.delete(ft))return!1;if(mt.size>0)return!0;var Me=Ze.get(pt);return Me.delete(At),Me.size>0||Ze.delete(pt),!0}o("deleteMetadata",ut);function Gt(ft,pt){for(var At=ft.length-1;At>=0;--At){var mt=ft[At],Me=mt(pt);if(!$t(Me)&&!St(Me)){if(!ce(Me))throw new TypeError;pt=Me}}return pt}function Kt(ft,pt,At,mt){for(var Me=ft.length-1;Me>=0;--Me){var ct=ft[Me],qe=ct(pt,At,mt);if(!$t(qe)&&!St(qe)){if(!be(qe))throw new TypeError;mt=qe}}return mt}function ar(ft,pt,At){var mt=Ze.get(ft);if($t(mt)){if(!At)return;mt=new dt,Ze.set(ft,mt)}var Me=mt.get(pt);if($t(Me)){if(!At)return;Me=new dt,mt.set(pt,Me)}return Me}function oe(ft,pt,At){var mt=Q(ft,pt,At);if(mt)return!0;var Me=Ke(pt);return St(Me)?!1:oe(ft,Me,At)}function Q(ft,pt,At){var mt=ar(pt,At,!1);return $t(mt)?!1:Pe(mt.has(ft))}function H(ft,pt,At){var mt=Q(ft,pt,At);if(mt)return Ce(ft,pt,At);var Me=Ke(pt);return St(Me)?void 0:H(ft,Me,At)}function Ce(ft,pt,At){var mt=ar(pt,At,!1);return $t(mt)?void 0:mt.get(ft)}function Ee(ft,pt,At,mt){var Me=ar(At,mt,!0);Me.set(ft,pt)}function _e(ft,pt){var At=ve(ft,pt),mt=Ke(ft);if(mt===null)return At;var Me=_e(mt,pt);if(Me.length<=0)return At;if(At.length<=0)return Me;for(var ct=new ke,qe=[],Vt=0,pr=At;Vt<pr.length;Vt++){var Gr=pr[Vt],ur=ct.has(Gr);ur||(ct.add(Gr),qe.push(Gr))}for(var zn=0,xn=Me;zn<xn.length;zn++){var Gr=xn[zn],ur=ct.has(Gr);ur||(ct.add(Gr),qe.push(Gr))}return qe}function ve(ft,pt){var At=[],mt=ar(ft,pt,!1);if($t(mt))return At;for(var Me=mt.keys(),ct=gt(Me),qe=0;;){var Vt=kt(ct);if(!Vt)return At.length=qe,At;var pr=nt(Vt);try{At[qe]=pr}catch(Gr){try{$(ct)}finally{throw Gr}}qe++}}function rt(ft){if(ft===null)return 1;switch(typeof ft){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ft===null?1:6;default:return 6}}function $t(ft){return ft===void 0}function St(ft){return ft===null}function ye(ft){return typeof ft=="symbol"}function be(ft){return typeof ft=="object"?ft!==null:typeof ft=="function"}function Be(ft,pt){switch(rt(ft)){case 0:return ft;case 1:return ft;case 2:return ft;case 3:return ft;case 4:return ft;case 5:return ft}var At=pt===3?"string":pt===5?"number":"default",mt=$e(ft,K);if(mt!==void 0){var Me=mt.call(ft,At);if(be(Me))throw new TypeError;return Me}return lt(ft,At==="default"?"number":At)}function lt(ft,pt){if(pt==="string"){var At=ft.toString;if(q(At)){var mt=At.call(ft);if(!be(mt))return mt}var Me=ft.valueOf;if(q(Me)){var mt=Me.call(ft);if(!be(mt))return mt}}else{var Me=ft.valueOf;if(q(Me)){var mt=Me.call(ft);if(!be(mt))return mt}var ct=ft.toString;if(q(ct)){var mt=ct.call(ft);if(!be(mt))return mt}}throw new TypeError}function Pe(ft){return!!ft}function ht(ft){return""+ft}function w(ft){var pt=Be(ft,3);return ye(pt)?pt:ht(pt)}function I(ft){return Array.isArray?Array.isArray(ft):ft instanceof Object?ft instanceof Array:Object.prototype.toString.call(ft)==="[object Array]"}function q(ft){return typeof ft=="function"}function ce(ft){return typeof ft=="function"}function Ve(ft){switch(rt(ft)){case 3:return!0;case 4:return!0;default:return!1}}function $e(ft,pt){var At=ft[pt];if(At==null)return;if(!q(At))throw new TypeError;return At}function gt(ft){var pt=$e(ft,re);if(!q(pt))throw new TypeError;var At=pt.call(ft);if(!be(At))throw new TypeError;return At}function nt(ft){return ft.value}function kt(ft){var pt=ft.next();return pt.done?!1:pt}function $(ft){var pt=ft.return;pt&&pt.call(ft)}function Ke(ft){var pt=Object.getPrototypeOf(ft);if(typeof ft!="function"||ft===ge)return pt;if(pt!==ge)return pt;var At=ft.prototype,mt=At&&Object.getPrototypeOf(At);if(mt==null||mt===Object.prototype)return pt;var Me=mt.constructor;return typeof Me!="function"||Me===ft?pt:Me}function ae(){var ft={},pt=[],At=function(){function qe(Vt,pr,Gr){this._index=0,this._keys=Vt,this._values=pr,this._selector=Gr}return qe.prototype["@@iterator"]=function(){return this},qe.prototype[re]=function(){return this},qe.prototype.next=function(){var Vt=this._index;if(Vt>=0&&Vt<this._keys.length){var pr=this._selector(this._keys[Vt],this._values[Vt]);return Vt+1>=this._keys.length?(this._index=-1,this._keys=pt,this._values=pt):this._index++,{value:pr,done:!1}}return{value:void 0,done:!0}},qe.prototype.throw=function(Vt){throw this._index>=0&&(this._index=-1,this._keys=pt,this._values=pt),Vt},qe.prototype.return=function(Vt){return this._index>=0&&(this._index=-1,this._keys=pt,this._values=pt),{value:Vt,done:!0}},qe}();return function(){function qe(){this._keys=[],this._values=[],this._cacheKey=ft,this._cacheIndex=-2}return Object.defineProperty(qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),qe.prototype.has=function(Vt){return this._find(Vt,!1)>=0},qe.prototype.get=function(Vt){var pr=this._find(Vt,!1);return pr>=0?this._values[pr]:void 0},qe.prototype.set=function(Vt,pr){var Gr=this._find(Vt,!0);return this._values[Gr]=pr,this},qe.prototype.delete=function(Vt){var pr=this._find(Vt,!1);if(pr>=0){for(var Gr=this._keys.length,ur=pr+1;ur<Gr;ur++)this._keys[ur-1]=this._keys[ur],this._values[ur-1]=this._values[ur];return this._keys.length--,this._values.length--,Vt===this._cacheKey&&(this._cacheKey=ft,this._cacheIndex=-2),!0}return!1},qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ft,this._cacheIndex=-2},qe.prototype.keys=function(){return new At(this._keys,this._values,mt)},qe.prototype.values=function(){return new At(this._keys,this._values,Me)},qe.prototype.entries=function(){return new At(this._keys,this._values,ct)},qe.prototype["@@iterator"]=function(){return this.entries()},qe.prototype[re]=function(){return this.entries()},qe.prototype._find=function(Vt,pr){return this._cacheKey!==Vt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Vt)),this._cacheIndex<0&&pr&&(this._cacheIndex=this._keys.length,this._keys.push(Vt),this._values.push(void 0)),this._cacheIndex},qe}();function mt(qe,Vt){return qe}function Me(qe,Vt){return Vt}function ct(qe,Vt){return[qe,Vt]}}function et(){return function(){function ft(){this._map=new dt}return Object.defineProperty(ft.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ft.prototype.has=function(pt){return this._map.has(pt)},ft.prototype.add=function(pt){return this._map.set(pt,pt),this},ft.prototype.delete=function(pt){return this._map.delete(pt)},ft.prototype.clear=function(){this._map.clear()},ft.prototype.keys=function(){return this._map.keys()},ft.prototype.values=function(){return this._map.values()},ft.prototype.entries=function(){return this._map.entries()},ft.prototype["@@iterator"]=function(){return this.keys()},ft.prototype[re]=function(){return this.keys()},ft}()}function zt(){var ft=16,pt=We.create(),At=mt();return function(){function pr(){this._key=mt()}return pr.prototype.has=function(Gr){var ur=Me(Gr,!1);return ur!==void 0?We.has(ur,this._key):!1},pr.prototype.get=function(Gr){var ur=Me(Gr,!1);return ur!==void 0?We.get(ur,this._key):void 0},pr.prototype.set=function(Gr,ur){var zn=Me(Gr,!0);return zn[this._key]=ur,this},pr.prototype.delete=function(Gr){var ur=Me(Gr,!1);return ur!==void 0?delete ur[this._key]:!1},pr.prototype.clear=function(){this._key=mt()},pr}();function mt(){var pr;do pr="@@WeakMap@@"+Vt();while(We.has(pt,pr));return pt[pr]=!0,pr}function Me(pr,Gr){if(!Z.call(pr,At)){if(!Gr)return;Object.defineProperty(pr,At,{value:We.create()})}return pr[At]}function ct(pr,Gr){for(var ur=0;ur<Gr;++ur)pr[ur]=Math.random()*255|0;return pr}function qe(pr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(pr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(pr)):ct(new Uint8Array(pr),pr):ct(new Array(pr),pr)}function Vt(){var pr=qe(ft);pr[6]=pr[6]&79|64,pr[8]=pr[8]&191|128;for(var Gr="",ur=0;ur<ft;++ur){var zn=pr[ur];(ur===4||ur===6||ur===8)&&(Gr+="-"),zn<16&&(Gr+="0"),Gr+=zn.toString(16).toLowerCase()}return Gr}}function sr(ft){return ft.__=void 0,delete ft.__,ft}})})(X||(X={}))}).call(this,i("Q2Ig"),i("yLpj"))},mTTR:function(Re,E,i){var T=i("b80T"),m=i("QcOe"),X=i("MMmD");function z(o){return X(o)?T(o,!0):m(o)}Re.exports=z},mc0g:function(Re,E){function i(T){return function(m,X,z){for(var o=-1,Z=Object(m),D=z(m),K=D.length;K--;){var re=D[T?K:++o];if(X(Z[re],re,Z)===!1)break}return m}}Re.exports=i},mhV4:function(Re,E,i){var T=i("ZK94");Re.exports.geometry=m,Re.exports.ring=z;function m(Z){var D=0,K;switch(Z.type){case"Polygon":return X(Z.coordinates);case"MultiPolygon":for(K=0;K<Z.coordinates.length;K++)D+=X(Z.coordinates[K]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(K=0;K<Z.geometries.length;K++)D+=m(Z.geometries[K]);return D}}function X(Z){var D=0;if(Z&&Z.length>0){D+=Math.abs(z(Z[0]));for(var K=1;K<Z.length;K++)D-=Math.abs(z(Z[K]))}return D}function z(Z){var D,K,re,fe,Y,Fe,We,ge=0,we=Z.length;if(we>2){for(We=0;We<we;We++)We===we-2?(fe=we-2,Y=we-1,Fe=0):We===we-1?(fe=we-1,Y=0,Fe=1):(fe=We,Y=We+1,Fe=We+2),D=Z[fe],K=Z[Y],re=Z[Fe],ge+=(o(re[0])-o(D[0]))*Math.sin(o(K[1]));ge=ge*T.RADIUS*T.RADIUS/2}return ge}function o(Z){return Z*Math.PI/180}},mpbz:function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";function T(De,Ne,Ue,st,Le,ut){if(Le-st<=Ue)return;var Gt=st+Le>>1;m(De,Ne,Gt,st,Le,ut%2),T(De,Ne,Ue,st,Gt-1,ut+1),T(De,Ne,Ue,Gt+1,Le,ut+1)}function m(De,Ne,Ue,st,Le,ut){for(;Le>st;){if(Le-st>600){var Gt=Le-st+1,Kt=Ue-st+1,ar=Math.log(Gt),oe=.5*Math.exp(2*ar/3),Q=.5*Math.sqrt(ar*oe*(Gt-oe)/Gt)*(Kt-Gt/2<0?-1:1),H=Math.max(st,Math.floor(Ue-Kt*oe/Gt+Q)),Ce=Math.min(Le,Math.floor(Ue+(Gt-Kt)*oe/Gt+Q));m(De,Ne,Ue,H,Ce,ut)}var Ee=Ne[2*Ue+ut],_e=st,ve=Le;for(X(De,Ne,st,Ue),Ne[2*Le+ut]>Ee&&X(De,Ne,st,Le);_e<ve;){for(X(De,Ne,_e,ve),_e++,ve--;Ne[2*_e+ut]<Ee;)_e++;for(;Ne[2*ve+ut]>Ee;)ve--}Ne[2*st+ut]===Ee?X(De,Ne,st,ve):(ve++,X(De,Ne,ve,Le)),ve<=Ue&&(st=ve+1),Ue<=ve&&(Le=ve-1)}}function X(De,Ne,Ue,st){z(De,Ue,st),z(Ne,2*Ue,2*st),z(Ne,2*Ue+1,2*st+1)}function z(De,Ne,Ue){var st=De[Ne];De[Ne]=De[Ue],De[Ue]=st}function o(De,Ne,Ue,st,Le,ut,Gt){for(var Kt=[0,De.length-1,0],ar=[],oe,Q;Kt.length;){var H=Kt.pop(),Ce=Kt.pop(),Ee=Kt.pop();if(Ce-Ee<=Gt){for(var _e=Ee;_e<=Ce;_e++)oe=Ne[2*_e],Q=Ne[2*_e+1],oe>=Ue&&oe<=Le&&Q>=st&&Q<=ut&&ar.push(De[_e]);continue}var ve=Math.floor((Ee+Ce)/2);oe=Ne[2*ve],Q=Ne[2*ve+1],oe>=Ue&&oe<=Le&&Q>=st&&Q<=ut&&ar.push(De[ve]);var rt=(H+1)%2;(H===0?Ue<=oe:st<=Q)&&(Kt.push(Ee),Kt.push(ve-1),Kt.push(rt)),(H===0?Le>=oe:ut>=Q)&&(Kt.push(ve+1),Kt.push(Ce),Kt.push(rt))}return ar}function Z(De,Ne,Ue,st,Le,ut){for(var Gt=[0,De.length-1,0],Kt=[],ar=Le*Le;Gt.length;){var oe=Gt.pop(),Q=Gt.pop(),H=Gt.pop();if(Q-H<=ut){for(var Ce=H;Ce<=Q;Ce++)D(Ne[2*Ce],Ne[2*Ce+1],Ue,st)<=ar&&Kt.push(De[Ce]);continue}var Ee=Math.floor((H+Q)/2),_e=Ne[2*Ee],ve=Ne[2*Ee+1];D(_e,ve,Ue,st)<=ar&&Kt.push(De[Ee]);var rt=(oe+1)%2;(oe===0?Ue-Le<=_e:st-Le<=ve)&&(Gt.push(H),Gt.push(Ee-1),Gt.push(rt)),(oe===0?Ue+Le>=_e:st+Le>=ve)&&(Gt.push(Ee+1),Gt.push(Q),Gt.push(rt))}return Kt}function D(De,Ne,Ue,st){var Le=De-Ue,ut=Ne-st;return Le*Le+ut*ut}var K=function(Ne){return Ne[0]},re=function(Ne){return Ne[1]},fe=function(Ne,Ue,st,Le,ut){Ue===void 0&&(Ue=K),st===void 0&&(st=re),Le===void 0&&(Le=64),ut===void 0&&(ut=Float64Array),this.nodeSize=Le,this.points=Ne;for(var Gt=Ne.length<65536?Uint16Array:Uint32Array,Kt=this.ids=new Gt(Ne.length),ar=this.coords=new ut(Ne.length*2),oe=0;oe<Ne.length;oe++)Kt[oe]=oe,ar[2*oe]=Ue(Ne[oe]),ar[2*oe+1]=st(Ne[oe]);T(Kt,ar,Le,0,Kt.length-1,0)};fe.prototype.range=function(Ne,Ue,st,Le){return o(this.ids,this.coords,Ne,Ue,st,Le,this.nodeSize)},fe.prototype.within=function(Ne,Ue,st){return Z(this.ids,this.coords,Ne,Ue,st,this.nodeSize)};var Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ne){return Ne}},Fe=function(Ne){this.options=Qe(Object.create(Y),Ne),this.trees=new Array(this.options.maxZoom+1)};Fe.prototype.load=function(Ne){var Ue=this.options,st=Ue.log,Le=Ue.minZoom,ut=Ue.maxZoom,Gt=Ue.nodeSize;st&&console.time("total time");var Kt="prepare "+Ne.length+" points";st&&console.time(Kt),this.points=Ne;for(var ar=[],oe=0;oe<Ne.length;oe++){if(!Ne[oe].geometry)continue;ar.push(ge(Ne[oe],oe))}this.trees[ut+1]=new fe(ar,yt,_t,Gt,Float32Array),st&&console.timeEnd(Kt);for(var Q=ut;Q>=Le;Q--){var H=+Date.now();ar=this._cluster(ar,Q),this.trees[Q]=new fe(ar,yt,_t,Gt,Float32Array),st&&console.log("z%d: %d clusters in %dms",Q,ar.length,+Date.now()-H)}return st&&console.timeEnd("total time"),this},Fe.prototype.getClusters=function(Ne,Ue){var st=((Ne[0]+180)%360+360)%360-180,Le=Math.max(-90,Math.min(90,Ne[1])),ut=Ne[2]===180?180:((Ne[2]+180)%360+360)%360-180,Gt=Math.max(-90,Math.min(90,Ne[3]));if(Ne[2]-Ne[0]>=360)st=-180,ut=180;else if(st>ut){var Kt=this.getClusters([st,Le,180,Gt],Ue),ar=this.getClusters([-180,Le,ut,Gt],Ue);return Kt.concat(ar)}for(var oe=this.trees[this._limitZoom(Ue)],Q=oe.range(ke(st),Et(Gt),ke(ut),Et(Le)),H=[],Ce=0,Ee=Q;Ce<Ee.length;Ce+=1){var _e=Ee[Ce],ve=oe.points[_e];H.push(ve.numPoints?we(ve):this.points[ve.index])}return H},Fe.prototype.getChildren=function(Ne){var Ue=this._getOriginId(Ne),st=this._getOriginZoom(Ne),Le="No cluster with the specified id.",ut=this.trees[st];if(!ut)throw new Error(Le);var Gt=ut.points[Ue];if(!Gt)throw new Error(Le);for(var Kt=this.options.radius/(this.options.extent*Math.pow(2,st-1)),ar=ut.within(Gt.x,Gt.y,Kt),oe=[],Q=0,H=ar;Q<H.length;Q+=1){var Ce=H[Q],Ee=ut.points[Ce];Ee.parentId===Ne&&oe.push(Ee.numPoints?we(Ee):this.points[Ee.index])}if(oe.length===0)throw new Error(Le);return oe},Fe.prototype.getLeaves=function(Ne,Ue,st){Ue=Ue||10,st=st||0;var Le=[];return this._appendLeaves(Le,Ne,Ue,st,0),Le},Fe.prototype.getTile=function(Ne,Ue,st){var Le=this.trees[this._limitZoom(Ne)],ut=Math.pow(2,Ne),Gt=this.options,Kt=Gt.extent,ar=Gt.radius,oe=ar/Kt,Q=(st-oe)/ut,H=(st+1+oe)/ut,Ce={features:[]};return this._addTileFeatures(Le.range((Ue-oe)/ut,Q,(Ue+1+oe)/ut,H),Le.points,Ue,st,ut,Ce),Ue===0&&this._addTileFeatures(Le.range(1-oe/ut,Q,1,H),Le.points,ut,st,ut,Ce),Ue===ut-1&&this._addTileFeatures(Le.range(0,Q,oe/ut,H),Le.points,-1,st,ut,Ce),Ce.features.length?Ce:null},Fe.prototype.getClusterExpansionZoom=function(Ne){for(var Ue=this._getOriginZoom(Ne)-1;Ue<=this.options.maxZoom;){var st=this.getChildren(Ne);if(Ue++,st.length!==1)break;Ne=st[0].properties.cluster_id}return Ue},Fe.prototype._appendLeaves=function(Ne,Ue,st,Le,ut){for(var Gt=this.getChildren(Ue),Kt=0,ar=Gt;Kt<ar.length;Kt+=1){var oe=ar[Kt],Q=oe.properties;if(Q&&Q.cluster?ut+Q.point_count<=Le?ut+=Q.point_count:ut=this._appendLeaves(Ne,Q.cluster_id,st,Le,ut):ut<Le?ut++:Ne.push(oe),Ne.length===st)break}return ut},Fe.prototype._addTileFeatures=function(Ne,Ue,st,Le,ut,Gt){for(var Kt=0,ar=Ne;Kt<ar.length;Kt+=1){var oe=ar[Kt],Q=Ue[oe],H=Q.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(Q.x*ut-st)),Math.round(this.options.extent*(Q.y*ut-Le))]],tags:H?dt(Q):this.points[Q.index].properties},Ee=void 0;H?Ee=Q.id:this.options.generateId?Ee=Q.index:this.points[Q.index].id&&(Ee=this.points[Q.index].id),Ee!==void 0&&(Ce.id=Ee),Gt.features.push(Ce)}},Fe.prototype._limitZoom=function(Ne){return Math.max(this.options.minZoom,Math.min(+Ne,this.options.maxZoom+1))},Fe.prototype._cluster=function(Ne,Ue){for(var st=[],Le=this.options,ut=Le.radius,Gt=Le.extent,Kt=Le.reduce,ar=Le.minPoints,oe=ut/(Gt*Math.pow(2,Ue)),Q=0;Q<Ne.length;Q++){var H=Ne[Q];if(H.zoom<=Ue)continue;H.zoom=Ue;for(var Ce=this.trees[Ue+1],Ee=Ce.within(H.x,H.y,oe),_e=H.numPoints||1,ve=_e,rt=0,$t=Ee;rt<$t.length;rt+=1){var St=$t[rt],ye=Ce.points[St];ye.zoom>Ue&&(ve+=ye.numPoints||1)}if(ve>=ar){for(var be=H.x*_e,Be=H.y*_e,lt=Kt&&_e>1?this._map(H,!0):null,Pe=(Q<<5)+(Ue+1)+this.points.length,ht=0,w=Ee;ht<w.length;ht+=1){var I=w[ht],q=Ce.points[I];if(q.zoom<=Ue)continue;q.zoom=Ue;var ce=q.numPoints||1;be+=q.x*ce,Be+=q.y*ce,q.parentId=Pe,Kt&&(lt||(lt=this._map(H,!0)),Kt(lt,this._map(q)))}H.parentId=Pe,st.push(We(be/ve,Be/ve,Pe,ve,lt))}else if(st.push(H),ve>1)for(var Ve=0,$e=Ee;Ve<$e.length;Ve+=1){var gt=$e[Ve],nt=Ce.points[gt];if(nt.zoom<=Ue)continue;nt.zoom=Ue,st.push(nt)}}return st},Fe.prototype._getOriginId=function(Ne){return Ne-this.points.length>>5},Fe.prototype._getOriginZoom=function(Ne){return(Ne-this.points.length)%32},Fe.prototype._map=function(Ne,Ue){if(Ne.numPoints)return Ue?Qe({},Ne.properties):Ne.properties;var st=this.points[Ne.index].properties,Le=this.options.map(st);return Ue&&Le===st?Qe({},Le):Le};function We(De,Ne,Ue,st,Le){return{x:De,y:Ne,zoom:Infinity,id:Ue,parentId:-1,numPoints:st,properties:Le}}function ge(De,Ne){var Ue=De.geometry.coordinates,st=Ue[0],Le=Ue[1];return{x:ke(st),y:Et(Le),zoom:Infinity,index:Ne,parentId:-1}}function we(De){return{type:"Feature",id:De.id,properties:dt(De),geometry:{type:"Point",coordinates:[Ze(De.x),vt(De.y)]}}}function dt(De){var Ne=De.numPoints,Ue=Ne>=1e4?Math.round(Ne/1e3)+"k":Ne>=1e3?Math.round(Ne/100)/10+"k":Ne;return Qe(Qe({},De.properties),{cluster:!0,cluster_id:De.id,point_count:Ne,point_count_abbreviated:Ue})}function ke(De){return De/360+.5}function Et(De){var Ne=Math.sin(De*Math.PI/180),Ue=.5-.25*Math.log((1+Ne)/(1-Ne))/Math.PI;return Ue<0?0:Ue>1?1:Ue}function Ze(De){return(De-.5)*360}function vt(De){var Ne=(180-De*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ne))/Math.PI-90}function Qe(De,Ne){for(var Ue in Ne)De[Ue]=Ne[Ue];return De}function yt(De){return De.x}function _t(De){return De.y}return Fe})},"mv/X":function(Re,E,i){var T=i("ljhN"),m=i("MMmD"),X=i("wJg7"),z=i("GoyQ");function o(Z,D,K){if(!z(K))return!1;var re=typeof D;return(re=="number"?m(K)&&X(D,K.length):re=="string"&&D in K)?T(K[D],Z):!1}Re.exports=o},"n+fv":function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"length",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"copy",function(){return Z}),i.d(E,"set",function(){return D}),i.d(E,"add",function(){return K}),i.d(E,"subtract",function(){return re}),i.d(E,"multiply",function(){return fe}),i.d(E,"divide",function(){return Y}),i.d(E,"ceil",function(){return Fe}),i.d(E,"floor",function(){return We}),i.d(E,"min",function(){return ge}),i.d(E,"max",function(){return we}),i.d(E,"round",function(){return dt}),i.d(E,"scale",function(){return ke}),i.d(E,"scaleAndAdd",function(){return Et}),i.d(E,"distance",function(){return Ze}),i.d(E,"squaredDistance",function(){return vt}),i.d(E,"squaredLength",function(){return Qe}),i.d(E,"negate",function(){return yt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return De}),i.d(E,"dot",function(){return Ne}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"hermite",function(){return Le}),i.d(E,"bezier",function(){return ut}),i.d(E,"random",function(){return Gt}),i.d(E,"transformMat4",function(){return Kt}),i.d(E,"transformMat3",function(){return ar}),i.d(E,"transformQuat",function(){return oe}),i.d(E,"rotateX",function(){return Q}),i.d(E,"rotateY",function(){return H}),i.d(E,"rotateZ",function(){return Ce}),i.d(E,"angle",function(){return Ee}),i.d(E,"zero",function(){return _e}),i.d(E,"str",function(){return ve}),i.d(E,"exactEquals",function(){return rt}),i.d(E,"equals",function(){return $t}),i.d(E,"sub",function(){return St}),i.d(E,"mul",function(){return ye}),i.d(E,"div",function(){return be}),i.d(E,"dist",function(){return Be}),i.d(E,"sqrDist",function(){return lt}),i.d(E,"len",function(){return Pe}),i.d(E,"sqrLen",function(){return ht}),i.d(E,"forEach",function(){return w});var T=i("yU0y");function m(){var I=new T.a(3);return T.a!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function X(I){var q=new T.a(3);return q[0]=I[0],q[1]=I[1],q[2]=I[2],q}function z(I){var q=I[0],ce=I[1],Ve=I[2];return Math.hypot(q,ce,Ve)}function o(I,q,ce){var Ve=new T.a(3);return Ve[0]=I,Ve[1]=q,Ve[2]=ce,Ve}function Z(I,q){return I[0]=q[0],I[1]=q[1],I[2]=q[2],I}function D(I,q,ce,Ve){return I[0]=q,I[1]=ce,I[2]=Ve,I}function K(I,q,ce){return I[0]=q[0]+ce[0],I[1]=q[1]+ce[1],I[2]=q[2]+ce[2],I}function re(I,q,ce){return I[0]=q[0]-ce[0],I[1]=q[1]-ce[1],I[2]=q[2]-ce[2],I}function fe(I,q,ce){return I[0]=q[0]*ce[0],I[1]=q[1]*ce[1],I[2]=q[2]*ce[2],I}function Y(I,q,ce){return I[0]=q[0]/ce[0],I[1]=q[1]/ce[1],I[2]=q[2]/ce[2],I}function Fe(I,q){return I[0]=Math.ceil(q[0]),I[1]=Math.ceil(q[1]),I[2]=Math.ceil(q[2]),I}function We(I,q){return I[0]=Math.floor(q[0]),I[1]=Math.floor(q[1]),I[2]=Math.floor(q[2]),I}function ge(I,q,ce){return I[0]=Math.min(q[0],ce[0]),I[1]=Math.min(q[1],ce[1]),I[2]=Math.min(q[2],ce[2]),I}function we(I,q,ce){return I[0]=Math.max(q[0],ce[0]),I[1]=Math.max(q[1],ce[1]),I[2]=Math.max(q[2],ce[2]),I}function dt(I,q){return I[0]=Math.round(q[0]),I[1]=Math.round(q[1]),I[2]=Math.round(q[2]),I}function ke(I,q,ce){return I[0]=q[0]*ce,I[1]=q[1]*ce,I[2]=q[2]*ce,I}function Et(I,q,ce,Ve){return I[0]=q[0]+ce[0]*Ve,I[1]=q[1]+ce[1]*Ve,I[2]=q[2]+ce[2]*Ve,I}function Ze(I,q){var ce=q[0]-I[0],Ve=q[1]-I[1],$e=q[2]-I[2];return Math.hypot(ce,Ve,$e)}function vt(I,q){var ce=q[0]-I[0],Ve=q[1]-I[1],$e=q[2]-I[2];return ce*ce+Ve*Ve+$e*$e}function Qe(I){var q=I[0],ce=I[1],Ve=I[2];return q*q+ce*ce+Ve*Ve}function yt(I,q){return I[0]=-q[0],I[1]=-q[1],I[2]=-q[2],I}function _t(I,q){return I[0]=1/q[0],I[1]=1/q[1],I[2]=1/q[2],I}function De(I,q){var ce=q[0],Ve=q[1],$e=q[2],gt=ce*ce+Ve*Ve+$e*$e;return gt>0&&(gt=1/Math.sqrt(gt)),I[0]=q[0]*gt,I[1]=q[1]*gt,I[2]=q[2]*gt,I}function Ne(I,q){return I[0]*q[0]+I[1]*q[1]+I[2]*q[2]}function Ue(I,q,ce){var Ve=q[0],$e=q[1],gt=q[2],nt=ce[0],kt=ce[1],$=ce[2];return I[0]=$e*$-gt*kt,I[1]=gt*nt-Ve*$,I[2]=Ve*kt-$e*nt,I}function st(I,q,ce,Ve){var $e=q[0],gt=q[1],nt=q[2];return I[0]=$e+Ve*(ce[0]-$e),I[1]=gt+Ve*(ce[1]-gt),I[2]=nt+Ve*(ce[2]-nt),I}function Le(I,q,ce,Ve,$e,gt){var nt=gt*gt,kt=nt*(2*gt-3)+1,$=nt*(gt-2)+gt,Ke=nt*(gt-1),ae=nt*(3-2*gt);return I[0]=q[0]*kt+ce[0]*$+Ve[0]*Ke+$e[0]*ae,I[1]=q[1]*kt+ce[1]*$+Ve[1]*Ke+$e[1]*ae,I[2]=q[2]*kt+ce[2]*$+Ve[2]*Ke+$e[2]*ae,I}function ut(I,q,ce,Ve,$e,gt){var nt=1-gt,kt=nt*nt,$=gt*gt,Ke=kt*nt,ae=3*gt*kt,et=3*$*nt,zt=$*gt;return I[0]=q[0]*Ke+ce[0]*ae+Ve[0]*et+$e[0]*zt,I[1]=q[1]*Ke+ce[1]*ae+Ve[1]*et+$e[1]*zt,I[2]=q[2]*Ke+ce[2]*ae+Ve[2]*et+$e[2]*zt,I}function Gt(I,q){q=q||1;var ce=T.c()*2*Math.PI,Ve=T.c()*2-1,$e=Math.sqrt(1-Ve*Ve)*q;return I[0]=Math.cos(ce)*$e,I[1]=Math.sin(ce)*$e,I[2]=Ve*q,I}function Kt(I,q,ce){var Ve=q[0],$e=q[1],gt=q[2],nt=ce[3]*Ve+ce[7]*$e+ce[11]*gt+ce[15];return nt=nt||1,I[0]=(ce[0]*Ve+ce[4]*$e+ce[8]*gt+ce[12])/nt,I[1]=(ce[1]*Ve+ce[5]*$e+ce[9]*gt+ce[13])/nt,I[2]=(ce[2]*Ve+ce[6]*$e+ce[10]*gt+ce[14])/nt,I}function ar(I,q,ce){var Ve=q[0],$e=q[1],gt=q[2];return I[0]=Ve*ce[0]+$e*ce[3]+gt*ce[6],I[1]=Ve*ce[1]+$e*ce[4]+gt*ce[7],I[2]=Ve*ce[2]+$e*ce[5]+gt*ce[8],I}function oe(I,q,ce){var Ve=ce[0],$e=ce[1],gt=ce[2],nt=ce[3],kt=q[0],$=q[1],Ke=q[2],ae=$e*Ke-gt*$,et=gt*kt-Ve*Ke,zt=Ve*$-$e*kt,sr=$e*zt-gt*et,ft=gt*ae-Ve*zt,pt=Ve*et-$e*ae,At=nt*2;return ae*=At,et*=At,zt*=At,sr*=2,ft*=2,pt*=2,I[0]=kt+ae+sr,I[1]=$+et+ft,I[2]=Ke+zt+pt,I}function Q(I,q,ce,Ve){var $e=[],gt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],gt[0]=$e[0],gt[1]=$e[1]*Math.cos(Ve)-$e[2]*Math.sin(Ve),gt[2]=$e[1]*Math.sin(Ve)+$e[2]*Math.cos(Ve),I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function H(I,q,ce,Ve){var $e=[],gt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],gt[0]=$e[2]*Math.sin(Ve)+$e[0]*Math.cos(Ve),gt[1]=$e[1],gt[2]=$e[2]*Math.cos(Ve)-$e[0]*Math.sin(Ve),I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function Ce(I,q,ce,Ve){var $e=[],gt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],gt[0]=$e[0]*Math.cos(Ve)-$e[1]*Math.sin(Ve),gt[1]=$e[0]*Math.sin(Ve)+$e[1]*Math.cos(Ve),gt[2]=$e[2],I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function Ee(I,q){var ce=I[0],Ve=I[1],$e=I[2],gt=q[0],nt=q[1],kt=q[2],$=Math.sqrt(ce*ce+Ve*Ve+$e*$e),Ke=Math.sqrt(gt*gt+nt*nt+kt*kt),ae=$*Ke,et=ae&&Ne(I,q)/ae;return Math.acos(Math.min(Math.max(et,-1),1))}function _e(I){return I[0]=0,I[1]=0,I[2]=0,I}function ve(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"}function rt(I,q){return I[0]===q[0]&&I[1]===q[1]&&I[2]===q[2]}function $t(I,q){var ce=I[0],Ve=I[1],$e=I[2],gt=q[0],nt=q[1],kt=q[2];return Math.abs(ce-gt)<=T.b*Math.max(1,Math.abs(ce),Math.abs(gt))&&Math.abs(Ve-nt)<=T.b*Math.max(1,Math.abs(Ve),Math.abs(nt))&&Math.abs($e-kt)<=T.b*Math.max(1,Math.abs($e),Math.abs(kt))}var St=re,ye=fe,be=Y,Be=Ze,lt=vt,Pe=z,ht=Qe,w=function(){var I=m();return function(q,ce,Ve,$e,gt,nt){var kt,$;for(ce||(ce=3),Ve||(Ve=0),$e?$=Math.min($e*ce+Ve,q.length):$=q.length,kt=Ve;kt<$;kt+=ce)I[0]=q[kt],I[1]=q[kt+1],I[2]=q[kt+2],gt(I,I,nt),q[kt]=I[0],q[kt+1]=I[1],q[kt+2]=I[2];return q}}()},n2J3:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(){return function(o,Z,D){var K=new m.Metadata(T.UNMANAGED_TAG,!0);X.tagParameter(o,Z,D,K)}}E.unmanaged=z},n3AX:function(Re,E,i){var T=i("Nsbk");function m(X,z){for(;!Object.prototype.hasOwnProperty.call(X,z)&&!(X=T(X),X===null););return X}Re.exports=m},"o+pz":function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m[m.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",m[m.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",m[m.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",m[m.POINTS=0]="POINTS",m[m.LINES=1]="LINES",m[m.LINE_LOOP=2]="LINE_LOOP",m[m.LINE_STRIP=3]="LINE_STRIP",m[m.TRIANGLES=4]="TRIANGLES",m[m.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",m[m.TRIANGLE_FAN=6]="TRIANGLE_FAN",m[m.ZERO=0]="ZERO",m[m.ONE=1]="ONE",m[m.SRC_COLOR=768]="SRC_COLOR",m[m.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",m[m.SRC_ALPHA=770]="SRC_ALPHA",m[m.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",m[m.DST_ALPHA=772]="DST_ALPHA",m[m.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",m[m.DST_COLOR=774]="DST_COLOR",m[m.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",m[m.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",m[m.FUNC_ADD=32774]="FUNC_ADD",m[m.BLEND_EQUATION=32777]="BLEND_EQUATION",m[m.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",m[m.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",m[m.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",m[m.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",m[m.MAX_EXT=32776]="MAX_EXT",m[m.MIN_EXT=32775]="MIN_EXT",m[m.BLEND_DST_RGB=32968]="BLEND_DST_RGB",m[m.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",m[m.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",m[m.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",m[m.CONSTANT_COLOR=32769]="CONSTANT_COLOR",m[m.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",m[m.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",m[m.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",m[m.BLEND_COLOR=32773]="BLEND_COLOR",m[m.ARRAY_BUFFER=34962]="ARRAY_BUFFER",m[m.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",m[m.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",m[m.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",m[m.STREAM_DRAW=35040]="STREAM_DRAW",m[m.STATIC_DRAW=35044]="STATIC_DRAW",m[m.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",m[m.BUFFER_SIZE=34660]="BUFFER_SIZE",m[m.BUFFER_USAGE=34661]="BUFFER_USAGE",m[m.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",m[m.FRONT=1028]="FRONT",m[m.BACK=1029]="BACK",m[m.FRONT_AND_BACK=1032]="FRONT_AND_BACK",m[m.CULL_FACE=2884]="CULL_FACE",m[m.BLEND=3042]="BLEND",m[m.DITHER=3024]="DITHER",m[m.STENCIL_TEST=2960]="STENCIL_TEST",m[m.DEPTH_TEST=2929]="DEPTH_TEST",m[m.SCISSOR_TEST=3089]="SCISSOR_TEST",m[m.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",m[m.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",m[m.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",m[m.NO_ERROR=0]="NO_ERROR",m[m.INVALID_ENUM=1280]="INVALID_ENUM",m[m.INVALID_VALUE=1281]="INVALID_VALUE",m[m.INVALID_OPERATION=1282]="INVALID_OPERATION",m[m.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",m[m.CW=2304]="CW",m[m.CCW=2305]="CCW",m[m.LINE_WIDTH=2849]="LINE_WIDTH",m[m.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",m[m.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",m[m.CULL_FACE_MODE=2885]="CULL_FACE_MODE",m[m.FRONT_FACE=2886]="FRONT_FACE",m[m.DEPTH_RANGE=2928]="DEPTH_RANGE",m[m.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",m[m.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",m[m.DEPTH_FUNC=2932]="DEPTH_FUNC",m[m.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",m[m.STENCIL_FUNC=2962]="STENCIL_FUNC",m[m.STENCIL_FAIL=2964]="STENCIL_FAIL",m[m.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",m[m.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",m[m.STENCIL_REF=2967]="STENCIL_REF",m[m.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",m[m.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",m[m.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",m[m.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",m[m.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",m[m.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",m[m.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",m[m.VIEWPORT=2978]="VIEWPORT",m[m.SCISSOR_BOX=3088]="SCISSOR_BOX",m[m.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",m[m.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",m[m.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",m[m.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",m[m.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",m[m.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",m[m.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",m[m.RED_BITS=3410]="RED_BITS",m[m.GREEN_BITS=3411]="GREEN_BITS",m[m.BLUE_BITS=3412]="BLUE_BITS",m[m.ALPHA_BITS=3413]="ALPHA_BITS",m[m.DEPTH_BITS=3414]="DEPTH_BITS",m[m.STENCIL_BITS=3415]="STENCIL_BITS",m[m.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",m[m.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",m[m.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",m[m.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",m[m.SAMPLES=32937]="SAMPLES",m[m.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",m[m.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",m[m.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",m[m.DONT_CARE=4352]="DONT_CARE",m[m.FASTEST=4353]="FASTEST",m[m.NICEST=4354]="NICEST",m[m.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",m[m.BYTE=5120]="BYTE",m[m.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",m[m.SHORT=5122]="SHORT",m[m.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",m[m.INT=5124]="INT",m[m.UNSIGNED_INT=5125]="UNSIGNED_INT",m[m.FLOAT=5126]="FLOAT",m[m.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",m[m.ALPHA=6406]="ALPHA",m[m.RGB=6407]="RGB",m[m.RGBA=6408]="RGBA",m[m.LUMINANCE=6409]="LUMINANCE",m[m.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",m[m.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",m[m.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",m[m.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",m[m.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",m[m.VERTEX_SHADER=35633]="VERTEX_SHADER",m[m.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",m[m.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",m[m.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",m[m.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",m[m.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",m[m.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",m[m.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",m[m.SHADER_TYPE=35663]="SHADER_TYPE",m[m.DELETE_STATUS=35712]="DELETE_STATUS",m[m.LINK_STATUS=35714]="LINK_STATUS",m[m.VALIDATE_STATUS=35715]="VALIDATE_STATUS",m[m.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",m[m.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",m[m.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",m[m.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",m[m.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",m[m.NEVER=512]="NEVER",m[m.LESS=513]="LESS",m[m.EQUAL=514]="EQUAL",m[m.LEQUAL=515]="LEQUAL",m[m.GREATER=516]="GREATER",m[m.NOTEQUAL=517]="NOTEQUAL",m[m.GEQUAL=518]="GEQUAL",m[m.ALWAYS=519]="ALWAYS",m[m.KEEP=7680]="KEEP",m[m.REPLACE=7681]="REPLACE",m[m.INCR=7682]="INCR",m[m.DECR=7683]="DECR",m[m.INVERT=5386]="INVERT",m[m.INCR_WRAP=34055]="INCR_WRAP",m[m.DECR_WRAP=34056]="DECR_WRAP",m[m.VENDOR=7936]="VENDOR",m[m.RENDERER=7937]="RENDERER",m[m.VERSION=7938]="VERSION",m[m.NEAREST=9728]="NEAREST",m[m.LINEAR=9729]="LINEAR",m[m.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",m[m.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",m[m.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",m[m.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",m[m.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",m[m.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",m[m.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",m[m.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",m[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE=5890]="TEXTURE",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",m[m.TEXTURE0=33984]="TEXTURE0",m[m.TEXTURE1=33985]="TEXTURE1",m[m.TEXTURE2=33986]="TEXTURE2",m[m.TEXTURE3=33987]="TEXTURE3",m[m.TEXTURE4=33988]="TEXTURE4",m[m.TEXTURE5=33989]="TEXTURE5",m[m.TEXTURE6=33990]="TEXTURE6",m[m.TEXTURE7=33991]="TEXTURE7",m[m.TEXTURE8=33992]="TEXTURE8",m[m.TEXTURE9=33993]="TEXTURE9",m[m.TEXTURE10=33994]="TEXTURE10",m[m.TEXTURE11=33995]="TEXTURE11",m[m.TEXTURE12=33996]="TEXTURE12",m[m.TEXTURE13=33997]="TEXTURE13",m[m.TEXTURE14=33998]="TEXTURE14",m[m.TEXTURE15=33999]="TEXTURE15",m[m.TEXTURE16=34e3]="TEXTURE16",m[m.TEXTURE17=34001]="TEXTURE17",m[m.TEXTURE18=34002]="TEXTURE18",m[m.TEXTURE19=34003]="TEXTURE19",m[m.TEXTURE20=34004]="TEXTURE20",m[m.TEXTURE21=34005]="TEXTURE21",m[m.TEXTURE22=34006]="TEXTURE22",m[m.TEXTURE23=34007]="TEXTURE23",m[m.TEXTURE24=34008]="TEXTURE24",m[m.TEXTURE25=34009]="TEXTURE25",m[m.TEXTURE26=34010]="TEXTURE26",m[m.TEXTURE27=34011]="TEXTURE27",m[m.TEXTURE28=34012]="TEXTURE28",m[m.TEXTURE29=34013]="TEXTURE29",m[m.TEXTURE30=34014]="TEXTURE30",m[m.TEXTURE31=34015]="TEXTURE31",m[m.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",m[m.REPEAT=10497]="REPEAT",m[m.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",m[m.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",m[m.FLOAT_VEC2=35664]="FLOAT_VEC2",m[m.FLOAT_VEC3=35665]="FLOAT_VEC3",m[m.FLOAT_VEC4=35666]="FLOAT_VEC4",m[m.INT_VEC2=35667]="INT_VEC2",m[m.INT_VEC3=35668]="INT_VEC3",m[m.INT_VEC4=35669]="INT_VEC4",m[m.BOOL=35670]="BOOL",m[m.BOOL_VEC2=35671]="BOOL_VEC2",m[m.BOOL_VEC3=35672]="BOOL_VEC3",m[m.BOOL_VEC4=35673]="BOOL_VEC4",m[m.FLOAT_MAT2=35674]="FLOAT_MAT2",m[m.FLOAT_MAT3=35675]="FLOAT_MAT3",m[m.FLOAT_MAT4=35676]="FLOAT_MAT4",m[m.SAMPLER_2D=35678]="SAMPLER_2D",m[m.SAMPLER_CUBE=35680]="SAMPLER_CUBE",m[m.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",m[m.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",m[m.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",m[m.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",m[m.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",m[m.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",m[m.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",m[m.COMPILE_STATUS=35713]="COMPILE_STATUS",m[m.LOW_FLOAT=36336]="LOW_FLOAT",m[m.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",m[m.HIGH_FLOAT=36338]="HIGH_FLOAT",m[m.LOW_INT=36339]="LOW_INT",m[m.MEDIUM_INT=36340]="MEDIUM_INT",m[m.HIGH_INT=36341]="HIGH_INT",m[m.FRAMEBUFFER=36160]="FRAMEBUFFER",m[m.RENDERBUFFER=36161]="RENDERBUFFER",m[m.RGBA4=32854]="RGBA4",m[m.RGB5_A1=32855]="RGB5_A1",m[m.RGB565=36194]="RGB565",m[m.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",m[m.STENCIL_INDEX=6401]="STENCIL_INDEX",m[m.STENCIL_INDEX8=36168]="STENCIL_INDEX8",m[m.DEPTH_STENCIL=34041]="DEPTH_STENCIL",m[m.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",m[m.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",m[m.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",m[m.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",m[m.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",m[m.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",m[m.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",m[m.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",m[m.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",m[m.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",m[m.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",m[m.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",m[m.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",m[m.NONE=0]="NONE",m[m.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",m[m.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",m[m.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",m[m.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",m[m.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",m[m.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",m[m.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",m[m.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",m[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",m[m.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",m[m.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",m[m.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(T||(T={}))},"oCl/":function(Re,E,i){var T=i("CH3K"),m=i("LcsW"),X=i("MvSz"),z=i("0ycA"),o=Object.getOwnPropertySymbols,Z=o?function(D){for(var K=[];D;)T(K,X(D)),D=m(D);return K}:z;Re.exports=Z},oIFs:function(Re,E,i){Re.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(Re,E,i){var T=i("Nsbk"),m=i("SksO"),X=i("xfeJ"),z=i("sXyB");function o(Z){var D=typeof Map=="function"?new Map:void 0;return Re.exports=o=function(re){if(re===null||!X(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(re))return D.get(re);D.set(re,fe)}function fe(){return z(re,arguments,T(this).constructor)}return fe.prototype=Object.create(re.prototype,{constructor:{value:fe,enumerable:!1,writable:!0,configurable:!0}}),m(fe,re)},o(Z)}Re.exports=o},oaX6:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.NAME_TAG,o);X.tagParameter(Z,D,K,re)}}E.targetName=z},"otv/":function(Re,E,i){var T=i("nmnc"),m=T?T.prototype:void 0,X=m?m.valueOf:void 0;function z(o){return X?Object(X.call(o)):{}}Re.exports=z},"oy+k":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function X(z){this.id=T.id(),this.container=z}return X.prototype.addPlan=function(z){this.plan=z},X.prototype.setCurrentRequest=function(z){this.currentRequest=z},X}();E.Context=m},pFRH:function(Re,E,i){var T=i("cvCv"),m=i("O0oS"),X=i("zZ0H"),z=m?function(o,Z){return m(o,"toString",{configurable:!0,enumerable:!1,value:T(Z),writable:!0})}:X;Re.exports=z},q4HE:function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="["+i+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",fe="[^"+i+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",We="\\u200d",ge=re+"?",we="["+o+"]?",dt="(?:"+We+"(?:"+[fe,Y,Fe].join("|")+")"+we+ge+")*",ke=we+ge+dt,Et="(?:"+[fe+D+"?",D,Y,Fe,Z].join("|")+")",Ze=RegExp(K+"(?="+K+")|"+Et+ke,"g");function vt(Qe){for(var yt=Ze.lastIndex=0;Ze.test(Qe);)++yt;return yt}Re.exports=vt},qK8v:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(X){return X instanceof RangeError||X.message===T.STACK_OVERFLOW}E.isStackOverflowExeption=m},qRkn:function(Re,E,i){var T=i("3cYt"),m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},X=T(m);Re.exports=X},qd8s:function(Re,E,i){(function(T,m){var X=200,z="__lodash_hash_undefined__",o=800,Z=16,D=9007199254740991,K="[object Arguments]",re="[object Array]",fe="[object AsyncFunction]",Y="[object Boolean]",Fe="[object Date]",We="[object Error]",ge="[object Function]",we="[object GeneratorFunction]",dt="[object Map]",ke="[object Number]",Et="[object Null]",Ze="[object Object]",vt="[object Proxy]",Qe="[object RegExp]",yt="[object Set]",_t="[object String]",De="[object Undefined]",Ne="[object WeakMap]",Ue="[object ArrayBuffer]",st="[object DataView]",Le="[object Float32Array]",ut="[object Float64Array]",Gt="[object Int8Array]",Kt="[object Int16Array]",ar="[object Int32Array]",oe="[object Uint8Array]",Q="[object Uint8ClampedArray]",H="[object Uint16Array]",Ce="[object Uint32Array]",Ee=/[\\^$.*+?()[\]{}|]/g,_e=/^\[object .+?Constructor\]$/,ve=/^(?:0|[1-9]\d*)$/,rt={};rt[Le]=rt[ut]=rt[Gt]=rt[Kt]=rt[ar]=rt[oe]=rt[Q]=rt[H]=rt[Ce]=!0,rt[K]=rt[re]=rt[Ue]=rt[Y]=rt[st]=rt[Fe]=rt[We]=rt[ge]=rt[dt]=rt[ke]=rt[Ze]=rt[Qe]=rt[yt]=rt[_t]=rt[Ne]=!1;var $t=typeof T=="object"&&T&&T.Object===Object&&T,St=typeof self=="object"&&self&&self.Object===Object&&self,ye=$t||St||Function("return this")(),be=E&&!E.nodeType&&E,Be=be&&typeof m=="object"&&m&&!m.nodeType&&m,lt=Be&&Be.exports===be,Pe=lt&&$t.process,ht=function(){try{var Ot=Be&&Be.require&&Be.require("util").types;return Ot||Pe&&Pe.binding&&Pe.binding("util")}catch(er){}}(),w=ht&&ht.isTypedArray;function I(Ot,er,Or){switch(Or.length){case 0:return Ot.call(er);case 1:return Ot.call(er,Or[0]);case 2:return Ot.call(er,Or[0],Or[1]);case 3:return Ot.call(er,Or[0],Or[1],Or[2])}return Ot.apply(er,Or)}function q(Ot,er){for(var Or=-1,Bn=Array(Ot);++Or<Ot;)Bn[Or]=er(Or);return Bn}function ce(Ot){return function(er){return Ot(er)}}function Ve(Ot,er){return Ot==null?void 0:Ot[er]}function $e(Ot,er){return function(Or){return Ot(er(Or))}}var gt=Array.prototype,nt=Function.prototype,kt=Object.prototype,$=ye["__core-js_shared__"],Ke=nt.toString,ae=kt.hasOwnProperty,et=function(){var Ot=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return Ot?"Symbol(src)_1."+Ot:""}(),zt=kt.toString,sr=Ke.call(Object),ft=RegExp("^"+Ke.call(ae).replace(Ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pt=lt?ye.Buffer:void 0,At=ye.Symbol,mt=ye.Uint8Array,Me=pt?pt.allocUnsafe:void 0,ct=$e(Object.getPrototypeOf,Object),qe=Object.create,Vt=kt.propertyIsEnumerable,pr=gt.splice,Gr=At?At.toStringTag:void 0,ur=function(){try{var Ot=Ys(Object,"defineProperty");return Ot({},"",{}),Ot}catch(er){}}(),zn=pt?pt.isBuffer:void 0,xn=Math.max,na=Date.now,fa=Ys(ye,"Map"),Hn=Ys(Object,"create"),Gn=function(){function Ot(){}return function(er){if(!uo(er))return{};if(qe)return qe(er);Ot.prototype=er;var Or=new Ot;return Ot.prototype=void 0,Or}}();function F(Ot){var er=-1,Or=Ot==null?0:Ot.length;for(this.clear();++er<Or;){var Bn=Ot[er];this.set(Bn[0],Bn[1])}}function W(){this.__data__=Hn?Hn(null):{},this.size=0}function le(Ot){var er=this.has(Ot)&&delete this.__data__[Ot];return this.size-=er?1:0,er}function pe(Ot){var er=this.__data__;if(Hn){var Or=er[Ot];return Or===z?void 0:Or}return ae.call(er,Ot)?er[Ot]:void 0}function at(Ot){var er=this.__data__;return Hn?er[Ot]!==void 0:ae.call(er,Ot)}function Tt(Ot,er){var Or=this.__data__;return this.size+=this.has(Ot)?0:1,Or[Ot]=Hn&&er===void 0?z:er,this}F.prototype.clear=W,F.prototype.delete=le,F.prototype.get=pe,F.prototype.has=at,F.prototype.set=Tt;function jt(Ot){var er=-1,Or=Ot==null?0:Ot.length;for(this.clear();++er<Or;){var Bn=Ot[er];this.set(Bn[0],Bn[1])}}function Ge(){this.__data__=[],this.size=0}function wt(Ot){var er=this.__data__,Or=Xi(er,Ot);if(Or<0)return!1;var Bn=er.length-1;return Or==Bn?er.pop():pr.call(er,Or,1),--this.size,!0}function ir(Ot){var er=this.__data__,Or=Xi(er,Ot);return Or<0?void 0:er[Or][1]}function Ur(Ot){return Xi(this.__data__,Ot)>-1}function Vr(Ot,er){var Or=this.__data__,Bn=Xi(Or,Ot);return Bn<0?(++this.size,Or.push([Ot,er])):Or[Bn][1]=er,this}jt.prototype.clear=Ge,jt.prototype.delete=wt,jt.prototype.get=ir,jt.prototype.has=Ur,jt.prototype.set=Vr;function or(Ot){var er=-1,Or=Ot==null?0:Ot.length;for(this.clear();++er<Or;){var Bn=Ot[er];this.set(Bn[0],Bn[1])}}function Fr(){this.size=0,this.__data__={hash:new F,map:new(fa||jt),string:new F}}function Sn(Ot){var er=so(this,Ot).delete(Ot);return this.size-=er?1:0,er}function fn(Ot){return so(this,Ot).get(Ot)}function Er(Ot){return so(this,Ot).has(Ot)}function Tn(Ot,er){var Or=so(this,Ot),Bn=Or.size;return Or.set(Ot,er),this.size+=Or.size==Bn?0:1,this}or.prototype.clear=Fr,or.prototype.delete=Sn,or.prototype.get=fn,or.prototype.has=Er,or.prototype.set=Tn;function dn(Ot){var er=this.__data__=new jt(Ot);this.size=er.size}function vn(){this.__data__=new jt,this.size=0}function Sr(Ot){var er=this.__data__,Or=er.delete(Ot);return this.size=er.size,Or}function Kr(Ot){return this.__data__.get(Ot)}function wn(Ot){return this.__data__.has(Ot)}function Ka(Ot,er){var Or=this.__data__;if(Or instanceof jt){var Bn=Or.__data__;if(!fa||Bn.length<X-1)return Bn.push([Ot,er]),this.size=++Or.size,this;Or=this.__data__=new or(Bn)}return Or.set(Ot,er),this.size=Or.size,this}dn.prototype.clear=vn,dn.prototype.delete=Sr,dn.prototype.get=Kr,dn.prototype.has=wn,dn.prototype.set=Ka;function da(Ot,er){var Or=Xl(Ot),Bn=!Or&&Hu(Ot),Qa=!Or&&!Bn&&Ll(Ot),Ii=!Or&&!Bn&&!Qa&&cu(Ot),Gi=Or||Bn||Qa||Ii,qa=Gi?q(Ot.length,String):[],bi=qa.length;for(var Ao in Ot)(er||ae.call(Ot,Ao))&&!(Gi&&(Ao=="length"||Qa&&(Ao=="offset"||Ao=="parent")||Ii&&(Ao=="buffer"||Ao=="byteLength"||Ao=="byteOffset")||Ks(Ao,bi)))&&qa.push(Ao);return qa}function Oa(Ot,er,Or){(Or!==void 0&&!Do(Ot[er],Or)||Or===void 0&&!(er in Ot))&&ha(Ot,er,Or)}function Ia(Ot,er,Or){var Bn=Ot[er];(!(ae.call(Ot,er)&&Do(Bn,Or))||Or===void 0&&!(er in Ot))&&ha(Ot,er,Or)}function Xi(Ot,er){for(var Or=Ot.length;Or--;)if(Do(Ot[Or][0],er))return Or;return-1}function ha(Ot,er,Or){er=="__proto__"&&ur?ur(Ot,er,{configurable:!0,enumerable:!0,value:Or,writable:!0}):Ot[er]=Or}var gi=oo();function Ma(Ot){return Ot==null?Ot===void 0?De:Et:Gr&&Gr in Object(Ot)?_o(Ot):tn(Ot)}function ya(Ot){return hs(Ot)&&Ma(Ot)==K}function la(Ot){if(!uo(Ot)||Ie(Ot))return!1;var er=fs(Ot)?ft:_e;return er.test(mo(Ot))}function Li(Ot){return hs(Ot)&&ks(Ot.length)&&!!rt[Ma(Ot)]}function po(Ot){if(!uo(Ot))return cr(Ot);var er=Pt(Ot),Or=[];for(var Bn in Ot)Bn=="constructor"&&(er||!ae.call(Ot,Bn))||Or.push(Bn);return Or}function Yi(Ot,er,Or,Bn,Qa){if(Ot===er)return;gi(er,function(Ii,Gi){if(Qa||(Qa=new dn),uo(Ii))Ko(Ot,er,Gi,Or,Yi,Bn,Qa);else{var qa=Bn?Bn(Fn(Ot,Gi),Ii,Gi+"",Ot,er,Qa):void 0;qa===void 0&&(qa=Ii),Oa(Ot,Gi,qa)}},yi)}function Ko(Ot,er,Or,Bn,Qa,Ii,Gi){var qa=Fn(Ot,Or),bi=Fn(er,Or),Ao=Gi.get(bi);if(Ao){Oa(Ot,Or,Ao);return}var zs=Ii?Ii(qa,bi,Or+"",Ot,er,Gi):void 0,di=zs===void 0;if(di){var Kl=Xl(bi),fu=!Kl&&Ll(bi),Os=!Kl&&!fu&&cu(bi);zs=bi,Kl||fu||Os?Xl(qa)?zs=qa:Ic(qa)?zs=Ki(qa):fu?(di=!1,zs=Ai(bi,!0)):Os?(di=!1,zs=ii(bi,!0)):zs=[]:Js(bi)||Hu(bi)?(zs=qa,Hu(qa)?zs=Yl(qa):(!uo(qa)||fs(qa))&&(zs=Zl(bi))):di=!1}di&&(Gi.set(bi,zs),Qa(zs,bi,Bn,Ii,Gi),Gi.delete(bi)),Oa(Ot,Or,zs)}function Gu(Ot,er){return Ri(En(Ot,er,js),Ot+"")}var Ba=ur?function(Ot,er){return ur(Ot,"toString",{configurable:!0,enumerable:!1,value:vl(er),writable:!0})}:js;function Ai(Ot,er){if(er)return Ot.slice();var Or=Ot.length,Bn=Me?Me(Or):new Ot.constructor(Or);return Ot.copy(Bn),Bn}function es(Ot){var er=new Ot.constructor(Ot.byteLength);return new mt(er).set(new mt(Ot)),er}function ii(Ot,er){var Or=er?es(Ot.buffer):Ot.buffer;return new Ot.constructor(Or,Ot.byteOffset,Ot.length)}function Ki(Ot,er){var Or=-1,Bn=Ot.length;for(er||(er=Array(Bn));++Or<Bn;)er[Or]=Ot[Or];return er}function ts(Ot,er,Or,Bn){var Qa=!Or;Or||(Or={});for(var Ii=-1,Gi=er.length;++Ii<Gi;){var qa=er[Ii],bi=Bn?Bn(Or[qa],Ot[qa],qa,Or,Ot):void 0;bi===void 0&&(bi=Ot[qa]),Qa?ha(Or,qa,bi):Ia(Or,qa,bi)}return Or}function Ja(Ot){return Gu(function(er,Or){var Bn=-1,Qa=Or.length,Ii=Qa>1?Or[Qa-1]:void 0,Gi=Qa>2?Or[2]:void 0;for(Ii=Ot.length>3&&typeof Ii=="function"?(Qa--,Ii):void 0,Gi&&So(Or[0],Or[1],Gi)&&(Ii=Qa<3?void 0:Ii,Qa=1),er=Object(er);++Bn<Qa;){var qa=Or[Bn];qa&&Ot(er,qa,Bn,Ii)}return er})}function oo(Ot){return function(er,Or,Bn){for(var Qa=-1,Ii=Object(er),Gi=Bn(er),qa=Gi.length;qa--;){var bi=Gi[Ot?qa:++Qa];if(Or(Ii[bi],bi,Ii)===!1)break}return er}}function so(Ot,er){var Or=Ot.__data__;return Ut(er)?Or[typeof er=="string"?"string":"hash"]:Or.map}function Ys(Ot,er){var Or=Ve(Ot,er);return la(Or)?Or:void 0}function _o(Ot){var er=ae.call(Ot,Gr),Or=Ot[Gr];try{Ot[Gr]=void 0;var Bn=!0}catch(Ii){}var Qa=zt.call(Ot);return Bn&&(er?Ot[Gr]=Or:delete Ot[Gr]),Qa}function Zl(Ot){return typeof Ot.constructor=="function"&&!Pt(Ot)?Gn(ct(Ot)):{}}function Ks(Ot,er){var Or=typeof Ot;return er=er==null?D:er,!!er&&(Or=="number"||Or!="symbol"&&ve.test(Ot))&&Ot>-1&&Ot%1==0&&Ot<er}function So(Ot,er,Or){if(!uo(Or))return!1;var Bn=typeof er;return(Bn=="number"?$s(Or)&&Ks(er,Or.length):Bn=="string"&&er in Or)?Do(Or[er],Ot):!1}function Ut(Ot){var er=typeof Ot;return er=="string"||er=="number"||er=="symbol"||er=="boolean"?Ot!=="__proto__":Ot===null}function Ie(Ot){return!!et&&et in Ot}function Pt(Ot){var er=Ot&&Ot.constructor,Or=typeof er=="function"&&er.prototype||kt;return Ot===Or}function cr(Ot){var er=[];if(Ot!=null)for(var Or in Object(Ot))er.push(Or);return er}function tn(Ot){return zt.call(Ot)}function En(Ot,er,Or){return er=xn(er===void 0?Ot.length-1:er,0),function(){for(var Bn=arguments,Qa=-1,Ii=xn(Bn.length-er,0),Gi=Array(Ii);++Qa<Ii;)Gi[Qa]=Bn[er+Qa];Qa=-1;for(var qa=Array(er+1);++Qa<er;)qa[Qa]=Bn[Qa];return qa[er]=Or(Gi),I(Ot,this,qa)}}function Fn(Ot,er){return er==="constructor"&&typeof Ot[er]=="function"||er=="__proto__"?void 0:Ot[er]}var Ri=to(Ba);function to(Ot){var er=0,Or=0;return function(){var Bn=na(),Qa=Z-(Bn-Or);if(Or=Bn,Qa>0){if(++er>=o)return arguments[0]}else er=0;return Ot.apply(void 0,arguments)}}function mo(Ot){if(Ot!=null){try{return Ke.call(Ot)}catch(er){}try{return Ot+""}catch(er){}}return""}function Do(Ot,er){return Ot===er||Ot!==Ot&&er!==er}var Hu=ya(function(){return arguments}())?ya:function(Ot){return hs(Ot)&&ae.call(Ot,"callee")&&!Vt.call(Ot,"callee")},Xl=Array.isArray;function $s(Ot){return Ot!=null&&ks(Ot.length)&&!fs(Ot)}function Ic(Ot){return hs(Ot)&&$s(Ot)}var Ll=zn||ds;function fs(Ot){if(!uo(Ot))return!1;var er=Ma(Ot);return er==ge||er==we||er==fe||er==vt}function ks(Ot){return typeof Ot=="number"&&Ot>-1&&Ot%1==0&&Ot<=D}function uo(Ot){var er=typeof Ot;return Ot!=null&&(er=="object"||er=="function")}function hs(Ot){return Ot!=null&&typeof Ot=="object"}function Js(Ot){if(!hs(Ot)||Ma(Ot)!=Ze)return!1;var er=ct(Ot);if(er===null)return!0;var Or=ae.call(er,"constructor")&&er.constructor;return typeof Or=="function"&&Or instanceof Or&&Ke.call(Or)==sr}var cu=w?ce(w):Li;function Yl(Ot){return ts(Ot,yi(Ot))}function yi(Ot){return $s(Ot)?da(Ot,!0):po(Ot)}var Ni=Ja(function(Ot,er,Or,Bn){Yi(Ot,er,Or,Bn)});function vl(Ot){return function(){return Ot}}function js(Ot){return Ot}function ds(){return!1}m.exports=Ni}).call(this,i("yLpj"),i("YuTi")(Re))},quyA:function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="\\u200d",D=RegExp("["+Z+i+z+o+"]");function K(re){return D.test(re)}Re.exports=K},qxNg:function(Re,E,i){"use strict";i.d(E,"a",function(){return D});var T=i("lSNA"),m=i.n(T),X=i("mpbz"),z=i.n(X);function o(re,fe){var Y=Object.keys(re);if(Object.getOwnPropertySymbols){var Fe=Object.getOwnPropertySymbols(re);fe&&(Fe=Fe.filter(function(We){return Object.getOwnPropertyDescriptor(re,We).enumerable})),Y.push.apply(Y,Fe)}return Y}function Z(re){for(var fe=1;fe<arguments.length;fe++){var Y=arguments[fe]!=null?arguments[fe]:{};fe%2?o(Object(Y),!0).forEach(function(Fe){m()(re,Fe,Y[Fe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(Y)):o(Object(Y)).forEach(function(Fe){Object.defineProperty(re,Fe,Object.getOwnPropertyDescriptor(Y,Fe))})}return re}function D(re,fe){var Y=fe.radius,Fe=Y===void 0?40:Y,We=fe.maxZoom,ge=We===void 0?18:We,we=fe.minZoom,dt=we===void 0?0:we,ke=fe.zoom,Et=ke===void 0?2:ke;if(re.pointIndex){var Ze=re.pointIndex.getClusters(re.extent,Math.floor(Et));return re.dataArray=K(Ze),re}var vt=new z.a({radius:Fe,minZoom:dt,maxZoom:ge}),Qe={type:"FeatureCollection",features:[]};return Qe.features=re.dataArray.map(function(yt){return{type:"Feature",geometry:{type:"Point",coordinates:yt.coordinates},properties:Z({},yt)}}),vt.load(Qe.features),vt}function K(re){return re.map(function(fe,Y){return Z({coordinates:fe.geometry.coordinates,_id:Y+1},fe.properties)})}},riiI:function(Re,E){},rlAn:function(Re,E,i){"use strict";var T=i("ISu3"),m=i("gMG2"),X=i("5gLl"),z=i("BpBL"),o=i("5zYK"),Z=i("lJbI"),D=i("l94r"),K=i("qxNg"),re=i("Y8BV"),fe=i("VIsB"),Y=i("+VLl"),Fe=i("aF1E"),We=i("fdMe");i.d(E,"getTransform",function(){return T.b}),i.d(E,"getParser",function(){return T.a});var ge=i("U1ZX"),we=i.n(ge);E.default=D.a,Object(T.c)("geojson",X.a),Object(T.c)("image",z.a),Object(T.c)("csv",m.a),Object(T.c)("json",o.a),Object(T.c)("raster",Z.a),Object(T.d)("cluster",K.a),Object(T.d)("filter",re.a),Object(T.d)("join",Fe.a),Object(T.d)("map",We.a),Object(T.d)("grid",fe.a),Object(T.d)("hexagon",Y.a)},rxlC:function(Re,E,i){"use strict";Re.exports=m,Re.exports.default=m;var T=1e20;function m(o,Z,D,K,re,fe){this.fontSize=o||24,this.buffer=Z===void 0?3:Z,this.cutoff=K||.25,this.fontFamily=re||"sans-serif",this.fontWeight=fe||"normal",this.radius=D||8;var Y=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}m.prototype.draw=function(o){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(o,this.buffer,this.middle);for(var Z=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),K=0;K<this.size*this.size;K++){var re=Z.data[K*4+3]/255;this.gridOuter[K]=re===1?0:re===0?T:Math.pow(Math.max(0,.5-re),2),this.gridInner[K]=re===1?T:re===0?0:Math.pow(Math.max(0,re-.5),2)}for(X(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),X(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),K=0;K<this.size*this.size;K++){var fe=this.gridOuter[K]-this.gridInner[K];D[K]=Math.max(0,Math.min(255,Math.round(255-255*(fe/this.radius+this.cutoff))))}return D};function X(o,Z,D,K,re,fe,Y){for(var Fe=0;Fe<Z;Fe++){for(var We=0;We<D;We++)K[We]=o[We*Z+Fe];for(z(K,re,fe,Y,D),We=0;We<D;We++)o[We*Z+Fe]=re[We]}for(We=0;We<D;We++){for(Fe=0;Fe<Z;Fe++)K[Fe]=o[We*Z+Fe];for(z(K,re,fe,Y,Z),Fe=0;Fe<Z;Fe++)o[We*Z+Fe]=Math.sqrt(re[Fe])}}function z(o,Z,D,K,re){D[0]=0,K[0]=-T,K[1]=+T;for(var fe=1,Y=0;fe<re;fe++){for(var Fe=(o[fe]+fe*fe-(o[D[Y]]+D[Y]*D[Y]))/(2*fe-2*D[Y]);Fe<=K[Y];)Y--,Fe=(o[fe]+fe*fe-(o[D[Y]]+D[Y]*D[Y]))/(2*fe-2*D[Y]);Y++,D[Y]=fe,K[Y]=Fe,K[Y+1]=+T}for(fe=0,Y=0;fe<re;fe++){for(;K[Y+1]<fe;)Y++;Z[fe]=(fe-D[Y])*(fe-D[Y])+o[D[Y]]}}},sGsY:function(Re,E,i){"use strict";var T=i("lSNA"),m=i.n(T),X=i("pVnL"),z=i.n(X),o=i("q1tI"),Z=i("TSYQ"),D=i.n(Z),K=i("H84U"),re=i("/ezw"),fe=i("B6l+"),Y=i.n(fe),Fe=function(ve){var rt=ve.value,$t=ve.formatter,St=ve.precision,ye=ve.decimalSeparator,be=ve.groupSeparator,Be=be===void 0?"":be,lt=ve.prefixCls,Pe;if(typeof $t=="function")Pe=$t(rt);else{var ht=String(rt),w=ht.match(/^(-?)(\d*)(\.(\d+))?$/);if(!w||ht==="-")Pe=ht;else{var I=w[1],q=w[2]||"0",ce=w[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,Be),typeof St=="number"&&(ce=Y()(ce,St,"0").slice(0,St)),ce&&(ce="".concat(ye).concat(ce)),Pe=[o.createElement("span",{key:"int",className:"".concat(lt,"-content-value-int")},I,q),ce&&o.createElement("span",{key:"decimal",className:"".concat(lt,"-content-value-decimal")},ce)]}}return o.createElement("span",{className:"".concat(lt,"-content-value")},Pe)},We=Fe,ge=function(ve){var rt=ve.prefixCls,$t=ve.className,St=ve.style,ye=ve.valueStyle,be=ve.value,Be=be===void 0?0:be,lt=ve.title,Pe=ve.valueRender,ht=ve.prefix,w=ve.suffix,I=ve.loading,q=ve.direction,ce=ve.onMouseEnter,Ve=ve.onMouseLeave,$e=o.createElement(We,z()({},ve,{value:Be})),gt=D()(rt,m()({},"".concat(rt,"-rtl"),q==="rtl"),$t);return o.createElement("div",{className:gt,style:St,onMouseEnter:ce,onMouseLeave:Ve},lt&&o.createElement("div",{className:"".concat(rt,"-title")},lt),o.createElement(re.a,{paragraph:!1,loading:I},o.createElement("div",{style:ye,className:"".concat(rt,"-content")},ht&&o.createElement("span",{className:"".concat(rt,"-content-prefix")},ht),Pe?Pe($e):$e,w&&o.createElement("span",{className:"".concat(rt,"-content-suffix")},w))))};ge.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var we=Object(K.c)({prefixCls:"statistic"})(ge),dt=we,ke=i("lwsE"),Et=i.n(ke),Ze=i("W8MJ"),vt=i.n(Ze),Qe=i("7W2i"),yt=i.n(Qe),_t=i("LQ03"),De=i.n(_t),Ne=i("J4zp"),Ue=i.n(Ne),st=i("QQZ/"),Le=i.n(st),ut=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Gt(_e,ve){var rt=_e,$t=/\[[^\]]*]/g,St=(ve.match($t)||[]).map(function(lt){return lt.slice(1,-1)}),ye=ve.replace($t,"[]"),be=ut.reduce(function(lt,Pe){var ht=Ue()(Pe,2),w=ht[0],I=ht[1];if(lt.indexOf(w)!==-1){var q=Math.floor(rt/I);return rt-=q*I,lt.replace(new RegExp("".concat(w,"+"),"g"),function(ce){var Ve=ce.length;return Le()(q.toString(),Ve,"0")})}return lt},ye),Be=0;return be.replace($t,function(){var lt=St[Be];return Be+=1,lt})}function Kt(_e,ve){var rt=ve.format,$t=rt===void 0?"":rt,St=new Date(_e).getTime(),ye=Date.now(),be=Math.max(St-ye,0);return Gt(be,$t)}var ar=i("0n0R"),oe=1e3/30;function Q(_e){return new Date(_e).getTime()}var H=function(_e){yt()(rt,_e);var ve=De()(rt);function rt(){var $t;return Et()(this,rt),$t=ve.apply(this,arguments),$t.syncTimer=function(){var St=$t.props.value,ye=Q(St);ye>=Date.now()?$t.startTimer():$t.stopTimer()},$t.startTimer=function(){if($t.countdownId)return;$t.countdownId=window.setInterval(function(){$t.forceUpdate()},oe)},$t.stopTimer=function(){var St=$t.props,ye=St.onFinish,be=St.value;if($t.countdownId){clearInterval($t.countdownId),$t.countdownId=void 0;var Be=Q(be);ye&&Be<Date.now()&&ye()}},$t.formatCountdown=function(St,ye){var be=$t.props.format;return Kt(St,z()(z()({},ye),{format:be}))},$t.valueRender=function(St){return Object(ar.a)(St,{title:void 0})},$t}return vt()(rt,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return o.createElement(dt,z()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),rt}(o.Component);H.defaultProps={format:"HH:mm:ss"};var Ce=H;dt.Countdown=Ce;var Ee=E.a=dt},sKgW:function(Re,E){var i=9007199254740991,T=Math.floor;function m(X,z){var o="";if(!X||z<1||z>i)return o;do z%2&&(o+=X),z=T(z/2),z&&(X+=X);while(z);return o}Re.exports=m},sXyB:function(Re,E,i){var T=i("SksO"),m=i("b48C");function X(z,o,Z){return m()?Re.exports=X=Reflect.construct:Re.exports=X=function(K,re,fe){var Y=[null];Y.push.apply(Y,re);var Fe=Function.bind.apply(K,Y),We=new Fe;return fe&&T(We,fe.prototype),We},X.apply(null,arguments)}Re.exports=X},sgoq:function(Re,E,i){var T=i("asDA"),m=i("TKrE"),X=i("6nK8"),z="['\u2019]",o=RegExp(z,"g");function Z(D){return function(K){return T(X(m(K).replace(o,"")),D,"")}}Re.exports=Z},sxDa:function(Re,E,i){"use strict";i.d(E,"e",function(){return Ku}),i.d(E,"f",function(){return cl}),i.d(E,"d",function(){return bc}),i.d(E,"a",function(){return so}),i.d(E,"c",function(){return bi}),i.d(E,"g",function(){return Fl}),i.d(E,"b",function(){return js});var T=i("h1nZ"),m=i("lwsE"),X=i.n(m),z=i("W8MJ"),o=i.n(z),Z=i("7W2i"),D=i.n(Z),K=i("a1gu"),re=i.n(K),fe=i("Nsbk"),Y=i.n(fe),Fe=i("QILm"),We=i.n(Fe),ge=i("lSNA"),we=i.n(ge),dt=i("yG8O"),ke=i.n(dt),Et=i("PJYZ"),Ze=i.n(Et),vt=i("U+yc"),Qe=i.n(vt),yt=i("1ABj"),_t=i("GoyQ"),De=i.n(_t),Ne=i("lSCD"),Ue=i.n(Ne),st=i("xp6e"),Le=i("Hel2"),ut=i("uhBA"),Gt=i("4U9+"),Kt=i.n(Gt),ar=i("4cb6"),oe,Q,H,Ce,Ee,_e;function ve(d){return d.map(function(S){return typeof S=="string"&&(S=[S,{}]),S})}var rt=(oe=Object(ar.injectable)(),Q=Object(ar.inject)(T.TYPES.IGlobalConfigService),oe(H=(Ce=(_e=function(){function d(){X()(this,d),ke()(this,"configService",Ee,this),this.enabled=void 0}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.rendererService,U=x.postProcessingPassFactory,ie=x.normalPassFactory;_.hooks.init.tap("MultiPassRendererPlugin",function(){var me=_.getLayerConfig(),ze=me.enableMultiPassRenderer,Nt=me.passes,Jt=Nt===void 0?[]:Nt;C.enabled=!!ze&&_.getLayerConfig().enableMultiPassRenderer!==!1,C.enabled&&(_.multiPassRenderer=C.createMultiPassRenderer(_,Jt,U,ie),_.multiPassRenderer.setRenderFlag(!0))}),_.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(_,x,C,M){var U=_.multiPassRenderer,ie=_.getLayerConfig(),me=ie.enablePicking,ze=ie.enableTAA;return me&&U.add(M("pixelPicking")),U}}]),d}(),_e),Ee=Qe()(Ce.prototype,"configService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce))||H),$t,St=($t={},we()($t,T.BlendType.additive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:1,dstAlpha:1}}),we()($t,T.BlendType.none,{enable:!1}),we()($t,T.BlendType.normal,{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),we()($t,T.BlendType.subtractive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:T.gl.ZERO,dstAlpha:T.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:T.gl.FUNC_SUBTRACT,alpha:T.gl.FUNC_SUBTRACT}}),we()($t,T.BlendType.max,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MAX_EXT}}),we()($t,T.BlendType.min,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MIN_EXT}}),$t),ye={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},be,Be,lt,Pe,ht,w,I,q;function ce(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=Ve(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(ze){throw ze},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var ze=_.next();return M=ze.done,ze},e:function(ze){U=!0,ie=ze},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function Ve(d,S){if(!d)return;if(typeof d=="string")return $e(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return $e(d,S)}function $e(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function gt(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function nt(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?gt(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):gt(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}function kt(d){var S=$();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ke=0,ae=(be=Object(T.lazyInject)(T.TYPES.ILogService),Be=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),lt=Object(T.lazyInject)(T.TYPES.IShaderModuleService),Pe=(q=function(d){D()(_,d);var S=kt(_);function _(){var x,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X()(this,_),x=S.call(this),x.id="".concat(Ke++),x.name="".concat(Ke),x.type=void 0,x.visible=!0,x.zIndex=0,x.minZoom=void 0,x.maxZoom=void 0,x.inited=!1,x.layerModelNeedUpdate=!1,x.pickedFeatureID=null,x.selectedFeatureID=null,x.styleNeedUpdate=!1,x.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},x.hooks={init:new st.b,afterInit:new st.b,beforeRender:new st.b,beforeRenderData:new st.d,afterRender:new st.c,beforePickingEncode:new st.c,afterPickingEncode:new st.c,beforeHighlight:new st.c(["pickedColor"]),afterHighlight:new st.c,beforeSelect:new st.c(["pickedColor"]),afterSelect:new st.c,beforeDestroy:new st.c,afterDestroy:new st.c},x.models=[],x.multiPassRenderer=void 0,x.plugins=void 0,x.sourceOption=void 0,x.layerModel=void 0,ke()(x,"logger",ht,Ze()(x)),ke()(x,"configService",w,Ze()(x)),ke()(x,"shaderModuleService",I,Ze()(x)),x.cameraService=void 0,x.coordinateService=void 0,x.iconService=void 0,x.fontService=void 0,x.rendererService=void 0,x.layerService=void 0,x.interactionService=void 0,x.mapService=void 0,x.styleAttributeService=void 0,x.layerSource=void 0,x.postProcessingPassFactory=void 0,x.normalPassFactory=void 0,x.animateOptions={enable:!1},x.container=void 0,x.encodedData=void 0,x.configSchema=void 0,x.currentPickId=null,x.rawConfig=void 0,x.needUpdateConfig=void 0,x.pendingStyleAttributes=[],x.scaleOptions={},x.animateStartTime=void 0,x.aniamateStatus=!1,x.sourceEvent=function(){x.dataState.dataSourceNeedUpdate=!0;var M=x.getLayerConfig(),U=M.autoFit,ie=M.fitBoundsOptions;U&&x.fitBounds(ie),x.emit("dataUpdate"),x.reRender()},x.name=C.name||x.id,x.zIndex=C.zIndex||0,x.rawConfig=C,x}return o()(_,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(C){if(!this.inited)this.needUpdateConfig=nt(nt({},this.needUpdateConfig),C);else{var M=this.container.get(T.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,nt(nt(nt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),C)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(C){this.container=C}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(C){return this.plugins.push(C),this}},{key:"init",value:function(){var C=this,M=this.container.get(T.TYPES.SceneID),U=this.rawConfig.enableMultiPassRenderer,ie=U===void 0?!1:U;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(T.TYPES.IIconService),this.fontService=this.container.get(T.TYPES.IFontService),this.rendererService=this.container.get(T.TYPES.IRendererService),this.layerService=this.container.get(T.TYPES.ILayerService),this.interactionService=this.container.get(T.TYPES.IInteractionService),this.mapService=this.container.get(T.TYPES.IMapService),this.cameraService=this.container.get(T.TYPES.ICameraService),this.coordinateService=this.container.get(T.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(T.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(T.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(T.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(T.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(Jt){var wr=Jt.attributeName,Dr=Jt.attributeField,bn=Jt.attributeValues,mn=Jt.updateOptions;C.styleAttributeService.updateStyleAttribute(wr,{scale:nt({field:Dr},C.splitValuesAndCallbackInAttribute(bn,C.getLayerConfig()[wr]))},mn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(T.TYPES.ILayerPlugin);var me=ce(this.plugins),ze;try{for(me.s();!(ze=me.n()).done;){var Nt=ze.value;Nt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(Jt){me.e(Jt)}finally{me.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nt(nt({},this.getDefaultConfig()),this.rawConfig));var C=this.getLayerConfig(),M=C.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(C,M,U){return this.updateStyleAttribute("color",C,M,U),this}},{key:"size",value:function(C,M,U){return this.updateStyleAttribute("size",C,M,U),this}},{key:"filter",value:function(C,M,U){return this.updateStyleAttribute("filter",C,M,U),this}},{key:"shape",value:function(C,M,U){return this.updateStyleAttribute("shape",C,M,U),this}},{key:"label",value:function(C,M,U){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:C,attributeValues:M,updateOptions:U}),this}},{key:"animate",value:function(C){var M={};return De()(C)?(M.enable=!0,M=nt(nt({},M),C)):M.enable=C,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(C,M){return this.sourceOption={data:C,options:M},this}},{key:"setData",value:function(C,M){var U=this;return this.inited?this.layerSource.setData(C,M):this.on("inited",function(){U.layerSource.setData(C,M)}),this}},{key:"style",value:function(C){var M=this,U=C.passes,ie=We()(C,["passes"]);return U&&ve(U).forEach(function(me){var ze=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(me[0]);ze&&ze.updateOptions(me[1])}),this.rawConfig=nt(nt({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(C,M){return De()(C)?this.scaleOptions=nt(nt({},this.scaleOptions),C):this.scaleOptions[C]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(C){var M={};return M.enableHighlight=De()(C)?!0:C,De()(C)?(M.enableHighlight=!0,C.color&&(M.highlightColor=C.color)):M.enableHighlight=!!C,this.updateLayerConfig(M),this}},{key:"setActive",value:function(C,M){var U=this;if(De()(C)){var ie=C.x,me=ie===void 0?0:ie,ze=C.y,Nt=ze===void 0?0:ze;this.updateLayerConfig({highlightColor:De()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:me,y:Nt})}else this.updateLayerConfig({pickedFeatureID:C,highlightColor:De()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Le.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"select",value:function(C){var M={};return M.enableSelect=De()(C)?!0:C,De()(C)?(M.enableSelect=!0,C.color&&(M.selectColor=C.color)):M.enableSelect=!!C,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(C,M){var U=this;if(De()(C)){var ie=C.x,me=ie===void 0?0:ie,ze=C.y,Nt=ze===void 0?0:ze;this.updateLayerConfig({selectColor:De()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:me,y:Nt})}else this.updateLayerConfig({pickedFeatureID:C,selectColor:De()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Le.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"setBlend",value:function(C){this.updateLayerConfig({blend:C}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(C){return this.zIndex=C,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(C){this.currentPickId=C}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(C){this.selectedFeatureID=C}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var C=this.mapService.getZoom(),M=this.getLayerConfig(),U=M.visible,ie=M.minZoom,me=ie===void 0?-Infinity:ie,ze=M.maxZoom,Nt=ze===void 0?Infinity:ze;return!!U&&C>=me&&C<=Nt}},{key:"setMinZoom",value:function(C){return this.updateLayerConfig({minZoom:C}),this}},{key:"getMinZoom",value:function(){var C=this.getLayerConfig(),M=C.minZoom;return M}},{key:"getMaxZoom",value:function(){var C=this.getLayerConfig(),M=C.maxZoom;return M}},{key:"get",value:function(C){var M=this.getLayerConfig();return M[C]}},{key:"setMaxZoom",value:function(C){return this.updateLayerConfig({maxZoom:C}),this}},{key:"fitBounds",value:function(C){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),U=M.extent,ie=U.some(function(me){return Math.abs(me)===Infinity});return ie?this:(this.mapService.fitBounds([[U[0],U[1]],[U[2],U[3]]],C),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(C){return C.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(C){return C.needRescale||C.needRemapping||C.needRegenerateVertices}).length}},{key:"setSource",value:function(C){this.layerSource=C;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(C){this.encodedData=C}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Kt()([ye,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(C){var M=this.styleAttributeService.getLayerAttributeScale(C);if(M){if(M.ticks){var U=M.ticks().map(function(me){return we()({value:me},C,M(me))});return U}else if(M.invertExtent){var ie=M.range().map(function(me){return we()({value:M.invertExtent(me)},C,me)});return ie}}else return[]}},{key:"pick",value:function(C){var M=C.x,U=C.y;this.interactionService.triggerHover({x:M,y:U})}},{key:"buildLayerModel",value:function(C){var M=C.moduleName,U=C.vertexShader,ie=C.fragmentShader,me=C.triangulation,ze=We()(C,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:U,fs:ie});var Nt=this.shaderModuleService.getModule(M),Jt=Nt.vs,wr=Nt.fs,Dr=Nt.uniforms,bn=this.rendererService.createModel,mn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,me),kn=mn.attributes,_a=mn.elements;return bn(nt({attributes:kn,uniforms:Dr,fs:wr,vs:Jt,elements:_a,blend:St[T.BlendType.normal]},ze))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(C){var M=this.getLayerConfig(),U=M.enableHighlight,ie=U===void 0?!0:U,me=M.enableSelect,ze=me===void 0?!0:me,Nt=this.eventNames().indexOf(C)!==-1||this.eventNames().indexOf("un"+C)!==-1;return(C==="click"||C==="dblclick")&&ze&&(Nt=!0),C==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Nt=!0),this.isVisible()&&Nt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var C=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:C.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(C,M){return{values:Ue()(C)?void 0:C||M,callback:Ue()(C)?C:void 0}}},{key:"updateStyleAttribute",value:function(C,M,U,ie){this.inited?this.styleAttributeService.updateStyleAttribute(C,{scale:nt({field:M},this.splitValuesAndCallbackInAttribute(U,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:C,attributeField:M,attributeValues:U,updateOptions:ie})}}]),_}(ut.EventEmitter),q),ht=Qe()(Pe.prototype,"logger",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Qe()(Pe.prototype,"configService",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Qe()(Pe.prototype,"shaderModuleService",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe),et,zt,sr,ft,pt,At,mt=(et=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),zt=Object(T.lazyInject)(T.TYPES.IShaderModuleService),sr=(At=function(){function d(S){X()(this,d),this.triangulation=void 0,this.layer=void 0,ke()(this,"configService",ft,this),ke()(this,"shaderModuleService",pt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=S,this.rendererService=S.getContainer().get(T.TYPES.IRendererService),this.styleAttributeService=S.getContainer().get(T.TYPES.IStyleAttributeService),this.mapService=S.getContainer().get(T.TYPES.IMapService),this.iconService=S.getContainer().get(T.TYPES.IIconService),this.fontService=S.getContainer().get(T.TYPES.IFontService),this.cameraService=S.getContainer().get(T.TYPES.ICameraService),this.layerService=S.getContainer().get(T.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return o()(d,[{key:"getBlend",value:function(){var _=this.layer.getLayerConfig(),x=_.blend,C=x===void 0?"normal":x;return St[T.BlendType[C]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(_){return[_.enable?0:1,_.duration||4,_.interval||.2,_.trailLength||.1]}},{key:"startModelAnimate",value:function(){var _=this.layer.getLayerConfig(),x=_.animateOption;x.enable&&this.layer.setAnimateStartTime()}}]),d}(),At),ft=Qe()(sr.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=Qe()(sr.prototype,"shaderModuleService",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sr),Me=i("J4zp"),ct=i.n(Me),qe=i("RIqP"),Vt=i.n(qe),pr=i("VmRL"),Gr=i.n(pr),ur=i("IOcx"),zn=ur.c.create(),xn=ur.c.create(),na=ur.c.create(),fa=ur.c.create(),Hn=ur.c.create();function Gn(d,S,_,x,C){ur.c.add(d,_,x),ur.c.normalize(d,d),S=ur.c.fromValues(-d[1],d[0]);var M=ur.c.fromValues(-_[1],_[0]);return[C/ur.c.dot(S,M),S]}function F(d,S){return ur.c.set(d,-S[1],S[0])}function W(d,S,_){return ur.c.sub(d,S,_),ur.c.normalize(d,d),d}function le(d,S){return d[0]===S[0]&&d[1]===S[1]}function pe(d){for(var S=new Map,_=0;_<d.length;_++){var x=d[0].toString()+"-"+d[1].toString();S.get(x)?(d.splice(_,1),_++):S.set(x,x)}return d}var at=function(){function d(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};X()(this,d),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=ur.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=S.join||"miter",this.cap=S.cap||"butt",this.miterLimit=S.miterLimit||10,this.thickness=S.thickness||1,this.dash=S.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return o()(d,[{key:"extrude",value:function(_){var x=this.complex;if(_.length<=1)return x;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var C=_.length,M=x.startIndex,U=1;U<C;U++){var ie=_[U-1],me=_[U],ze=U<_.length-1?_[U+1]:null,Nt=this.segment(x,M,ie,me,ze);M+=Nt}if(this.dash)for(var Jt=0;Jt<x.positions.length/6;Jt++)x.positions[Jt*6+5]=this.totalDistance;return x.startIndex=x.positions.length/6,x}},{key:"segment",value:function(_,x,C,M,U){var ie=0,me=_.indices,ze=_.positions,Nt=_.normals,Jt=this.cap==="square",wr=this.join==="bevel",Dr=Object(Le.d)([M[0],M[1]]),bn=Object(Le.d)([C[0],C[1]]);W(na,Dr,bn);var mn=0;if(this.dash&&(mn=this.lineSegmentDistance(Dr,bn),this.totalDistance+=mn),this.normal||(this.normal=ur.c.create(),F(this.normal,na)),!this.started)if(this.started=!0,Jt){var kn=ur.c.create(),_a=ur.c.create();ur.c.add(kn,this.normal,na),ur.c.add(_a,this.normal,na),Nt.push(_a[0],_a[1],0),Nt.push(kn[0],kn[1],0),ze.push(C[0],C[1],0,this.totalDistance-mn,-this.thickness,0),ze.push(C[0],C[1],0,this.totalDistance-mn,this.thickness,0)}else this.extrusions(ze,Nt,C,this.normal,this.thickness,this.totalDistance-mn);if(me.push(x+0,x+1,x+2),U){var ui=Object(Le.d)([U[0],U[1]]);le(Dr,ui)&&ur.c.add(ui,Dr,ur.c.normalize(ui,ur.c.subtract(ui,Dr,bn))),W(fa,ui,Dr);var li=Gn(Hn,ur.c.create(),na,fa,this.thickness),qi=ct()(li,2),wa=qi[0],eo=qi[1],To=ur.c.dot(Hn,this.normal)<0?-1:1,Xs=wr;if(!Xs&&this.join==="miter"){var Ya=wa;Ya>this.miterLimit&&(Xs=!0)}Xs?(Nt.push(this.normal[0],this.normal[1],0),Nt.push(eo[0],eo[1],0),ze.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),ze.push(M[0],M[1],0,this.totalDistance,this.thickness*To,0),me.push.apply(me,Vt()(this.lastFlip!==-To?[x,x+2,x+3]:[x+2,x+1,x+3])),me.push(x+2,x+3,x+4),F(zn,fa),ur.c.copy(this.normal,zn),Nt.push(this.normal[0],this.normal[1],0),ze.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),ie+=3):(this.extrusions(ze,Nt,M,eo,wa,this.totalDistance),me.push.apply(me,Vt()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),To=-1,ur.c.copy(this.normal,eo),ie+=2),this.lastFlip=To}else{if(F(this.normal,na),Jt){var Ca=ur.c.create(),Di=ur.c.create();ur.c.sub(Di,na,this.normal),ur.c.add(Ca,na,this.normal),Nt.push(Di[0],Di[1],0),Nt.push(Ca[0],Ca[1],0),ze.push(M[0],M[1],0,this.totalDistance,this.thickness,0),ze.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(ze,Nt,M,this.normal,this.thickness,this.totalDistance);me.push.apply(me,Vt()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),ie+=2}return ie}},{key:"extrusions",value:function(_,x,C,M,U,ie){x.push(M[0],M[1],0),x.push(M[0],M[1],0),_.push(C[0],C[1],0,ie,-U,0),_.push(C[0],C[1],0,ie,U,0)}},{key:"lineSegmentDistance",value:function(_,x){var C=x[0]-_[0],M=x[1]-_[1];return Math.sqrt(C*C+M*M)}}]),d}(),Tt=i("UB5X"),jt=i.n(Tt);function Ge(d){if(jt()(d[0]))return d;if(jt()(d[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(jt()(d[0][0][0])){var S=d,_=0,x=0,C=0;return S.forEach(function(M){M.forEach(function(U){_+=U[0],x+=U[1],C++})}),[_/C,x/C,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function wt(d){var S=d[0][0],_=d[0][d[0].length-1];S[0]===_[0]&&S[1]===_[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var x=d[0].length,C=Gr.a.flatten(d),M=C.vertices,U=C.dimensions,ie=[],me=[],ze=0;ze<M.length/U;ze++)U===2?ie.push(M[ze*2],M[ze*2+1],1):ie.push(M[ze*3],M[ze*3+1],1);var Nt=Gr()(C.vertices,C.holes,C.dimensions);me.push.apply(me,Vt()(Nt));for(var Jt=function(bn){var mn=C.vertices.slice(bn*U,(bn+1)*U),kn=C.vertices.slice((bn+1)*U,(bn+2)*U);kn.length===0&&(kn=C.vertices.slice(0,U));var _a=ie.length/3;ie.push(mn[0],mn[1],1,kn[0],kn[1],1,mn[0],mn[1],0,kn[0],kn[1],0),me.push.apply(me,Vt()([0,2,1,2,3,1].map(function(Ca){return Ca+_a})))},wr=0;wr<x;wr++)Jt(wr);return{positions:ie,index:me}}function ir(d){var S=Gr.a.flatten(d),_=Gr()(S.vertices,S.holes,S.dimensions);return{positions:S.vertices,index:_}}function Ur(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=d[0][0],x=d[0][d[0].length-1];_[0]===x[0]&&_[1]===x[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var C=d[0].length,M=Gr.a.flatten(d),U=M.vertices,ie=M.dimensions,me=[],ze=[],Nt=[],Jt=0;Jt<U.length/ie;Jt++)ie===2?me.push(U[Jt*2],U[Jt*2+1],1,-1,-1):me.push(U[Jt*3],U[Jt*3+1],1,-1,-1),Nt.push(0,0,1);var wr=Gr()(M.vertices,M.holes,M.dimensions);ze.push.apply(ze,Vt()(wr));for(var Dr=function(kn){var _a=M.vertices.slice(kn*ie,(kn+1)*ie),Ca=M.vertices.slice((kn+1)*ie,(kn+2)*ie);Ca.length===0&&(Ca=M.vertices.slice(0,ie));var Di=me.length/5;me.push(_a[0],_a[1],1,0,0,Ca[0],Ca[1],1,.1,0,_a[0],_a[1],0,0,.8,Ca[0],Ca[1],0,.1,.8);var ui=Vr([Ca[0],Ca[1],1],[_a[0],_a[1],0],[_a[0],_a[1],1],S);Nt.push.apply(Nt,Vt()(ui).concat(Vt()(ui),Vt()(ui),Vt()(ui))),ze.push.apply(ze,Vt()([1,2,0,3,2,1].map(function(li){return li+Di})))},bn=0;bn<C;bn++)Dr(bn);return{positions:me,index:ze,normals:Nt}}function Vr(d,S,_){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=ur.d.create(),M=ur.d.create(),U=ur.d.create();x&&(d=Object(Le.p)(d),S=Object(Le.p)(S),_=Object(Le.p)(_));var ie=ur.d.fromValues.apply(ur.d,Vt()(d)),me=ur.d.fromValues.apply(ur.d,Vt()(S)),ze=ur.d.fromValues.apply(ur.d,Vt()(_));ur.d.sub(C,ze,me),ur.d.sub(M,ie,me),ur.d.cross(U,C,M);var Nt=ur.d.create();return ur.d.normalize(Nt,U),Nt}var or,Fr;(function(d){d.CYLINDER="cylinder",d.SQUARECOLUMN="squareColumn",d.TRIANGLECOLUMN="triangleColumn",d.HEXAGONCOLUMN="hexagonColumn",d.PENTAGONCOLUMN="pentagonColumn"})(Fr||(Fr={}));var Sn;(function(d){d.CIRCLE="circle",d.SQUARE="square",d.TRIANGLE="triangle",d.HEXAGON="hexagon",d.PENTAGON="pentagon"})(Sn||(Sn={}));function fn(d){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=Math.PI*2/d,x=[],C=0;C<d;C++)x.push(_*C+S*Math.PI/12);var M=x.map(function(U){var ie=Math.sin(U+Math.PI/4),me=Math.cos(U+Math.PI/4);return[ie,me,0]});return M}function Er(){return fn(30)}function Tn(){return fn(4)}function dn(){return fn(3)}function vn(){return fn(6,1)}function Sr(){return fn(5)}var Kr=(or={},we()(or,Sn.CIRCLE,Er),we()(or,Sn.HEXAGON,vn),we()(or,Sn.TRIANGLE,dn),we()(or,Sn.SQUARE,Tn),we()(or,Sn.PENTAGON,Sr),we()(or,Fr.CYLINDER,Er),we()(or,Fr.HEXAGONCOLUMN,vn),we()(or,Fr.TRIANGLECOLUMN,dn),we()(or,Fr.SQUARECOLUMN,Tn),we()(or,Fr.PENTAGONCOLUMN,Sr),or),wn={};function Ka(d){var S=Ge(d.coordinates);return{vertices:[].concat(Vt()(S),Vt()(S),Vt()(S),Vt()(S)),indices:[0,1,2,2,3,0],size:S.length}}function da(d){var S=d.shape,_=Li(S,!1),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function Oa(d){var S=Ge(d.coordinates);return{vertices:Vt()(S),indices:[0],size:S.length}}function Ia(d){var S=d.coordinates,_=S;Array.isArray(_[0][0])||(_=[S]);var x=new at({dash:!0,join:"bevel"});_.forEach(function(M){x.extrude(M)});var C=x.complex;return{vertices:C.positions,indices:C.indices,normals:C.normals,size:6}}function Xi(d){var S=d.coordinates,_=Gr.a.flatten(S),x=_.vertices,C=_.dimensions,M=_.holes;return{indices:Gr()(x,M,C),vertices:x,size:C}}function ha(d){var S=d.coordinates,_=Ur(S,!0),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function gi(d){var S=d.shape,_=Gu(S),x=_.positions,C=_.index;return{vertices:x,indices:C,size:3}}function Ma(d){var S=d.coordinates,_=[].concat(Vt()(S[0]),[0,0,1,S[1][0],S[0][1],0,1,1],Vt()(S[1]),[0,1,0],Vt()(S[0]),[0,0,1],Vt()(S[1]),[0,1,0,S[0][0],S[1][1],0,0,0]),x=[0,1,2,3,4,5];return{vertices:_,indices:x,size:5}}function ya(d){for(var S=30,_=d.coordinates,x=[],C=[],M=function(me){x.push(me,1,me,_[0][0],_[0][1],_[1][0],_[1][1],me,-1,me,_[0][0],_[0][1],_[1][0],_[1][1]),me!==S-1&&C.push.apply(C,Vt()([0,1,2,1,3,2].map(function(ze){return me*2+ze})))},U=0;U<S;U++)M(U);return{vertices:x,indices:C,size:7}}function la(d){var S=d.coordinates;S.length===2&&S.push(0);var _=d.size,x=Ba(-1,1),C=Ba(1,1),M=Ba(-1,-1),U=Ba(1,-1),ie=[].concat(Vt()(S),Vt()(x),Vt()(S),Vt()(M),Vt()(S),Vt()(U),Vt()(S),Vt()(C)),me=[0,1,2,3,0,2];return{vertices:ie,indices:me,size:5}}function Li(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(wn&&wn[d])return wn[d];var _=Kr[d]?Kr[d]():Kr.cylinder(),x=Ur([_],S);return wn[d]=x,x}function po(d,S){for(var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=new Float32Array(d.length/_*3),M,U,ie,me=ur.d.create(),ze=ur.d.create(),Nt=ur.d.create(),Jt=0,wr=S.length;Jt<wr;Jt+=3){M=S[Jt+0]*3,U=S[Jt+1]*3,ie=S[Jt+2]*3;var Dr=[d[M],d[M+1]],bn=[d[U],d[U+1]],mn=[d[ie],d[ie+1]];x&&(Dr=Object(Le.p)(Dr),bn=Object(Le.p)(bn),mn=Object(Le.p)(mn));var kn=Dr,_a=ct()(kn,2),Ca=_a[0],Di=_a[1],ui=ur.d.fromValues(Ca,Di,d[M+2]),li=bn,qi=ct()(li,2),wa=qi[0],eo=qi[1],To=ur.d.fromValues(wa,eo,d[U+2]),Xs=mn,Ya=ct()(Xs,2),ws=Ya[0],qo=Ya[1],gf=ur.d.fromValues(ws,qo,d[ie+2]);ur.d.sub(me,gf,To),ur.d.sub(ze,ui,To),ur.d.cross(Nt,me,ze),C[M]+=me[0],C[M+1]+=me[1],C[M+2]+=me[2],C[U]+=me[0],C[U+1]+=me[1],C[U+2]+=me[2],C[ie]+=me[0],C[ie+1]+=me[1],C[ie+2]+=me[2]}return Yi(C),C}function Yi(d){for(var S=0,_=d.length;S<_;S+=3){var x=ur.d.fromValues(d[S],d[S+1],d[S+2]),C=ur.d.create();ur.d.normalize(C,x),d.set(C,S)}}function Ko(d){var S=d[0][0],_=d[0][d[0].length-1];return S[0]===_[0]&&S[1]===_[1]}function Gu(d){var S=["cylinder","triangleColumn","hexagonColumn","squareColumn"],_=Kr[d]?Kr[d]():Kr.circle(),x=S.indexOf(d)===-1?ir([_]):wt([_]);return x}function Ba(d,S){var _=(d+1)/2,x=(S+1)/2;return[_,x]}function Ai(d){var S=es();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function es(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ii=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ki=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,ts=function(d){D()(_,d);var S=Ai(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.baseColor,me=ie===void 0?"rgb(16,16,16)":ie,ze=C.brightColor,Nt=ze===void 0?"rgb(255,176,38)":ze,Jt=C.windowColor,wr=Jt===void 0?"rgb(30,60,89)":Jt,Dr=C.time,bn=Dr===void 0?0:Dr;return{u_opacity:U,u_baseColor:Object(Le.s)(me),u_brightColor:Object(Le.s)(Nt),u_windowColor:Object(Le.s)(wr),u_time:this.layer.getLayerAnimateTime()||bn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Ki,fragmentShader:ii,triangulation:ha})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,me,ze){return ze}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?10:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){var ze=M.size;return[ie[3],ie[4]]}}})}}]),_}(mt);function Ja(d){var S=oo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var so=function(d){D()(_,d);var S=Ja(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){this.layerModel=new ts(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(C){this.updateLayerConfig({time:C})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),_}(ae);function Ys(d){var S=_o();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Zl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,Ks=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,So=function(d){D()(_,d);var S=Ys(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Zl,fragmentShader:Ks,triangulation:gi,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(mt);function Ut(d){var S=Ie();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ie(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Pt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,cr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,tn=function(d){D()(_,d);var S=Ut(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Pt,fragmentShader:cr,triangulation:da,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size;return Array.isArray(ze)?[ze[0]]:[ze]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,me,ze){return ze}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(mt);function En(d,S){for(var _=[],x=[],C=[],M=d+1,U=S+1,ie=d/2,me=S/2,ze=0;ze<U;ze++)for(var Nt=ze-me,Jt=0;Jt<M;Jt++){var wr=Jt-ie;x.push(wr/ie,-Nt/me,0),C.push(Jt/d),C.push(1-ze/S)}for(var Dr=0;Dr<S;Dr++)for(var bn=0;bn<d;bn++){var mn=bn+M*Dr,kn=bn+M*(Dr+1),_a=bn+1+M*(Dr+1),Ca=bn+1+M*Dr;_.push(mn,kn,Ca),_.push(kn,_a,Ca)}return{vertices:x,indices:_,uvs:C}}function Fn(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function Ri(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?Fn(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):Fn(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}function to(d){var S=mo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Do=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Hu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Xl=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,$s=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,Ic=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Ll=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,fs=function(d){D()(_,d);var S=to(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x.heatmapFramerBuffer=void 0,x.intensityModel=void 0,x.colorModel=void 0,x.shapeType=void 0,x}return o()(_,[{key:"render",value:function(){var C=this,M=this.rendererService,U=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){U({color:[0,0,0,0],depth:1,stencil:0,framebuffer:C.heatmapFramerBuffer}),C.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var C,M=this.rendererService,U=M.createFramebuffer,ie=M.clear,me=M.getViewportSize,ze=M.createTexture2D,Nt=M.useFramebuffer,Jt=this.styleAttributeService.getLayerStyleAttribute("shape"),wr=(Jt==null||((C=Jt.scale)===null||C===void 0)?void 0:C.field)||"heatmap";this.shapeType=wr,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=wr==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Dr=this.layer.getLayerConfig(),bn=Dr.rampColors,mn=Object(Le.n)(bn),kn=me(),_a=kn.width,Ca=kn.height;return this.heatmapFramerBuffer=U({color:ze({width:Math.floor(_a/4),height:Math.floor(Ca/4),wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.LINEAR,mag:T.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:T.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?1:ze;return[Nt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:Ic,fragmentShader:$s,triangulation:la,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:T.gl.ONE,srcAlpha:1,dstRGB:T.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Ll,fs:Xl});var C=this.shaderModuleService.getModule("heatmapColor"),M=C.vs,U=C.fs,ie=C.uniforms,me=this.rendererService,ze=me.createAttribute,Nt=me.createElements,Jt=me.createBuffer,wr=me.createModel;return wr({vs:M,fs:U,attributes:{a_Position:ze({buffer:Jt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:T.gl.FLOAT}),size:3}),a_Uv:ze({buffer:Jt({data:[0,1,1,1,0,0,1,0],type:T.gl.FLOAT}),size:2})},uniforms:Ri({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Nt({data:[0,2,1,2,3,1],type:T.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.intensity,ie=U===void 0?10:U,me=C.radius,ze=me===void 0?5:me;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:ze,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=ur.b.invert(ur.b.create(),ur.b.fromValues.apply(ur.b,Vt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Vt()(U)}})}},{key:"build3dHeatMap",value:function(){var C=this.rendererService.getViewportSize,M=C(),U=M.width,ie=M.height,me=En(U/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Hu,fs:Do});var ze=this.shaderModuleService.getModule("heatmap3dColor"),Nt=ze.vs,Jt=ze.fs,wr=ze.uniforms,Dr=this.rendererService,bn=Dr.createAttribute,mn=Dr.createElements,kn=Dr.createBuffer,_a=Dr.createModel;return _a({vs:Nt,fs:Jt,attributes:{a_Position:bn({buffer:kn({data:me.vertices,type:T.gl.FLOAT}),size:3}),a_Uv:bn({buffer:kn({data:me.uvs,type:T.gl.FLOAT}),size:2})},primitive:T.gl.TRIANGLES,uniforms:Ri({},wr),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,srcAlpha:1,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:mn({data:me.indices,type:T.gl.UNSIGNED_INT,count:me.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var C=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Le.n)(U);this.colorTexture=C({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.NEAREST,mag:T.gl.NEAREST,flipY:!1})}}]),_}(mt);function ks(d){var S=uo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var hs=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Js=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,cu=function(d){D()(_,d);var S=ks(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Js,fragmentShader:hs,triangulation:gi,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(mt),Yl={heatmap:fs,heatmap3d:fs,grid:So,grid3d:tn,hexagon:cu},yi=Yl;function Ni(d){var S=vl();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function vl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var js=function(d){D()(_,d);var S=Ni(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="HeatMapLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new yi[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var C=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(U){return U.draw({uniforms:C.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=this.getLayerConfig(),ie=U.shape3d,me=this.getSource(),ze=me.data.type,Nt=(M==null||((C=M.scale)===null||C===void 0)?void 0:C.field)||"heatmap";return Nt==="heatmap"||Nt==="heatmap3d"?"heatmap":ze==="hexagon"?(ie==null?void 0:ie.indexOf(Nt))===-1?"hexagon":"grid3d":ze==="grid"?(ie==null?void 0:ie.indexOf(Nt))===-1?"grid":"grid3d":"heatmap"}}]),_}(ae);function ds(d){var S=Ot();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ot(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var er=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Or=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Bn=function(d){D()(_,d);var S=ds(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var C=this,M=this.layer.getSource(),U=this.rendererService.createTexture2D;return this.texture=U({height:0,width:0}),M.data.images.then(function(ie){C.texture=U({data:ie[0],width:ie[0].width,height:ie[0].height}),C.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Or,fragmentShader:er,triangulation:Ma,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){return[ie[3],ie[4]]}}})}}]),_}(mt),Qa={image:Bn},Ii=Qa;function Gi(d){var S=qa();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function qa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var bi=function(d){D()(_,d);var S=Gi(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="ImageLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Ii[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={image:{}};return M[C]}},{key:"getModelType",value:function(){return"image"}}]),_}(ae);function Ao(d){var S=zs();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function zs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var di=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Kl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,fu={solid:0,dash:1},Os=function(d){D()(_,d);var S=Ao(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,me=C.dashArray,ze=me===void 0?[10,5]:me;return ze.length===2&&ze.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:fu[ie||"solid"],u_dash_array:ze,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Kl,fragmentShader:di,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?1:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,me){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(mt);function gl(d){var S=hu();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function hu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Wu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,Qs=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,nl={solid:0,dash:1},du=function(d){D()(_,d);var S=gl(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,me=C.dashArray,ze=me===void 0?[10,5]:me;return ze.length===2&&ze.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:nl[ie]||0,u_dash_array:ze}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Wu,fragmentShader:Qs,triangulation:ya,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?1:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,me){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(mt);function vc(d){var S=Pf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Pf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Dc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,gc={solid:0,dash:1},rf=function(d){D()(_,d);var S=vc(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,me=C.dashArray,ze=me===void 0?[10,5]:me;return ze.length===2&&ze.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:gc[ie]||0,u_dash_array:ze}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Dc,fragmentShader:pi,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?1:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,me){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(mt);function nf(d){var S=af();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function af(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var $i=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Cu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,qs={solid:0,dash:1},ps=function(d){D()(_,d);var S=nf(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,me=C.dashArray,ze=me===void 0?[10,5,0,0]:me;return ze.length===2&&ze.push(0,0),{u_opacity:M||1,u_line_type:qs[ie],u_dash_array:ze}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Cu,fragmentShader:$i,triangulation:Ia,primitive:T.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var C=this.layer.getLayerConfig(),M=C.lineType,U=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,ze,Nt,Jt){return[Nt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,ze,Nt,Jt){return[Nt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(me,ze,Nt,Jt){var wr=me.size,Dr=wr===void 0?1:wr;return Array.isArray(Dr)?[Dr[0],Dr[1]]:[Dr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(me,ze,Nt,Jt,wr){return wr}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:T.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,ze,Nt,Jt){return[Nt[4]]}}})}}]),_}(mt),Nc={arc:Os,arc3d:du,greatcircle:rf,line:ps},yc=Nc;function yl(d){var S=al();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function al(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var bc=function(d){D()(_,d);var S=yl(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="LineLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new yc[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[C]}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U||"line"}}]),_}(ae);function eu(d){var S=Zu();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Zu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var kc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,$l=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Ci=function(d){D()(_,d);var S=eu(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.offsets;return{u_opacity:M||1,u_offsets:U||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:$l,fragmentShader:kc,triangulation:da,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,me){var ze=M.size;if(ze){var Nt=[];return Array.isArray(ze)&&(Nt=ze.length===2?[ze[0],ze[0],ze[1]]:ze),Array.isArray(ze)||(Nt=[ze]),Nt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,me,ze){return ze}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=Ge(M.coordinates);return[ie[0],ie[1],0]}}})}}]),_}(mt);function jc(d){var S=Lf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Lf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var xc=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,zc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,Jl=function(d){D()(_,d);var S=jc(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,me=ie===void 0?"rgb(0,0,0,0)":ie,ze=C.strokeWidth,Nt=ze===void 0?1:ze,Jt=C.strokeOpacity,wr=Jt===void 0?1:Jt,Dr=C.offsets,bn=Dr===void 0?[0,0]:Dr;return{u_opacity:U,u_stroke_width:Nt,u_stroke_color:Object(Le.s)(me),u_stroke_opacity:wr,u_offsets:[-bn[0],bn[1]]}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ka)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:zc,fragmentShader:xc,triangulation:Ka,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(C){return[C.enable?0:1,C.speed||1,C.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:T.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,me,ze){var Nt=[1,1,-1,1,-1,-1,1,-1],Jt=ze%4*2;return[Nt[Jt],Nt[Jt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,me,ze){var Nt=U.size,Jt=Nt===void 0?5:Nt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:T.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,me,ze){var Nt=U.shape,Jt=Nt===void 0?2:Nt,wr=C.layer.getLayerConfig().shape2d,Dr=wr.indexOf(Jt);return[Dr]}}})}}]),_}(mt);function Xu(d){var S=wu();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function wu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Rl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,No=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Ql=function(d){D()(_,d);var S=Xu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var C=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){C.updateTexture(),C.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:No,fragmentShader:Rl,triangulation:Oa,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,me,ze){var Nt=U.size;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,me,ze){var Nt=C.fontService.mapping,Jt=U.shape,wr=C.fontService.getGlyph(Jt),Dr=Nt[wr],bn=Dr.x,mn=Dr.y;return[bn,mn]}}})}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.fontWeight,ie=U===void 0?"normal":U,me=M.fontFamily,ze=me===void 0?"sans-serif":me,Nt=this.layer.getEncodedData(),Jt=[];Nt.forEach(function(wr){var Dr=wr.shape,bn=Dr===void 0?"":Dr;bn=bn.toString();var mn=C.fontService.getGlyph(bn);Jt.indexOf(mn)===-1&&Jt.push(mn)}),this.fontService.setFontOptions({characterSet:Jt,fontWeight:ie,fontFamily:ze,fontSize:48})}}]),_}(mt);function Il(d){var S=bl();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function bl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Fc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Dl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,tu=function(d){D()(_,d);var S=Il(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.updateTexture=function(){var ie=x.rendererService.createTexture2D;if(x.texture){x.texture.update({data:x.iconService.getCanvas()}),x.layer.render();return}x.texture=ie({data:x.iconService.getCanvas(),mag:T.gl.LINEAR,min:T.gl.LINEAR,width:1024,height:x.iconService.canvasHeight||128})},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.offsets,ie=U===void 0?[0,0]:U;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ie[0],ie[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Dl,fragmentShader:Fc,triangulation:Oa,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,me,ze){var Nt=U.size,Jt=Nt===void 0?5:Nt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,me,ze){var Nt=C.iconService.getIconMap(),Jt=U.shape,wr=Nt[Jt]||{x:0,y:0},Dr=wr.x,bn=wr.y;return[Dr,bn]}}})}}]),_}(mt);function yf(d){var S=bf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function bf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var of=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,xl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function ki(d){var S=d.coordinates;return{vertices:Vt()(S),indices:[0],size:S.length}}var il=function(d){D()(_,d);var S=yf(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,me=ie===void 0?"rgb(0,0,0,0)":ie,ze=C.strokeWidth,Nt=ze===void 0?1:ze,Jt=C.offsets,wr=Jt===void 0?[0,0]:Jt;return{u_opacity:U,u_stroke_width:Nt,u_stroke_color:Object(Le.s)(me),u_offsets:[-wr[0],wr[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:xl,fragmentShader:of,triangulation:ki,depth:{enable:!1},primitive:T.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?1:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:T.BlendType.additive}}}]),_}(mt);function Nl(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=Ec(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(ze){throw ze},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var ze=_.next();return M=ze.done,ze},e:function(ze){U=!0,ie=ze},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function Ec(d,S){if(!d)return;if(typeof d=="string")return Uc(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return Uc(d,S)}function Uc(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}var kl=function(){function d(S,_,x){X()(this,d),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var C=this.boxCells;this.xCellCount=Math.ceil(S/x),this.yCellCount=Math.ceil(_/x);for(var M=0;M<this.xCellCount*this.yCellCount;M++)C.push([]);this.boxKeys=[],this.bboxes=[],this.width=S,this.height=_,this.xScale=this.xCellCount/S,this.yScale=this.yCellCount/_,this.boxUid=0}return o()(d,[{key:"insert",value:function(_,x,C,M,U){this.forEachCell(x,C,M,U,this.insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(M),this.bboxes.push(U)}},{key:"query",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!1,U)}},{key:"hitTest",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!0,U)}},{key:"insertBoxCell",value:function(_,x,C,M,U,ie){this.boxCells[U].push(ie)}},{key:"queryHitTest",value:function(_,x,C,M,U,ie){if(C<0||_>this.width||M<0||x>this.height)return U?!1:[];var me=[];if(_<=0&&x<=0&&this.width<=C&&this.height<=M){if(U)return!0;for(var ze=0;ze<this.boxKeys.length;ze++)me.push({key:this.boxKeys[ze],x1:this.bboxes[ze*4],y1:this.bboxes[ze*4+1],x2:this.bboxes[ze*4+2],y2:this.bboxes[ze*4+3]});return ie?me.filter(ie):me}var Nt={hitTest:U,seenUids:{box:{},circle:{}}};return this.forEachCell(_,x,C,M,this.queryCell,me,Nt,ie),U?me.length>0:me}},{key:"queryCell",value:function(_,x,C,M,U,ie,me,ze){var Nt=me.seenUids,Jt=this.boxCells[U];if(Jt!==null){var wr=this.bboxes,Dr=Nl(Jt),bn;try{for(Dr.s();!(bn=Dr.n()).done;){var mn=bn.value;if(!Nt.box[mn]){Nt.box[mn]=!0;var kn=mn*4;if(_<=wr[kn+2]&&x<=wr[kn+3]&&C>=wr[kn+0]&&M>=wr[kn+1]&&(!ze||ze(this.boxKeys[mn]))){if(me.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[mn],x1:wr[kn],y1:wr[kn+1],x2:wr[kn+2],y2:wr[kn+3]})}}}}catch(_a){Dr.e(_a)}finally{Dr.f()}}return!1}},{key:"forEachCell",value:function(_,x,C,M,U,ie,me,ze){for(var Nt=this.convertToXCellCoord(_),Jt=this.convertToYCellCoord(x),wr=this.convertToXCellCoord(C),Dr=this.convertToYCellCoord(M),bn=Nt;bn<=wr;bn++)for(var mn=Jt;mn<=Dr;mn++){var kn=this.xCellCount*mn+bn;if(U.call(this,_,x,C,M,kn,ie,me,ze))return}}},{key:"convertToXCellCoord",value:function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))}},{key:"convertToYCellCoord",value:function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))}}]),d}(),Rf=kl,If=function(){function d(S,_){X()(this,d),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=S,this.height=_,this.viewportPadding=Math.max(S,_),this.grid=new Rf(S+this.viewportPadding,_+this.viewportPadding,25),this.screenRightBoundary=S+this.viewportPadding,this.screenBottomBoundary=_+this.viewportPadding,this.gridRightBoundary=S+2*this.viewportPadding,this.gridBottomBoundary=_+2*this.viewportPadding}return o()(d,[{key:"placeCollisionBox",value:function(_){var x=_.x1+_.anchorPointX+this.viewportPadding,C=_.y1+_.anchorPointY+this.viewportPadding,M=_.x2+_.anchorPointX+this.viewportPadding,U=_.y2+_.anchorPointY+this.viewportPadding;return!this.isInsideGrid(x,C,M,U)||this.grid.hitTest(x,C,M,U)?{box:[]}:{box:[x,C,M,U]}}},{key:"insertCollisionBox",value:function(_,x){var C={featureIndex:x};this.grid.insert(C,_[0],_[1],_[2],_[3])}},{key:"project",value:function(_,x,C){var M=ur.e.fromValues(x,C,0,1),U=ur.e.create(),ie=ur.b.fromValues.apply(ur.b,Vt()(_));return ur.e.transformMat4(U,M,ie),{x:(U[0]/U[3]+1)/2*this.width+this.viewportPadding,y:(-U[1]/U[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(_,x,C,M){return C>=0&&_<this.gridRightBoundary&&M>=0&&x<this.gridBottomBoundary}}]),d}();function sf(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=El(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(ze){throw ze},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var ze=_.next();return M=ze.done,ze},e:function(ze){U=!0,ie=ze},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function El(d,S){if(!d)return;if(typeof d=="string")return ql(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return ql(d,S)}function ql(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function Ou(d){var S=.5,_=.5;switch(d){case"right":case"top-right":case"bottom-right":S=1;break;case"left":case"top-left":case"bottom-left":S=0;break;default:S=.5}switch(d){case"bottom":case"bottom-right":case"bottom-left":_=1;break;case"top":case"top-right":case"top-left":_=0;break;default:_=.5}return{horizontalAlign:S,verticalAlign:_}}function Fs(d,S,_,x,C){if(!C)return;var M=d[x],U=M.glyph;if(U)for(var ie=S[U].advance*M.scale,me=(d[x].x+ie)*C,ze=_;ze<=x;ze++)d[ze].x-=me}function ol(d,S,_,x,C,M,U){var ie=(S-_)*C,me=(-x*U+.5)*M,ze=sf(d),Nt;try{for(ze.s();!(Nt=ze.n()).done;){var Jt=Nt.value;Jt.x+=ie,Jt.y+=me}}catch(wr){ze.e(wr)}finally{ze.f()}}function Bc(d,S,_,x,C,M,U){var ie=-8,me=0,ze=ie,Nt=0,Jt=d.positionedGlyphs,wr=M==="right"?1:M==="left"?0:.5,Dr=Jt.length;_.forEach(function(Ca){if(Ca.split("").forEach(function(ui){var li=S[ui],qi=0;li&&(Jt.push({glyph:ui,x:me,y:ze+qi,vertical:!1,scale:1,metrics:li}),me+=li.advance+U)}),Jt.length!==Dr){var Di=me-U;Nt=Math.max(Di,Nt),Fs(Jt,S,Dr,Jt.length-1,wr)}me=0,ze+=x});var bn=Ou(C),mn=bn.horizontalAlign,kn=bn.verticalAlign;ol(Jt,wr,mn,kn,Nt,x,_.length);var _a=ze-ie;d.top+=-kn*_a,d.bottom=d.top+_a,d.left+=-mn*Nt,d.right=d.left+Nt}function Yu(d,S,_,x,C,M){var U=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=d.split(`
`),me=[],ze={positionedGlyphs:me,top:U[1],bottom:U[1],left:U[0],right:U[0],lineCount:ie.length,text:d};return Bc(ze,S,ie,_,x,C,M),me.length?ze:!1}function ji(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],_=arguments.length>2?arguments[2]:void 0,x=d.positionedGlyphs,C=x===void 0?[]:x,M=[],U=sf(C),ie;try{for(U.s();!(ie=U.n()).done;){var me=ie.value,ze=me.metrics,Nt=4,Jt=ze.advance*me.scale/2,wr=_?[me.x+Jt,me.y]:[0,0],Dr=_?[0,0]:[me.x+Jt+S[0],me.y+S[1]],bn=(0-Nt)*me.scale-Jt+Dr[0],mn=(0-Nt)*me.scale+Dr[1],kn=bn+ze.width*me.scale,_a=mn+ze.height*me.scale,Ca={x:bn,y:mn},Di={x:kn,y:mn},ui={x:bn,y:_a},li={x:kn,y:_a};M.push({tl:Ca,tr:Di,bl:ui,br:li,tex:ze,glyphOffset:wr})}}catch(qi){U.e(qi)}finally{U.f()}return M}function pu(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=sl(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(ze){throw ze},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var ze=_.next();return M=ze.done,ze},e:function(ze){U=!0,ie=ze},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function sl(d,S){if(!d)return;if(typeof d=="string")return ul(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return ul(d,S)}function ul(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function Da(d){var S=mi();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function mi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ms=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ti=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Wa(d){var S=this,_=d.id,x=[],C=[];if(!S.glyphInfoMap||!S.glyphInfoMap[_])return{vertices:[],indices:[],size:7};var M=S.glyphInfoMap[_].centroid,U=M.length===2?[M[0],M[1],0]:M;return S.glyphInfoMap[_].glyphQuads.forEach(function(ie,me){x.push.apply(x,Vt()(U).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Vt()(U),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Vt()(U),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Vt()(U),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),C.push(0+me*4,1+me*4,2+me*4,2+me*4,3+me*4,0+me*4)}),{vertices:x,indices:C,size:7}}var ec=function(d){D()(_,d);var S=Da(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.glyphInfo=void 0,x.glyphInfoMap={},x.texture=void 0,x.currentZoom=-1,x.extent=void 0,x.textureHeight=0,x.textCount=0,x.preTextStyle={},x.buildModels=function(){return x.initGlyph(),x.updateTexture(),x.filterGlyphs(),[x.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ti,fragmentShader:Ms,triangulation:Wa.bind(Ze()(x)),depth:{enable:!1},blend:x.getBlend()})]},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,me=ie===void 0?"#fff":ie,ze=C.strokeWidth,Nt=ze===void 0?0:ze,Jt=C.strokeOpacity,wr=Jt===void 0?1:Jt,Dr=C.textAnchor,bn=Dr===void 0?"center":Dr,mn=C.textAllowOverlap,kn=mn===void 0?!1:mn,_a=C.halo,Ca=_a===void 0?.5:_a,Di=C.gamma,ui=Di===void 0?2:Di,li=this.fontService,qi=li.canvas,wa=li.mapping;return Object.keys(wa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(wa).length),this.preTextStyle={textAnchor:bn,textAllowOverlap:kn},{u_opacity:U,u_stroke_opacity:wr,u_sdf_map:this.texture,u_stroke:Object(Le.s)(me),u_halo_blur:Ca,u_gamma_scale:ui,u_sdf_map_size:[qi.width,qi.height],u_strokeWidth:Nt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var C=this.layer.getLayerConfig(),M=C.textAnchor,U=M===void 0?"center":M,ie=C.textAllowOverlap,me=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:U,textAllowOverlap:me},this.buildModels()}},{key:"needUpdate",value:function(){var C=this.layer.getLayerConfig(),M=C.textAllowOverlap,U=M===void 0?!1:M,ie=this.mapService.getZoom(),me=this.mapService.getBounds(),ze=Object(Le.j)(this.extent,me);return!U&&(Math.abs(this.currentZoom-ie)>1||!ze)||U!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:T.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?12:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:T.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var C=this.mapService.getBounds();return Object(Le.r)(C,.5)}},{key:"initTextFont",value:function(){var C=this.layer.getLayerConfig(),M=C.fontWeight,U=M===void 0?"400":M,ie=C.fontFamily,me=ie===void 0?"sans-serif":ie,ze=this.layer.getEncodedData(),Nt=[];ze.forEach(function(Jt){var wr=Jt.shape,Dr=wr===void 0?"":wr;Dr=Dr.toString();var bn=pu(Dr),mn;try{for(bn.s();!(mn=bn.n()).done;){var kn=mn.value;Nt.indexOf(kn)===-1&&Nt.push(kn)}}catch(_a){bn.e(_a)}finally{bn.f()}}),this.fontService.setFontOptions({characterSet:Nt,fontWeight:U,fontFamily:me})}},{key:"generateGlyphLayout",value:function(){var C=this,M=this.fontService.mapping,U=this.layer.getLayerConfig(),ie=U.spacing,me=ie===void 0?2:ie,ze=U.textAnchor,Nt=ze===void 0?"center":ze,Jt=U.textOffset,wr=this.layer.getEncodedData();this.glyphInfo=wr.map(function(Dr){var bn=Dr.shape,mn=bn===void 0?"":bn,kn=Dr.coordinates,_a=Dr.id,Ca=Dr.size,Di=Ca===void 0?1:Ca,ui=Yu(mn.toString(),M,Di,Nt,"center",me,Jt),li=ji(ui,Jt,!1);return Dr.shaping=ui,Dr.glyphQuads=li,Dr.centroid=Ge(kn),C.glyphInfoMap[_a]={shaping:ui,glyphQuads:li,centroid:Ge(kn)},Dr})}},{key:"filterGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.padding,ie=U===void 0?[4,4]:U,me=M.textAllowOverlap,ze=me===void 0?!1:me;if(ze)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Nt=this.rendererService.getViewportSize(),Jt=Nt.width,wr=Nt.height,Dr=new If(Jt,wr),bn=this.glyphInfo.filter(function(mn){var kn=mn.shaping,_a=mn.id,Ca=_a===void 0?0:_a,Di=mn.centroid,ui=mn.size,li=ui/24,qi=C.mapService.lngLatToContainer(Di),wa=Dr.placeCollisionBox({x1:kn.left*li-ie[0],x2:kn.right*li+ie[0],y1:kn.top*li-ie[1],y2:kn.bottom*li+ie[1],anchorPointX:qi.x,anchorPointY:qi.y}),eo=wa.box;return eo&&eo.length?(Dr.insertCollisionBox(eo,Ca),!0):!1});bn.forEach(function(mn){C.glyphInfoMap[mn.id]=mn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ti,fragmentShader:Ms,triangulation:Wa.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),_}(mt),xf={fill:Jl,image:tu,normal:il,extrude:Ci,text:ec,icon:Ql},rs=xf;function ll(d){var S=mu();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function mu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ku=function(d){D()(_,d);var S=ll(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PointLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new rs[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[C]}},{key:"getModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,me=this.iconService.getIconMap(),ze=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(ze){var Nt=ze.shape;return Nt==="dot"?"normal":(U==null?void 0:U.indexOf(Nt))!==-1?"fill":(ie==null?void 0:ie.indexOf(Nt))!==-1?"extrude":me.hasOwnProperty(Nt)?"image":this.fontService.getGlyph(Nt)!==""?"icon":"text"}else return"normal"}}]),_}(ae);function ro(d){var S=ns();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function ns(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var jl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,lo=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Mn=function(d){D()(_,d);var S=ro(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:lo,fragmentShader:jl,triangulation:ha})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,me,ze){return ze}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,me){var ze=M.size,Nt=ze===void 0?10:ze;return Array.isArray(Nt)?[Nt[0]]:[Nt]}}})}}]),_}(mt);function Us(d){var S=Tc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Tc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Tl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Mu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Bs=function(d){D()(_,d);var S=Us(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:Mu,fragmentShader:Tl,triangulation:Xi,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),_}(mt),ei={fill:Bs,line:ps,extrude:Mn,text:ec,point_fill:Jl,point_image:tu,point_normal:il,point_extrude:Ci},qr=ei;function Vc(d){var S=_c();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function _c(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var cl=function(d){D()(_,d);var S=Vc(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new qr[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U==="fill"?"fill":U==="extrude"?"extrude":U==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,me=this.iconService.getIconMap(),ze=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(ze){var Nt=ze.shape;return Nt==="dot"?"point_normal":(U==null?void 0:U.indexOf(Nt))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(Nt))!==-1?"point_extrude":me.hasOwnProperty(Nt)?"point_image":"text"}else return"fill"}}]),_}(ae);function vu(d){var S=Ps();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ls=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,$o=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,ko=function(d){D()(_,d);var S=vu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.clampLow,me=ie===void 0?!0:ie,ze=C.clampHigh,Nt=ze===void 0?!0:ze,Jt=C.noDataValue,wr=Jt===void 0?-9999999:Jt,Dr=C.domain,bn=Dr===void 0?[0,1]:Dr;return this.updateColorTexure(),{u_opacity:U||1,u_texture:this.texture,u_domain:bn,u_clampLow:me,u_clampHigh:typeof Nt!="undefined"?Nt:me,u_noDataValue:wr,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var C=this.layer.getSource(),M=this.rendererService.createTexture2D,U=C.data.dataArray[0];this.texture=M({data:U.data,width:U.width,height:U.height,format:T.gl.LUMINANCE,type:T.gl.FLOAT});var ie=this.layer.getLayerConfig(),me=ie.rampColors,ze=Object(Le.n)(me);return this.colorTexture=M({data:ze.data,width:ze.width,height:ze.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:$o,fragmentShader:Ls,triangulation:Ma,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,me){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var C=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Le.n)(U);this.colorTexture=C({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),_}(mt),fl={raster:ko,raster3d:ko},_l=fl;function zl(d){var S=uf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Fl=function(d){D()(_,d);var S=zl(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="RasterLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new _l[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={raster:{},raster3d:{}};return M[C]}},{key:"getModelType",value:function(){return"raster"}}]),_}(ae),Rs,as,Pa,$u,zi,Co,Sl,gu;function yu(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function Ss(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?yu(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):yu(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var Sc=(Rs=Object(ar.injectable)(),as=Object(ar.inject)(T.TYPES.IGlobalConfigService),Pa=Object(ar.inject)(T.TYPES.ILogService),Rs($u=(zi=(gu=function(){function d(){X()(this,d),ke()(this,"configService",Co,this),ke()(this,"logger",Sl,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("DataMappingPlugin",function(){C.generateMaping(_,{styleAttributeService:M})}),_.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return _.dataState.dataMappingNeedUpdate=!1,C.generateMaping(_,{styleAttributeService:M}),!0}),_.hooks.beforeRender.tap("DataMappingPlugin",function(){if(_.layerModelNeedUpdate)return;var U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),me=_.getSource().data.dataArray,ze=U.filter(function(Jt){return Jt.needRemapping}),Nt=me;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(Nt=me.filter(function(Jt){return C.applyAttributeMapping(ie,Jt)[0]})),ze.length&&((ie==null?void 0:ie.needRemapping)?(_.setEncodedData(C.mapping(U,Nt)),ie.needRemapping=!1):_.setEncodedData(C.mapping(ze,Nt,_.getEncodedData())),C.logger.debug("remapping finished"),_.emit("remapping",null))})}},{key:"generateMaping",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),me=_.getSource().data.dataArray,ze=me;(ie==null?void 0:ie.scale)&&(ze=me.filter(function(Nt){return C.applyAttributeMapping(ie,Nt)[0]})),_.setEncodedData(this.mapping(U,ze))}},{key:"mapping",value:function(_,x,C){var M=this;return x.map(function(U,ie){var me=C?C[ie]:{},ze=Ss({id:U._id,coordinates:U.coordinates},me);return _.filter(function(Nt){return Nt.scale!==void 0}).forEach(function(Nt){var Jt=M.applyAttributeMapping(Nt,U);Nt.needRemapping=!1,Nt.name==="color"&&(Jt=Jt.map(function(wr){return Object(Le.s)(wr)})),ze[Nt.name]=Array.isArray(Jt)&&Jt.length===1?Jt[0]:Jt}),ze})}},{key:"applyAttributeMapping",value:function(_,x){var C;if(!_.scale)return[];var M=(_==null||((C=_.scale)===null||C===void 0)?void 0:C.scalers)||[],U=[];return M.forEach(function(ie){var me,ze=ie.field;(x.hasOwnProperty(ze)||((me=_.scale)===null||me===void 0?void 0:me.type)==="variable")&&U.push(x[ze])}),_.mapping?_.mapping(U):[]}}]),d}(),gu),Co=Qe()(zi.prototype,"configService",[as],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sl=Qe()(zi.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zi))||$u),Yn=i("rlAn"),Nn,Ac,ms,jo=(Nn=Object(ar.injectable)(),Nn(Ac=(ms=function(){function d(){X()(this,d),this.mapService=void 0}return o()(d,[{key:"apply",value:function(_){var x=this;this.mapService=_.getContainer().get(T.TYPES.IMapService),_.hooks.init.tap("DataSourcePlugin",function(){var C=_.sourceOption,M=C.data,U=C.options;_.setSource(new Yn.default(M,U)),x.updateClusterData(_)}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var C=x.updateClusterData(_),M=_.dataState.dataSourceNeedUpdate;return _.dataState.dataSourceNeedUpdate=!1,C||M})}},{key:"updateClusterData",value:function(_){var x=_.getSource(),C=x.cluster,M=x.clusterOptions,U=M.zoom,ie=U===void 0?0:U,me=M.maxZoom,ze=me===void 0?16:me,Nt=this.mapService.getZoom()-1;return C&&Math.abs(ie-Nt)>1&&ze>ie?(x.updateClusterData(Math.floor(Nt)),!0):!1}}]),d}(),ms))||Ac),wo=i("7tbW"),ru=i.n(wo),Pu=i("4qC0"),tc=i.n(Pu),Za=i("J2iB"),Hi=i.n(Za),hl=function(d,S){return d<S?-1:d>S?1:d>=S?0:NaN},dl=function(d){return d.length===1&&(d=rc(d)),{left:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;d(_[U],x)<0?C=U+1:M=U}return C},right:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;d(_[U],x)>0?M=U:C=U+1}return C}}};function rc(d){return function(S,_){return hl(d(S),_)}}var Lu=dl(hl),Is=Lu.right,Ul=Lu.left,vs=Is,Ef=function(d,S){S==null&&(S=Bl);for(var _=0,x=d.length-1,C=d[0],M=new Array(x<0?0:x);_<x;)M[_]=S(C,C=d[++_]);return M};function Bl(d,S){return[d,S]}var Gc=function(d,S,_){var x=d.length,C=S.length,M=new Array(x*C),U,ie,me,ze;for(_==null&&(_=Bl),U=me=0;U<x;++U)for(ze=d[U],ie=0;ie<C;++ie,++me)M[me]=_(ze,S[ie]);return M},Tf=function(d,S){return S<d?-1:S>d?1:S>=d?0:NaN},Vs=function(d){return d===null?NaN:+d},Al=function(d,S){var _=d.length,x=0,C=-1,M=0,U,ie,me=0;if(S==null)for(;++C<_;)isNaN(U=Vs(d[C]))||(ie=U-M,M+=ie/++x,me+=ie*(U-M));else for(;++C<_;)isNaN(U=Vs(S(d[C],C,d)))||(ie=U-M,M+=ie/++x,me+=ie*(U-M));if(x>1)return me/(x-1)},Vl=function(d,S){var _=Al(d,S);return _&&Math.sqrt(_)},Ru=function(d,S){var _=d.length,x=-1,C,M,U;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=U=C;++x<_;)(C=d[x])!=null&&(M>C&&(M=C),U<C&&(U=C))}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=U=C;++x<_;)(C=S(d[x],x,d))!=null&&(M>C&&(M=C),U<C&&(U=C));return[M,U]},Iu=Array.prototype,Cl=Iu.slice,Ju=Iu.map,Ds=function(d){return function(){return d}},Cc=function(d){return d},nc=function(d,S,_){d=+d,S=+S,_=(C=arguments.length)<2?(S=d,d=0,1):C<3?1:+_;for(var x=-1,C=Math.max(0,Math.ceil((S-d)/_))|0,M=new Array(C);++x<C;)M[x]=d+x*_;return M},ac=Math.sqrt(50),ic=Math.sqrt(10),s=Math.sqrt(2),a=function(d,S,_){var x,C=-1,M,U,ie;if(S=+S,d=+d,_=+_,d===S&&_>0)return[d];if((x=S<d)&&(M=d,d=S,S=M),(ie=n(d,S,_))===0||!isFinite(ie))return[];if(ie>0)for(d=Math.ceil(d/ie),S=Math.floor(S/ie),U=new Array(M=Math.ceil(S-d+1));++C<M;)U[C]=(d+C)*ie;else for(d=Math.floor(d*ie),S=Math.ceil(S*ie),U=new Array(M=Math.ceil(d-S+1));++C<M;)U[C]=(d-C)/ie;return x&&U.reverse(),U};function n(d,S,_){var x=(S-d)/Math.max(0,_),C=Math.floor(Math.log(x)/Math.LN10),M=x/Math.pow(10,C);return C>=0?(M>=ac?10:M>=ic?5:M>=s?2:1)*Math.pow(10,C):-Math.pow(10,-C)/(M>=ac?10:M>=ic?5:M>=s?2:1)}function l(d,S,_){var x=Math.abs(S-d)/Math.max(0,_),C=Math.pow(10,Math.floor(Math.log(x)/Math.LN10)),M=x/C;return M>=ac?C*=10:M>=ic?C*=5:M>=s&&(C*=2),S<d?-C:C}var b=function(d){return Math.ceil(Math.log(d.length)/Math.LN2)+1},O=function(){var d=Cc,S=Ru,_=b;function x(C){var M,U=C.length,ie,me=new Array(U);for(M=0;M<U;++M)me[M]=d(C[M],M,C);var ze=S(me),Nt=ze[0],Jt=ze[1],wr=_(me,Nt,Jt);Array.isArray(wr)||(wr=l(Nt,Jt,wr),wr=nc(Math.ceil(Nt/wr)*wr,Jt,wr));for(var Dr=wr.length;wr[0]<=Nt;)wr.shift(),--Dr;for(;wr[Dr-1]>Jt;)wr.pop(),--Dr;var bn=new Array(Dr+1),mn;for(M=0;M<=Dr;++M)mn=bn[M]=[],mn.x0=M>0?wr[M-1]:Nt,mn.x1=M<Dr?wr[M]:Jt;for(M=0;M<U;++M)ie=me[M],Nt<=ie&&ie<=Jt&&bn[vs(wr,ie,0,Dr)].push(C[M]);return bn}return x.value=function(C){return arguments.length?(d=typeof C=="function"?C:Ds(C),x):d},x.domain=function(C){return arguments.length?(S=typeof C=="function"?C:Ds([C[0],C[1]]),x):S},x.thresholds=function(C){return arguments.length?(_=typeof C=="function"?C:Array.isArray(C)?Ds(Cl.call(C)):Ds(C),x):_},x},R=function(d,S,_){if(_==null&&(_=Vs),!(x=d.length))return;if((S=+S)<=0||x<2)return+_(d[0],0,d);if(S>=1)return+_(d[x-1],x-1,d);var x,C=(x-1)*S,M=Math.floor(C),U=+_(d[M],M,d),ie=+_(d[M+1],M+1,d);return U+(ie-U)*(C-M)},j=function(d,S,_){return d=Ju.call(d,Vs).sort(hl),Math.ceil((_-S)/(2*(R(d,.75)-R(d,.25))*Math.pow(d.length,-1/3)))},ue=function(d,S,_){return Math.ceil((_-S)/(3.5*Vl(d)*Math.pow(d.length,-1/3)))},Te=function(d,S){var _=d.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=C;++x<_;)(C=d[x])!=null&&C>M&&(M=C)}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=C;++x<_;)(C=S(d[x],x,d))!=null&&C>M&&(M=C);return M},Xe=function(d,S){var _=d.length,x=_,C=-1,M,U=0;if(S==null)for(;++C<_;)isNaN(M=Vs(d[C]))?--x:U+=M;else for(;++C<_;)isNaN(M=Vs(S(d[C],C,d)))?--x:U+=M;if(x)return U/x},Je=function(d,S){var _=d.length,x=-1,C,M=[];if(S==null)for(;++x<_;)isNaN(C=Vs(d[x]))||M.push(C);else for(;++x<_;)isNaN(C=Vs(S(d[x],x,d)))||M.push(C);return R(M.sort(hl),.5)},tt=function(d){for(var S=d.length,_,x=-1,C=0,M,U;++x<S;)C+=d[x].length;for(M=new Array(C);--S>=0;)for(U=d[S],_=U.length;--_>=0;)M[--C]=U[_];return M},Dt=function(d,S){var _=d.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=C;++x<_;)(C=d[x])!=null&&M>C&&(M=C)}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=C;++x<_;)(C=S(d[x],x,d))!=null&&M>C&&(M=C);return M},Lt=function(d,S){for(var _=S.length,x=new Array(_);_--;)x[_]=d[S[_]];return x},Zt=function(d,S){if(!(_=d.length))return;var _,x=0,C=0,M,U=d[C];for(S==null&&(S=hl);++x<_;)(S(M=d[x],U)<0||S(U,U)!==0)&&(U=M,C=x);if(S(U,U)===0)return C},Rt=function(d,S,_){for(var x=(_==null?d.length:_)-(S=S==null?0:+S),C,M;x;)M=Math.random()*x--|0,C=d[x+S],d[x+S]=d[M+S],d[M+S]=C;return d},Bt=function(d,S){var _=d.length,x=-1,C,M=0;if(S==null)for(;++x<_;)(C=+d[x])&&(M+=C);else for(;++x<_;)(C=+S(d[x],x,d))&&(M+=C);return M},qt=function(d){if(!(M=d.length))return[];for(var S=-1,_=Dt(d,Qt),x=new Array(_);++S<_;)for(var C=-1,M,U=x[S]=new Array(M);++C<M;)U[C]=d[C][S];return x};function Qt(d){return d.length}var Pr=function(){return qt(arguments)};function fr(d,S){switch(arguments.length){case 0:break;case 1:this.range(d);break;default:this.range(S).domain(d);break}return this}function Tr(d,S){switch(arguments.length){case 0:break;case 1:this.interpolator(d);break;default:this.interpolator(S).domain(d);break}return this}var Ar="$";function nn(){}nn.prototype=Xr.prototype={constructor:nn,has:function(S){return Ar+S in this},get:function(S){return this[Ar+S]},set:function(S,_){return this[Ar+S]=_,this},remove:function(S){var _=Ar+S;return _ in this&&delete this[_]},clear:function(){for(var S in this)S[0]===Ar&&delete this[S]},keys:function(){var S=[];for(var _ in this)_[0]===Ar&&S.push(_.slice(1));return S},values:function(){var S=[];for(var _ in this)_[0]===Ar&&S.push(this[_]);return S},entries:function(){var S=[];for(var _ in this)_[0]===Ar&&S.push({key:_.slice(1),value:this[_]});return S},size:function(){var S=0;for(var _ in this)_[0]===Ar&&++S;return S},empty:function(){for(var S in this)if(S[0]===Ar)return!1;return!0},each:function(S){for(var _ in this)_[0]===Ar&&S(this[_],_.slice(1),this)}};function Xr(d,S){var _=new nn;if(d instanceof nn)d.each(function(ie,me){_.set(me,ie)});else if(Array.isArray(d)){var x=-1,C=d.length,M;if(S==null)for(;++x<C;)_.set(x,d[x]);else for(;++x<C;)_.set(S(M=d[x],x,d),M)}else if(d)for(var U in d)_.set(U,d[U]);return _}var gn=Xr,Pn=function(){var d=[],S=[],_,x,C;function M(ie,me,ze,Nt){if(me>=d.length)return _!=null&&ie.sort(_),x!=null?x(ie):ie;for(var Jt=-1,wr=ie.length,Dr=d[me++],bn,mn,kn=gn(),_a,Ca=ze();++Jt<wr;)(_a=kn.get(bn=Dr(mn=ie[Jt])+""))?_a.push(mn):kn.set(bn,[mn]);return kn.each(function(Di,ui){Nt(Ca,ui,M(Di,me,ze,Nt))}),Ca}function U(ie,me){if(++me>d.length)return ie;var ze,Nt=S[me-1];return x!=null&&me>=d.length?ze=ie.entries():(ze=[],ie.each(function(Jt,wr){ze.push({key:wr,values:U(Jt,me)})})),Nt!=null?ze.sort(function(Jt,wr){return Nt(Jt.key,wr.key)}):ze}return C={object:function(me){return M(me,0,Jn,aa)},map:function(me){return M(me,0,ba,Xa)},entries:function(me){return U(M(me,0,ba,Xa),0)},key:function(me){return d.push(me),C},sortKeys:function(me){return S[d.length-1]=me,C},sortValues:function(me){return _=me,C},rollup:function(me){return x=me,C}}};function Jn(){return{}}function aa(d,S,_){d[S]=_}function ba(){return gn()}function Xa(d,S,_){d.set(S,_)}function _n(){}var ia=gn.prototype;_n.prototype=xa.prototype={constructor:_n,has:ia.has,add:function(S){return S+="",this[Ar+S]=S,this},remove:ia.remove,clear:ia.clear,values:ia.keys,size:ia.size,empty:ia.empty,each:ia.each};function xa(d,S){var _=new _n;if(d instanceof _n)d.each(function(M){_.add(M)});else if(d){var x=-1,C=d.length;if(S==null)for(;++x<C;)_.add(d[x]);else for(;++x<C;)_.add(S(d[x],x,d))}return _}var Wn=xa,Aa=function(d){var S=[];for(var _ in d)S.push(_);return S},ta=function(d){var S=[];for(var _ in d)S.push(d[_]);return S},La=function(d){var S=[];for(var _ in d)S.push({key:_,value:d[_]});return S},ja=Array.prototype,Ji=ja.map,wi=ja.slice,vo={name:"implicit"};function _i(){var d=gn(),S=[],_=[],x=vo;function C(M){var U=M+"",ie=d.get(U);if(!ie){if(x!==vo)return x;d.set(U,ie=S.push(M))}return _[(ie-1)%_.length]}return C.domain=function(M){if(!arguments.length)return S.slice();S=[],d=gn();for(var U=-1,ie=M.length,me,ze;++U<ie;)d.has(ze=(me=M[U])+"")||d.set(ze,S.push(me));return C},C.range=function(M){return arguments.length?(_=wi.call(M),C):_.slice()},C.unknown=function(M){return arguments.length?(x=M,C):x},C.copy=function(){return _i(S,_).unknown(x)},fr.apply(C,arguments),C}function Wi(){var d=_i().unknown(void 0),S=d.domain,_=d.range,x=[0,1],C,M,U=!1,ie=0,me=0,ze=.5;delete d.unknown;function Nt(){var Jt=S().length,wr=x[1]<x[0],Dr=x[wr-0],bn=x[1-wr];C=(bn-Dr)/Math.max(1,Jt-ie+me*2),U&&(C=Math.floor(C)),Dr+=(bn-Dr-C*(Jt-ie))*ze,M=C*(1-ie),U&&(Dr=Math.round(Dr),M=Math.round(M));var mn=nc(Jt).map(function(kn){return Dr+C*kn});return _(wr?mn.reverse():mn)}return d.domain=function(Jt){return arguments.length?(S(Jt),Nt()):S()},d.range=function(Jt){return arguments.length?(x=[+Jt[0],+Jt[1]],Nt()):x.slice()},d.rangeRound=function(Jt){return x=[+Jt[0],+Jt[1]],U=!0,Nt()},d.bandwidth=function(){return M},d.step=function(){return C},d.round=function(Jt){return arguments.length?(U=!!Jt,Nt()):U},d.padding=function(Jt){return arguments.length?(ie=Math.min(1,me=+Jt),Nt()):ie},d.paddingInner=function(Jt){return arguments.length?(ie=Math.min(1,Jt),Nt()):ie},d.paddingOuter=function(Jt){return arguments.length?(me=+Jt,Nt()):me},d.align=function(Jt){return arguments.length?(ze=Math.max(0,Math.min(1,Jt)),Nt()):ze},d.copy=function(){return Wi(S(),x).round(U).paddingInner(ie).paddingOuter(me).align(ze)},fr.apply(Nt(),arguments)}function Ns(d){var S=d.copy;return d.padding=d.paddingOuter,delete d.paddingInner,delete d.paddingOuter,d.copy=function(){return Ns(S())},d}function go(){return Ns(Wi.apply(null,arguments).paddingInner(1))}var bu=i("FmoU");function xu(d,S,_,x,C){var M=d*d,U=M*d;return((1-3*d+3*M-U)*S+(4-6*M+3*U)*_+(1+3*d+3*M-3*U)*x+U*C)/6}var zo=function(d){var S=d.length-1;return function(_){var x=_<=0?_=0:_>=1?(_=1,S-1):Math.floor(_*S),C=d[x],M=d[x+1],U=x>0?d[x-1]:2*C-M,ie=x<S-1?d[x+2]:2*M-C;return xu((_-x/S)*S,U,C,M,ie)}},As=function(d){var S=d.length;return function(_){var x=Math.floor(((_%=1)<0?++_:_)*S),C=d[(x+S-1)%S],M=d[x%S],U=d[(x+1)%S],ie=d[(x+2)%S];return xu((_-x/S)*S,C,M,U,ie)}},Du=function(d){return function(){return d}};function oc(d,S){return function(_){return d+_*S}}function Qu(d,S,_){return d=Math.pow(d,_),S=Math.pow(S,_)-d,_=1/_,function(x){return Math.pow(d+x*S,_)}}function sc(d,S){var _=S-d;return _?oc(d,_>180||_<-180?_-360*Math.round(_/360):_):Du(isNaN(d)?S:d)}function uc(d){return(d=+d)===1?Nu:function(S,_){return _-S?Qu(S,_,d):Du(isNaN(S)?_:S)}}function Nu(d,S){var _=S-d;return _?oc(d,_):Du(isNaN(d)?S:d)}var pl=function d(S){var _=uc(S);function x(C,M){var U=_((C=Object(bu.b)(C)).r,(M=Object(bu.b)(M)).r),ie=_(C.g,M.g),me=_(C.b,M.b),ze=Nu(C.opacity,M.opacity);return function(Nt){return C.r=U(Nt),C.g=ie(Nt),C.b=me(Nt),C.opacity=ze(Nt),C+""}}return x.gamma=d,x}(1);function Cs(d){return function(S){var _=S.length,x=new Array(_),C=new Array(_),M=new Array(_),U,ie;for(U=0;U<_;++U)ie=Object(bu.b)(S[U]),x[U]=ie.r||0,C[U]=ie.g||0,M[U]=ie.b||0;return x=d(x),C=d(C),M=d(M),ie.opacity=1,function(me){return ie.r=x(me),ie.g=C(me),ie.b=M(me),ie+""}}}var co=Cs(zo),ku=Cs(As),Eu=function(d,S){S||(S=[]);var _=d?Math.min(S.length,d.length):0,x=S.slice(),C;return function(M){for(C=0;C<_;++C)x[C]=d[C]*(1-M)+S[C]*M;return x}};function Oo(d){return ArrayBuffer.isView(d)&&!(d instanceof DataView)}var Mo=function(d,S){return(Oo(S)?Eu:Po)(d,S)};function Po(d,S){var _=S?S.length:0,x=d?Math.min(_,d.length):0,C=new Array(x),M=new Array(_),U;for(U=0;U<x;++U)C[U]=ju(d[U],S[U]);for(;U<_;++U)M[U]=S[U];return function(ie){for(U=0;U<x;++U)M[U]=C[U](ie);return M}}var Jo=function(d,S){var _=new Date;return d=+d,S=+S,function(x){return _.setTime(d*(1-x)+S*x),_}},yo=function(d,S){return d=+d,S=+S,function(_){return d*(1-_)+S*_}},Fo=function(d,S){var _={},x={},C;(d===null||typeof d!="object")&&(d={}),(S===null||typeof S!="object")&&(S={});for(C in S)C in d?_[C]=ju(d[C],S[C]):x[C]=S[C];return function(M){for(C in _)x[C]=_[C](M);return x}},Gs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wl=new RegExp(Gs.source,"g");function Hc(d){return function(){return d}}function Gl(d){return function(S){return d(S)+""}}var qu=function(d,S){var _=Gs.lastIndex=wl.lastIndex=0,x,C,M,U=-1,ie=[],me=[];for(d=d+"",S=S+"";(x=Gs.exec(d))&&(C=wl.exec(S));)(M=C.index)>_&&(M=S.slice(_,M),ie[U]?ie[U]+=M:ie[++U]=M),(x=x[0])===(C=C[0])?ie[U]?ie[U]+=C:ie[++U]=C:(ie[++U]=null,me.push({i:U,x:yo(x,C)})),_=wl.lastIndex;return _<S.length&&(M=S.slice(_),ie[U]?ie[U]+=M:ie[++U]=M),ie.length<2?me[0]?Gl(me[0].x):Hc(S):(S=me.length,function(ze){for(var Nt=0,Jt;Nt<S;++Nt)ie[(Jt=me[Nt]).i]=Jt.x(ze);return ie.join("")})},ju=function(d,S){var _=typeof S,x;return S==null||_==="boolean"?Du(S):(_==="number"?yo:_==="string"?(x=Object(bu.a)(S))?(S=x,pl):qu:S instanceof bu.a?pl:S instanceof Date?Jo:Oo(S)?Eu:Array.isArray(S)?Po:typeof S.valueOf!="function"&&typeof S.toString!="function"||isNaN(S)?Fo:yo)(d,S)},zu=function(d,S){return d=+d,S=+S,function(_){return Math.round(d*(1-_)+S*_)}},Hs=function(d){return function(){return d}},Lo=function(d){return+d},Wc=[0,1];function gs(d){return d}function lf(d,S){return(S-=d=+d)?function(_){return(_-d)/S}:Hs(isNaN(S)?NaN:.5)}function Df(d){var S=d[0],_=d[d.length-1],x;return S>_&&(x=S,S=_,_=x),function(C){return Math.max(S,Math.min(_,C))}}function Nf(d,S,_){var x=d[0],C=d[1],M=S[0],U=S[1];return C<x?(x=lf(C,x),M=_(U,M)):(x=lf(x,C),M=_(M,U)),function(ie){return M(x(ie))}}function Bf(d,S,_){var x=Math.min(d.length,S.length)-1,C=new Array(x),M=new Array(x),U=-1;for(d[x]<d[0]&&(d=d.slice().reverse(),S=S.slice().reverse());++U<x;)C[U]=lf(d[U],d[U+1]),M[U]=_(S[U],S[U+1]);return function(ie){var me=vs(d,ie,1,x)-1;return M[me](C[me](ie))}}function el(d,S){return S.domain(d.domain()).range(d.range()).interpolate(d.interpolate()).clamp(d.clamp()).unknown(d.unknown())}function _f(){var d=Wc,S=Wc,_=ju,x,C,M,U=gs,ie,me,ze;function Nt(){return ie=Math.min(d.length,S.length)>2?Bf:Nf,me=ze=null,Jt}function Jt(wr){return isNaN(wr=+wr)?M:(me||(me=ie(d.map(x),S,_)))(x(U(wr)))}return Jt.invert=function(wr){return U(C((ze||(ze=ie(S,d.map(x),yo)))(wr)))},Jt.domain=function(wr){return arguments.length?(d=Ji.call(wr,Lo),U===gs||(U=Df(d)),Nt()):d.slice()},Jt.range=function(wr){return arguments.length?(S=wi.call(wr),Nt()):S.slice()},Jt.rangeRound=function(wr){return S=wi.call(wr),_=zu,Nt()},Jt.clamp=function(wr){return arguments.length?(U=wr?Df(d):gs,Jt):U!==gs},Jt.interpolate=function(wr){return arguments.length?(_=wr,Nt()):_},Jt.unknown=function(wr){return arguments.length?(M=wr,Jt):M},function(wr,Dr){return x=wr,C=Dr,Nt()}}function cf(d,S){return _f()(d,S)}var lc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fu(d){if(!(S=lc.exec(d)))throw new Error("invalid format: "+d);var S;return new cc({fill:S[1],align:S[2],sign:S[3],symbol:S[4],zero:S[5],width:S[6],comma:S[7],precision:S[8]&&S[8].slice(1),trim:S[9],type:S[10]})}Fu.prototype=cc.prototype;function cc(d){this.fill=d.fill===void 0?" ":d.fill+"",this.align=d.align===void 0?">":d.align+"",this.sign=d.sign===void 0?"-":d.sign+"",this.symbol=d.symbol===void 0?"":d.symbol+"",this.zero=!!d.zero,this.width=d.width===void 0?void 0:+d.width,this.comma=!!d.comma,this.precision=d.precision===void 0?void 0:+d.precision,this.trim=!!d.trim,this.type=d.type===void 0?"":d.type+""}cc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Vf=function(d){return Math.abs(d=Math.round(d))>=1e21?d.toLocaleString("en").replace(/,/g,""):d.toString(10)};function wc(d,S){if((_=(d=S?d.toExponential(S-1):d.toExponential()).indexOf("e"))<0)return null;var _,x=d.slice(0,_);return[x.length>1?x[0]+x.slice(2):x,+d.slice(_+1)]}var Oc=function(d){return d=wc(Math.abs(d)),d?d[1]:NaN},Gf=function(d,S){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Oc(S)/3)))*3-Oc(Math.abs(d)))},Hf=function(d,S){return function(_,x){for(var C=_.length,M=[],U=0,ie=d[0],me=0;C>0&&ie>0&&!(me+ie+1>x&&(ie=Math.max(1,x-me)),M.push(_.substring(C-=ie,C+ie)),(me+=ie+1)>x);)ie=d[U=(U+1)%d.length];return M.reverse().join(S)}},ih=function(d){return function(S){return S.replace(/[0-9]/g,function(_){return d[+_]})}},Wf=function(d){e:for(var S=d.length,_=1,x=-1,C;_<S;++_)switch(d[_]){case".":x=C=_;break;case"0":x===0&&(x=_),C=_;break;default:if(!+d[_])break e;x>0&&(x=0);break}return x>0?d.slice(0,x)+d.slice(C+1):d},kf,fh=function(d,S){var _=wc(d,S);if(!_)return d+"";var x=_[0],C=_[1],M=C-(kf=Math.max(-8,Math.min(8,Math.floor(C/3)))*3)+1,U=x.length;return M===U?x:M>U?x+new Array(M-U+1).join("0"):M>0?x.slice(0,M)+"."+x.slice(M):"0."+new Array(1-M).join("0")+wc(d,Math.max(0,S+M-1))[0]},fc=function(d,S){var _=wc(d,S);if(!_)return d+"";var x=_[0],C=_[1];return C<0?"0."+new Array(-C).join("0")+x:x.length>C+1?x.slice(0,C+1)+"."+x.slice(C+1):x+new Array(C-x.length+2).join("0")},ff={"%":function(S,_){return(S*100).toFixed(_)},b:function(S){return Math.round(S).toString(2)},c:function(S){return S+""},d:Vf,e:function(S,_){return S.toExponential(_)},f:function(S,_){return S.toFixed(_)},g:function(S,_){return S.toPrecision(_)},o:function(S){return Math.round(S).toString(8)},p:function(S,_){return fc(S*100,_)},r:fc,s:fh,X:function(S){return Math.round(S).toString(16).toUpperCase()},x:function(S){return Math.round(S).toString(16)}},no=function(d){return d},Hl=Array.prototype.map,hf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Zc=function(d){var S=d.grouping===void 0||d.thousands===void 0?no:Hf(Hl.call(d.grouping,Number),d.thousands+""),_=d.currency===void 0?"":d.currency[0]+"",x=d.currency===void 0?"":d.currency[1]+"",C=d.decimal===void 0?".":d.decimal+"",M=d.numerals===void 0?no:ih(Hl.call(d.numerals,String)),U=d.percent===void 0?"%":d.percent+"",ie=d.minus===void 0?"-":d.minus+"",me=d.nan===void 0?"NaN":d.nan+"";function ze(Jt){Jt=Fu(Jt);var wr=Jt.fill,Dr=Jt.align,bn=Jt.sign,mn=Jt.symbol,kn=Jt.zero,_a=Jt.width,Ca=Jt.comma,Di=Jt.precision,ui=Jt.trim,li=Jt.type;li==="n"?(Ca=!0,li="g"):ff[li]||(Di===void 0&&(Di=12),ui=!0,li="g"),(kn||wr==="0"&&Dr==="=")&&(kn=!0,wr="0",Dr="=");var qi=mn==="$"?_:mn==="#"&&/[boxX]/.test(li)?"0"+li.toLowerCase():"",wa=mn==="$"?x:/[%p]/.test(li)?U:"",eo=ff[li],To=/[defgprs%]/.test(li);Di=Di===void 0?6:/[gprs]/.test(li)?Math.max(1,Math.min(21,Di)):Math.max(0,Math.min(20,Di));function Xs(Ya){var ws=qi,qo=wa,gf,kh,Lc;if(li==="c")qo=eo(Ya)+qo,Ya="";else{Ya=+Ya;var Th=Ya<0||1/Ya<0;if(Ya=isNaN(Ya)?me:eo(Math.abs(Ya),Di),ui&&(Ya=Wf(Ya)),Th&&+Ya===0&&bn!=="+"&&(Th=!1),ws=(Th?bn==="("?bn:ie:bn==="-"||bn==="("?"":bn)+ws,qo=(li==="s"?hf[8+kf/3]:"")+qo+(Th&&bn==="("?")":""),To){for(gf=-1,kh=Ya.length;++gf<kh;)if(Lc=Ya.charCodeAt(gf),48>Lc||Lc>57){qo=(Lc===46?C+Ya.slice(gf+1):Ya.slice(gf))+qo,Ya=Ya.slice(0,gf);break}}}Ca&&!kn&&(Ya=S(Ya,Infinity));var lh=ws.length+Ya.length+qo.length,qc=lh<_a?new Array(_a-lh+1).join(wr):"";Ca&&kn&&(Ya=S(qc+Ya,qc.length?_a-qo.length:Infinity),qc="");switch(Dr){case"<":Ya=ws+Ya+qo+qc;break;case"=":Ya=ws+qc+Ya+qo;break;case"^":Ya=qc.slice(0,lh=qc.length>>1)+ws+Ya+qo+qc.slice(lh);break;default:Ya=qc+ws+Ya+qo;break}return M(Ya)}return Xs.toString=function(){return Jt+""},Xs}function Nt(Jt,wr){var Dr=ze((Jt=Fu(Jt),Jt.type="f",Jt)),bn=Math.max(-8,Math.min(8,Math.floor(Oc(wr)/3)))*3,mn=Math.pow(10,-bn),kn=hf[8+bn/3];return function(_a){return Dr(mn*_a)+kn}}return{format:ze,formatPrefix:Nt}},nu,Ol,Sf;Af({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Af(d){return nu=Zc(d),Ol=nu.format,Sf=nu.formatPrefix,nu}var Xc=function(d,S){return d=Math.abs(d),S=Math.abs(S)-d,Math.max(0,Oc(S)-Oc(d))+1},df=function(d){return Math.max(0,-Oc(Math.abs(d)))},Yc=function(d,S,_,x){var C=l(d,S,_),M;x=Fu(x==null?",f":x);switch(x.type){case"s":{var U=Math.max(Math.abs(d),Math.abs(S));return x.precision==null&&!isNaN(M=Gf(C,U))&&(x.precision=M),Sf(x,U)}case"":case"e":case"g":case"p":case"r":{x.precision==null&&!isNaN(M=Xc(C,Math.max(Math.abs(d),Math.abs(S))))&&(x.precision=M-(x.type==="e"));break}case"f":case"%":{x.precision==null&&!isNaN(M=df(C))&&(x.precision=M-(x.type==="%")*2);break}}return Ol(x)};function Wl(d){var S=d.domain;return d.ticks=function(_){var x=S();return a(x[0],x[x.length-1],_==null?10:_)},d.tickFormat=function(_,x){var C=S();return Yc(C[0],C[C.length-1],_==null?10:_,x)},d.nice=function(_){_==null&&(_=10);var x=S(),C=0,M=x.length-1,U=x[C],ie=x[M],me;return ie<U&&(me=U,U=ie,ie=me,me=C,C=M,M=me),me=n(U,ie,_),me>0?(U=Math.floor(U/me)*me,ie=Math.ceil(ie/me)*me,me=n(U,ie,_)):me<0&&(U=Math.ceil(U*me)/me,ie=Math.floor(ie*me)/me,me=n(U,ie,_)),me>0?(x[C]=Math.floor(U/me)*me,x[M]=Math.ceil(ie/me)*me,S(x)):me<0&&(x[C]=Math.ceil(U*me)/me,x[M]=Math.floor(ie*me)/me,S(x)),d},d}function ne(){var d=cf(gs,gs);return d.copy=function(){return el(d,ne())},fr.apply(d,arguments),Wl(d)}function se(d){var S;function _(x){return isNaN(x=+x)?S:x}return _.invert=_,_.domain=_.range=function(x){return arguments.length?(d=Ji.call(x,Lo),_):d.slice()},_.unknown=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return se(d).unknown(S)},d=arguments.length?Ji.call(d,Lo):[0,1],Wl(_)}var k=function(d,S){d=d.slice();var _=0,x=d.length-1,C=d[_],M=d[x],U;return M<C&&(U=_,_=x,x=U,U=C,C=M,M=U),d[_]=S.floor(C),d[x]=S.ceil(M),d};function G(d){return Math.log(d)}function Ae(d){return Math.exp(d)}function ot(d){return-Math.log(-d)}function Xt(d){return-Math.exp(-d)}function nr(d){return isFinite(d)?+("1e"+d):d<0?0:d}function rr(d){return d===10?nr:d===Math.E?Math.exp:function(S){return Math.pow(d,S)}}function Rr(d){return d===Math.E?Math.log:d===10&&Math.log10||d===2&&Math.log2||(d=Math.log(d),function(S){return Math.log(S)/d})}function on(d){return function(S){return-d(-S)}}function Un(d){var S=d(G,Ae),_=S.domain,x=10,C,M;function U(){return C=Rr(x),M=rr(x),_()[0]<0?(C=on(C),M=on(M),d(ot,Xt)):d(G,Ae),S}return S.base=function(ie){return arguments.length?(x=+ie,U()):x},S.domain=function(ie){return arguments.length?(_(ie),U()):_()},S.ticks=function(ie){var me=_(),ze=me[0],Nt=me[me.length-1],Jt;(Jt=Nt<ze)&&(wr=ze,ze=Nt,Nt=wr);var wr=C(ze),Dr=C(Nt),bn,mn,kn,_a=ie==null?10:+ie,Ca=[];if(!(x%1)&&Dr-wr<_a)if(wr=Math.round(wr)-1,Dr=Math.round(Dr)+1,ze>0)for(;wr<Dr;++wr)for(mn=1,bn=M(wr);mn<x;++mn){if(kn=bn*mn,kn<ze)continue;if(kn>Nt)break;Ca.push(kn)}else for(;wr<Dr;++wr)for(mn=x-1,bn=M(wr);mn>=1;--mn){if(kn=bn*mn,kn<ze)continue;if(kn>Nt)break;Ca.push(kn)}else Ca=a(wr,Dr,Math.min(Dr-wr,_a)).map(M);return Jt?Ca.reverse():Ca},S.tickFormat=function(ie,me){if(me==null&&(me=x===10?".0e":","),typeof me!="function"&&(me=Ol(me)),ie===Infinity)return me;ie==null&&(ie=10);var ze=Math.max(1,x*ie/S.ticks().length);return function(Nt){var Jt=Nt/M(Math.round(C(Nt)));return Jt*x<x-.5&&(Jt*=x),Jt<=ze?me(Nt):""}},S.nice=function(){return _(k(_(),{floor:function(me){return M(Math.floor(C(me)))},ceil:function(me){return M(Math.ceil(C(me)))}}))},S}function Kn(){var d=Un(_f()).domain([1,10]);return d.copy=function(){return el(d,Kn()).base(d.base())},fr.apply(d,arguments),d}function oa(d){return function(S){return Math.sign(S)*Math.log1p(Math.abs(S/d))}}function ti(d){return function(S){return Math.sign(S)*Math.expm1(Math.abs(S))*d}}function za(d){var S=1,_=d(oa(S),ti(S));return _.constant=function(x){return arguments.length?d(oa(S=+x),ti(S)):S},Wl(_)}function Oi(){var d=za(_f());return d.copy=function(){return el(d,Oi()).constant(d.constant())},fr.apply(d,arguments)}function ni(d){return function(S){return S<0?-Math.pow(-S,d):Math.pow(S,d)}}function Fi(d){return d<0?-Math.sqrt(-d):Math.sqrt(d)}function Ro(d){return d<0?-d*d:d*d}function bo(d){var S=d(gs,gs),_=1;function x(){return _===1?d(gs,gs):_===.5?d(Fi,Ro):d(ni(_),ni(1/_))}return S.exponent=function(C){return arguments.length?(_=+C,x()):_},Wl(S)}function Zi(){var d=bo(_f());return d.copy=function(){return el(d,Zi()).exponent(d.exponent())},fr.apply(d,arguments),d}function Uo(){return Zi.apply(null,arguments).exponent(.5)}function ri(){var d=[],S=[],_=[],x;function C(){var U=0,ie=Math.max(1,S.length);for(_=new Array(ie-1);++U<ie;)_[U-1]=R(d,U/ie);return M}function M(U){return isNaN(U=+U)?x:S[vs(_,U)]}return M.invertExtent=function(U){var ie=S.indexOf(U);return ie<0?[NaN,NaN]:[ie>0?_[ie-1]:d[0],ie<_.length?_[ie]:d[d.length-1]]},M.domain=function(U){if(!arguments.length)return d.slice();d=[];for(var ie=0,me=U.length,ze;ie<me;++ie)(ze=U[ie],ze!=null&&!isNaN(ze=+ze))&&d.push(ze);return d.sort(hl),C()},M.range=function(U){return arguments.length?(S=wi.call(U),C()):S.slice()},M.unknown=function(U){return arguments.length?(x=U,M):x},M.quantiles=function(){return _.slice()},M.copy=function(){return ri().domain(d).range(S).unknown(x)},fr.apply(M,arguments)}function fo(){var d=0,S=1,_=1,x=[.5],C=[0,1],M;function U(me){return me<=me?C[vs(x,me,0,_)]:M}function ie(){var me=-1;for(x=new Array(_);++me<_;)x[me]=((me+1)*S-(me-_)*d)/(_+1);return U}return U.domain=function(me){return arguments.length?(d=+me[0],S=+me[1],ie()):[d,S]},U.range=function(me){return arguments.length?(_=(C=wi.call(me)).length-1,ie()):C.slice()},U.invertExtent=function(me){var ze=C.indexOf(me);return ze<0?[NaN,NaN]:ze<1?[d,x[0]]:ze>=_?[x[_-1],S]:[x[ze-1],x[ze]]},U.unknown=function(me){return arguments.length&&(M=me),U},U.thresholds=function(){return x.slice()},U.copy=function(){return fo().domain([d,S]).range(C).unknown(M)},fr.apply(Wl(U),arguments)}function au(){var d=[.5],S=[0,1],_,x=1;function C(M){return M<=M?S[vs(d,M,0,x)]:_}return C.domain=function(M){return arguments.length?(d=wi.call(M),x=Math.min(d.length,S.length-1),C):d.slice()},C.range=function(M){return arguments.length?(S=wi.call(M),x=Math.min(d.length,S.length-1),C):S.slice()},C.invertExtent=function(M){var U=S.indexOf(M);return[d[U-1],d[U]]},C.unknown=function(M){return arguments.length?(_=M,C):_},C.copy=function(){return au().domain(d).range(S).unknown(_)},fr.apply(C,arguments)}var Si=new Date,Ui=new Date;function Ea(d,S,_,x){function C(M){return d(M=arguments.length===0?new Date:new Date(+M)),M}return C.floor=function(M){return d(M=new Date(+M)),M},C.ceil=function(M){return d(M=new Date(M-1)),S(M,1),d(M),M},C.round=function(M){var U=C(M),ie=C.ceil(M);return M-U<ie-M?U:ie},C.offset=function(M,U){return S(M=new Date(+M),U==null?1:Math.floor(U)),M},C.range=function(M,U,ie){var me=[],ze;if(M=C.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<U)||!(ie>0))return me;do me.push(ze=new Date(+M)),S(M,ie),d(M);while(ze<M&&M<U);return me},C.filter=function(M){return Ea(function(U){if(U>=U)for(;d(U),!M(U);)U.setTime(U-1)},function(U,ie){if(U>=U)if(ie<0)for(;++ie<=0;)for(;S(U,-1),!M(U););else for(;--ie>=0;)for(;S(U,1),!M(U););})},_&&(C.count=function(M,U){return Si.setTime(+M),Ui.setTime(+U),d(Si),d(Ui),Math.floor(_(Si,Ui))},C.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?C.filter(x?function(U){return x(U)%M===0}:function(U){return C.count(0,U)%M===0}):C}),C}var Io=Ea(function(d){d.setMonth(0,1),d.setHours(0,0,0,0)},function(d,S){d.setFullYear(d.getFullYear()+S)},function(d,S){return S.getFullYear()-d.getFullYear()},function(d){return d.getFullYear()});Io.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:Ea(function(S){S.setFullYear(Math.floor(S.getFullYear()/d)*d),S.setMonth(0,1),S.setHours(0,0,0,0)},function(S,_){S.setFullYear(S.getFullYear()+_*d)})};var hc=Io,Zf=Io.range,hh=Ea(function(d){d.setDate(1),d.setHours(0,0,0,0)},function(d,S){d.setMonth(d.getMonth()+S)},function(d,S){return S.getMonth()-d.getMonth()+(S.getFullYear()-d.getFullYear())*12},function(d){return d.getMonth()}),Xf=hh,Uu=hh.range,Yf=1e3,pf=6e4,Kf=36e5,Sh=864e5,dh=6048e5;function Cf(d){return Ea(function(S){S.setDate(S.getDate()-(S.getDay()+7-d)%7),S.setHours(0,0,0,0)},function(S,_){S.setDate(S.getDate()+_*7)},function(S,_){return(_-S-(_.getTimezoneOffset()-S.getTimezoneOffset())*pf)/dh})}var oh=Cf(0),$f=Cf(1),ph=Cf(2),jh=Cf(3),wf=Cf(4),jf=Cf(5),Ah=Cf(6),xe=oh.range,je=$f.range,bt=ph.range,vr=jh.range,Mr=wf.range,Cr=jf.range,gr=Ah.range,Wr=Ea(function(d){d.setHours(0,0,0,0)},function(d,S){d.setDate(d.getDate()+S)},function(d,S){return(S-d-(S.getTimezoneOffset()-d.getTimezoneOffset())*pf)/Sh},function(d){return d.getDate()-1}),sn=Wr,en=Wr.range,$r=Ea(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Yf-d.getMinutes()*pf)},function(d,S){d.setTime(+d+S*Kf)},function(d,S){return(S-d)/Kf},function(d){return d.getHours()}),ln=$r,An=$r.range,pn=Ea(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Yf)},function(d,S){d.setTime(+d+S*pf)},function(d,S){return(S-d)/pf},function(d){return d.getMinutes()}),Jr=pn,yr=pn.range,hr=Ea(function(d){d.setTime(d-d.getMilliseconds())},function(d,S){d.setTime(+d+S*Yf)},function(d,S){return(S-d)/Yf},function(d){return d.getUTCSeconds()}),Zr=hr,On=hr.range,Lr=Ea(function(){},function(d,S){d.setTime(+d+S)},function(d,S){return S-d});Lr.every=function(d){return d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?Ea(function(S){S.setTime(Math.floor(S/d)*d)},function(S,_){S.setTime(+S+_*d)},function(S,_){return(_-S)/d}):Lr};var Qn=Lr,Qr=Lr.range;function zr(d){return Ea(function(S){S.setUTCDate(S.getUTCDate()-(S.getUTCDay()+7-d)%7),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCDate(S.getUTCDate()+_*7)},function(S,_){return(_-S)/dh})}var Br=zr(0),Yr=zr(1),Zn=zr(2),ra=zr(3),an=zr(4),Hr=zr(5),kr=zr(6),pa=Br.range,ca=Yr.range,jn=Zn.range,Fa=ra.range,Sa=an.range,Ua=Hr.range,fi=kr.range,Bo=Ea(function(d){d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCDate(d.getUTCDate()+S)},function(d,S){return(S-d)/Sh},function(d){return d.getUTCDate()-1}),ys=Bo,Va=Bo.range,xo=Ea(function(d){d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCFullYear(d.getUTCFullYear()+S)},function(d,S){return S.getUTCFullYear()-d.getUTCFullYear()},function(d){return d.getUTCFullYear()});xo.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:Ea(function(S){S.setUTCFullYear(Math.floor(S.getUTCFullYear()/d)*d),S.setUTCMonth(0,1),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCFullYear(S.getUTCFullYear()+_*d)})};var Mi=xo,bs=xo.range;function is(d){if(0<=d.y&&d.y<100){var S=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return S.setFullYear(d.y),S}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function os(d){if(0<=d.y&&d.y<100){var S=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return S.setUTCFullYear(d.y),S}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function ss(d,S,_){return{y:d,m:S,d:_,H:0,M:0,S:0,L:0}}function Ws(d){var S=d.dateTime,_=d.date,x=d.time,C=d.periods,M=d.days,U=d.shortDays,ie=d.months,me=d.shortMonths,ze=Ga(C),Nt=Go(C),Jt=Ga(M),wr=Go(M),Dr=Ga(U),bn=Go(U),mn=Ga(ie),kn=Go(ie),_a=Ga(me),Ca=Go(me),Di={a:Th,A:lh,b:qc,B:dd,c:null,d:It,e:It,f:un,g:_u,G:Ml,H:Ft,I:Yt,j:lr,L:_r,m:Nr,M:rn,p:sd,q:pd,Q:rd,s:ld,S:yn,u:Vn,U:ua,V:Pi,w:Ha,W:Ho,x:null,X:null,y:Qo,Y:us,Z:Kc,"%":td},ui={a:md,A:ud,b:vd,B:Hh,c:null,d:Pc,e:Pc,f:Pl,g:Wh,G:Ch,H:ao,I:ai,j:Of,L:dc,m:$c,M:Jf,p:gd,q:qh,Q:rd,s:ld,S:io,u:ou,U:mf,V:xs,w:ml,W:pc,x:null,X:null,y:zh,Y:ed,Z:Qf,"%":td},li={a:Xs,A:Ya,b:ws,B:qo,c:gf,d:p,e:p,f:J,g:Na,G:Rn,H:P,I:P,j:y,L:B,m:c,M:N,p:To,q:h,Q:Ye,s:He,S:ee,u:Mc,U:Mt,V:xr,w:iu,W:mr,x:kh,X:Lc,y:Na,Y:Rn,Z:v,"%":he};Di.x=qi(_,Di),Di.X=qi(x,Di),Di.c=qi(S,Di),ui.x=qi(_,ui),ui.X=qi(x,ui),ui.c=qi(S,ui);function qi(ka,Vi){return function(ci){var In=[],Rc=-1,_s=0,ef=ka.length,tf,_h,yd;for(ci instanceof Date||(ci=new Date(+ci));++Rc<ef;)ka.charCodeAt(Rc)===37&&(In.push(ka.slice(_s,Rc)),(_h=Vo[tf=ka.charAt(++Rc)])!=null?tf=ka.charAt(++Rc):_h=tf==="e"?" ":"0",(yd=Vi[tf])&&(tf=yd(ci,_h)),In.push(tf),_s=Rc+1);return In.push(ka.slice(_s,Rc)),In.join("")}}function wa(ka,Vi){return function(ci){var In=ss(1900,void 0,1),Rc=eo(In,ka,ci+="",0),_s,ef;if(Rc!=ci.length)return null;if("Q"in In)return new Date(In.Q);if("s"in In)return new Date(In.s*1e3+("L"in In?In.L:0));if(Vi&&!("Z"in In)&&(In.Z=0),"p"in In&&(In.H=In.H%12+In.p*12),In.m===void 0&&(In.m="q"in In?In.q:0),"V"in In){if(In.V<1||In.V>53)return null;"w"in In||(In.w=1),"Z"in In?(_s=os(ss(In.y,0,1)),ef=_s.getUTCDay(),_s=ef>4||ef===0?Yr.ceil(_s):Yr(_s),_s=ys.offset(_s,(In.V-1)*7),In.y=_s.getUTCFullYear(),In.m=_s.getUTCMonth(),In.d=_s.getUTCDate()+(In.w+6)%7):(_s=is(ss(In.y,0,1)),ef=_s.getDay(),_s=ef>4||ef===0?$f.ceil(_s):$f(_s),_s=sn.offset(_s,(In.V-1)*7),In.y=_s.getFullYear(),In.m=_s.getMonth(),In.d=_s.getDate()+(In.w+6)%7)}else("W"in In||"U"in In)&&("w"in In||(In.w="u"in In?In.u%7:"W"in In?1:0),ef="Z"in In?os(ss(In.y,0,1)).getUTCDay():is(ss(In.y,0,1)).getDay(),In.m=0,In.d="W"in In?(In.w+6)%7+In.W*7-(ef+5)%7:In.w+In.U*7-(ef+6)%7);return"Z"in In?(In.H+=In.Z/100|0,In.M+=In.Z%100,os(In)):is(In)}}function eo(ka,Vi,ci,In){for(var Rc=0,_s=Vi.length,ef=ci.length,tf,_h;Rc<_s;){if(In>=ef)return-1;if(tf=Vi.charCodeAt(Rc++),tf===37){if(tf=Vi.charAt(Rc++),_h=li[tf in Vo?Vi.charAt(Rc++):tf],!_h||(In=_h(ka,ci,In))<0)return-1}else if(tf!=ci.charCodeAt(In++))return-1}return In}function To(ka,Vi,ci){var In=ze.exec(Vi.slice(ci));return In?(ka.p=Nt[In[0].toLowerCase()],ci+In[0].length):-1}function Xs(ka,Vi,ci){var In=Dr.exec(Vi.slice(ci));return In?(ka.w=bn[In[0].toLowerCase()],ci+In[0].length):-1}function Ya(ka,Vi,ci){var In=Jt.exec(Vi.slice(ci));return In?(ka.w=wr[In[0].toLowerCase()],ci+In[0].length):-1}function ws(ka,Vi,ci){var In=_a.exec(Vi.slice(ci));return In?(ka.m=Ca[In[0].toLowerCase()],ci+In[0].length):-1}function qo(ka,Vi,ci){var In=mn.exec(Vi.slice(ci));return In?(ka.m=kn[In[0].toLowerCase()],ci+In[0].length):-1}function gf(ka,Vi,ci){return eo(ka,S,Vi,ci)}function kh(ka,Vi,ci){return eo(ka,_,Vi,ci)}function Lc(ka,Vi,ci){return eo(ka,x,Vi,ci)}function Th(ka){return U[ka.getDay()]}function lh(ka){return M[ka.getDay()]}function qc(ka){return me[ka.getMonth()]}function dd(ka){return ie[ka.getMonth()]}function sd(ka){return C[+(ka.getHours()>=12)]}function pd(ka){return 1+~~(ka.getMonth()/3)}function md(ka){return U[ka.getUTCDay()]}function ud(ka){return M[ka.getUTCDay()]}function vd(ka){return me[ka.getUTCMonth()]}function Hh(ka){return ie[ka.getUTCMonth()]}function gd(ka){return C[+(ka.getUTCHours()>=12)]}function qh(ka){return 1+~~(ka.getUTCMonth()/3)}return{format:function(Vi){var ci=qi(Vi+="",Di);return ci.toString=function(){return Vi},ci},parse:function(Vi){var ci=wa(Vi+="",!1);return ci.toString=function(){return Vi},ci},utcFormat:function(Vi){var ci=qi(Vi+="",ui);return ci.toString=function(){return Vi},ci},utcParse:function(Vi){var ci=wa(Vi+="",!0);return ci.toString=function(){return Vi},ci}}}var Vo={"-":"",_:" ","0":"0"},ea=/^\s*\d+/,Tu=/^%/,xi=/[\\^$*+?|[\]().{}]/g;function Cn(d,S,_){var x=d<0?"-":"",C=(x?-d:d)+"",M=C.length;return x+(M<_?new Array(_-M+1).join(S)+C:C)}function ga(d){return d.replace(xi,"\\$&")}function Ga(d){return new RegExp("^(?:"+d.map(ga).join("|")+")","i")}function Go(d){for(var S={},_=-1,x=d.length;++_<x;)S[d[_].toLowerCase()]=_;return S}function iu(d,S,_){var x=ea.exec(S.slice(_,_+1));return x?(d.w=+x[0],_+x[0].length):-1}function Mc(d,S,_){var x=ea.exec(S.slice(_,_+1));return x?(d.u=+x[0],_+x[0].length):-1}function Mt(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.U=+x[0],_+x[0].length):-1}function xr(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.V=+x[0],_+x[0].length):-1}function mr(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.W=+x[0],_+x[0].length):-1}function Rn(d,S,_){var x=ea.exec(S.slice(_,_+4));return x?(d.y=+x[0],_+x[0].length):-1}function Na(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.y=+x[0]+(+x[0]>68?1900:2e3),_+x[0].length):-1}function v(d,S,_){var x=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(S.slice(_,_+6));return x?(d.Z=x[1]?0:-(x[2]+(x[3]||"00")),_+x[0].length):-1}function h(d,S,_){var x=ea.exec(S.slice(_,_+1));return x?(d.q=x[0]*3-3,_+x[0].length):-1}function c(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.m=x[0]-1,_+x[0].length):-1}function p(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.d=+x[0],_+x[0].length):-1}function y(d,S,_){var x=ea.exec(S.slice(_,_+3));return x?(d.m=0,d.d=+x[0],_+x[0].length):-1}function P(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.H=+x[0],_+x[0].length):-1}function N(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.M=+x[0],_+x[0].length):-1}function ee(d,S,_){var x=ea.exec(S.slice(_,_+2));return x?(d.S=+x[0],_+x[0].length):-1}function B(d,S,_){var x=ea.exec(S.slice(_,_+3));return x?(d.L=+x[0],_+x[0].length):-1}function J(d,S,_){var x=ea.exec(S.slice(_,_+6));return x?(d.L=Math.floor(x[0]/1e3),_+x[0].length):-1}function he(d,S,_){var x=Tu.exec(S.slice(_,_+1));return x?_+x[0].length:-1}function Ye(d,S,_){var x=ea.exec(S.slice(_));return x?(d.Q=+x[0],_+x[0].length):-1}function He(d,S,_){var x=ea.exec(S.slice(_));return x?(d.s=+x[0],_+x[0].length):-1}function It(d,S){return Cn(d.getDate(),S,2)}function Ft(d,S){return Cn(d.getHours(),S,2)}function Yt(d,S){return Cn(d.getHours()%12||12,S,2)}function lr(d,S){return Cn(1+sn.count(hc(d),d),S,3)}function _r(d,S){return Cn(d.getMilliseconds(),S,3)}function un(d,S){return _r(d,S)+"000"}function Nr(d,S){return Cn(d.getMonth()+1,S,2)}function rn(d,S){return Cn(d.getMinutes(),S,2)}function yn(d,S){return Cn(d.getSeconds(),S,2)}function Vn(d){var S=d.getDay();return S===0?7:S}function ua(d,S){return Cn(oh.count(hc(d)-1,d),S,2)}function ma(d){var S=d.getDay();return S>=4||S===0?wf(d):wf.ceil(d)}function Pi(d,S){return d=ma(d),Cn(wf.count(hc(d),d)+(hc(d).getDay()===4),S,2)}function Ha(d){return d.getDay()}function Ho(d,S){return Cn($f.count(hc(d)-1,d),S,2)}function Qo(d,S){return Cn(d.getFullYear()%100,S,2)}function _u(d,S){return d=ma(d),Cn(d.getFullYear()%100,S,2)}function us(d,S){return Cn(d.getFullYear()%1e4,S,4)}function Ml(d,S){var _=d.getDay();return d=_>=4||_===0?wf(d):wf.ceil(d),Cn(d.getFullYear()%1e4,S,4)}function Kc(d){var S=d.getTimezoneOffset();return(S>0?"-":(S*=-1,"+"))+Cn(S/60|0,"0",2)+Cn(S%60,"0",2)}function Pc(d,S){return Cn(d.getUTCDate(),S,2)}function ao(d,S){return Cn(d.getUTCHours(),S,2)}function ai(d,S){return Cn(d.getUTCHours()%12||12,S,2)}function Of(d,S){return Cn(1+ys.count(Mi(d),d),S,3)}function dc(d,S){return Cn(d.getUTCMilliseconds(),S,3)}function Pl(d,S){return dc(d,S)+"000"}function $c(d,S){return Cn(d.getUTCMonth()+1,S,2)}function Jf(d,S){return Cn(d.getUTCMinutes(),S,2)}function io(d,S){return Cn(d.getUTCSeconds(),S,2)}function ou(d){var S=d.getUTCDay();return S===0?7:S}function mf(d,S){return Cn(Br.count(Mi(d)-1,d),S,2)}function sh(d){var S=d.getUTCDay();return S>=4||S===0?an(d):an.ceil(d)}function xs(d,S){return d=sh(d),Cn(an.count(Mi(d),d)+(Mi(d).getUTCDay()===4),S,2)}function ml(d){return d.getUTCDay()}function pc(d,S){return Cn(Yr.count(Mi(d)-1,d),S,2)}function zh(d,S){return Cn(d.getUTCFullYear()%100,S,2)}function Wh(d,S){return d=sh(d),Cn(d.getUTCFullYear()%100,S,2)}function ed(d,S){return Cn(d.getUTCFullYear()%1e4,S,4)}function Ch(d,S){var _=d.getUTCDay();return d=_>=4||_===0?an(d):an.ceil(d),Cn(d.getUTCFullYear()%1e4,S,4)}function Qf(){return"+0000"}function td(){return"%"}function rd(d){return+d}function ld(d){return Math.floor(+d/1e3)}var Es,qf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(d){return Es=Ws(d),qf=Es.format,cd=Es.parse,e=Es.utcFormat,t=Es.utcParse,Es}var u=1e3,f=u*60,g=f*60,A=g*24,L=A*7,V=A*30,te=A*365;function de(d){return new Date(d)}function Se(d){return d instanceof Date?+d:+new Date(+d)}function Oe(d,S,_,x,C,M,U,ie,me){var ze=cf(gs,gs),Nt=ze.invert,Jt=ze.domain,wr=me(".%L"),Dr=me(":%S"),bn=me("%I:%M"),mn=me("%I %p"),kn=me("%a %d"),_a=me("%b %d"),Ca=me("%B"),Di=me("%Y"),ui=[[U,1,u],[U,5,5*u],[U,15,15*u],[U,30,30*u],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[C,1,g],[C,3,3*g],[C,6,6*g],[C,12,12*g],[x,1,A],[x,2,2*A],[_,1,L],[S,1,V],[S,3,3*V],[d,1,te]];function li(wa){return(U(wa)<wa?wr:M(wa)<wa?Dr:C(wa)<wa?bn:x(wa)<wa?mn:S(wa)<wa?_(wa)<wa?kn:_a:d(wa)<wa?Ca:Di)(wa)}function qi(wa,eo,To,Xs){if(wa==null&&(wa=10),typeof wa=="number"){var Ya=Math.abs(To-eo)/wa,ws=dl(function(qo){return qo[2]}).right(ui,Ya);ws===ui.length?(Xs=l(eo/te,To/te,wa),wa=d):ws?(ws=ui[Ya/ui[ws-1][2]<ui[ws][2]/Ya?ws-1:ws],Xs=ws[1],wa=ws[0]):(Xs=Math.max(l(eo,To,wa),1),wa=ie)}return Xs==null?wa:wa.every(Xs)}return ze.invert=function(wa){return new Date(Nt(wa))},ze.domain=function(wa){return arguments.length?Jt(Ji.call(wa,Se)):Jt().map(de)},ze.ticks=function(wa,eo){var To=Jt(),Xs=To[0],Ya=To[To.length-1],ws=Ya<Xs,qo;return ws&&(qo=Xs,Xs=Ya,Ya=qo),qo=qi(wa,Xs,Ya,eo),qo=qo?qo.range(Xs,Ya+1):[],ws?qo.reverse():qo},ze.tickFormat=function(wa,eo){return eo==null?li:me(eo)},ze.nice=function(wa,eo){var To=Jt();return(wa=qi(wa,To[0],To[To.length-1],eo))?Jt(k(To,wa)):ze},ze.copy=function(){return el(ze,Oe(d,S,_,x,C,M,U,ie,me))},ze}var it=function(){return fr.apply(Oe(hc,Xf,oh,sn,ln,Jr,Zr,Qn,qf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Ct=Ea(function(d){d.setUTCDate(1),d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCMonth(d.getUTCMonth()+S)},function(d,S){return S.getUTCMonth()-d.getUTCMonth()+(S.getUTCFullYear()-d.getUTCFullYear())*12},function(d){return d.getUTCMonth()}),xt=Ct,Wt=Ct.range,Ht=Ea(function(d){d.setUTCMinutes(0,0,0)},function(d,S){d.setTime(+d+S*Kf)},function(d,S){return(S-d)/Kf},function(d){return d.getUTCHours()}),tr=Ht,dr=Ht.range,br=Ea(function(d){d.setUTCSeconds(0,0)},function(d,S){d.setTime(+d+S*pf)},function(d,S){return(S-d)/pf},function(d){return d.getUTCMinutes()}),jr=br,Ir=br.range,hn=function(){return fr.apply(Oe(Mi,xt,Br,ys,tr,jr,Zr,Qn,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function cn(){var d=0,S=1,_,x,C,M,U=gs,ie=!1,me;function ze(Nt){return isNaN(Nt=+Nt)?me:U(C===0?.5:(Nt=(M(Nt)-_)*C,ie?Math.max(0,Math.min(1,Nt)):Nt))}return ze.domain=function(Nt){return arguments.length?(_=M(d=+Nt[0]),x=M(S=+Nt[1]),C=_===x?0:1/(x-_),ze):[d,S]},ze.clamp=function(Nt){return arguments.length?(ie=!!Nt,ze):ie},ze.interpolator=function(Nt){return arguments.length?(U=Nt,ze):U},ze.unknown=function(Nt){return arguments.length?(me=Nt,ze):me},function(Nt){return M=Nt,_=Nt(d),x=Nt(S),C=_===x?0:1/(x-_),ze}}function Ln(d,S){return S.domain(d.domain()).interpolator(d.interpolator()).clamp(d.clamp()).unknown(d.unknown())}function $n(){var d=Wl(cn()(gs));return d.copy=function(){return Ln(d,$n())},Tr.apply(d,arguments)}function Xn(){var d=Un(cn()).domain([1,10]);return d.copy=function(){return Ln(d,Xn()).base(d.base())},Tr.apply(d,arguments)}function Dn(){var d=za(cn());return d.copy=function(){return Ln(d,Dn()).constant(d.constant())},Tr.apply(d,arguments)}function Ta(){var d=bo(cn());return d.copy=function(){return Ln(d,Ta()).exponent(d.exponent())},Tr.apply(d,arguments)}function sa(){return Ta.apply(null,arguments).exponent(.5)}function qn(){var d=[],S=gs;function _(x){if(!isNaN(x=+x))return S((vs(d,x)-1)/(d.length-1))}return _.domain=function(x){if(!arguments.length)return d.slice();d=[];for(var C=0,M=x.length,U;C<M;++C)(U=x[C],U!=null&&!isNaN(U=+U))&&d.push(U);return d.sort(hl),_},_.interpolator=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return qn(S).domain(d)},Tr.apply(_,arguments)}function $a(){var d=0,S=.5,_=1,x,C,M,U,ie,me=gs,ze,Nt=!1,Jt;function wr(Dr){return isNaN(Dr=+Dr)?Jt:(Dr=.5+((Dr=+ze(Dr))-C)*(Dr<C?U:ie),me(Nt?Math.max(0,Math.min(1,Dr)):Dr))}return wr.domain=function(Dr){return arguments.length?(x=ze(d=+Dr[0]),C=ze(S=+Dr[1]),M=ze(_=+Dr[2]),U=x===C?0:.5/(C-x),ie=C===M?0:.5/(M-C),wr):[d,S,_]},wr.clamp=function(Dr){return arguments.length?(Nt=!!Dr,wr):Nt},wr.interpolator=function(Dr){return arguments.length?(me=Dr,wr):me},wr.unknown=function(Dr){return arguments.length?(Jt=Dr,wr):Jt},function(Dr){return ze=Dr,x=Dr(d),C=Dr(S),M=Dr(_),U=x===C?0:.5/(C-x),ie=C===M?0:.5/(M-C),wr}}function Ra(){var d=Wl($a()(gs));return d.copy=function(){return Ln(d,Ra())},Tr.apply(d,arguments)}function Bi(){var d=Un($a()).domain([.1,1,10]);return d.copy=function(){return Ln(d,Bi()).base(d.base())},Tr.apply(d,arguments)}function va(){var d=za($a());return d.copy=function(){return Ln(d,va()).constant(d.constant())},Tr.apply(d,arguments)}function oi(){var d=bo($a());return d.copy=function(){return Ln(d,oi()).exponent(d.exponent())},Tr.apply(d,arguments)}function Wo(){return oi.apply(null,arguments).exponent(.5)}var Ei,Zo,Xo,ls,Su,cs,tl,su,rl,uu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Zs=(Ei={},we()(Ei,T.ScaleTypes.LINEAR,ne),we()(Ei,T.ScaleTypes.POWER,Zi),we()(Ei,T.ScaleTypes.LOG,Kn),we()(Ei,T.ScaleTypes.IDENTITY,se),we()(Ei,T.ScaleTypes.TIME,it),we()(Ei,T.ScaleTypes.QUANTILE,ri),we()(Ei,T.ScaleTypes.QUANTIZE,fo),we()(Ei,T.ScaleTypes.THRESHOLD,au),we()(Ei,T.ScaleTypes.CAT,_i),Ei),lu=(Zo=Object(ar.injectable)(),Xo=Object(ar.inject)(T.TYPES.IGlobalConfigService),ls=Object(ar.inject)(T.TYPES.ILogService),Zo(Su=(cs=(rl=function(){function d(){X()(this,d),ke()(this,"configService",tl,this),ke()(this,"logger",su,this),this.scaleCache={},this.scaleOptions={}}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=_.getSource().data.dataArray;if(ie.length===0)return;C.caculateScalesForAttributes(U||[],ie)}),_.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=_.getSource().data.dataArray;return C.caculateScalesForAttributes(U||[],ie),_.layerModelNeedUpdate=!0,!0}),_.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(_.layerModelNeedUpdate)return;C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes();if(U){var ie=_.getSource().data.dataArray;if(ie.length===0)return;var me=U.filter(function(ze){return ze.needRescale});me.length&&(C.caculateScalesForAttributes(me,ie),C.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(_){return!isNaN(parseFloat(_))&&isFinite(_)}},{key:"caculateScalesForAttributes",value:function(_,x){var C=this;this.scaleCache={},_.forEach(function(M){if(M.scale){var U=M.scale,ie=M.name;U.names=C.parseFields(M.scale.field||[]);var me=[];U.names.forEach(function(ze){me.push(C.getOrCreateScale(ze,M,x))}),me.some(function(ze){return ze.type===T.StyleScaleType.VARIABLE})?(U.type=T.StyleScaleType.VARIABLE,me.forEach(function(ze){if(!U.callback){var Nt;if(U.values&&U.values!=="text"){var Jt;if(((Jt=ze.option)===null||Jt===void 0?void 0:Jt.type)==="linear"&&U.values.length>2){var wr=ze.scale.ticks(U.values.length);ie==="color"&&ze.scale.domain(wr)}ze.scale.range(U.values)}else((Nt=ze.option)===null||Nt===void 0?void 0:Nt.type)==="cat"&&ze.scale.range(ze.option.domain)}})):(U.type=T.StyleScaleType.CONSTANT,U.defaultValues=me.map(function(ze,Nt){return ze.scale(U.names[Nt])})),U.scalers=me.map(function(ze){return{field:ze.field,func:ze.scale,option:ze.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(_,x,C){var M,U=[_,x.name].join("_"),ie=(M=x.scale)===null||M===void 0?void 0:M.values,me=this.createScale(_,x.name,ie,C);return me}},{key:"parseFields",value:function(_){return Array.isArray(_)?_:tc()(_)?_.split("*"):[_]}},{key:"createScale",value:function(_,x,C,M){var U,ie=this.scaleOptions[x]&&this.scaleOptions[x].field===_?this.scaleOptions[x]:this.scaleOptions[_],me={field:_,scale:void 0,type:T.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?me.scale=this.createDefaultScale(ie):(me.scale=_i([_]),me.type=T.StyleScaleType.CONSTANT),me;var ze=(U=M.find(function(wr){return!Hi()(wr[_])}))===null||U===void 0?void 0:U[_];if(this.isNumber(_)||Hi()(ze)&&!ie)me.scale=_i([_]),me.type=T.StyleScaleType.CONSTANT;else{var Nt=ie&&ie.type||this.getDefaultType(ze);C==="text"&&(Nt=T.ScaleTypes.CAT);var Jt=this.createDefaultScaleConfig(Nt,_,M);Object.assign(Jt,ie),me.scale=this.createDefaultScale(Jt),me.option=Jt}return me}},{key:"getDefaultType",value:function(_){var x=T.ScaleTypes.LINEAR;return typeof _=="string"&&(x=uu.test(_)?T.ScaleTypes.TIME:T.ScaleTypes.CAT),x}},{key:"createDefaultScaleConfig",value:function(_,x,C){var M={type:_},U=(C==null?void 0:C.map(function(ie){return ie[x]}))||[];return _!==T.ScaleTypes.CAT&&_!==T.ScaleTypes.QUANTILE?M.domain=Ru(U):_===T.ScaleTypes.CAT?M.domain=ru()(U):_===T.ScaleTypes.QUANTILE&&(M.domain=U),M}},{key:"createDefaultScale",value:function(_){var x=_.type,C=_.domain,M=Zs[x]();return C&&M.domain(C),M}}]),d}(),rl),tl=Qe()(cs.prototype,"configService",[Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=Qe()(cs.prototype,"logger",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cs))||Su),vi,si,Qi,ho,Au,Eo,Yo,Bu;function hi(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function eh(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?hi(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):hi(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var Jc=(vi=Object(ar.injectable)(),si=Object(ar.inject)(T.TYPES.ICameraService),Qi=Object(ar.inject)(T.TYPES.IRendererService),vi(ho=(Au=(Bu=function(){function d(){X()(this,d),ke()(this,"cameraService",Eo,this),ke()(this,"rendererService",Yo,this)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){_.models.forEach(function(x){x.addUniforms(eh({},_.layerModel.getAnimateUniforms()))})})}}]),d}(),Bu),Eo=Qe()(Au.prototype,"cameraService",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Qe()(Au.prototype,"rendererService",[Qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Au))||ho),vf,mc,Vu=(vf=Object(ar.injectable)(),vf(mc=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.init.tap("LayerModelPlugin",function(){_.prepareBuildModel(),_.buildModels(),_.styleNeedUpdate=!1}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return _.prepareBuildModel(),_.clearModels(),_.buildModels(),_.layerModelNeedUpdate=!1,!1})}}]),d}())||mc),zf,Ff,th=(zf=Object(ar.injectable)(),zf(Ff=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.afterInit.tap("LayerStylePlugin",function(){_.updateLayerConfig({});var x=_.getLayerConfig(),C=x.autoFit,M=x.fitBoundsOptions;C&&setTimeout(function(){_.fitBounds(M)},100)})}}]),d}())||Ff),wh,Mf;function Oh(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function rh(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?Oh(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):Oh(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var mh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Zh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Fh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Xh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},vh=["ambient","diffuse","specular"];function Mh(d){var S={u_DirectionalLights:new Array(3).fill(rh({},Fh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(rh({},Xh)),u_NumOfSpotLights:0};return(!d||!d.length)&&(d=[Zh]),d.forEach(function(_,x){var C=_.type,M=C===void 0?"directional":C,U=We()(_,["type"]),ie=mh[M].lights,me=mh[M].num,ze=S[me];S[ie][ze]=rh(rh({},S[ie][ze]),U),S[me]++}),S}var Yh=(wh=Object(ar.injectable)(),wh(Mf=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LightingPlugin",function(){var x=_.getLayerConfig(),C=x.enableLighting;C&&_.models.forEach(function(M){return M.addUniforms(rh({},Mh()))})})}}]),d}())||Mf),gh,nh,uh={NONE:0,ENCODE:1,HIGHLIGHT:2},Kh=(gh=Object(ar.injectable)(),gh(nh=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_,x){var C=x.rendererService,M=x.styleAttributeService;_.hooks.init.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:T.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(ze,Nt){var Jt=ze.id;return ie?Object(Le.l)(Jt):[0,0,0]}}})}),_.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;ie&&_.isVisible()&&_.models.forEach(function(me){return me.addUniforms({u_PickingStage:uh.ENCODE})})}),_.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;ie&&_.isVisible()&&_.models.forEach(function(me){return me.addUniforms({u_PickingStage:uh.HIGHLIGHT})})}),_.hooks.beforeHighlight.tap("PixelPickingPlugin",function(U){var ie=_.getLayerConfig(),me=ie.highlightColor,ze=typeof me=="string"?Object(Le.s)(me):me||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(U))}),_.models.forEach(function(Nt){return Nt.addUniforms({u_PickingStage:uh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:ze.map(function(Jt){return Jt*255})})})}),_.hooks.beforeSelect.tap("PixelPickingPlugin",function(U){var ie=_.getLayerConfig(),me=ie.selectColor,ze=typeof me=="string"?Object(Le.s)(me):me||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(U))}),_.models.forEach(function(Nt){return Nt.addUniforms({u_PickingStage:uh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:ze.map(function(Jt){return Jt*255})})})})}}]),d}())||nh),Uh,yh,Bh,Ph,bh,Vh,Gh=(Uh=Object(ar.injectable)(),yh=Object(ar.inject)(T.TYPES.ILogService),Uh(Bh=(Ph=(Vh=function(){function d(){X()(this,d),ke()(this,"logger",bh,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("RegisterStyleAttributePlugin",function(){C.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(_){_.registerStyleAttribute({name:"position",type:T.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(C,M,U){return U.length===2?[U[0],U[1],0]:[U[0],U[1],U[2]]}}}),_.registerStyleAttribute({name:"filter",type:T.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(C,M){var U=C.filter;return U?[1]:[0]}}}),_.registerStyleAttribute({name:"color",type:T.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(C,M){var U=C.color;return!U||!U.length?[1,1,1,1]:U}}})}}]),d}(),Vh),bh=Qe()(Ph.prototype,"logger",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ph))||Bh),Lh,Rh,xh,Ih,Eh,Uf,Dh,$h,Jh,nd,ad=(Lh=Object(ar.injectable)(),Rh=Object(ar.inject)(T.TYPES.ICameraService),xh=Object(ar.inject)(T.TYPES.ICoordinateSystemService),Ih=Object(ar.inject)(T.TYPES.IRendererService),Lh(Eh=(Uf=(nd=function(){function d(){X()(this,d),ke()(this,"cameraService",Dh,this),ke()(this,"coordinateSystemService",$h,this),ke()(this,"rendererService",Jh,this)}return o()(d,[{key:"apply",value:function(_){var x=this;_.hooks.beforeRender.tap("ShaderUniformPlugin",function(){x.coordinateSystemService.refresh();var C=x.rendererService.getViewportSize(),M=C.width,U=C.height;_.models.forEach(function(ie){var me;return ie.addUniforms((me={},we()(me,T.CameraUniform.ProjectionMatrix,x.cameraService.getProjectionMatrix()),we()(me,T.CameraUniform.ViewMatrix,x.cameraService.getViewMatrix()),we()(me,T.CameraUniform.ViewProjectionMatrix,x.cameraService.getViewProjectionMatrix()),we()(me,T.CameraUniform.Zoom,x.cameraService.getZoom()),we()(me,T.CameraUniform.ZoomScale,x.cameraService.getZoomScale()),we()(me,T.CameraUniform.FocalDistance,x.cameraService.getFocalDistance()),we()(me,T.CameraUniform.CameraPosition,x.cameraService.getCameraPosition()),we()(me,T.CoordinateUniform.CoordinateSystem,x.coordinateSystemService.getCoordinateSystem()),we()(me,T.CoordinateUniform.ViewportCenter,x.coordinateSystemService.getViewportCenter()),we()(me,T.CoordinateUniform.ViewportCenterProjection,x.coordinateSystemService.getViewportCenterProjection()),we()(me,T.CoordinateUniform.PixelsPerDegree,x.coordinateSystemService.getPixelsPerDegree()),we()(me,T.CoordinateUniform.PixelsPerDegree2,x.coordinateSystemService.getPixelsPerDegree2()),we()(me,T.CoordinateUniform.PixelsPerMeter,x.coordinateSystemService.getPixelsPerMeter()),we()(me,"u_ViewportSize",[M,U]),we()(me,"u_DevicePixelRatio",window.devicePixelRatio),we()(me,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),we()(me,"u_PickingBuffer",_.getLayerConfig().pickingBuffer||0),me))})})}}]),d}(),nd),Dh=Qe()(Uf.prototype,"cameraService",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Qe()(Uf.prototype,"coordinateSystemService",[xh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jh=Qe()(Uf.prototype,"rendererService",[Ih],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uf))||Eh),id,Qh,Ed=(id=Object(ar.injectable)(),id(Qh=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("UpdateModelPlugin",function(){_.layerModel&&_.layerModel.needUpdate()})}}]),d}())||Qh),fd,Nh,Ts,Qc,hd,ah,od=(fd=Object(ar.injectable)(),Nh=Object(ar.inject)(T.TYPES.ILogService),fd(Ts=(Qc=(ah=function(){function d(){X()(this,d),ke()(this,"logger",hd,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("UpdateStyleAttributePlugin",function(){C.initStyleAttribute(_,{styleAttributeService:M})}),_.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(_.layerModelNeedUpdate)return;C.updateStyleAtrribute(_,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),me=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||me&&me.needRegenerateVertices){_.layerModelNeedUpdate=!0,U.forEach(function(ze){return ze.needRegenerateVertices=!1});return}U.filter(function(ze){return ze.needRegenerateVertices}).forEach(function(ze){M.updateAttributeByFeatureRange(ze.name,_.getEncodedData(),ze.featureRange.startIndex,ze.featureRange.endIndex),ze.needRegenerateVertices=!1,C.logger.debug("regenerate vertex attributes: ".concat(ze.name," finished"))})}},{key:"initStyleAttribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[];U.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,_.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,C.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),d}(),ah),hd=Qe()(Qc.prototype,"logger",[Nh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qc))||Ts);T.container.bind(T.TYPES.ILayerPlugin).to(jo).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Gh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(lu).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Sc).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(th).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(od).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Ed).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(rt).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(ad).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Jc).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Yh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Kh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Vu).inRequestScope()},t2Dn:function(Re,E,i){var T=i("hypo"),m=i("ljhN");function X(z,o,Z){(Z!==void 0&&!m(z[o],Z)||Z===void 0&&!(o in z))&&T(z,o,Z)}Re.exports=X},u6S6:function(Re,E,i){var T=i("6acW"),m=i("sgoq"),X=m(function(z,o,Z){return o=o.toLowerCase(),z+(Z?T(o):o)});Re.exports=X},uhBA:function(Re,E,i){"use strict";var T=Object.prototype.hasOwnProperty,m="~";function X(){}Object.create&&(X.prototype=Object.create(null),new X().__proto__||(m=!1));function z(K,re,fe){this.fn=K,this.context=re,this.once=fe||!1}function o(K,re,fe,Y,Fe){if(typeof fe!="function")throw new TypeError("The listener must be a function");var We=new z(fe,Y||K,Fe),ge=m?m+re:re;return K._events[ge]?K._events[ge].fn?K._events[ge]=[K._events[ge],We]:K._events[ge].push(We):(K._events[ge]=We,K._eventsCount++),K}function Z(K,re){--K._eventsCount===0?K._events=new X:delete K._events[re]}function D(){this._events=new X,this._eventsCount=0}D.prototype.eventNames=function(){var re=[],fe,Y;if(this._eventsCount===0)return re;for(Y in fe=this._events)T.call(fe,Y)&&re.push(m?Y.slice(1):Y);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(fe)):re},D.prototype.listeners=function(re){var fe=m?m+re:re,Y=this._events[fe];if(!Y)return[];if(Y.fn)return[Y.fn];for(var Fe=0,We=Y.length,ge=new Array(We);Fe<We;Fe++)ge[Fe]=Y[Fe].fn;return ge},D.prototype.listenerCount=function(re){var fe=m?m+re:re,Y=this._events[fe];return Y?Y.fn?1:Y.length:0},D.prototype.emit=function(re,fe,Y,Fe,We,ge){var we=m?m+re:re;if(!this._events[we])return!1;var dt=this._events[we],ke=arguments.length,Et,Ze;if(dt.fn){dt.once&&this.removeListener(re,dt.fn,void 0,!0);switch(ke){case 1:return dt.fn.call(dt.context),!0;case 2:return dt.fn.call(dt.context,fe),!0;case 3:return dt.fn.call(dt.context,fe,Y),!0;case 4:return dt.fn.call(dt.context,fe,Y,Fe),!0;case 5:return dt.fn.call(dt.context,fe,Y,Fe,We),!0;case 6:return dt.fn.call(dt.context,fe,Y,Fe,We,ge),!0}for(Ze=1,Et=new Array(ke-1);Ze<ke;Ze++)Et[Ze-1]=arguments[Ze];dt.fn.apply(dt.context,Et)}else{var vt=dt.length,Qe;for(Ze=0;Ze<vt;Ze++){dt[Ze].once&&this.removeListener(re,dt[Ze].fn,void 0,!0);switch(ke){case 1:dt[Ze].fn.call(dt[Ze].context);break;case 2:dt[Ze].fn.call(dt[Ze].context,fe);break;case 3:dt[Ze].fn.call(dt[Ze].context,fe,Y);break;case 4:dt[Ze].fn.call(dt[Ze].context,fe,Y,Fe);break;default:if(!Et)for(Qe=1,Et=new Array(ke-1);Qe<ke;Qe++)Et[Qe-1]=arguments[Qe];dt[Ze].fn.apply(dt[Ze].context,Et)}}}return!0},D.prototype.on=function(re,fe,Y){return o(this,re,fe,Y,!1)},D.prototype.once=function(re,fe,Y){return o(this,re,fe,Y,!0)},D.prototype.removeListener=function(re,fe,Y,Fe){var We=m?m+re:re;if(!this._events[We])return this;if(!fe)return Z(this,We),this;var ge=this._events[We];if(ge.fn)ge.fn===fe&&(!Fe||ge.once)&&(!Y||ge.context===Y)&&Z(this,We);else{for(var we=0,dt=[],ke=ge.length;we<ke;we++)(ge[we].fn!==fe||Fe&&!ge[we].once||Y&&ge[we].context!==Y)&&dt.push(ge[we]);dt.length?this._events[We]=dt.length===1?dt[0]:dt:Z(this,We)}return this},D.prototype.removeAllListeners=function(re){var fe;return re?(fe=m?m+re:re,this._events[fe]&&Z(this,fe)):(this._events=new X,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=m,D.EventEmitter=D,Re.exports=D},ujMp:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(re){if(typeof re=="function"){var fe=re;return fe.name}else{if(typeof re=="symbol")return re.toString();var fe=re;return fe}}E.getServiceIdentifierAsString=m;function X(re,fe,Y){var Fe="",We=Y(re,fe);return We.length!==0&&(Fe=`
Registered bindings:`,We.forEach(function(ge){var we="Object";ge.implementationType!==null&&(we=K(ge.implementationType)),Fe=Fe+`
 `+we,ge.constraint.metaData&&(Fe=Fe+" - "+ge.constraint.metaData)})),Fe}E.listRegisteredBindingsForServiceIdentifier=X;function z(re,fe){return re.parentRequest===null?!1:re.parentRequest.serviceIdentifier===fe?!0:z(re.parentRequest,fe)}function o(re){function fe(Fe,We){We===void 0&&(We=[]);var ge=m(Fe.serviceIdentifier);return We.push(ge),Fe.parentRequest!==null?fe(Fe.parentRequest,We):We}var Y=fe(re);return Y.reverse().join(" --> ")}function Z(re){re.childRequests.forEach(function(fe){if(z(fe,fe.serviceIdentifier)){var Y=o(fe);throw new Error(T.CIRCULAR_DEPENDENCY+" "+Y)}else Z(fe)})}E.circularDependencyToException=Z;function D(re,fe){if(fe.isTagged()||fe.isNamed()){var Y="",Fe=fe.getNamedTag(),We=fe.getCustomTags();return Fe!==null&&(Y+=Fe.toString()+`
`),We!==null&&We.forEach(function(ge){Y+=ge.toString()+`
`})," "+re+`
 `+re+" - "+Y}else return" "+re}E.listMetadataForTarget=D;function K(re){if(re.name)return re.name;var fe=re.toString(),Y=fe.match(/^function\s*([^\s(]+)/);return Y?Y[1]:"Anonymous function: "+fe}E.getFunctionName=K},"vN+2":function(Re,E){function i(){}Re.exports=i},"w/wX":function(Re,E,i){var T=i("QqLw"),m=i("ExA7"),X="[object Set]";function z(o){return m(o)&&T(o)==X}Re.exports=z},w26f:function(Re,E,i){(function(T){var m=200,X="__lodash_hash_undefined__",z=1/0,o="[object Function]",Z="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,re=typeof T=="object"&&T&&T.Object===Object&&T,fe=typeof self=="object"&&self&&self.Object===Object&&self,Y=re||fe||Function("return this")();function Fe(ct,qe){var Vt=ct?ct.length:0;return!!Vt&&we(ct,qe,0)>-1}function We(ct,qe,Vt){for(var pr=-1,Gr=ct?ct.length:0;++pr<Gr;)if(Vt(qe,ct[pr]))return!0;return!1}function ge(ct,qe,Vt,pr){for(var Gr=ct.length,ur=Vt+(pr?1:-1);pr?ur--:++ur<Gr;)if(qe(ct[ur],ur,ct))return ur;return-1}function we(ct,qe,Vt){if(qe!==qe)return ge(ct,dt,Vt);for(var pr=Vt-1,Gr=ct.length;++pr<Gr;)if(ct[pr]===qe)return pr;return-1}function dt(ct){return ct!==ct}function ke(ct,qe){return ct.has(qe)}function Et(ct,qe){return ct==null?void 0:ct[qe]}function Ze(ct){var qe=!1;if(ct!=null&&typeof ct.toString!="function")try{qe=!!(ct+"")}catch(Vt){}return qe}function vt(ct){var qe=-1,Vt=Array(ct.size);return ct.forEach(function(pr){Vt[++qe]=pr}),Vt}var Qe=Array.prototype,yt=Function.prototype,_t=Object.prototype,De=Y["__core-js_shared__"],Ne=function(){var ct=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||"");return ct?"Symbol(src)_1."+ct:""}(),Ue=yt.toString,st=_t.hasOwnProperty,Le=_t.toString,ut=RegExp("^"+Ue.call(st).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gt=Qe.splice,Kt=ae(Y,"Map"),ar=ae(Y,"Set"),oe=ae(Object,"create");function Q(ct){var qe=-1,Vt=ct?ct.length:0;for(this.clear();++qe<Vt;){var pr=ct[qe];this.set(pr[0],pr[1])}}function H(){this.__data__=oe?oe(null):{}}function Ce(ct){return this.has(ct)&&delete this.__data__[ct]}function Ee(ct){var qe=this.__data__;if(oe){var Vt=qe[ct];return Vt===X?void 0:Vt}return st.call(qe,ct)?qe[ct]:void 0}function _e(ct){var qe=this.__data__;return oe?qe[ct]!==void 0:st.call(qe,ct)}function ve(ct,qe){var Vt=this.__data__;return Vt[ct]=oe&&qe===void 0?X:qe,this}Q.prototype.clear=H,Q.prototype.delete=Ce,Q.prototype.get=Ee,Q.prototype.has=_e,Q.prototype.set=ve;function rt(ct){var qe=-1,Vt=ct?ct.length:0;for(this.clear();++qe<Vt;){var pr=ct[qe];this.set(pr[0],pr[1])}}function $t(){this.__data__=[]}function St(ct){var qe=this.__data__,Vt=gt(qe,ct);if(Vt<0)return!1;var pr=qe.length-1;return Vt==pr?qe.pop():Gt.call(qe,Vt,1),!0}function ye(ct){var qe=this.__data__,Vt=gt(qe,ct);return Vt<0?void 0:qe[Vt][1]}function be(ct){return gt(this.__data__,ct)>-1}function Be(ct,qe){var Vt=this.__data__,pr=gt(Vt,ct);return pr<0?Vt.push([ct,qe]):Vt[pr][1]=qe,this}rt.prototype.clear=$t,rt.prototype.delete=St,rt.prototype.get=ye,rt.prototype.has=be,rt.prototype.set=Be;function lt(ct){var qe=-1,Vt=ct?ct.length:0;for(this.clear();++qe<Vt;){var pr=ct[qe];this.set(pr[0],pr[1])}}function Pe(){this.__data__={hash:new Q,map:new(Kt||rt),string:new Q}}function ht(ct){return Ke(this,ct).delete(ct)}function w(ct){return Ke(this,ct).get(ct)}function I(ct){return Ke(this,ct).has(ct)}function q(ct,qe){return Ke(this,ct).set(ct,qe),this}lt.prototype.clear=Pe,lt.prototype.delete=ht,lt.prototype.get=w,lt.prototype.has=I,lt.prototype.set=q;function ce(ct){var qe=-1,Vt=ct?ct.length:0;for(this.__data__=new lt;++qe<Vt;)this.add(ct[qe])}function Ve(ct){return this.__data__.set(ct,X),this}function $e(ct){return this.__data__.has(ct)}ce.prototype.add=ce.prototype.push=Ve,ce.prototype.has=$e;function gt(ct,qe){for(var Vt=ct.length;Vt--;)if(pt(ct[Vt][0],qe))return Vt;return-1}function nt(ct){if(!mt(ct)||zt(ct))return!1;var qe=At(ct)||Ze(ct)?ut:K;return qe.test(sr(ct))}function kt(ct,qe,Vt){var pr=-1,Gr=Fe,ur=ct.length,zn=!0,xn=[],na=xn;if(Vt)zn=!1,Gr=We;else if(ur>=m){var fa=qe?null:$(ct);if(fa)return vt(fa);zn=!1,Gr=ke,na=new ce}else na=qe?[]:xn;e:for(;++pr<ur;){var Hn=ct[pr],Gn=qe?qe(Hn):Hn;if(Hn=Vt||Hn!==0?Hn:0,zn&&Gn===Gn){for(var F=na.length;F--;)if(na[F]===Gn)continue e;qe&&na.push(Gn),xn.push(Hn)}else Gr(na,Gn,Vt)||(na!==xn&&na.push(Gn),xn.push(Hn))}return xn}var $=ar&&1/vt(new ar([,-0]))[1]==z?function(ct){return new ar(ct)}:Me;function Ke(ct,qe){var Vt=ct.__data__;return et(qe)?Vt[typeof qe=="string"?"string":"hash"]:Vt.map}function ae(ct,qe){var Vt=Et(ct,qe);return nt(Vt)?Vt:void 0}function et(ct){var qe=typeof ct;return qe=="string"||qe=="number"||qe=="symbol"||qe=="boolean"?ct!=="__proto__":ct===null}function zt(ct){return!!Ne&&Ne in ct}function sr(ct){if(ct!=null){try{return Ue.call(ct)}catch(qe){}try{return ct+""}catch(qe){}}return""}function ft(ct){return ct&&ct.length?kt(ct):[]}function pt(ct,qe){return ct===qe||ct!==ct&&qe!==qe}function At(ct){var qe=mt(ct)?Le.call(ct):"";return qe==o||qe==Z}function mt(ct){var qe=typeof ct;return!!ct&&(qe=="object"||qe=="function")}function Me(){}Re.exports=ft}).call(this,i("yLpj"))},wclG:function(Re,E,i){var T=i("pFRH"),m=i("88Gu"),X=m(T);Re.exports=X},wnjb:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function X(){}return X.prototype.getConstructorMetadata=function(z){var o=Reflect.getMetadata(T.PARAM_TYPES,z),Z=Reflect.getMetadata(T.TAGGED,z);return{compilerGeneratedMetadata:o,userGeneratedMetadata:Z||{}}},X.prototype.getPropertiesMetadata=function(z){var o=Reflect.getMetadata(T.TAGGED_PROP,z)||[];return o},X}();E.MetadataReader=m},wrZu:function(Re,E,i){var T=i("+K+b"),m=i("XYm9"),X=i("b2z7"),z=i("otv/"),o=i("yP5f"),Z="[object Boolean]",D="[object Date]",K="[object Map]",re="[object Number]",fe="[object RegExp]",Y="[object Set]",Fe="[object String]",We="[object Symbol]",ge="[object ArrayBuffer]",we="[object DataView]",dt="[object Float32Array]",ke="[object Float64Array]",Et="[object Int8Array]",Ze="[object Int16Array]",vt="[object Int32Array]",Qe="[object Uint8Array]",yt="[object Uint8ClampedArray]",_t="[object Uint16Array]",De="[object Uint32Array]";function Ne(Ue,st,Le){var ut=Ue.constructor;switch(st){case ge:return T(Ue);case Z:case D:return new ut(+Ue);case we:return m(Ue,Le);case dt:case ke:case Et:case Ze:case vt:case Qe:case yt:case _t:case De:return o(Ue,Le);case K:return new ut;case re:case Fe:return new ut(Ue);case fe:return X(Ue);case Y:return new ut;case We:return z(Ue)}}Re.exports=Ne},wy8a:function(Re,E,i){var T=i("KxBF");function m(X,z,o){var Z=X.length;return o=o===void 0?Z:o,!z&&o>=Z?X:T(X,z,o)}Re.exports=m},xfSm:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.NAMED_TAG="named",E.NAME_TAG="name",E.UNMANAGED_TAG="unmanaged",E.OPTIONAL_TAG="optional",E.INJECT_TAG="inject",E.MULTI_INJECT_TAG="multi_inject",E.TAGGED="inversify:tagged",E.TAGGED_PROP="inversify:tagged_props",E.PARAM_TYPES="inversify:paramtypes",E.DESIGN_PARAM_TYPES="design:paramtypes",E.POST_CONSTRUCT="post_construct"},xfeJ:function(Re,E){function i(T){return Function.toString.call(T).indexOf("[native code]")!==-1}Re.exports=i},xiII:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function X(z,o,Z,D,K){this.id=T.id(),this.serviceIdentifier=z,this.parentContext=o,this.parentRequest=Z,this.target=K,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=Z===null?new Map:null}return X.prototype.addChildRequest=function(z,o,Z){var D=new X(z,this.parentContext,this,o,Z);return this.childRequests.push(D),D},X}();E.Request=m},xp6e:function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return Ee}),i.d(E,"b",function(){return $t}),i.d(E,"c",function(){return oe}),i.d(E,"d",function(){return rt});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function m(St,ye,be,Be){function lt(Pe){return Pe instanceof be?Pe:new be(function(ht){ht(Pe)})}return new(be||(be=Promise))(function(Pe,ht){function w(ce){try{q(Be.next(ce))}catch(Ve){ht(Ve)}}function I(ce){try{q(Be.throw(ce))}catch(Ve){ht(Ve)}}function q(ce){ce.done?Pe(ce.value):lt(ce.value).then(w,I)}q((Be=Be.apply(St,ye||[])).next())})}function X(St,ye){var be={label:0,sent:function(){if(Pe[0]&1)throw Pe[1];return Pe[1]},trys:[],ops:[]},Be,lt,Pe,ht;return ht={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(ht[Symbol.iterator]=function(){return this}),ht;function w(q){return function(ce){return I([q,ce])}}function I(q){if(Be)throw new TypeError("Generator is already executing.");for(;be;)try{if(Be=1,lt&&(Pe=q[0]&2?lt.return:q[0]?lt.throw||((Pe=lt.return)&&Pe.call(lt),0):lt.next)&&!(Pe=Pe.call(lt,q[1])).done)return Pe;(lt=0,Pe)&&(q=[q[0]&2,Pe.value]);switch(q[0]){case 0:case 1:Pe=q;break;case 4:return be.label++,{value:q[1],done:!1};case 5:be.label++,lt=q[1],q=[0];continue;case 7:q=be.ops.pop(),be.trys.pop();continue;default:if(!(Pe=be.trys,Pe=Pe.length>0&&Pe[Pe.length-1])&&(q[0]===6||q[0]===2)){be=0;continue}if(q[0]===3&&(!Pe||q[1]>Pe[0]&&q[1]<Pe[3])){be.label=q[1];break}if(q[0]===6&&be.label<Pe[1]){be.label=Pe[1],Pe=q;break}if(Pe&&be.label<Pe[2]){be.label=Pe[2],be.ops.push(q);break}Pe[2]&&be.ops.pop(),be.trys.pop();continue}q=ye.call(St,be)}catch(ce){q=[6,ce],lt=0}finally{Be=Pe=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function z(St,ye){var be=typeof Symbol=="function"&&St[Symbol.iterator];if(!be)return St;var Be=be.call(St),lt,Pe=[],ht;try{for(;(ye===void 0||ye-- >0)&&!(lt=Be.next()).done;)Pe.push(lt.value)}catch(w){ht={error:w}}finally{try{lt&&!lt.done&&(be=Be.return)&&be.call(Be)}finally{if(ht)throw ht.error}}return Pe}function o(){for(var St=[],ye=0;ye<arguments.length;ye++)St=St.concat(z(arguments[ye]));return St}function Z(St){return St&&St.__esModule&&Object.prototype.hasOwnProperty.call(St,"default")?St.default:St}function D(St,ye){return ye={exports:{}},St(ye,ye.exports),ye.exports}var K=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Be){return Be&&typeof Be.length=="number"&&Be.length>=0&&Be.length%1===0}St.exports=ye.default});Z(K);var re=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=function(be){return function(){for(var Be=[],lt=arguments.length;lt--;)Be[lt]=arguments[lt];var Pe=Be.pop();return be.call(this,Be,Pe)}},St.exports=ye.default});Z(re);var fe=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.fallback=lt,ye.wrap=Pe;var be=ye.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Be=ye.hasNextTick=typeof T=="object"&&typeof T.nextTick=="function";function lt(w){setTimeout(w,0)}function Pe(w){return function(I){for(var q=[],ce=arguments.length-1;ce-- >0;)q[ce]=arguments[ce+1];return w(function(){return I.apply(void 0,q)})}}var ht;be?ht=setImmediate:Be?ht=T.nextTick:ht=lt,ye.default=Pe(ht)});Z(fe);var Y=fe.fallback,Fe=fe.wrap,We=fe.hasSetImmediate,ge=fe.hasNextTick,we=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Pe;var be=lt(re),Be=lt(fe);function lt(I){return I&&I.__esModule?I:{default:I}}function Pe(I){return(0,dt.isAsync)(I)?function(){for(var q=[],ce=arguments.length;ce--;)q[ce]=arguments[ce];var Ve=q.pop(),$e=I.apply(this,q);return ht($e,Ve)}:(0,be.default)(function(q,ce){var Ve;try{Ve=I.apply(this,q)}catch($e){return ce($e)}if(Ve&&typeof Ve.then=="function")return ht(Ve,ce);ce(null,Ve)})}function ht(I,q){return I.then(function(ce){w(q,null,ce)},function(ce){w(q,ce&&ce.message?ce:new Error(ce))})}function w(I,q,ce){try{I(q,ce)}catch(Ve){(0,Be.default)(function($e){throw $e},Ve)}}St.exports=ye.default});Z(we);var dt=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.isAsyncIterable=ye.isAsyncGenerator=ye.isAsync=void 0;var be=Be(we);function Be(I){return I&&I.__esModule?I:{default:I}}function lt(I){return I[Symbol.toStringTag]==="AsyncFunction"}function Pe(I){return I[Symbol.toStringTag]==="AsyncGenerator"}function ht(I){return typeof I[Symbol.asyncIterator]=="function"}function w(I){if(typeof I!="function")throw new Error("expected a function");return lt(I)?(0,be.default)(I):I}ye.default=w,ye.isAsync=lt,ye.isAsyncGenerator=Pe,ye.isAsyncIterable=ht});Z(dt);var ke=dt.isAsyncIterable,Et=dt.isAsyncGenerator,Ze=dt.isAsync,vt=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Be,lt){if(lt===void 0&&(lt=Be.length),!lt)throw new Error("arity is undefined");function Pe(){for(var ht=this,w=[],I=arguments.length;I--;)w[I]=arguments[I];return typeof w[lt-1]=="function"?Be.apply(this,w):new Promise(function(q,ce){w[lt-1]=function(Ve){for(var $e=[],gt=arguments.length-1;gt-- >0;)$e[gt]=arguments[gt+1];if(Ve)return ce(Ve);q($e.length>1?$e:$e[0])},Be.apply(ht,w)})}return Object.defineProperty(Pe,"name",{configurable:!0,value:"awaitable("+Be.name+")"}),Pe}St.exports=ye.default});Z(vt);var Qe=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=Pe(K),Be=Pe(dt),lt=Pe(vt);function Pe(ht){return ht&&ht.__esModule?ht:{default:ht}}ye.default=(0,lt.default)(function(ht,w,I){var q=(0,be.default)(w)?[]:{};ht(w,function(ce,Ve,$e){(0,Be.default)(ce)(function(gt){for(var nt,kt=[],$=arguments.length-1;$-- >0;)kt[$]=arguments[$+1];kt.length<2&&(nt=kt,kt=nt[0]),q[Ve]=kt,$e(gt)})},function(ce){return I(ce,q)})},3),St.exports=ye.default});Z(Qe);var yt=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Be){function lt(){for(var Pe=[],ht=arguments.length;ht--;)Pe[ht]=arguments[ht];if(Be===null)return;var w=Be;Be=null,w.apply(this,Pe)}return Object.assign(lt,Be),lt}St.exports=ye.default});Z(yt);var _t=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=function(be){return be[Symbol.iterator]&&be[Symbol.iterator]()},St.exports=ye.default});Z(_t);var De=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=I;var be=lt(K),Be=lt(_t);function lt(q){return q&&q.__esModule?q:{default:q}}function Pe(q){var ce=-1,Ve=q.length;return function(){return++ce<Ve?{value:q[ce],key:ce}:null}}function ht(q){var ce=-1;return function(){var $e=q.next();return $e.done?null:(ce++,{value:$e.value,key:ce})}}function w(q){var ce=q?Object.keys(q):[],Ve=-1,$e=ce.length;return function(){var nt=ce[++Ve];return Ve<$e?{value:q[nt],key:nt}:null}}function I(q){if((0,be.default)(q))return Pe(q);var ce=(0,Be.default)(q);return ce?ht(ce):w(q)}St.exports=ye.default});Z(De);var Ne=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Be){return function(){for(var lt=[],Pe=arguments.length;Pe--;)lt[Pe]=arguments[Pe];if(Be===null)throw new Error("Callback was already called.");var ht=Be;Be=null,ht.apply(this,lt)}}St.exports=ye.default});Z(Ne);var Ue=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be={};ye.default=be,St.exports=ye.default});Z(Ue);var st=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=lt;var be=Be(Ue);function Be(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}}function lt(Pe,ht,w,I){var q=!1,ce=!1,Ve=!1,$e=0,gt=0;function nt(){if($e>=ht||Ve||q)return;Ve=!0,Pe.next().then(function(Ke){var ae=Ke.value,et=Ke.done;if(ce||q)return;if(Ve=!1,et){q=!0,$e<=0&&I(null);return}$e++,w(ae,gt,kt),gt++,nt()}).catch($)}function kt(Ke,ae){if($e-=1,ce)return;if(Ke)return $(Ke);if(Ke===!1){q=!0,ce=!0;return}if(ae===be.default||q&&$e<=0)return q=!0,I(null);nt()}function $(Ke){if(ce)return;Ve=!1,q=!0,I(Ke)}nt()}St.exports=ye.default});Z(st);var Le=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=w(yt),Be=w(De),lt=w(Ne),Pe=w(st),ht=w(Ue);function w(I){return I&&I.__esModule?I:{default:I}}ye.default=function(I){return function(q,ce,Ve){if(Ve=(0,be.default)(Ve),I<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return Ve(null);if((0,dt.isAsyncGenerator)(q))return(0,Pe.default)(q,I,ce,Ve);if((0,dt.isAsyncIterable)(q))return(0,Pe.default)(q[Symbol.asyncIterator](),I,ce,Ve);var $e=(0,Be.default)(q),gt=!1,nt=!1,kt=0,$=!1;function Ke(et,zt){if(nt)return;if(kt-=1,et)gt=!0,Ve(et);else if(et===!1)gt=!0,nt=!0;else{if(zt===ht.default||gt&&kt<=0)return gt=!0,Ve(null);$||ae()}}function ae(){for($=!0;kt<I&&!gt;){var et=$e();if(et===null){gt=!0,kt<=0&&Ve(null);return}kt+=1,ce(et.value,et.key,(0,lt.default)(Ke))}$=!1}ae()}},St.exports=ye.default});Z(Le);var ut=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=Pe(Le),Be=Pe(dt),lt=Pe(vt);function Pe(w){return w&&w.__esModule?w:{default:w}}function ht(w,I,q,ce){return(0,be.default)(I)(w,(0,Be.default)(q),ce)}ye.default=(0,lt.default)(ht,4),St.exports=ye.default});Z(ut);var Gt=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=lt(ut),Be=lt(vt);function lt(ht){return ht&&ht.__esModule?ht:{default:ht}}function Pe(ht,w,I){return(0,be.default)(ht,1,w,I)}ye.default=(0,Be.default)(Pe,3),St.exports=ye.default});Z(Gt);var Kt=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Pe;var be=lt(Qe),Be=lt(Gt);function lt(ht){return ht&&ht.__esModule?ht:{default:ht}}function Pe(ht,w){return(0,be.default)(Be.default,ht,w)}St.exports=ye.default}),ar=Z(Kt),oe=function(){function St(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];this.args=[],this.tasks=[]}return St.prototype.call=function(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];return this.args=be,ar(this.tasks)},St.prototype.tap=function(ye,be){var Be=this;this.tasks.push(function(lt){be.apply(void 0,o(Be.args)),lt(null,ye)})},St}(),Q=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=q(K),Be=q(Ue),lt=q(ut),Pe=q(yt),ht=q(Ne),w=q(dt),I=q(vt);function q(gt){return gt&&gt.__esModule?gt:{default:gt}}function ce(gt,nt,kt){kt=(0,Pe.default)(kt);var $=0,Ke=0,ae=gt.length,et=!1;ae===0&&kt(null);function zt(sr,ft){if(sr===!1&&(et=!0),et===!0)return;sr?kt(sr):(++Ke===ae||ft===Be.default)&&kt(null)}for(;$<ae;$++)nt(gt[$],$,(0,ht.default)(zt))}function Ve(gt,nt,kt){return(0,lt.default)(gt,Infinity,nt,kt)}function $e(gt,nt,kt){var $=(0,be.default)(gt)?ce:Ve;return $(gt,(0,w.default)(nt),kt)}ye.default=(0,I.default)($e,3),St.exports=ye.default});Z(Q);var H=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Pe;var be=lt(Q),Be=lt(Qe);function lt(ht){return ht&&ht.__esModule?ht:{default:ht}}function Pe(ht,w){return(0,Be.default)(be.default,ht,w)}St.exports=ye.default}),Ce=Z(H),Ee=function(){function St(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];this.tasks=[]}return St.prototype.promise=function(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];return Ce(this.tasks)},St.prototype.tapPromise=function(ye,be){var Be=this;this.tasks.push(function(lt){return m(Be,void 0,void 0,function(){return X(this,function(Pe){switch(Pe.label){case 0:return[4,be()];case 1:return Pe.sent(),lt(null,ye),[2]}})})})},St}(),_e=D(function(St,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=ht(yt),Be=ht(Ne),lt=ht(dt),Pe=ht(vt);function ht(I){return I&&I.__esModule?I:{default:I}}function w(I,q){if(q=(0,be.default)(q),!Array.isArray(I))return q(new Error("First argument to waterfall must be an array of functions"));if(!I.length)return q();var ce=0;function Ve(gt){var nt=(0,lt.default)(I[ce++]);nt.apply(void 0,gt.concat([(0,Be.default)($e)]))}function $e(gt){for(var nt=[],kt=arguments.length-1;kt-- >0;)nt[kt]=arguments[kt+1];if(gt===!1)return;if(gt||ce===I.length)return q.apply(void 0,[gt].concat(nt));Ve(nt)}Ve([])}ye.default=(0,Pe.default)(w),St.exports=ye.default}),ve=Z(_e),rt=function(){function St(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];this.tasks=[]}return St.prototype.call=function(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];return ve(this.tasks)},St.prototype.tap=function(ye,be){this.tasks.length===0?this.tasks.push(function(Be){var lt=be();Be(lt?null:!1,lt)}):this.tasks.push(function(Be,lt){var Pe=be();lt(Pe?null:!1,ye)})},St}(),$t=function(){function St(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];this.tasks=[]}return St.prototype.call=function(){for(var ye=arguments,be=[],Be=0;Be<arguments.length;Be++)be[Be]=ye[Be];return ar(this.tasks)},St.prototype.tap=function(ye,be){this.tasks.push(function(Be){var lt=be();Be(lt,ye)})},St}()}).call(this,i("Q2Ig"))},yG8O:function(Re,E){function i(T,m,X,z){if(!X)return;Object.defineProperty(T,m,{enumerable:X.enumerable,configurable:X.configurable,writable:X.writable,value:X.initializer?X.initializer.call(z):void 0})}Re.exports=i},yHx3:function(Re,E){var i=Object.prototype,T=i.hasOwnProperty;function m(X){var z=X.length,o=new X.constructor(z);return z&&typeof X[0]=="string"&&T.call(X,"index")&&(o.index=X.index,o.input=X.input),o}Re.exports=m},yLV6:function(Re,E,i){var T;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(m,X,z,o){"use strict";var Z=["","webkit","Moz","MS","ms","o"],D=X.createElement("div"),K="function",re=Math.round,fe=Math.abs,Y=Date.now;function Fe(Ut,Ie,Pt){return setTimeout(vt(Ut,Pt),Ie)}function We(Ut,Ie,Pt){return Array.isArray(Ut)?(ge(Ut,Pt[Ie],Pt),!0):!1}function ge(Ut,Ie,Pt){var cr;if(!Ut)return;if(Ut.forEach)Ut.forEach(Ie,Pt);else if(Ut.length!==o)for(cr=0;cr<Ut.length;)Ie.call(Pt,Ut[cr],cr,Ut),cr++;else for(cr in Ut)Ut.hasOwnProperty(cr)&&Ie.call(Pt,Ut[cr],cr,Ut)}function we(Ut,Ie,Pt){var cr="DEPRECATED METHOD: "+Ie+`
`+Pt+` AT 
`;return function(){var tn=new Error("get-stack-trace"),En=tn&&tn.stack?tn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Fn=m.console&&(m.console.warn||m.console.log);return Fn&&Fn.call(m.console,cr,En),Ut.apply(this,arguments)}}var dt;typeof Object.assign!="function"?dt=function(Ie){if(Ie===o||Ie===null)throw new TypeError("Cannot convert undefined or null to object");for(var Pt=Object(Ie),cr=1;cr<arguments.length;cr++){var tn=arguments[cr];if(tn!==o&&tn!==null)for(var En in tn)tn.hasOwnProperty(En)&&(Pt[En]=tn[En])}return Pt}:dt=Object.assign;var ke=we(function(Ie,Pt,cr){for(var tn=Object.keys(Pt),En=0;En<tn.length;)(!cr||cr&&Ie[tn[En]]===o)&&(Ie[tn[En]]=Pt[tn[En]]),En++;return Ie},"extend","Use `assign`."),Et=we(function(Ie,Pt){return ke(Ie,Pt,!0)},"merge","Use `assign`.");function Ze(Ut,Ie,Pt){var cr=Ie.prototype,tn;tn=Ut.prototype=Object.create(cr),tn.constructor=Ut,tn._super=cr,Pt&&dt(tn,Pt)}function vt(Ut,Ie){return function(){return Ut.apply(Ie,arguments)}}function Qe(Ut,Ie){return typeof Ut==K?Ut.apply(Ie&&Ie[0]||o,Ie):Ut}function yt(Ut,Ie){return Ut===o?Ie:Ut}function _t(Ut,Ie,Pt){ge(st(Ie),function(cr){Ut.addEventListener(cr,Pt,!1)})}function De(Ut,Ie,Pt){ge(st(Ie),function(cr){Ut.removeEventListener(cr,Pt,!1)})}function Ne(Ut,Ie){for(;Ut;){if(Ut==Ie)return!0;Ut=Ut.parentNode}return!1}function Ue(Ut,Ie){return Ut.indexOf(Ie)>-1}function st(Ut){return Ut.trim().split(/\s+/g)}function Le(Ut,Ie,Pt){if(Ut.indexOf&&!Pt)return Ut.indexOf(Ie);for(var cr=0;cr<Ut.length;){if(Pt&&Ut[cr][Pt]==Ie||!Pt&&Ut[cr]===Ie)return cr;cr++}return-1}function ut(Ut){return Array.prototype.slice.call(Ut,0)}function Gt(Ut,Ie,Pt){for(var cr=[],tn=[],En=0;En<Ut.length;){var Fn=Ie?Ut[En][Ie]:Ut[En];Le(tn,Fn)<0&&cr.push(Ut[En]),tn[En]=Fn,En++}return Pt&&(Ie?cr=cr.sort(function(to,mo){return to[Ie]>mo[Ie]}):cr=cr.sort()),cr}function Kt(Ut,Ie){for(var Pt,cr,tn=Ie[0].toUpperCase()+Ie.slice(1),En=0;En<Z.length;){if(Pt=Z[En],cr=Pt?Pt+tn:Ie,cr in Ut)return cr;En++}return o}var ar=1;function oe(){return ar++}function Q(Ut){var Ie=Ut.ownerDocument||Ut;return Ie.defaultView||Ie.parentWindow||m}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Ce="ontouchstart"in m,Ee=Kt(m,"PointerEvent")!==o,_e=Ce&&H.test(navigator.userAgent),ve="touch",rt="pen",$t="mouse",St="kinect",ye=25,be=1,Be=2,lt=4,Pe=8,ht=1,w=2,I=4,q=8,ce=16,Ve=w|I,$e=q|ce,gt=Ve|$e,nt=["x","y"],kt=["clientX","clientY"];function $(Ut,Ie){var Pt=this;this.manager=Ut,this.callback=Ie,this.element=Ut.element,this.target=Ut.options.inputTarget,this.domHandler=function(cr){Qe(Ut.options.enable,[Ut])&&Pt.handler(cr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&_t(this.element,this.evEl,this.domHandler),this.evTarget&&_t(this.target,this.evTarget,this.domHandler),this.evWin&&_t(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&De(this.element,this.evEl,this.domHandler),this.evTarget&&De(this.target,this.evTarget,this.domHandler),this.evWin&&De(Q(this.element),this.evWin,this.domHandler)}};function Ke(Ut){var Ie,Pt=Ut.options.inputClass;return Pt?Ie=Pt:Ee?Ie=Gn:_e?Ie=Ge:Ce?Ie=Vr:Ie=zn,new Ie(Ut,ae)}function ae(Ut,Ie,Pt){var cr=Pt.pointers.length,tn=Pt.changedPointers.length,En=Ie&be&&cr-tn===0,Fn=Ie&(lt|Pe)&&cr-tn===0;Pt.isFirst=!!En,Pt.isFinal=!!Fn,En&&(Ut.session={}),Pt.eventType=Ie,et(Ut,Pt),Ut.emit("hammer.input",Pt),Ut.recognize(Pt),Ut.session.prevInput=Pt}function et(Ut,Ie){var Pt=Ut.session,cr=Ie.pointers,tn=cr.length;Pt.firstInput||(Pt.firstInput=ft(Ie)),tn>1&&!Pt.firstMultiple?Pt.firstMultiple=ft(Ie):tn===1&&(Pt.firstMultiple=!1);var En=Pt.firstInput,Fn=Pt.firstMultiple,Ri=Fn?Fn.center:En.center,to=Ie.center=pt(cr);Ie.timeStamp=Y(),Ie.deltaTime=Ie.timeStamp-En.timeStamp,Ie.angle=ct(Ri,to),Ie.distance=Me(Ri,to),zt(Pt,Ie),Ie.offsetDirection=mt(Ie.deltaX,Ie.deltaY);var mo=At(Ie.deltaTime,Ie.deltaX,Ie.deltaY);Ie.overallVelocityX=mo.x,Ie.overallVelocityY=mo.y,Ie.overallVelocity=fe(mo.x)>fe(mo.y)?mo.x:mo.y,Ie.scale=Fn?Vt(Fn.pointers,cr):1,Ie.rotation=Fn?qe(Fn.pointers,cr):0,Ie.maxPointers=Pt.prevInput?Ie.pointers.length>Pt.prevInput.maxPointers?Ie.pointers.length:Pt.prevInput.maxPointers:Ie.pointers.length,sr(Pt,Ie);var Do=Ut.element;Ne(Ie.srcEvent.target,Do)&&(Do=Ie.srcEvent.target),Ie.target=Do}function zt(Ut,Ie){var Pt=Ie.center,cr=Ut.offsetDelta||{},tn=Ut.prevDelta||{},En=Ut.prevInput||{};(Ie.eventType===be||En.eventType===lt)&&(tn=Ut.prevDelta={x:En.deltaX||0,y:En.deltaY||0},cr=Ut.offsetDelta={x:Pt.x,y:Pt.y}),Ie.deltaX=tn.x+(Pt.x-cr.x),Ie.deltaY=tn.y+(Pt.y-cr.y)}function sr(Ut,Ie){var Pt=Ut.lastInterval||Ie,cr=Ie.timeStamp-Pt.timeStamp,tn,En,Fn,Ri;if(Ie.eventType!=Pe&&(cr>ye||Pt.velocity===o)){var to=Ie.deltaX-Pt.deltaX,mo=Ie.deltaY-Pt.deltaY,Do=At(cr,to,mo);En=Do.x,Fn=Do.y,tn=fe(Do.x)>fe(Do.y)?Do.x:Do.y,Ri=mt(to,mo),Ut.lastInterval=Ie}else tn=Pt.velocity,En=Pt.velocityX,Fn=Pt.velocityY,Ri=Pt.direction;Ie.velocity=tn,Ie.velocityX=En,Ie.velocityY=Fn,Ie.direction=Ri}function ft(Ut){for(var Ie=[],Pt=0;Pt<Ut.pointers.length;)Ie[Pt]={clientX:re(Ut.pointers[Pt].clientX),clientY:re(Ut.pointers[Pt].clientY)},Pt++;return{timeStamp:Y(),pointers:Ie,center:pt(Ie),deltaX:Ut.deltaX,deltaY:Ut.deltaY}}function pt(Ut){var Ie=Ut.length;if(Ie===1)return{x:re(Ut[0].clientX),y:re(Ut[0].clientY)};for(var Pt=0,cr=0,tn=0;tn<Ie;)Pt+=Ut[tn].clientX,cr+=Ut[tn].clientY,tn++;return{x:re(Pt/Ie),y:re(cr/Ie)}}function At(Ut,Ie,Pt){return{x:Ie/Ut||0,y:Pt/Ut||0}}function mt(Ut,Ie){return Ut===Ie?ht:fe(Ut)>=fe(Ie)?Ut<0?w:I:Ie<0?q:ce}function Me(Ut,Ie,Pt){Pt||(Pt=nt);var cr=Ie[Pt[0]]-Ut[Pt[0]],tn=Ie[Pt[1]]-Ut[Pt[1]];return Math.sqrt(cr*cr+tn*tn)}function ct(Ut,Ie,Pt){Pt||(Pt=nt);var cr=Ie[Pt[0]]-Ut[Pt[0]],tn=Ie[Pt[1]]-Ut[Pt[1]];return Math.atan2(tn,cr)*180/Math.PI}function qe(Ut,Ie){return ct(Ie[1],Ie[0],kt)+ct(Ut[1],Ut[0],kt)}function Vt(Ut,Ie){return Me(Ie[0],Ie[1],kt)/Me(Ut[0],Ut[1],kt)}var pr={mousedown:be,mousemove:Be,mouseup:lt},Gr="mousedown",ur="mousemove mouseup";function zn(){this.evEl=Gr,this.evWin=ur,this.pressed=!1,$.apply(this,arguments)}Ze(zn,$,{handler:function(Ie){var Pt=pr[Ie.type];if(Pt&be&&Ie.button===0&&(this.pressed=!0),Pt&Be&&Ie.which!==1&&(Pt=lt),!this.pressed)return;Pt&lt&&(this.pressed=!1),this.callback(this.manager,Pt,{pointers:[Ie],changedPointers:[Ie],pointerType:$t,srcEvent:Ie})}});var xn={pointerdown:be,pointermove:Be,pointerup:lt,pointercancel:Pe,pointerout:Pe},na={2:ve,3:rt,4:$t,5:St},fa="pointerdown",Hn="pointermove pointerup pointercancel";m.MSPointerEvent&&!m.PointerEvent&&(fa="MSPointerDown",Hn="MSPointerMove MSPointerUp MSPointerCancel");function Gn(){this.evEl=fa,this.evWin=Hn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Ze(Gn,$,{handler:function(Ie){var Pt=this.store,cr=!1,tn=Ie.type.toLowerCase().replace("ms",""),En=xn[tn],Fn=na[Ie.pointerType]||Ie.pointerType,Ri=Fn==ve,to=Le(Pt,Ie.pointerId,"pointerId");if(En&be&&(Ie.button===0||Ri)?to<0&&(Pt.push(Ie),to=Pt.length-1):En&(lt|Pe)&&(cr=!0),to<0)return;Pt[to]=Ie,this.callback(this.manager,En,{pointers:Pt,changedPointers:[Ie],pointerType:Fn,srcEvent:Ie}),cr&&Pt.splice(to,1)}});var F={touchstart:be,touchmove:Be,touchend:lt,touchcancel:Pe},W="touchstart",le="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=W,this.evWin=le,this.started=!1,$.apply(this,arguments)}Ze(pe,$,{handler:function(Ie){var Pt=F[Ie.type];if(Pt===be&&(this.started=!0),!this.started)return;var cr=at.call(this,Ie,Pt);Pt&(lt|Pe)&&cr[0].length-cr[1].length===0&&(this.started=!1),this.callback(this.manager,Pt,{pointers:cr[0],changedPointers:cr[1],pointerType:ve,srcEvent:Ie})}});function at(Ut,Ie){var Pt=ut(Ut.touches),cr=ut(Ut.changedTouches);return Ie&(lt|Pe)&&(Pt=Gt(Pt.concat(cr),"identifier",!0)),[Pt,cr]}var Tt={touchstart:be,touchmove:Be,touchend:lt,touchcancel:Pe},jt="touchstart touchmove touchend touchcancel";function Ge(){this.evTarget=jt,this.targetIds={},$.apply(this,arguments)}Ze(Ge,$,{handler:function(Ie){var Pt=Tt[Ie.type],cr=wt.call(this,Ie,Pt);if(!cr)return;this.callback(this.manager,Pt,{pointers:cr[0],changedPointers:cr[1],pointerType:ve,srcEvent:Ie})}});function wt(Ut,Ie){var Pt=ut(Ut.touches),cr=this.targetIds;if(Ie&(be|Be)&&Pt.length===1)return cr[Pt[0].identifier]=!0,[Pt,Pt];var tn,En,Fn=ut(Ut.changedTouches),Ri=[],to=this.target;if(En=Pt.filter(function(mo){return Ne(mo.target,to)}),Ie===be)for(tn=0;tn<En.length;)cr[En[tn].identifier]=!0,tn++;for(tn=0;tn<Fn.length;)cr[Fn[tn].identifier]&&Ri.push(Fn[tn]),Ie&(lt|Pe)&&delete cr[Fn[tn].identifier],tn++;return Ri.length?[Gt(En.concat(Ri),"identifier",!0),Ri]:void 0}var ir=2500,Ur=25;function Vr(){$.apply(this,arguments);var Ut=vt(this.handler,this);this.touch=new Ge(this.manager,Ut),this.mouse=new zn(this.manager,Ut),this.primaryTouch=null,this.lastTouches=[]}Ze(Vr,$,{handler:function(Ie,Pt,cr){var tn=cr.pointerType==ve,En=cr.pointerType==$t;if(En&&cr.sourceCapabilities&&cr.sourceCapabilities.firesTouchEvents)return;if(tn)or.call(this,Pt,cr);else if(En&&Sn.call(this,cr))return;this.callback(Ie,Pt,cr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function or(Ut,Ie){Ut&be?(this.primaryTouch=Ie.changedPointers[0].identifier,Fr.call(this,Ie)):Ut&(lt|Pe)&&Fr.call(this,Ie)}function Fr(Ut){var Ie=Ut.changedPointers[0];if(Ie.identifier===this.primaryTouch){var Pt={x:Ie.clientX,y:Ie.clientY};this.lastTouches.push(Pt);var cr=this.lastTouches,tn=function(){var Fn=cr.indexOf(Pt);Fn>-1&&cr.splice(Fn,1)};setTimeout(tn,ir)}}function Sn(Ut){for(var Ie=Ut.srcEvent.clientX,Pt=Ut.srcEvent.clientY,cr=0;cr<this.lastTouches.length;cr++){var tn=this.lastTouches[cr],En=Math.abs(Ie-tn.x),Fn=Math.abs(Pt-tn.y);if(En<=Ur&&Fn<=Ur)return!0}return!1}var fn=Kt(D.style,"touchAction"),Er=fn!==o,Tn="compute",dn="auto",vn="manipulation",Sr="none",Kr="pan-x",wn="pan-y",Ka=Ia();function da(Ut,Ie){this.manager=Ut,this.set(Ie)}da.prototype={set:function(Ie){Ie==Tn&&(Ie=this.compute()),Er&&this.manager.element.style&&Ka[Ie]&&(this.manager.element.style[fn]=Ie),this.actions=Ie.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ie=[];return ge(this.manager.recognizers,function(Pt){Qe(Pt.options.enable,[Pt])&&(Ie=Ie.concat(Pt.getTouchAction()))}),Oa(Ie.join(" "))},preventDefaults:function(Ie){var Pt=Ie.srcEvent,cr=Ie.offsetDirection;if(this.manager.session.prevented){Pt.preventDefault();return}var tn=this.actions,En=Ue(tn,Sr)&&!Ka[Sr],Fn=Ue(tn,wn)&&!Ka[wn],Ri=Ue(tn,Kr)&&!Ka[Kr];if(En){var to=Ie.pointers.length===1,mo=Ie.distance<2,Do=Ie.deltaTime<250;if(to&&mo&&Do)return}if(Ri&&Fn)return;if(En||Fn&&cr&Ve||Ri&&cr&$e)return this.preventSrc(Pt)},preventSrc:function(Ie){this.manager.session.prevented=!0,Ie.preventDefault()}};function Oa(Ut){if(Ue(Ut,Sr))return Sr;var Ie=Ue(Ut,Kr),Pt=Ue(Ut,wn);return Ie&&Pt?Sr:Ie||Pt?Ie?Kr:wn:Ue(Ut,vn)?vn:dn}function Ia(){if(!Er)return!1;var Ut={},Ie=m.CSS&&m.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Pt){Ut[Pt]=Ie?m.CSS.supports("touch-action",Pt):!0}),Ut}var Xi=1,ha=2,gi=4,Ma=8,ya=Ma,la=16,Li=32;function po(Ut){this.options=dt({},this.defaults,Ut||{}),this.id=oe(),this.manager=null,this.options.enable=yt(this.options.enable,!0),this.state=Xi,this.simultaneous={},this.requireFail=[]}po.prototype={defaults:{},set:function(Ie){return dt(this.options,Ie),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ie){if(We(Ie,"recognizeWith",this))return this;var Pt=this.simultaneous;return Ie=Gu(Ie,this),Pt[Ie.id]||(Pt[Ie.id]=Ie,Ie.recognizeWith(this)),this},dropRecognizeWith:function(Ie){return We(Ie,"dropRecognizeWith",this)?this:(Ie=Gu(Ie,this),delete this.simultaneous[Ie.id],this)},requireFailure:function(Ie){if(We(Ie,"requireFailure",this))return this;var Pt=this.requireFail;return Ie=Gu(Ie,this),Le(Pt,Ie)===-1&&(Pt.push(Ie),Ie.requireFailure(this)),this},dropRequireFailure:function(Ie){if(We(Ie,"dropRequireFailure",this))return this;Ie=Gu(Ie,this);var Pt=Le(this.requireFail,Ie);return Pt>-1&&this.requireFail.splice(Pt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ie){return!!this.simultaneous[Ie.id]},emit:function(Ie){var Pt=this,cr=this.state;function tn(En){Pt.manager.emit(En,Ie)}cr<Ma&&tn(Pt.options.event+Yi(cr)),tn(Pt.options.event),Ie.additionalEvent&&tn(Ie.additionalEvent),cr>=Ma&&tn(Pt.options.event+Yi(cr))},tryEmit:function(Ie){if(this.canEmit())return this.emit(Ie);this.state=Li},canEmit:function(){for(var Ie=0;Ie<this.requireFail.length;){if(!(this.requireFail[Ie].state&(Li|Xi)))return!1;Ie++}return!0},recognize:function(Ie){var Pt=dt({},Ie);if(!Qe(this.options.enable,[this,Pt])){this.reset(),this.state=Li;return}this.state&(ya|la|Li)&&(this.state=Xi),this.state=this.process(Pt),this.state&(ha|gi|Ma|la)&&this.tryEmit(Pt)},process:function(Ie){},getTouchAction:function(){},reset:function(){}};function Yi(Ut){return Ut&la?"cancel":Ut&Ma?"end":Ut&gi?"move":Ut&ha?"start":""}function Ko(Ut){return Ut==ce?"down":Ut==q?"up":Ut==w?"left":Ut==I?"right":""}function Gu(Ut,Ie){var Pt=Ie.manager;return Pt?Pt.get(Ut):Ut}function Ba(){po.apply(this,arguments)}Ze(Ba,po,{defaults:{pointers:1},attrTest:function(Ie){var Pt=this.options.pointers;return Pt===0||Ie.pointers.length===Pt},process:function(Ie){var Pt=this.state,cr=Ie.eventType,tn=Pt&(ha|gi),En=this.attrTest(Ie);return tn&&(cr&Pe||!En)?Pt|la:tn||En?cr&lt?Pt|Ma:Pt&ha?Pt|gi:ha:Li}});function Ai(){Ba.apply(this,arguments),this.pX=null,this.pY=null}Ze(Ai,Ba,{defaults:{event:"pan",threshold:10,pointers:1,direction:gt},getTouchAction:function(){var Ie=this.options.direction,Pt=[];return Ie&Ve&&Pt.push(wn),Ie&$e&&Pt.push(Kr),Pt},directionTest:function(Ie){var Pt=this.options,cr=!0,tn=Ie.distance,En=Ie.direction,Fn=Ie.deltaX,Ri=Ie.deltaY;return En&Pt.direction||(Pt.direction&Ve?(En=Fn===0?ht:Fn<0?w:I,cr=Fn!=this.pX,tn=Math.abs(Ie.deltaX)):(En=Ri===0?ht:Ri<0?q:ce,cr=Ri!=this.pY,tn=Math.abs(Ie.deltaY))),Ie.direction=En,cr&&tn>Pt.threshold&&En&Pt.direction},attrTest:function(Ie){return Ba.prototype.attrTest.call(this,Ie)&&(this.state&ha||!(this.state&ha)&&this.directionTest(Ie))},emit:function(Ie){this.pX=Ie.deltaX,this.pY=Ie.deltaY;var Pt=Ko(Ie.direction);Pt&&(Ie.additionalEvent=this.options.event+Pt),this._super.emit.call(this,Ie)}});function es(){Ba.apply(this,arguments)}Ze(es,Ba,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Sr]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.scale-1)>this.options.threshold||this.state&ha)},emit:function(Ie){if(Ie.scale!==1){var Pt=Ie.scale<1?"in":"out";Ie.additionalEvent=this.options.event+Pt}this._super.emit.call(this,Ie)}});function ii(){po.apply(this,arguments),this._timer=null,this._input=null}Ze(ii,po,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dn]},process:function(Ie){var Pt=this.options,cr=Ie.pointers.length===Pt.pointers,tn=Ie.distance<Pt.threshold,En=Ie.deltaTime>Pt.time;if(this._input=Ie,!tn||!cr||Ie.eventType&(lt|Pe)&&!En)this.reset();else if(Ie.eventType&be)this.reset(),this._timer=Fe(function(){this.state=ya,this.tryEmit()},Pt.time,this);else if(Ie.eventType&lt)return ya;return Li},reset:function(){clearTimeout(this._timer)},emit:function(Ie){if(this.state!==ya)return;Ie&&Ie.eventType&lt?this.manager.emit(this.options.event+"up",Ie):(this._input.timeStamp=Y(),this.manager.emit(this.options.event,this._input))}});function Ki(){Ba.apply(this,arguments)}Ze(Ki,Ba,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Sr]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.rotation)>this.options.threshold||this.state&ha)}});function ts(){Ba.apply(this,arguments)}Ze(ts,Ba,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ve|$e,pointers:1},getTouchAction:function(){return Ai.prototype.getTouchAction.call(this)},attrTest:function(Ie){var Pt=this.options.direction,cr;return Pt&(Ve|$e)?cr=Ie.overallVelocity:Pt&Ve?cr=Ie.overallVelocityX:Pt&$e&&(cr=Ie.overallVelocityY),this._super.attrTest.call(this,Ie)&&Pt&Ie.offsetDirection&&Ie.distance>this.options.threshold&&Ie.maxPointers==this.options.pointers&&fe(cr)>this.options.velocity&&Ie.eventType&lt},emit:function(Ie){var Pt=Ko(Ie.offsetDirection);Pt&&this.manager.emit(this.options.event+Pt,Ie),this.manager.emit(this.options.event,Ie)}});function Ja(){po.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Ze(Ja,po,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[vn]},process:function(Ie){var Pt=this.options,cr=Ie.pointers.length===Pt.pointers,tn=Ie.distance<Pt.threshold,En=Ie.deltaTime<Pt.time;if(this.reset(),Ie.eventType&be&&this.count===0)return this.failTimeout();if(tn&&En&&cr){if(Ie.eventType!=lt)return this.failTimeout();var Fn=this.pTime?Ie.timeStamp-this.pTime<Pt.interval:!0,Ri=!this.pCenter||Me(this.pCenter,Ie.center)<Pt.posThreshold;this.pTime=Ie.timeStamp,this.pCenter=Ie.center,!Ri||!Fn?this.count=1:this.count+=1,this._input=Ie;var to=this.count%Pt.taps;if(to===0)return this.hasRequireFailures()?(this._timer=Fe(function(){this.state=ya,this.tryEmit()},Pt.interval,this),ha):ya}return Li},failTimeout:function(){return this._timer=Fe(function(){this.state=Li},this.options.interval,this),Li},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ya&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(Ut,Ie){return Ie=Ie||{},Ie.recognizers=yt(Ie.recognizers,oo.defaults.preset),new _o(Ut,Ie)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:Tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Ki,{enable:!1}],[es,{enable:!1},["rotate"]],[ts,{direction:Ve}],[Ai,{direction:Ve},["swipe"]],[Ja],[Ja,{event:"doubletap",taps:2},["tap"]],[ii]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,Ys=2;function _o(Ut,Ie){this.options=dt({},oo.defaults,Ie||{}),this.options.inputTarget=this.options.inputTarget||Ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ut,this.input=Ke(this),this.touchAction=new da(this,this.options.touchAction),Zl(this,!0),ge(this.options.recognizers,function(Pt){var cr=this.add(new Pt[0](Pt[1]));Pt[2]&&cr.recognizeWith(Pt[2]),Pt[3]&&cr.requireFailure(Pt[3])},this)}_o.prototype={set:function(Ie){return dt(this.options,Ie),Ie.touchAction&&this.touchAction.update(),Ie.inputTarget&&(this.input.destroy(),this.input.target=Ie.inputTarget,this.input.init()),this},stop:function(Ie){this.session.stopped=Ie?Ys:so},recognize:function(Ie){var Pt=this.session;if(Pt.stopped)return;this.touchAction.preventDefaults(Ie);var cr,tn=this.recognizers,En=Pt.curRecognizer;(!En||En&&En.state&ya)&&(En=Pt.curRecognizer=null);for(var Fn=0;Fn<tn.length;)cr=tn[Fn],Pt.stopped!==Ys&&(!En||cr==En||cr.canRecognizeWith(En))?cr.recognize(Ie):cr.reset(),!En&&cr.state&(ha|gi|Ma)&&(En=Pt.curRecognizer=cr),Fn++},get:function(Ie){if(Ie instanceof po)return Ie;for(var Pt=this.recognizers,cr=0;cr<Pt.length;cr++)if(Pt[cr].options.event==Ie)return Pt[cr];return null},add:function(Ie){if(We(Ie,"add",this))return this;var Pt=this.get(Ie.options.event);return Pt&&this.remove(Pt),this.recognizers.push(Ie),Ie.manager=this,this.touchAction.update(),Ie},remove:function(Ie){if(We(Ie,"remove",this))return this;if(Ie=this.get(Ie),Ie){var Pt=this.recognizers,cr=Le(Pt,Ie);cr!==-1&&(Pt.splice(cr,1),this.touchAction.update())}return this},on:function(Ie,Pt){if(Ie===o)return;if(Pt===o)return;var cr=this.handlers;return ge(st(Ie),function(tn){cr[tn]=cr[tn]||[],cr[tn].push(Pt)}),this},off:function(Ie,Pt){if(Ie===o)return;var cr=this.handlers;return ge(st(Ie),function(tn){Pt?cr[tn]&&cr[tn].splice(Le(cr[tn],Pt),1):delete cr[tn]}),this},emit:function(Ie,Pt){this.options.domEvents&&Ks(Ie,Pt);var cr=this.handlers[Ie]&&this.handlers[Ie].slice();if(!cr||!cr.length)return;Pt.type=Ie,Pt.preventDefault=function(){Pt.srcEvent.preventDefault()};for(var tn=0;tn<cr.length;)cr[tn](Pt),tn++},destroy:function(){this.element&&Zl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zl(Ut,Ie){var Pt=Ut.element;if(!Pt.style)return;var cr;ge(Ut.options.cssProps,function(tn,En){cr=Kt(Pt.style,En),Ie?(Ut.oldCssProps[cr]=Pt.style[cr],Pt.style[cr]=tn):Pt.style[cr]=Ut.oldCssProps[cr]||""}),Ie||(Ut.oldCssProps={})}function Ks(Ut,Ie){var Pt=X.createEvent("Event");Pt.initEvent(Ut,!0,!0),Pt.gesture=Ie,Ie.target.dispatchEvent(Pt)}dt(oo,{INPUT_START:be,INPUT_MOVE:Be,INPUT_END:lt,INPUT_CANCEL:Pe,STATE_POSSIBLE:Xi,STATE_BEGAN:ha,STATE_CHANGED:gi,STATE_ENDED:Ma,STATE_RECOGNIZED:ya,STATE_CANCELLED:la,STATE_FAILED:Li,DIRECTION_NONE:ht,DIRECTION_LEFT:w,DIRECTION_RIGHT:I,DIRECTION_UP:q,DIRECTION_DOWN:ce,DIRECTION_HORIZONTAL:Ve,DIRECTION_VERTICAL:$e,DIRECTION_ALL:gt,Manager:_o,Input:$,TouchAction:da,TouchInput:Ge,MouseInput:zn,PointerEventInput:Gn,TouchMouseInput:Vr,SingleTouchInput:pe,Recognizer:po,AttrRecognizer:Ba,Tap:Ja,Pan:Ai,Swipe:ts,Pinch:es,Rotate:Ki,Press:ii,on:_t,off:De,each:ge,merge:Et,extend:ke,assign:dt,inherit:Ze,bindFn:vt,prefixed:Kt});var So=typeof m!="undefined"?m:typeof self!="undefined"?self:{};So.Hammer=oo,!(T=function(){return oo}.call(E,i,E,Re),T!==o&&(Re.exports=T))})(window,document,"Hammer")},yMAV:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(X,z){this.parentContext=X,this.rootRequest=z}return m}();E.Plan=T},yP5f:function(Re,E,i){var T=i("+K+b");function m(X,z){var o=z?T(X.buffer):X.buffer;return new X.constructor(o,X.byteOffset,X.length)}Re.exports=m},yU0y:function(Re,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"a",function(){return m}),i.d(E,"c",function(){return X});var T=1e-6,m=typeof Float32Array!="undefined"?Float32Array:Array,X=Math.random;function z(K){m=K}var o=Math.PI/180;function Z(K){return K*o}function D(K,re){return Math.abs(K-re)<=T*Math.max(1,Math.abs(K),Math.abs(re))}Math.hypot||(Math.hypot=function(){for(var K=0,re=arguments.length;re--;)K+=arguments[re]*arguments[re];return Math.sqrt(K)})},yXPU:function(Re,E){function i(m,X,z,o,Z,D,K){try{var re=m[D](K),fe=re.value}catch(Y){z(Y);return}re.done?X(fe):Promise.resolve(fe).then(o,Z)}function T(m){return function(){var X=this,z=arguments;return new Promise(function(o,Z){var D=m.apply(X,z);function K(fe){i(D,o,Z,K,re,"next",fe)}function re(fe){i(D,o,Z,K,re,"throw",fe)}K(void 0)})}}Re.exports=T},ycre:function(Re,E,i){var T=i("711d"),m=T("length");Re.exports=m},z4Hk:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("RR/i"),X=function(){function z(o){this._binding=o}return z.prototype.when=function(o){return this._binding.constraint=o,new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetNamed=function(o){return this._binding.constraint=m.namedConstraint(o),new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(o){var Z=o.target!==null&&!o.target.isNamed()&&!o.target.isTagged();return Z},new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetTagged=function(o,Z){return this._binding.constraint=m.taggedConstraint(o)(Z),new T.BindingOnSyntax(this._binding)},z.prototype.whenInjectedInto=function(o){return this._binding.constraint=function(Z){return m.typeConstraint(o)(Z.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentNamed=function(o){return this._binding.constraint=function(Z){return m.namedConstraint(o)(Z.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentTagged=function(o,Z){return this._binding.constraint=function(D){return m.taggedConstraint(o)(Z)(D.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorIs=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorIs=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorNamed=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorNamed=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorTagged=function(o,Z){return this._binding.constraint=function(D){return m.traverseAncerstors(D,m.taggedConstraint(o)(Z))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorTagged=function(o,Z){return this._binding.constraint=function(D){return!m.traverseAncerstors(D,m.taggedConstraint(o)(Z))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorMatches=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,o)},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorMatches=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,o)},new T.BindingOnSyntax(this._binding)},z}();E.BindingWhenSyntax=X},zEVN:function(Re,E,i){var T=i("Gi0A"),m=i("sEf8"),X=i("mdPL"),z=X&&X.isMap,o=z?m(z):T;Re.exports=o},zZ0H:function(Re,E){function i(T){return T}Re.exports=i},zZPE:function(Re,E){var i="[object Object]";function T(Fe){var We=!1;if(Fe!=null&&typeof Fe.toString!="function")try{We=!!(Fe+"")}catch(ge){}return We}function m(Fe,We){return function(ge){return Fe(We(ge))}}var X=Function.prototype,z=Object.prototype,o=X.toString,Z=z.hasOwnProperty,D=o.call(Object),K=z.toString,re=m(Object.getPrototypeOf,Object);function fe(Fe){return!!Fe&&typeof Fe=="object"}function Y(Fe){if(!fe(Fe)||K.call(Fe)!=i||T(Fe))return!1;var We=re(Fe);if(We===null)return!0;var ge=Z.call(We,"constructor")&&We.constructor;return typeof ge=="function"&&ge instanceof ge&&o.call(ge)==D}Re.exports=Y},zoYe:function(Re,E,i){var T=i("nmnc"),m=i("eUgh"),X=i("Z0cm"),z=i("/9aa"),o=1/0,Z=T?T.prototype:void 0,D=Z?Z.toString:void 0;function K(re){if(typeof re=="string")return re;if(X(re))return m(re,K)+"";if(z(re))return D?D.call(re):"";var fe=re+"";return fe=="0"&&1/re==-o?"-0":fe}Re.exports=K},zvhG:function(Re,E){Re.exports=i;function i(T,m,X,z){this.cx=3*T,this.bx=3*(X-T)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(z-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=T,this.p1y=z,this.p2x=X,this.p2y=z}i.prototype.sampleCurveX=function(T){return((this.ax*T+this.bx)*T+this.cx)*T},i.prototype.sampleCurveY=function(T){return((this.ay*T+this.by)*T+this.cy)*T},i.prototype.sampleCurveDerivativeX=function(T){return(3*this.ax*T+2*this.bx)*T+this.cx},i.prototype.solveCurveX=function(T,m){typeof m=="undefined"&&(m=1e-6);var X,z,o,Z,D;for(o=T,D=0;D<8;D++){if(Z=this.sampleCurveX(o)-T,Math.abs(Z)<m)return o;var K=this.sampleCurveDerivativeX(o);if(Math.abs(K)<1e-6)break;o=o-Z/K}if(X=0,z=1,o=T,o<X)return X;if(o>z)return z;for(;X<z;){if(Z=this.sampleCurveX(o),Math.abs(Z-T)<m)return o;T>Z?X=o:z=o,o=(z-X)*.5+X}return o},i.prototype.solve=function(T,m){return this.sampleCurveY(this.solveCurveX(T,m))}},zxMA:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(X){this.str=X}return m.prototype.startsWith=function(X){return this.str.indexOf(X)===0},m.prototype.endsWith=function(X){var z="",o=X.split("").reverse().join("");return z=this.str.split("").reverse().join(""),this.startsWith.call({str:z},o)},m.prototype.contains=function(X){return this.str.indexOf(X)!==-1},m.prototype.equals=function(X){return this.str===X},m.prototype.value=function(){return this.str},m}();E.QueryableString=T}}]);
